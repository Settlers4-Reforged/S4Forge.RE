#include "globals.h"
// address=[0x12fcae0]
// Decompiled from void *__cdecl operator new(unsigned int a1, void *a2)
void * __cdecl operator new(unsigned int a1, void * a2) {
  
  return a2;
}


// address=[0x12fe7d0]
// [Decompilation failed for void __cdecl __empty_global_delete(void *)]

// address=[0x12fe7e0]
// Decompiled from void __empty_global_delete()
void __cdecl __global_array_delete(void *,unsigned int) {
  
  ;
}


// address=[0x12fe7e0]
// Decompiled from void __empty_global_delete()
void __cdecl __global_delete(void *,unsigned int) {
  
  ;
}


// address=[0x12fe7e0]
// Decompiled from void __empty_global_delete()
void __cdecl __empty_global_delete(void *,unsigned int) {
  
  ;
}


// address=[0x1300fa0]
// Decompiled from _DWORD *__thiscall TPriorityQueue<SSquadValue,51>::TPriorityQueue<SSquadValue,51>(_DWORD *this)
public: __thiscall TPriorityQueue<struct SSquadValue,51>::TPriorityQueue<struct SSquadValue,51>(void) {
  
  *this = 0;
  SSquadValue::MaxItem((SSquadValue *)(this + 1));
  return this;
}


// address=[0x1301220]
// Decompiled from int __thiscall TPriorityQueue<SSquadValue,51>::DownHeap(int *this, int a2)
protected: void __thiscall TPriorityQueue<struct SSquadValue,51>::DownHeap(int a2) {
  
  int v2; // eax
  int v3; // eax
  int v4; // ecx
  int *v5; // esi
  int result; // eax
  int *v7; // ecx
  int v8; // [esp+4h] [ebp-18h] BYREF
  int v9; // [esp+8h] [ebp-14h]
  int v10; // [esp+Ch] [ebp-10h]
  int v11; // [esp+10h] [ebp-Ch]
  int *v12; // [esp+14h] [ebp-8h]
  int v13; // [esp+18h] [ebp-4h]

  v12 = this;
  v11 = a2;
  v10 = *this;
  v2 = this[2 * a2 + 2];
  v8 = this[2 * a2 + 1];
  v9 = v2;
  while ( v11 <= v10 >> 1 )
  {
    v13 = 2 * v11;
    if ( 2 * v11 < v10 && SSquadValue::operator<(&v12[2 * v13 + 1], (int)&v12[2 * v13 + 3]) )
      ++v13;
    if ( !SSquadValue::operator<(&v8, (int)&v12[2 * v13 + 1]) )
      break;
    v3 = v12[2 * v13 + 2];
    v4 = v11;
    v5 = v12;
    v12[2 * v11 + 1] = v12[2 * v13 + 1];
    v5[2 * v4 + 2] = v3;
    v11 = v13;
  }
  result = v11;
  v7 = v12;
  v12[2 * v11 + 1] = v8;
  v7[2 * result + 2] = v9;
  return result;
}


// address=[0x1301330]
// Decompiled from bool __thiscall TPriorityQueue<SSquadValue,51>::Empty(_DWORD *this)
public: bool __thiscall TPriorityQueue<struct SSquadValue,51>::Empty(void)const {
  
  return *this == 0;
}


// address=[0x1301680]
// Decompiled from int __thiscall TPriorityQueue<SSquadValue,51>::Pop(int *this)
public: void __thiscall TPriorityQueue<struct SSquadValue,51>::Pop(void) {
  
  int v1; // ecx
  int v2; // eax
  int v3; // ecx

  v1 = *this;
  v2 = this[2 * v1 + 1];
  v3 = this[2 * v1 + 2];
  this[3] = v2;
  this[4] = v3;
  --*this;
  return TPriorityQueue<SSquadValue,51>::DownHeap(this, 1);
}


// address=[0x13016e0]
// Decompiled from int __thiscall TPriorityQueue<SSquadValue,51>::Push(int *this, int *a2)
public: void __thiscall TPriorityQueue<struct SSquadValue,51>::Push(struct SSquadValue const & a2) {
  
  int v2; // eax
  int v4; // [esp+4h] [ebp-8h]

  v4 = *this + 1;
  *this = v4;
  v2 = a2[1];
  this[2 * v4 + 1] = *a2;
  this[2 * v4 + 2] = v2;
  return TPriorityQueue<SSquadValue,51>::UpHeap(*this);
}


// address=[0x1301830]
// Decompiled from char *__thiscall TPriorityQueue<SSquadValue,51>::Top(char *this)
public: struct SSquadValue const & __thiscall TPriorityQueue<struct SSquadValue,51>::Top(void)const {
  
  return this + 12;
}


// address=[0x1301870]
// Decompiled from _DWORD *__thiscall TPriorityQueue<SSquadValue,51>::UpHeap(_DWORD *this, int a2)
protected: void __thiscall TPriorityQueue<struct SSquadValue,51>::UpHeap(int a2) {
  
  int v2; // eax
  int v3; // edx
  _DWORD *v4; // esi
  _DWORD *result; // eax
  int v6; // [esp+4h] [ebp-Ch] BYREF
  int v7; // [esp+8h] [ebp-8h]
  _DWORD *v8; // [esp+Ch] [ebp-4h]

  v8 = this;
  v2 = this[2 * a2 + 2];
  v6 = this[2 * a2 + 1];
  v7 = v2;
  while ( SSquadValue::operator<(&v8[2 * (a2 >> 1) + 1], (int)&v6) )
  {
    v3 = v8[2 * (a2 >> 1) + 2];
    v4 = v8;
    v8[2 * a2 + 1] = v8[2 * (a2 >> 1) + 1];
    v4[2 * a2 + 2] = v3;
    a2 >>= 1;
  }
  result = v8;
  v8[2 * a2 + 1] = v6;
  result[2 * a2 + 2] = v7;
  return result;
}


// address=[0x13066c0]
// Decompiled from bool __cdecl Grid::InQuadrat(int grid, unsigned int a2, unsigned int a3)
bool __cdecl Grid::InQuadrat(int grid, int a2, int a3) {
  
  int v4; // [esp+4h] [ebp-8h]
  int v5; // [esp+8h] [ebp-4h]

  if ( grid < a3 )
    v5 = -1;
  else
    v5 = 0;
  if ( a2 < a3 )
    v4 = -1;
  else
    v4 = 0;
  return (v4 & v5) != 0;
}


// address=[0x1306b00]
// Decompiled from int __cdecl Squares::XYToVW(int xy)
int __cdecl Squares::XYToVW(int xy) {
  
  return xy >> 4;
}


// address=[0x1307190]
// Decompiled from int __cdecl Y16X16::UnpackXFast(unsigned __int16 a1)
int __cdecl Y16X16::UnpackXFast(int a1) {
  
  return a1;
}


// address=[0x13071a0]
// Decompiled from int __cdecl sub_17071A0(int a1)
int __cdecl Y16X16::UnpackYFast(int a1) {
  
  return a1 >> 16;
}


// address=[0x1309eb0]
// Decompiled from _DWORD *__thiscall TAIStaticMemoryPool<48,512>::TAIStaticMemoryPool<48,512>(_DWORD *this)
public: __thiscall TAIStaticMemoryPool<48,512>::TAIStaticMemoryPool<48,512>(void) {
  
  int i; // [esp+4h] [ebp-8h]

  *this = 0;
  *(_DWORD *)TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(0) = -1;
  *(_DWORD *)(TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(0) + 4) = 1;
  for ( i = 1; i < 511; ++i )
  {
    *(_DWORD *)TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(i) = i - 1;
    *(_DWORD *)(TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(i) + 4) = i + 1;
  }
  *(_DWORD *)TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(511) = 510;
  *(_DWORD *)(TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(511) + 4) = -1;
  return this;
}


// address=[0x1309f90]
// Decompiled from _DWORD *__thiscall TAIStaticObjectMemoryPool<CAIEcoSectorAIEx,48,512>::TAIStaticObjectMemoryPool<CAIEcoSectorAIEx,48,512>(  _DWORD *this)
public: __thiscall TAIStaticObjectMemoryPool<class CAIEcoSectorAIEx,48,512>::TAIStaticObjectMemoryPool<class CAIEcoSectorAIEx,48,512>(void) {
  
  TAIStaticMemoryPool<48,512>::TAIStaticMemoryPool<48,512>(this);
  return this;
}


// address=[0x130a0f0]
// Decompiled from void operator delete()
void __cdecl operator delete(void *,void *) {
  
  ;
}


// address=[0x130a140]
// Decompiled from int __thiscall TAIStaticMemoryPool<48,512>::AllocateMemory(_DWORD *this, unsigned int a2)
public: void * __thiscall TAIStaticMemoryPool<48,512>::AllocateMemory(unsigned int a2) {
  
  int v3; // [esp+0h] [ebp-8h]

  if ( a2 > 0x30
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         53,
         "_uSize <= ENTRY_SIZE") == 1 )
  {
    __debugbreak();
  }
  v3 = *this;
  if ( (int)*this < 0 )
  {
    if ( BBSupportDbgReport(
           1,
           "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
           72,
           "TAIStaticMemoryPool::AllocateMemory(): Out of pool memory!") == 1 )
      __debugbreak();
    return 0;
  }
  else
  {
    if ( *(_DWORD *)TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(v3) != -1
      && BBSupportDbgReport(
           2,
           "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
           59,
           "PoolFreeEntryPtr(iEntryIdx)->m_iPrevFreeEntryIdx == -1") == 1 )
    {
      __debugbreak();
    }
    *this = *(_DWORD *)(TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(v3) + 4);
    if ( (int)*this >= 0 )
      *(_DWORD *)TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(*this) = -1;
    return (int)&this[12 * v3 + 1];
  }
}


// address=[0x130a270]
// Decompiled from int __stdcall TAIStaticObjectMemoryPool<CAIEcoSectorAIEx,48,512>::Delete(CAIEcoSectorAIEx *a1)
public: void __thiscall TAIStaticObjectMemoryPool<class CAIEcoSectorAIEx,48,512>::Delete(class CAIEcoSectorAIEx * a1) {
  
  int result; // eax

  if ( !a1 )
    return result;
  delete a1;
  return TAIStaticMemoryPool<48,512>::FreeMemory(a1);
}


// address=[0x130a2b0]
// Decompiled from void __thiscall TAIStaticMemoryPool<48,512>::FreeMemory(int *this, int a2)
public: void __thiscall TAIStaticMemoryPool<48,512>::FreeMemory(void * a2) {
  
  int v2; // [esp+0h] [ebp-8h]

  if ( a2 )
  {
    v2 = (a2 - (int)(this + 1)) / 48;
    if ( a2 != TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(v2)
      && BBSupportDbgReport(
           2,
           "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
           84,
           "_pMemory == PoolFreeEntryPtr(iEntryIdx)") == 1 )
    {
      __debugbreak();
    }
    *(_DWORD *)TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(v2) = -1;
    *(_DWORD *)(TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(v2) + 4) = *this;
    if ( *this >= 0 )
    {
      if ( *(_DWORD *)TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(*this) != -1
        && BBSupportDbgReport(
             2,
             "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
             91,
             "PoolFreeEntryPtr(m_iFirstFreeEntryIdx)->m_iPrevFreeEntryIdx == -1") == 1 )
      {
        __debugbreak();
      }
      *(_DWORD *)TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(*this) = v2;
    }
    *this = v2;
  }
}


// address=[0x130a4c0]
// Decompiled from int __thiscall TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(void *this, int a2)
protected: struct TAIStaticMemoryPool<48,512>::SFreeEntry * __thiscall TAIStaticMemoryPool<48,512>::PoolFreeEntryPtr(int a2) {
  
  return (int)this + 48 * a2 + 4;
}


// address=[0x130e310]
// Decompiled from void __vcrt_va_start_verify_argument_type<char const *>()
void __cdecl __vcrt_va_start_verify_argument_type<char const *>(void) {
  
  ;
}


// address=[0x130ea40]
// Decompiled from int __cdecl Grid::Distance(int x1, int y1, int x2, int y2)
int __cdecl Grid::Distance(int x1, int y1, int x2, int y2) {
  
  return Grid::Distance(x2 - x1, y2 - y1);
}


// address=[0x130ea70]
// Decompiled from int __cdecl Grid::DistanceInline(int this, int a2)
int __cdecl Grid::DistanceInline(int a2, int a2) {
  
  int v3; // [esp+0h] [ebp-Ch]
  int Number; // [esp+14h] [ebp+8h]
  int v7; // [esp+18h] [ebp+Ch]

  v3 = a2 ^ this;
  Number = j__abs(this);
  v7 = j__abs(a2);
  if ( v3 < 0 )
    return v7 + Number;
  if ( Number >= v7 )
    return Number;
  else
    return v7;
}


// address=[0x130f2a0]
// Decompiled from int __cdecl Y16X16::PackXYFast(int a1, int a2)
int __cdecl Y16X16::PackXYFast(int a1, int a2) {
  
  return a1 + (a2 << 16);
}


// address=[0x130f460]
// Decompiled from void __cdecl Y16X16::UnpackXYFast(int packed, int *x, int *y)
void __cdecl Y16X16::UnpackXYFast(int packed, int & x, int & y) {
  
  *x = (unsigned __int16)packed;
  *y = packed >> 16;
}


// address=[0x130f4d0]
// Decompiled from bool __cdecl Squares::ValidVW(unsigned int vw)
bool __cdecl Squares::ValidVW(int vw) {
  
  return vw < 0x40;
}


// address=[0x1315f10]
// [Decompilation failed for void __cdecl DebugIteratorTest(void)]

// address=[0x1319010]
// Decompiled from _DWORD *__thiscall TAIStaticMemoryPool<692,9>::TAIStaticMemoryPool<692,9>(_DWORD *this)
public: __thiscall TAIStaticMemoryPool<692,9>::TAIStaticMemoryPool<692,9>(void) {
  
  int i; // [esp+4h] [ebp-8h]

  *this = 0;
  *(_DWORD *)TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(0) = -1;
  *(_DWORD *)(TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(0) + 4) = 1;
  for ( i = 1; i < 8; ++i )
  {
    *(_DWORD *)TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(i) = i - 1;
    *(_DWORD *)(TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(i) + 4) = i + 1;
  }
  *(_DWORD *)TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(8) = 7;
  *(_DWORD *)(TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(8) + 4) = -1;
  return this;
}


// address=[0x13190e0]
// Decompiled from _DWORD *__thiscall TAIStaticObjectMemoryPool<CAIPlayerAI,692,9>::TAIStaticObjectMemoryPool<CAIPlayerAI,692,9>(  _DWORD *this)
public: __thiscall TAIStaticObjectMemoryPool<class CAIPlayerAI,692,9>::TAIStaticObjectMemoryPool<class CAIPlayerAI,692,9>(void) {
  
  TAIStaticMemoryPool<692,9>::TAIStaticMemoryPool<692,9>(this);
  return this;
}


// address=[0x1319100]
// Decompiled from _DWORD *__thiscall TAIStaticPtrVector<CAISectorAI,8>::TAIStaticPtrVector<CAISectorAI,8>(_DWORD *this)
public: __thiscall TAIStaticPtrVector<class CAISectorAI,8>::TAIStaticPtrVector<class CAISectorAI,8>(void) {
  
  *this = 0;
  memset(this + 1, 0, 0x20u);
  return this;
}


// address=[0x1319140]
// Decompiled from std::_Basic_container_proxy_ptr12 *__thiscall TStaticArray<int,8>::TStaticArray<int,8>(  std::_Basic_container_proxy_ptr12 *this)
public: __thiscall TStaticArray<int,8>::TStaticArray<int,8>(void) {
  
  TStaticArray<int,8>::Init(this);
  return this;
}


// address=[0x1319210]
// Decompiled from int __thiscall TAIStaticPtrVector<CAISectorAI,8>::~TAIStaticPtrVector<CAISectorAI,8>(void *this)
public: __thiscall TAIStaticPtrVector<class CAISectorAI,8>::~TAIStaticPtrVector<class CAISectorAI,8>(void) {
  
  return TAIStaticPtrVector<CAISectorAI,8>::ReleaseAll(this);
}


// address=[0x1319320]
// Decompiled from int __thiscall TAIStaticPtrVector<CAISectorAI,8>::operator[](_DWORD *this, int a2)
public: class CAISectorAI * __thiscall TAIStaticPtrVector<class CAISectorAI,8>::operator[](int a2)const {
  
  return this[a2 + 1];
}


// address=[0x13194c0]
// Decompiled from int __thiscall TAIStaticMemoryPool<692,9>::AllocateMemory(_DWORD *this, unsigned int a2)
public: void * __thiscall TAIStaticMemoryPool<692,9>::AllocateMemory(unsigned int a2) {
  
  int v3; // [esp+0h] [ebp-8h]

  if ( a2 > 0x2B4
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         53,
         "_uSize <= ENTRY_SIZE") == 1 )
  {
    __debugbreak();
  }
  v3 = *this;
  if ( (int)*this < 0 )
  {
    if ( BBSupportDbgReport(
           1,
           "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
           72,
           "TAIStaticMemoryPool::AllocateMemory(): Out of pool memory!") == 1 )
      __debugbreak();
    return 0;
  }
  else
  {
    if ( *(_DWORD *)TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(v3) != -1
      && BBSupportDbgReport(
           2,
           "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
           59,
           "PoolFreeEntryPtr(iEntryIdx)->m_iPrevFreeEntryIdx == -1") == 1 )
    {
      __debugbreak();
    }
    *this = *(_DWORD *)(TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(v3) + 4);
    if ( (int)*this >= 0 )
      *(_DWORD *)TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(*this) = -1;
    return (int)&this[173 * v3 + 1];
  }
}


// address=[0x1319660]
// Decompiled from int __stdcall TAIStaticObjectMemoryPool<CAIPlayerAI,692,9>::Delete(CAIPlayerAI *a1)
public: void __thiscall TAIStaticObjectMemoryPool<class CAIPlayerAI,692,9>::Delete(class CAIPlayerAI * a1) {
  
  int result; // eax

  if ( !a1 )
    return result;
  delete a1;
  return TAIStaticMemoryPool<692,9>::FreeMemory(a1);
}


// address=[0x13196b0]
// Decompiled from void __thiscall TAIStaticMemoryPool<692,9>::FreeMemory(int *this, int a2)
public: void __thiscall TAIStaticMemoryPool<692,9>::FreeMemory(void * a2) {
  
  int v2; // [esp+0h] [ebp-8h]

  if ( a2 )
  {
    v2 = (a2 - (int)(this + 1)) / 692;
    if ( a2 != TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(v2)
      && BBSupportDbgReport(
           2,
           "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
           84,
           "_pMemory == PoolFreeEntryPtr(iEntryIdx)") == 1 )
    {
      __debugbreak();
    }
    *(_DWORD *)TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(v2) = -1;
    *(_DWORD *)(TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(v2) + 4) = *this;
    if ( *this >= 0 )
    {
      if ( *(_DWORD *)TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(*this) != -1
        && BBSupportDbgReport(
             2,
             "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
             91,
             "PoolFreeEntryPtr(m_iFirstFreeEntryIdx)->m_iPrevFreeEntryIdx == -1") == 1 )
      {
        __debugbreak();
      }
      *(_DWORD *)TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(*this) = v2;
    }
    *this = v2;
  }
}


// address=[0x13197d0]
// Decompiled from void __thiscall TStaticArray<int,8>::Init(std::_Basic_container_proxy_ptr12 *this)
public: void __thiscall TStaticArray<int,8>::Init(void) {
  
  *(_DWORD *)this = 0;
}


// address=[0x1319850]
// Decompiled from int __thiscall TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(void *this, int a2)
protected: struct TAIStaticMemoryPool<692,9>::SFreeEntry * __thiscall TAIStaticMemoryPool<692,9>::PoolFreeEntryPtr(int a2) {
  
  return (int)this + 692 * a2 + 4;
}


// address=[0x13198c0]
// Decompiled from int __thiscall TAIStaticPtrVector<CAISectorAI,8>::PushBack(int *this, int a2)
public: void __thiscall TAIStaticPtrVector<class CAISectorAI,8>::PushBack(class CAISectorAI * a2) {
  
  int result; // eax

  if ( !a2
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         216,
         "_pEntry != 0") == 1 )
  {
    __debugbreak();
  }
  if ( *this >= 8
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         217,
         "m_iSize < iMaxSize") == 1 )
  {
    __debugbreak();
  }
  if ( this[*this + 1]
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         218,
         "m_pEntries[m_iSize] == 0") == 1 )
  {
    __debugbreak();
  }
  this[*this + 1] = a2;
  result = *this + 1;
  *this = result;
  return result;
}


// address=[0x1319990]
// Decompiled from int *__thiscall TStaticArray<int,8>::PushBack(int *this, int *a2)
public: void __thiscall TStaticArray<int,8>::PushBack(int const & a2) {
  
  int *result; // eax

  if ( *this >= 8
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\BaseLib\\Include\\Misc\\Templates.h",
         154,
         "m_iSize < MAX_SIZE") == 1 )
  {
    __debugbreak();
  }
  this[*this + 1] = *a2;
  result = this;
  ++*this;
  return result;
}


// address=[0x1319a00]
// Decompiled from _DWORD *__thiscall TAIStaticPtrVector<CAISectorAI,8>::ReleaseAll(_DWORD *this)
public: void __thiscall TAIStaticPtrVector<class CAISectorAI,8>::ReleaseAll(void) {
  
  _DWORD *result; // eax
  int i; // [esp+4h] [ebp-4h]

  for ( i = 0; i < *this; ++i )
  {
    if ( !this[i + 1]
      && BBSupportDbgReport(
           2,
           "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
           246,
           "m_pEntries[i] != 0") == 1 )
    {
      __debugbreak();
    }
    (**(void (__thiscall ***)(_DWORD))this[i + 1])(this[i + 1]);
    this[i + 1] = 0;
  }
  result = this;
  *this = 0;
  return result;
}


// address=[0x1319ab0]
// Decompiled from char __thiscall TStaticArray<int,8>::SearchBackwards(_DWORD *this, _DWORD *a2)
public: bool __thiscall TStaticArray<int,8>::SearchBackwards(int const & a2) {
  
  int i; // [esp+4h] [ebp-4h]

  for ( i = *this - 1; i >= 0; --i )
  {
    if ( this[i + 1] == *a2 )
      return 1;
  }
  return 0;
}


// address=[0x1319b10]
// Decompiled from int __thiscall TAIStaticPtrVector<CAISectorAI,8>::Size(void *this)
public: int __thiscall TAIStaticPtrVector<class CAISectorAI,8>::Size(void)const {
  
  return *(_DWORD *)this;
}


// address=[0x131a520]
// Decompiled from double __cdecl sqrt<int>(int a1)
double __cdecl sqrt<int>(int a1) {
  
  return sqrt((double)a1);
}


// address=[0x131b520]
// Decompiled from bool __cdecl operator==(void *Buf1, void *Buf2)
bool __cdecl operator==(struct SAIResourceData const & Buf1, struct SAIResourceData const & Buf2) {
  
  return j__memcmp(Buf1, Buf2, 0x2Au) == 0;
}


// address=[0x131bcc0]
// Decompiled from int InitResourceGroundInfoMap()
void __cdecl InitResourceGroundInfoMap(void) {
  
  int result; // eax
  int i; // [esp+0h] [ebp-4h]

  for ( i = 0; i < 16; ++i )
    dword_3EC2D28[i] = 7;
  dword_3EC2D28[1] = 1;
  dword_3EC2D28[4] = 2;
  dword_3EC2D28[9] = 3;
  result = 8;
  dword_3EC2D28[2] = 4;
  return result;
}


// address=[0x131ca50]
// Decompiled from int __cdecl Squares::VWToXY(int vw)
int __cdecl Squares::VWToXY(int vw) {
  
  return 16 * vw;
}


// address=[0x131ca60]
// Decompiled from bool __cdecl Squares::ValidVW(int a1, int a2)
bool __cdecl Squares::ValidVW(int a1, int a2) {
  
  int v3; // [esp+4h] [ebp-8h]
  int v4; // [esp+8h] [ebp-4h]

  if ( (unsigned int)a1 < 0x40 )
    v4 = -1;
  else
    v4 = 0;
  if ( (unsigned int)a2 < 0x40 )
    v3 = -1;
  else
    v3 = 0;
  return (v3 & v4) != 0;
}


// address=[0x131d8c0]
// [Decompilation failed for void __cdecl AILuaGlobalFuncDebugTest(void)]

// address=[0x131e5d0]
// Decompiled from _DWORD *__thiscall TStaticConfigIntArray<3>::TStaticConfigIntArray<3>(  _DWORD *this,  int a2,  int a3,  int a4,  int a5,  int a6)
public: __thiscall TStaticConfigIntArray<3>::TStaticConfigIntArray<3>(char const * a2, char const * a3, int a4, int a5, int a6) {
  
  TStaticConfigIntArrayBase<3>::TStaticConfigIntArrayBase<3>(a2, a3);
  *this = &TStaticConfigIntArray_3_::_vftable_;
  this[2] = a4;
  this[3] = a5;
  this[4] = a6;
  return this;
}


// address=[0x131e650]
// Decompiled from _DWORD *__thiscall TStaticConfigIntArrayBase<3>::TStaticConfigIntArrayBase<3>(_DWORD *this, int a2, int a3)
private: __thiscall TStaticConfigIntArrayBase<3>::TStaticConfigIntArrayBase<3>(char const * a2, char const * a3) {
  
  CStaticConfigVar::CStaticConfigVar(this, a2, a3, 2, 3);
  *this = &TStaticConfigIntArrayBase_3_::_vftable_;
  return this;
}


// address=[0x131e930]
// Decompiled from int __thiscall TStaticConfigIntArray<3>::~TStaticConfigIntArray<3>(void *this)
public: __thiscall TStaticConfigIntArray<3>::~TStaticConfigIntArray<3>(void) {
  
  return TStaticConfigIntArrayBase<3>::~TStaticConfigIntArrayBase<3>(this, this);
}


// address=[0x131e950]
// Decompiled from CConfigVar *__thiscall TStaticConfigIntArrayBase<3>::~TStaticConfigIntArrayBase<3>(CStaticConfigVar *this)
public: __thiscall TStaticConfigIntArrayBase<3>::~TStaticConfigIntArrayBase<3>(void) {
  
  return CStaticConfigVar::~CStaticConfigVar(this);
}


// address=[0x131eab0]
// Decompiled from int __thiscall TStaticConfigIntArrayBase<3>::operator[](void *this, int a2)
public: int & __thiscall TStaticConfigIntArrayBase<3>::operator[](int a2) {
  
  return (int)this + 4 * a2 + 8;
}


// address=[0x131ec40]
// Decompiled from char *__thiscall TStaticConfigIntArrayBase<3>::GetIntArray(char *this)
public: int * __thiscall TStaticConfigIntArrayBase<3>::GetIntArray(void) {
  
  return this + 8;
}


// address=[0x131ec60]
// Decompiled from char *__thiscall TStaticConfigIntArrayBase<3>::GetIntArray(char *this)
public: int const * __thiscall TStaticConfigIntArrayBase<3>::GetIntArray(void)const {
  
  return this + 8;
}


// address=[0x1325a00]
// Decompiled from _DWORD *__thiscall TAIStaticPtrVector<CAIEcoSectorAIEx,512>::TAIStaticPtrVector<CAIEcoSectorAIEx,512>(_DWORD *this)
public: __thiscall TAIStaticPtrVector<class CAIEcoSectorAIEx,512>::TAIStaticPtrVector<class CAIEcoSectorAIEx,512>(void) {
  
  *this = 0;
  memset(this + 1, 0, 0x800u);
  return this;
}


// address=[0x1325be0]
// Decompiled from int __thiscall TAIStaticPtrVector<CAIEcoSectorAIEx,512>::~TAIStaticPtrVector<CAIEcoSectorAIEx,512>(void *this)
public: __thiscall TAIStaticPtrVector<class CAIEcoSectorAIEx,512>::~TAIStaticPtrVector<class CAIEcoSectorAIEx,512>(void) {
  
  return TAIStaticPtrVector<CAIEcoSectorAIEx,512>::ReleaseAll(this);
}


// address=[0x1325ea0]
// Decompiled from int __thiscall TAIStaticPtrVector<CAIEcoSectorAIEx,512>::operator[](_DWORD *this, int a2)
public: class CAIEcoSectorAIEx * __thiscall TAIStaticPtrVector<class CAIEcoSectorAIEx,512>::operator[](int a2)const {
  
  return this[a2 + 1];
}


// address=[0x13261f0]
// Decompiled from int __thiscall TAIStaticPtrVector<CAIEcoSectorAIEx,512>::PushBack(int *this, int a2)
public: void __thiscall TAIStaticPtrVector<class CAIEcoSectorAIEx,512>::PushBack(class CAIEcoSectorAIEx * a2) {
  
  int result; // eax

  if ( !a2
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         216,
         "_pEntry != 0") == 1 )
  {
    __debugbreak();
  }
  if ( *this >= 512
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         217,
         "m_iSize < iMaxSize") == 1 )
  {
    __debugbreak();
  }
  if ( this[*this + 1]
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         218,
         "m_pEntries[m_iSize] == 0") == 1 )
  {
    __debugbreak();
  }
  this[*this + 1] = a2;
  result = *this + 1;
  *this = result;
  return result;
}


// address=[0x13262d0]
// Decompiled from int __thiscall TAIStaticPtrVector<CAIEcoSectorAIEx,512>::Release(int *this, int a2)
public: void __thiscall TAIStaticPtrVector<class CAIEcoSectorAIEx,512>::Release(int a2) {
  
  int result; // eax

  if ( a2 < 0
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         225,
         "_iIdx >= 0") == 1 )
  {
    __debugbreak();
  }
  if ( a2 >= *this
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         226,
         "_iIdx < m_iSize") == 1 )
  {
    __debugbreak();
  }
  if ( *this <= 0
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         227,
         "m_iSize > 0") == 1 )
  {
    __debugbreak();
  }
  if ( !this[a2 + 1]
    && BBSupportDbgReport(
         2,
         "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
         228,
         "m_pEntries[_iIdx] != 0") == 1 )
  {
    __debugbreak();
  }
  (**(void (__thiscall ***)(int))this[a2 + 1])(this[a2 + 1]);
  if ( a2 < --*this )
    this[a2 + 1] = this[*this + 1];
  result = *this;
  this[*this + 1] = 0;
  return result;
}


// address=[0x1326420]
// Decompiled from _DWORD *__thiscall TAIStaticPtrVector<CAIEcoSectorAIEx,512>::ReleaseAll(_DWORD *this)
public: void __thiscall TAIStaticPtrVector<class CAIEcoSectorAIEx,512>::ReleaseAll(void) {
  
  _DWORD *result; // eax
  int i; // [esp+4h] [ebp-4h]

  for ( i = 0; i < *this; ++i )
  {
    if ( !this[i + 1]
      && BBSupportDbgReport(
           2,
           "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\ai\\AI_Templates.h",
           246,
           "m_pEntries[i] != 0") == 1 )
    {
      __debugbreak();
    }
    (**(void (__thiscall ***)(_DWORD))this[i + 1])(this[i + 1]);
    this[i + 1] = 0;
  }
  result = this;
  *this = 0;
  return result;
}


// address=[0x13264d0]
// Decompiled from int __thiscall TAIStaticPtrVector<CAIEcoSectorAIEx,512>::Size(void *this)
public: int __thiscall TAIStaticPtrVector<class CAIEcoSectorAIEx,512>::Size(void)const {
  
  return *(_DWORD *)this;
}


// address=[0x132f920]
// Decompiled from int __cdecl SurroundingHexPointsCount(int a1)
int __cdecl SurroundingHexPointsCount(int a1) {
  
  return (a1 + 1) * 3 * a1 + 1;
}


// address=[0x1339ef0]
// Decompiled from void *__thiscall TPowerOf2Wrap<1024>::TPowerOf2Wrap<1024>(void *this)
protected: __thiscall TPowerOf2Wrap<1024>::TPowerOf2Wrap<1024>(void) {
  
  return this;
}


// address=[0x1339f10]
// Decompiled from void *__thiscall TStaticFIFO<unsigned short,1024>::TStaticFIFO<unsigned short,1024>(void *this)
public: __thiscall TStaticFIFO<unsigned short,1024>::TStaticFIFO<unsigned short,1024>(void) {
  
  TPowerOf2Wrap<1024>::TPowerOf2Wrap<1024>(this);
  TStaticFIFO<unsigned short,1024>::Init(this);
  return this;
}


// address=[0x1339f70]
// Decompiled from bool __thiscall TStaticFIFO<unsigned short,1024>::Empty(_DWORD *this)
public: bool __thiscall TStaticFIFO<unsigned short,1024>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x1339fb0]
// Decompiled from _DWORD *__thiscall TStaticFIFO<unsigned short,1024>::Init(_DWORD *this)
public: void __thiscall TStaticFIFO<unsigned short,1024>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x133a070]
// Decompiled from int __thiscall TStaticFIFO<unsigned short,1024>::Pop(_DWORD *this)
public: void __thiscall TStaticFIFO<unsigned short,1024>::Pop(void) {
  
  int result; // eax

  result = TPowerOf2Wrap<1024>::Wrap(*this + 1);
  *this = result;
  return result;
}


// address=[0x133a0a0]
// Decompiled from int __thiscall TStaticFIFO<unsigned short,1024>::Push(_DWORD *this, _WORD *a2)
public: void __thiscall TStaticFIFO<unsigned short,1024>::Push(unsigned short const & a2) {
  
  int result; // eax

  *((_WORD *)this + this[1] + 4) = *a2;
  result = TPowerOf2Wrap<1024>::Wrap(this[1] + 1);
  this[1] = result;
  return result;
}


// address=[0x133a1a0]
// Decompiled from int __thiscall TStaticFIFO<unsigned short,1024>::Top(_DWORD *this)
public: unsigned short & __thiscall TStaticFIFO<unsigned short,1024>::Top(void) {
  
  return (int)this + 2 * *this + 8;
}


// address=[0x133a1c0]
// Decompiled from int __cdecl TPowerOf2Wrap<1024>::Wrap(__int16 a1)
protected: int __cdecl TPowerOf2Wrap<1024>::Wrap(int a1) {
  
  return a1 & 0x3FF;
}


// address=[0x1346cf0]
// Decompiled from int __cdecl _tcsstr(unsigned __int8 *Str, unsigned __int8 *Substr)
char * __cdecl _tcsstr(char * Str, char const * Substr) {
  
  return j___tcsstr(Str, Substr);
}


// address=[0x134dba0]
// Decompiled from int GetAvailableSection()
int __cdecl GetAvailableSection(void) {
  
  if ( ++dword_3ECD9CC < 255 )
    return dword_3ECD9CC;
  else
    return -1;
}


// address=[0x134dbe0]
// Decompiled from int __cdecl Bugreport::GetBugReportsDirectoryPath(int a1)
std::wstring __cdecl Bugreport::GetBugReportsDirectoryPath(void a1) {
  
  void *UserDirectoryPath; // [esp+4h] [ebp-38h]
  _BYTE v3[28]; // [esp+10h] [ebp-2Ch] BYREF
  int v4; // [esp+38h] [ebp-4h]

  UserDirectoryPath = FilePaths::GetUserDirectoryPath(v3);
  v4 = 0;
  std::operator+<wchar_t>(a1, (int)UserDirectoryPath, (wchar_t *)L"Bugreport\\");
  v4 = -1;
  std::wstring::~wstring(v3);
  return a1;
}


// address=[0x134dc80]
// Decompiled from int __cdecl Bugreport::GetBugReportScreenshotPath(int a1)
std::wstring __cdecl Bugreport::GetBugReportScreenshotPath(void a1) {
  
  void *UserDirectoryPath; // [esp+4h] [ebp-38h]
  _BYTE v3[28]; // [esp+10h] [ebp-2Ch] BYREF
  int v4; // [esp+38h] [ebp-4h]

  UserDirectoryPath = FilePaths::GetUserDirectoryPath(v3);
  v4 = 0;
  std::operator+<wchar_t>(a1, (int)UserDirectoryPath, (wchar_t *)L"Bugreport\\screenshot%2d.bmp");
  v4 = -1;
  std::wstring::~wstring(v3);
  return a1;
}


// address=[0x134dd20]
// Decompiled from int __cdecl Bugreport::GetBugReportMessageFilePath(int a1)
std::wstring __cdecl Bugreport::GetBugReportMessageFilePath(void a1) {
  
  void *UserDirectoryPath; // [esp+4h] [ebp-38h]
  _BYTE v3[28]; // [esp+10h] [ebp-2Ch] BYREF
  int v4; // [esp+38h] [ebp-4h]

  UserDirectoryPath = FilePaths::GetUserDirectoryPath(v3);
  v4 = 0;
  std::operator+<wchar_t>(a1, (int)UserDirectoryPath, (wchar_t *)L"Bugreport\\Message.txt");
  v4 = -1;
  std::wstring::~wstring(v3);
  return a1;
}


// address=[0x134ddc0]
// Decompiled from int __cdecl Bugreport::BuildAutoReporterCmdLineArgsForDebugReports(int a1)
std::wstring __cdecl Bugreport::BuildAutoReporterCmdLineArgsForDebugReports(void a1) {
  
  int v2; // [esp+4h] [ebp-5Ch]
  void *UserDirectoryPath; // [esp+Ch] [ebp-54h]
  _BYTE v4[28]; // [esp+18h] [ebp-48h] BYREF
  int v5[7]; // [esp+34h] [ebp-2Ch] BYREF
  int v6; // [esp+5Ch] [ebp-4h]

  UserDirectoryPath = FilePaths::GetUserDirectoryPath(v4);
  v6 = 0;
  v2 = std::operator+<wchar_t>((int)v5, (wchar_t *)L" Settlers4,", (int)UserDirectoryPath);
  LOBYTE(v6) = 1;
  std::operator+<wchar_t>(a1, v2, (wchar_t *)L"Bugreport,Message.txt,0");
  LOBYTE(v6) = 0;
  std::wstring::~wstring(v5);
  v6 = -1;
  std::wstring::~wstring(v4);
  return a1;
}


// address=[0x134de90]
// Decompiled from int __cdecl Bugreport::BuildAutoReporterCmdLineArgsForUserReports(int a1)
std::wstring __cdecl Bugreport::BuildAutoReporterCmdLineArgsForUserReports(void a1) {
  
  int v2; // [esp+4h] [ebp-5Ch]
  void *UserDirectoryPath; // [esp+Ch] [ebp-54h]
  _BYTE v4[28]; // [esp+18h] [ebp-48h] BYREF
  int v5[7]; // [esp+34h] [ebp-2Ch] BYREF
  int v6; // [esp+5Ch] [ebp-4h]

  UserDirectoryPath = FilePaths::GetUserDirectoryPath(v4);
  v6 = 0;
  v2 = std::operator+<wchar_t>((int)v5, (wchar_t *)L" Settlers4,", (int)UserDirectoryPath);
  LOBYTE(v6) = 1;
  std::operator+<wchar_t>(a1, v2, (wchar_t *)L"Bugreport,Message.txt,1,0");
  LOBYTE(v6) = 0;
  std::wstring::~wstring(v5);
  v6 = -1;
  std::wstring::~wstring(v4);
  return a1;
}


// address=[0x134df60]
// Decompiled from void *__cdecl Bugreport::BuildTraceFilePath(void *a1, int a2)
std::wstring __cdecl Bugreport::BuildTraceFilePath(std::wstring const & a1) {
  
  void *BugReportsDirectoryPath; // [esp+4h] [ebp-84h]
  _BYTE v4[44]; // [esp+10h] [ebp-78h] BYREF
  _BYTE v5[32]; // [esp+3Ch] [ebp-4Ch] BYREF
  _BYTE v6[28]; // [esp+5Ch] [ebp-2Ch] BYREF
  int v7; // [esp+84h] [ebp-4h]

  if ( (unsigned __int8)std::wstring::empty(a2) )
  {
    std::wstring::wstring(a1, (wchar_t *)&word_36823E0);
  }
  else
  {
    FilePaths::SplitPath((int)v4, a2);
    v7 = 0;
    BugReportsDirectoryPath = (void *)Bugreport::GetBugReportsDirectoryPath((int)v6);
    LOBYTE(v7) = 1;
    std::operator+<wchar_t>(a1, BugReportsDirectoryPath, (_Cnd_internal_imp_t *)v5);
    LOBYTE(v7) = 0;
    std::wstring::~wstring(v6);
    v7 = -1;
    FilePaths::PathSplitResult::~PathSplitResult(v4);
  }
  return a1;
}


// address=[0x134e050]
// Decompiled from int __cdecl Bugreport::LaunchAutoreport(char a1, void *a2)
void __cdecl Bugreport::LaunchAutoreport(bool a1, std::wstring const & a2) {
  
  _DWORD *v2; // eax
  int result; // eax
  _STARTUPINFOW StartupInfo; // [esp+0h] [ebp-264h] BYREF
  _PROCESS_INFORMATION ProcessInformation; // [esp+44h] [ebp-220h] BYREF
  DWORD ExitCode; // [esp+54h] [ebp-210h] BYREF
  WCHAR CommandLine[260]; // [esp+58h] [ebp-20Ch] BYREF

  memset(&StartupInfo, 0, sizeof(StartupInfo));
  StartupInfo.cb = 68;
  memset(&ProcessInformation, 0, sizeof(ProcessInformation));
  if ( (unsigned int)std::wstring::size(a2) >= 0x104 )
    j___wassert(L"commandLineArgs.size() < MAX_PATH", L"Bugreport.cpp", 0x41u);
  v2 = std::wstring::c_str((_Cnd_internal_imp_t *)a2);
  j___snwprintf((char *const)CommandLine, 0x104u, L"%s", v2);
  result = CreateProcessW(L"Exe\\Autoreport.exe", CommandLine, 0, 0, 0, 0, 0, 0, &StartupInfo, &ProcessInformation);
  if ( result )
  {
    for ( ExitCode = 259; ExitCode == 259; result = GetExitCodeProcess(ProcessInformation.hProcess, &ExitCode) )
      ;
  }
  else if ( a1 )
  {
    return MessageBoxA(g_hWnd, "Unable to launch Autoreport.exe!", "S4", 0x30u);
  }
  return result;
}


// address=[0x134e470]
// Decompiled from void __vcrt_va_start_verify_argument_type<wchar_t const *>()
void __cdecl __vcrt_va_start_verify_argument_type<wchar_t const *>(void) {
  
  ;
}


// address=[0x134f6d0]
// [Decompilation failed for void __cdecl S4DebugTest(void)]

// address=[0x1350c00]
// Decompiled from void __vcrt_va_start_verify_argument_type<char const * const>()
void __cdecl __vcrt_va_start_verify_argument_type<char const * const>(void) {
  
  ;
}


// address=[0x1351960]
// Decompiled from String *__cdecl operator+(String *a1, int a2, int a3)
class String __cdecl operator+(class String const & a1, class String const & a2) {
  
  int v4; // [esp+4h] [ebp-38h]
  _BYTE v5[28]; // [esp+10h] [ebp-2Ch] BYREF
  int v6; // [esp+38h] [ebp-4h]

  v4 = std::operator+<char>(v5, a2, a3);
  v6 = 0;
  String::String(a1, v4);
  v6 = -1;
  std::string::~string(v5);
  return a1;
}


// address=[0x1352bd0]
// Decompiled from int GetEvnInterfaceVersion()
int __cdecl GetEvnInterfaceVersion(void) {
  
  return 5;
}


// address=[0x1353b80]
// Decompiled from int __cdecl SaveWindowsPositionAndSize(HWND hwnd)
void __cdecl SaveWindowsPositionAndSize(struct HWND__ * hwnd) {
  
  int result; // eax
  LONG left; // [esp+0h] [ebp-58h]
  LONG top; // [esp+4h] [ebp-54h]
  int v4; // [esp+8h] [ebp-50h]
  int v5; // [esp+Ch] [ebp-4Ch]
  bool v6; // [esp+17h] [ebp-41h]
  tagWINDOWINFO pwi; // [esp+18h] [ebp-40h] BYREF

  pwi.cbSize = 60;
  GetWindowInfo(hwnd, &pwi);
  v4 = pwi.rcWindow.right - pwi.rcWindow.left;
  v5 = pwi.rcWindow.bottom - pwi.rcWindow.top;
  left = pwi.rcWindow.left;
  top = pwi.rcWindow.top;
  v6 = (pwi.dwStyle & 0x40000) == 0;
  result = CGameSettings::SetGfxFullscreenEnabled(v6);
  if ( v4 < 800 || v5 < 600 )
    return result;
  result = v6;
  if ( !v6 )
    return CGameSettings::SetWindowsDimensions(left, top, v4, v5);
  return result;
}


// address=[0x1353c30]
// Decompiled from int __stdcall WndMsgProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
long __stdcall WndMsgProc(struct HWND__ * hWnd, unsigned int Msg, unsigned int wParam, long lParam) {
  
  int result; // eax
  UINT v5; // [esp+0h] [ebp-20h]
  WPARAM v6; // [esp+4h] [ebp-1Ch]
  LPARAM v7; // [esp+8h] [ebp-18h]

  v5 = Msg;
  v6 = wParam;
  v7 = lParam;
  if ( Msg <= 0x10 )
  {
    if ( Msg != 16 )
    {
      switch ( Msg )
      {
        case 2u:
          Msg = 4;
          goto LABEL_78;
        case 3u:
          Msg = 2;
          SaveWindowsPositionAndSize(hWnd);
          goto LABEL_78;
        case 5u:
          Msg = 3;
          SaveWindowsPositionAndSize(hWnd);
          goto LABEL_78;
        case 8u:
          Msg = 111;
          goto LABEL_78;
        default:
          goto WndMsgProc___def_1753C74;
      }
    }
    Msg = 118;
LABEL_78:
    if ( !g_pEvnEngine )
      return 0;
    if ( IEventEngine::IsEventEngineLocked((ATL::CImage *)g_pEvnEngine) )
      return 0;
    if ( IEventEngine::SendRawWindowEvent(g_pEvnEngine, (int)hWnd, Msg, wParam, lParam) )
      return 0;
    return DefWindowProcA(hWnd, v5, v6, v7);
  }
  if ( Msg <= 0x200 )
  {
    if ( Msg != 512 )
    {
      switch ( Msg )
      {
        case 0x1Cu:
          Msg = 22;
          goto LABEL_78;
        case 0xA0u:
          Msg = 6;
          goto LABEL_78;
        case 0x100u:
          Msg = 11;
          lParam = 0;
          if ( (GetKeyState(18) & 0x8000000) != 0 )
            lParam = 16;
          if ( (GetKeyState(17) & 0x8000000) != 0 )
            lParam |= 8u;
          if ( (GetAsyncKeyState(16) & 0x8000000) != 0 )
            lParam |= 4u;
          if ( lParam == 24 )
            lParam = 16;
          goto LABEL_78;
        case 0x101u:
          Msg = 20;
          lParam = 0;
          if ( (GetKeyState(18) & 0x8000000) != 0 )
            lParam = 16;
          if ( (GetKeyState(17) & 0x8000000) != 0 )
            lParam |= 8u;
          if ( (GetKeyState(16) & 0x8000000) != 0 )
            lParam |= 4u;
          if ( lParam == 24 )
            lParam = 16;
          goto LABEL_78;
        case 0x102u:
          Msg = 13;
          lParam = 0;
          if ( (GetKeyState(18) & 0x8000000) != 0 )
            lParam = 16;
          if ( (GetKeyState(17) & 0x8000000) != 0 )
            lParam |= 8u;
          if ( (GetKeyState(16) & 0x8000000) != 0 )
            lParam |= 4u;
          if ( lParam == 24 )
            lParam = 16;
          goto LABEL_78;
        case 0x104u:
          Msg = 12;
          lParam = 0;
          if ( (GetKeyState(18) & 0x8000000) != 0 )
            lParam = 16;
          if ( (GetKeyState(17) & 0x8000000) != 0 )
            lParam |= 8u;
          if ( (GetAsyncKeyState(16) & 0x8000000) != 0 )
            lParam |= 4u;
          if ( lParam == 24 )
            lParam = 16;
          goto LABEL_78;
        case 0x111u:
          Msg = 0;
          goto LABEL_78;
        default:
          goto WndMsgProc___def_1753C74;
      }
    }
    Msg = 5;
    goto LABEL_78;
  }
  switch ( Msg )
  {
    case 0x201u:
      Msg = 7;
      wParam &= ~0x10u;
      if ( (GetKeyState(18) & 0x8000000) != 0 )
        wParam |= 0x10u;
      goto LABEL_78;
    case 0x202u:
      Msg = 8;
      wParam &= ~0x10u;
      if ( (GetKeyState(18) & 0x8000000) != 0 )
        wParam |= 0x10u;
      goto LABEL_78;
    case 0x204u:
      Msg = 9;
      wParam &= ~0x10u;
      if ( (GetKeyState(18) & 0x8000000) != 0 )
        wParam |= 0x10u;
      goto LABEL_78;
    case 0x205u:
      Msg = 10;
      wParam &= ~0x10u;
      if ( (GetKeyState(18) & 0x8000000) != 0 )
        wParam |= 0x10u;
      goto LABEL_78;
    case 0x20Au:
      Msg = 14;
      if ( (GetKeyState(18) & 0x8000000) != 0 )
        wParam |= 0x10u;
      goto LABEL_78;
    case 0x214u:
      if ( *(_DWORD *)(lParam + 8) - *(_DWORD *)lParam < 800 )
      {
        switch ( wParam )
        {
          case 1u:
          case 4u:
          case 7u:
            *(_DWORD *)lParam = *(_DWORD *)(lParam + 8) - 800;
            break;
          case 2u:
          case 5u:
          case 8u:
            *(_DWORD *)(lParam + 8) = *(_DWORD *)lParam + 800;
            break;
          default:
            break;
        }
      }
      if ( *(_DWORD *)(lParam + 12) - *(_DWORD *)(lParam + 4) < 600 )
      {
        switch ( wParam )
        {
          case 3u:
          case 4u:
          case 5u:
            *(_DWORD *)(lParam + 4) = *(_DWORD *)(lParam + 12) - 600;
            break;
          case 6u:
          case 7u:
          case 8u:
            *(_DWORD *)(lParam + 12) = *(_DWORD *)(lParam + 4) + 600;
            break;
          default:
            goto LABEL_78;
        }
      }
      goto LABEL_78;
    default:
WndMsgProc___def_1753C74:
      result = DefWindowProcA(hWnd, Msg, wParam, lParam);
      break;
  }
  return result;
}


// address=[0x13568e0]
// Decompiled from char *__cdecl strstr(char *Str, char *SubStr)
char * __cdecl strstr(char * const Str, char const * const SubStr) {
  
  return j__strstr(Str, SubStr);
}


// address=[0x1359410]
// Decompiled from ATOM __cdecl RegisterWindowClass(HINSTANCE hInstance)
unsigned short __cdecl RegisterWindowClass(struct HINSTANCE__ * hInstance) {
  
  WNDCLASSEXA v2; // [esp+0h] [ebp-30h] BYREF

  if ( !g_pEvnEngine && BBSupportDbgReport(2, "FrameWork.cpp", 300, "g_pEvnEngine != NULL") == 1 )
    __debugbreak();
  if ( !g_pEvnEngine )
    return -1;
  v2.cbSize = 48;
  v2.style = 3;
  v2.lpfnWndProc = IEventEngine::GetEventFunction(g_pEvnEngine);
  v2.cbClsExtra = 0;
  v2.cbWndExtra = 0;
  v2.hInstance = hInstance;
  v2.hIcon = LoadIconA(hInstance, (LPCSTR)0x72);
  v2.hCursor = LoadCursorA(0, (LPCSTR)&_enc_textbss_begin[7104]);
  v2.hbrBackground = CreateSolidBrush(0);
  v2.lpszMenuName = 0;
  v2.lpszClassName = "S4";
  v2.hIconSm = 0;
  return RegisterClassExA(&v2);
}


// address=[0x13594d0]
// Decompiled from char ExistsExtractCommand()
bool __cdecl ExistsExtractCommand(void) {
  
  const wchar_t *v1; // eax
  size_t v2; // eax
  _DWORD v3[7]; // [esp+0h] [ebp-228h] BYREF
  void *v4; // [esp+1Ch] [ebp-20Ch]
  size_t v5; // [esp+20h] [ebp-208h]
  size_t v6; // [esp+24h] [ebp-204h]
  void *Buffer; // [esp+28h] [ebp-200h]
  size_t ElementCount; // [esp+2Ch] [ebp-1FCh]
  char v9; // [esp+31h] [ebp-1F7h]
  char v10; // [esp+32h] [ebp-1F6h]
  char v11; // [esp+33h] [ebp-1F5h]
  char v12[88]; // [esp+34h] [ebp-1F4h] BYREF
  _DWORD v13[26]; // [esp+8Ch] [ebp-19Ch] BYREF
  int v14; // [esp+F4h] [ebp-134h] BYREF
  int v15[7]; // [esp+F8h] [ebp-130h] BYREF
  wchar_t Src[128]; // [esp+114h] [ebp-114h] BYREF
  _DWORD *v17; // [esp+218h] [ebp-10h]
  int v18; // [esp+224h] [ebp-4h]

  v17 = v3;
  v3[4] = 128;
  if ( !g_iArgc )
    return 0;
  memset(Src, 0, sizeof(Src));
  std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v12);
  v18 = 0;
  std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::from_bytes(
    (int)v15,
    *(char **)g_pArgv);
  LOBYTE(v18) = 1;
  v1 = (const wchar_t *)std::wstring::c_str((_Cnd_internal_imp_t *)v15);
  j__wcsncpy(Src, v1, 0x7Fu);
  j__wcsupr(Src);
  if ( wcsstr(Src, (wchar_t *)L"EXTRACT:\"") )
  {
    v2 = j__wcslen(Src);
    j__memcpy(Src, &Src[9], v2 - 9);
    v6 = 2 * j__wcslen(Src) - 20;
    if ( v6 >= 0x100 )
      j____report_rangecheckfailure();
    *(wchar_t *)((char *)Src + v6) = 0;
    v11 = 1;
    ElementCount = 0;
    Buffer = 0;
    CFileEx::CFileEx((CFileEx *)v13, 1);
    LOBYTE(v18) = 3;
    CFileEx::Open(&v14, Src, 6, 0, UNUSED_ARG(), UNUSED_ARG());
    v5 = CFileEx::Size(v13);
    ElementCount = v5;
    if ( v5 )
    {
      v4 = operator new[](ElementCount + 8);
      v3[6] = v4;
      Buffer = v4;
      memset(v4, 0, ElementCount + 8);
      CFileEx::Read(
        &v14,
        Buffer,
        1,
        ElementCount,
        "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\BaseLib\\Include\\FileEx.h",
        110);
    }
    v18 = 2;
    CFileEx::Close((CFileEx *)&v14, UNUSED_ARG(), UNUSED_ARG());
    if ( v11 && Buffer )
    {
      CFileEx::Open(&v14, (wchar_t *)L"Extract", 8, 0, UNUSED_ARG(), UNUSED_ARG());
      CFileEx::Write(Buffer, 1u, ElementCount, UNUSED_ARG(), UNUSED_ARG());
      CFileEx::Close((CFileEx *)&v14, UNUSED_ARG(), UNUSED_ARG());
      MessageBoxA(0, "File successfully extracted!", &byte_36833EB, 0);
      v3[5] = Buffer;
      operator delete[](Buffer);
    }
    else
    {
      MessageBoxA(0, "Error while reading file!", &byte_368342B, 0);
    }
    v10 = 1;
    LOBYTE(v18) = 1;
    CFileEx::~CFileEx(v13);
    LOBYTE(v18) = 0;
    std::wstring::~wstring(v15);
    v18 = -1;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v12);
    return v10;
  }
  else
  {
    v9 = 0;
    LOBYTE(v18) = 0;
    std::wstring::~wstring(v15);
    v18 = -1;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v12);
    return v9;
  }
}


// address=[0x1359940]
// Decompiled from int WriteIniFile()
void __cdecl WriteIniFile(void) {
  
  size_t v0; // eax
  _DWORD v2[5]; // [esp+0h] [ebp-14A8h] BYREF
  int v3; // [esp+14h] [ebp-1494h]
  int v4; // [esp+18h] [ebp-1490h]
  int v5; // [esp+1Ch] [ebp-148Ch]
  _BYTE v6[72]; // [esp+20h] [ebp-1488h] BYREF
  int v7[7]; // [esp+68h] [ebp-1440h] BYREF
  char v8[2048]; // [esp+84h] [ebp-1424h] BYREF
  wchar_t Dir[256]; // [esp+884h] [ebp-C24h] BYREF
  wchar_t Filename[256]; // [esp+A84h] [ebp-A24h] BYREF
  wchar_t Ext[256]; // [esp+C84h] [ebp-824h] BYREF
  char Str[1024]; // [esp+E84h] [ebp-624h] BYREF
  WCHAR Buffer[260]; // [esp+1284h] [ebp-224h] BYREF
  wchar_t Drive[4]; // [esp+148Ch] [ebp-1Ch] BYREF
  _DWORD *v15; // [esp+1498h] [ebp-10h]
  int v16; // [esp+14A4h] [ebp-4h]

  v15 = v2;
  v2[4] = GetEnvironmentVariableW(L"SYSTEMROOT", Buffer, 0x208u);
  CFile::CFile((CFile *)v6);
  v16 = 0;
  std::wstring::wstring(v7, Buffer);
  LOBYTE(v16) = 1;
  std::wstring::operator+=(v7, (wchar_t *)L"\\Settlers4.ini");
  GetModuleFileNameW(0, Buffer, 0x208u);
  j___wsplitpath(Buffer, Drive, Dir, Filename, Ext);
  LOBYTE(v16) = 2;
  CFile::Open((int)v7, 9, "d:\\projects\\tshe\\purplelamp\\s4\\source\\baselib\\include\\File.h", 0);
  swprintf(v8, (char *)L"path=%s%s\nprogram=%s%s\nversion=%d.%d", (char)Drive);
  v4 = 0;
  v5 = 0;
  while ( *(_WORD *)&v8[2 * v4] )
  {
    Str[v5] = v8[2 * v4];
    v3 = Str[v5++];
    if ( v3 == 92 )
      Str[v5++] = v8[2 * v4];
    ++v4;
  }
  v0 = j__strlen(Str);
  CFile::Write(Str, v0, 1u, (int)"d:\\projects\\tshe\\purplelamp\\s4\\source\\baselib\\include\\File.h", 0);
  CFile::Close((CFile *)v6, "d:\\projects\\tshe\\purplelamp\\s4\\source\\baselib\\include\\File.h", 0);
  v16 = 0;
  std::wstring::~wstring(v7);
  v16 = -1;
  return CFile::~CFile();
}


// address=[0x1359be0]
// Decompiled from int ShowFingerprint()
void __cdecl ShowFingerprint(void) {
  
  int v1; // [esp+0h] [ebp-F8h] BYREF
  int v2; // [esp+10h] [ebp-E8h]
  signed int v3; // [esp+14h] [ebp-E4h]
  size_t ElementSize; // [esp+18h] [ebp-E0h]
  _BYTE v5[72]; // [esp+1Ch] [ebp-DCh] BYREF
  CHAR Text[128]; // [esp+64h] [ebp-94h] BYREF
  int *v7; // [esp+E8h] [ebp-10h]
  int v8; // [esp+F4h] [ebp-4h]

  v7 = &v1;
  CFile::CFile((CFile *)v5);
  v8 = 1;
  CFile::Open((wchar_t *)L"Version.txt", 5, "d:\\projects\\tshe\\purplelamp\\s4\\source\\baselib\\include\\File.h", 0);
  v3 = CFile::Size(v5);
  ElementSize = v3;
  if ( v3 >= 128 )
  {
    v2 = BBSupportDbgReport(2, "FrameWork.cpp", 770, "iSize < MAX_FINGERPRINT_LENGTH");
    if ( v2 == 1 )
      __debugbreak();
  }
  memset(Text, 0, sizeof(Text));
  CFile::Read(Text, ElementSize, 1u, (int)"d:\\projects\\tshe\\purplelamp\\s4\\source\\baselib\\include\\File.h", 0);
  CFile::Close((CFile *)v5, "d:\\projects\\tshe\\purplelamp\\s4\\source\\baselib\\include\\File.h", 0);
  MessageBoxA(g_hWnd, Text, "S4", 0x30u);
  v8 = -1;
  return CFile::~CFile();
}


// address=[0x1359d70]
// Decompiled from int __cdecl ErrorMessageBox(LPCSTR lpText)
void __cdecl ErrorMessageBox(char const * lpText) {
  
  HWND hWnd; // [esp+0h] [ebp-4h]

  hWnd = GetActiveWindow();
  if ( hWnd )
    hWnd = GetLastActivePopup(hWnd);
  return MessageBoxA(hWnd, lpText, "S4", 0x52010u);
}


// address=[0x1359db0]
// Decompiled from int GetSystemLanguage()
unsigned long __cdecl GetSystemLanguage(void) {
  
  unsigned int i; // [esp+8h] [ebp-4D8h]
  char *Str1; // [esp+Ch] [ebp-4D4h]
  _DWORD v3[51]; // [esp+10h] [ebp-4D0h]
  CHAR LCData[1024]; // [esp+DCh] [ebp-404h] BYREF

  Str1 = "DE";
  v3[0] = 1;
  v3[1] = "GE";
  v3[2] = 1;
  v3[3] = "EN";
  v3[4] = 0;
  v3[5] = "CH";
  v3[6] = 7;
  v3[7] = "ZH";
  v3[8] = 7;
  v3[9] = "CZ";
  v3[10] = 13;
  v3[11] = "CE";
  v3[12] = 13;
  v3[13] = "CS";
  v3[14] = 13;
  v3[15] = "DA";
  v3[16] = 9;
  v3[17] = "FI";
  v3[18] = 14;
  v3[19] = "FR";
  v3[20] = 2;
  v3[21] = "HE";
  v3[22] = 12;
  v3[23] = "HU";
  v3[24] = 11;
  v3[25] = "IT";
  v3[26] = 4;
  v3[27] = "JP";
  v3[28] = 18;
  v3[29] = "JA";
  v3[30] = 18;
  v3[31] = "KO";
  v3[32] = 6;
  v3[33] = "NO";
  v3[34] = 10;
  v3[35] = "PO";
  v3[36] = 5;
  v3[37] = "PL";
  v3[38] = 5;
  v3[39] = "RU";
  v3[40] = 16;
  v3[41] = "SP";
  v3[42] = 3;
  v3[43] = "ES";
  v3[44] = 3;
  v3[45] = "SW";
  v3[46] = 8;
  v3[47] = "SV";
  v3[48] = 8;
  v3[49] = "TH";
  v3[50] = 17;
  GetLocaleInfoA(0x800u, 3u, LCData, 1024);
  LCData[2] = 0;
  for ( i = 0; i < 0x1A; ++i )
  {
    if ( !j__strcmp((const char *)v3[2 * i - 1], LCData) )
      return v3[2 * i];
  }
  return 0;
}


// address=[0x135b9c0]
// Decompiled from void __vcrt_va_start_verify_argument_type<wchar_t const * const>()
void __cdecl __vcrt_va_start_verify_argument_type<wchar_t const * const>(void) {
  
  ;
}


// address=[0x1360e20]
// Decompiled from int swprintf(char *Buffer, char *Format, ...)
int __cdecl swprintf(wchar_t * const Buffer, wchar_t const * const Format, ... a3) {
  
  va_list va; // [esp+18h] [ebp+10h] BYREF

  va_start(va, Format);
  __vcrt_va_start_verify_argument_type<wchar_t const * const>();
  return j__vswprintf(Buffer, 0x7FFFFFFFu, Format, va);
}


// address=[0x1360e70]
// Decompiled from wchar_t *__cdecl wcsstr(wchar_t *Str, wchar_t *SubStr)
wchar_t * __cdecl wcsstr(wchar_t * Str, wchar_t const * SubStr) {
  
  return j__wcsstr(Str, SubStr);
}


// address=[0x136b250]
// Decompiled from void *MapFilePaths::GetMapDirectoryPath(void *a1, ...)
std::wstring __cdecl MapFilePaths::GetMapDirectoryPath(int a1) {
  
  int v2; // eax
  _BYTE v3[12]; // [esp+4h] [ebp-34h] BYREF
  _BYTE v4[12]; // [esp+10h] [ebp-28h] BYREF
  std::_Iterator_base12 *v5; // [esp+1Ch] [ebp-1Ch]
  std::_Iterator_base12 *v6; // [esp+20h] [ebp-18h]
  int v7; // [esp+24h] [ebp-14h]
  char v8; // [esp+2Bh] [ebp-Dh]
  int v9; // [esp+34h] [ebp-4h]
  va_list va; // [esp+44h] [ebp+Ch] BYREF

  va_start(va, a1);
  v7 = 0;
  std::_Tree<std::_Tmap_traits<int,std::wstring,std::less<int>,std::allocator<std::pair<int const,std::wstring>>,0>>::find(
    v4,
    va);
  v9 = 0;
  v6 = (std::_Iterator_base12 *)std::_Tree<std::_Tmap_traits<int,std::wstring,std::less<int>,std::allocator<std::pair<int const,std::wstring>>,0>>::end(v3);
  v5 = v6;
  LOBYTE(v9) = 1;
  v8 = std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<int const,std::wstring>>>>::operator==(v6);
  LOBYTE(v9) = 0;
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<int const,std::wstring>>>>::~_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<int const,std::wstring>>>>(v3);
  if ( v8 )
  {
    sub_136B4E0(a1);
  }
  else
  {
    v2 = std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<int const,std::wstring>>>>::operator->(v4);
    std::wstring::wstring(a1, (void *)(v2 + 4));
  }
  v7 |= 1u;
  v9 = -1;
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<int const,std::wstring>>>>::~_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<int const,std::wstring>>>>(v4);
  return a1;
}


// address=[0x136b340]
// Decompiled from int __cdecl MapFilePaths::GetMapFilePatternOfDirectory(int a1, int a2)
std::wstring __cdecl MapFilePaths::GetMapFilePatternOfDirectory(int a1) {
  
  void *MapDirectoryPath; // [esp+4h] [ebp-38h]
  _BYTE v4[28]; // [esp+10h] [ebp-2Ch] BYREF
  int v5; // [esp+38h] [ebp-4h]

  MapDirectoryPath = MapFilePaths::GetMapDirectoryPath(v4, a2);
  v5 = 0;
  std::operator+<wchar_t>(a1, (int)MapDirectoryPath, (wchar_t *)L"*.MAP");
  v5 = -1;
  std::wstring::~wstring(v4);
  return a1;
}


// address=[0x136b3e0]
// Decompiled from int __cdecl MapFilePaths::GetFilePathForMapName(int a1, _Cnd_internal_imp_t *a2)
std::wstring __cdecl MapFilePaths::GetFilePathForMapName(std::wstring const & a1) {
  
  char v3; // [esp-38h] [ebp-B0h] BYREF
  int v4; // [esp-34h] [ebp-ACh]
  int v5; // [esp-30h] [ebp-A8h]
  char v6; // [esp-2Ch] [ebp-A4h] BYREF
  int v7; // [esp-28h] [ebp-A0h]
  int v8; // [esp-24h] [ebp-9Ch]
  char v9; // [esp-20h] [ebp-98h] BYREF
  int v10; // [esp-1Ch] [ebp-94h]
  int v11; // [esp-18h] [ebp-90h]
  int v12; // [esp-14h] [ebp-8Ch]
  int v13; // [esp-10h] [ebp-88h]
  int v14; // [esp-Ch] [ebp-84h]
  int v15; // [esp-8h] [ebp-80h]
  int v16; // [esp-4h] [ebp-7Ch]
  int v17; // [esp+4h] [ebp-74h]
  int v18; // [esp+8h] [ebp-70h]
  char *v19; // [esp+Ch] [ebp-6Ch]
  int v20; // [esp+10h] [ebp-68h]
  char *v21; // [esp+14h] [ebp-64h]
  void *v22; // [esp+18h] [ebp-60h]
  char *v23; // [esp+1Ch] [ebp-5Ch]
  void *v24; // [esp+24h] [ebp-54h]
  void *v25; // [esp+28h] [ebp-50h]
  int v26; // [esp+2Ch] [ebp-4Ch]
  _BYTE v27[28]; // [esp+30h] [ebp-48h] BYREF
  _BYTE v28[28]; // [esp+4Ch] [ebp-2Ch] BYREF
  int v29; // [esp+74h] [ebp-4h]

  v26 = 0;
  v25 = (void *)sub_136B4E0(v27);
  v24 = v25;
  v29 = 0;
  std::operator+<wchar_t>(v28, v25, a2);
  LOBYTE(v29) = 2;
  std::wstring::~wstring(v27);
  v16 = *(_DWORD *)unknown_libname_11127(v28);
  v23 = &v9;
  v22 = std::wstring::wstring(&v9, v28);
  v21 = &v6;
  v20 = std::_Tree<std::_Tmap_traits<int,std::wstring,std::less<int>,std::allocator<std::pair<int const,std::wstring>>,0>>::end(&v6);
  v19 = &v3;
  v18 = std::_Tree<std::_Tmap_traits<int,std::wstring,std::less<int>,std::allocator<std::pair<int const,std::wstring>>,0>>::begin(&v3);
  v17 = std::accumulate<std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<int const,std::wstring>>>>,std::wstring,_lambda_262b56d0dc28872bffad289ee61dbafa_>(
          a1,
          v3,
          v4,
          v5,
          v6,
          v7,
          v8,
          v9,
          v10,
          v11,
          v12,
          v13,
          v14,
          v15,
          v16);
  v26 |= 1u;
  v29 = -1;
  std::wstring::~wstring(v28);
  return a1;
}


// address=[0x1372900]
// Decompiled from char UpdateGuiDlgAddSoldierBar()
void __cdecl UpdateGuiDlgAddSoldierBar(void) {
  
  int i; // [esp+20h] [ebp-40h]
  char v2; // [esp+27h] [ebp-39h]
  char v3; // [esp+27h] [ebp-39h]
  char v4; // [esp+27h] [ebp-39h]
  char v5; // [esp+27h] [ebp-39h]
  CHAR Destination; // [esp+28h] [ebp-38h] BYREF
  char v7; // [esp+29h] [ebp-37h]

  for ( i = 0; i < 3; ++i )
  {
    if ( byte_3F1EF70[i] <= 0 || byte_3F1EF70[i] >= 100 )
    {
      if ( byte_3F1EF70[i] <= 0 )
      {
        j__strncpy(&Destination, "0", 1u);
        v7 = 0;
        v2 = 0;
      }
      else
      {
        j__strncpy(&Destination, "E", 1u);
        v7 = 0;
        v2 = 1;
      }
    }
    else
    {
      _wsprintfA(&Destination, "%u", byte_3F1EF70[i]);
      v2 = 1;
    }
    IGuiEngine::SetText((void *)g_pGUIEngine, 48, dword_3689FC4[2 * i], &Destination);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 48, dword_3689FC4[2 * i], v2);
    if ( byte_3F1EF73[i] <= 0 || byte_3F1EF73[i] >= 100 )
    {
      if ( byte_3F1EF73[i] <= 0 )
      {
        j__strncpy(&Destination, "0", 1u);
        v7 = 0;
        v3 = 0;
      }
      else
      {
        j__strncpy(&Destination, "E", 1u);
        v7 = 0;
        v3 = 1;
      }
    }
    else
    {
      _wsprintfA(&Destination, "%u", byte_3F1EF73[i]);
      v3 = 1;
    }
    IGuiEngine::SetText((void *)g_pGUIEngine, 48, dword_3689FDC[2 * i], &Destination);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 48, dword_3689FDC[2 * i], v3);
    if ( byte_3F1EF76[i] <= 0 || byte_3F1EF76[i] >= 100 )
    {
      if ( byte_3F1EF76[i] <= 0 )
      {
        j__strncpy(&Destination, "0", 1u);
        v7 = 0;
        v4 = 0;
      }
      else
      {
        j__strncpy(&Destination, "E", 1u);
        v7 = 0;
        v4 = 1;
      }
    }
    else
    {
      _wsprintfA(&Destination, "%u", byte_3F1EF76[i]);
      v4 = 1;
    }
    IGuiEngine::SetText((void *)g_pGUIEngine, 48, dword_3689FF4[2 * i], &Destination);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 48, dword_3689FF4[2 * i], v4);
  }
  if ( byte_3F1EF79 <= 0 || byte_3F1EF79 >= 100 )
  {
    if ( byte_3F1EF79 <= 0 )
    {
      j__strncpy(&Destination, "0", 1u);
      v7 = 0;
      v5 = 0;
    }
    else
    {
      j__strncpy(&Destination, "E", 1u);
      v7 = 0;
      v5 = 1;
    }
  }
  else
  {
    _wsprintfA(&Destination, "%u", byte_3F1EF79);
    v5 = 1;
  }
  IGuiEngine::SetText((void *)g_pGUIEngine, 48, 159, &Destination);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 48, 159, v5);
  _wsprintfA(&Destination, "%u", dword_3F1EF7C);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 48, 167, &Destination);
}


// address=[0x1372d50]
// Decompiled from char __cdecl GuiDlgAddSoldierBarProc(int a1, int a2, int a3)
bool __cdecl GuiDlgAddSoldierBarProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  int LocalPlayerId; // eax
  CPlayerInfo *v7; // eax
  int v8; // eax
  CPlayerInfo *v9; // eax
  int v10; // eax
  CPlayerInfo *v11; // eax
  int v12; // [esp+0h] [ebp-118h]
  CEvn_Logic *v13; // [esp+4h] [ebp-114h]
  CEvn_Logic *v14; // [esp+Ch] [ebp-10Ch]
  CEvn_Logic *v15; // [esp+14h] [ebp-104h]
  CEvn_Logic *v16; // [esp+1Ch] [ebp-FCh]
  CEvn_Logic *v17; // [esp+24h] [ebp-F4h]
  CEvn_Logic *v18; // [esp+2Ch] [ebp-ECh]
  DWORD v19; // [esp+38h] [ebp-E0h]
  DWORD v20; // [esp+3Ch] [ebp-DCh]
  DWORD v21; // [esp+40h] [ebp-D8h]
  _BYTE v22[32]; // [esp+48h] [ebp-D0h] BYREF
  _BYTE v23[32]; // [esp+68h] [ebp-B0h] BYREF
  _BYTE v24[32]; // [esp+88h] [ebp-90h] BYREF
  _BYTE v25[32]; // [esp+A8h] [ebp-70h] BYREF
  _BYTE v26[32]; // [esp+C8h] [ebp-50h] BYREF
  _BYTE v27[32]; // [esp+E8h] [ebp-30h] BYREF
  int v28; // [esp+114h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      dword_3ECDD90 = 0;
      UpdateGuiDlgAddSoldierBar();
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 48, dword_3689FC4[1], 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 140:
          dword_3ECDD90 = 29;
          PlayGuiSound(2);
          break;
        case 141:
          dword_3ECDD90 = 30;
          PlayGuiSound(2);
          break;
        case 142:
          dword_3ECDD90 = 31;
          PlayGuiSound(2);
          break;
        case 143:
          dword_3ECDD90 = 32;
          PlayGuiSound(2);
          break;
        case 144:
          dword_3ECDD90 = 33;
          PlayGuiSound(2);
          break;
        case 145:
          dword_3ECDD90 = 34;
          PlayGuiSound(2);
          break;
        case 146:
          LocalPlayerId = CPlayerManager::GetLocalPlayerId(v12);
          v7 = CPlayerManager::PlayerInfo(LocalPlayerId);
          v21 = CPlayerInfo::Race(v7);
          switch ( v21 )
          {
            case 1u:
              dword_3ECDD90 = 38;
              break;
            case 2u:
              dword_3ECDD90 = 41;
              break;
            case 4u:
              dword_3ECDD90 = 61;
              break;
            default:
              dword_3ECDD90 = 35;
              break;
          }
          break;
        case 147:
          v8 = CPlayerManager::GetLocalPlayerId(v12);
          v9 = CPlayerManager::PlayerInfo(v8);
          v20 = CPlayerInfo::Race(v9);
          switch ( v20 )
          {
            case 1u:
              dword_3ECDD90 = 39;
              break;
            case 2u:
              dword_3ECDD90 = 42;
              break;
            case 4u:
              dword_3ECDD90 = 62;
              break;
            default:
              dword_3ECDD90 = 36;
              break;
          }
          goto LABEL_35;
        case 148:
          v10 = CPlayerManager::GetLocalPlayerId(v12);
          v11 = CPlayerManager::PlayerInfo(v10);
          v19 = CPlayerInfo::Race(v11);
          switch ( v19 )
          {
            case 1u:
              dword_3ECDD90 = 40;
              break;
            case 2u:
              dword_3ECDD90 = 43;
              break;
            case 4u:
              dword_3ECDD90 = 63;
              break;
            default:
              dword_3ECDD90 = 37;
              break;
          }
LABEL_35:
          PlayGuiSound(2);
          break;
        case 149:
          dword_3ECDD90 = 44;
          PlayGuiSound(2);
          break;
        case 160:
          v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v27, 0x1CDu, dword_3ECDD90, 0x64u, 0, 0, 0);
          v28 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v27);
          PlayGuiSound(2);
          break;
        case 161:
          v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v26, 0x1CDu, dword_3ECDD90, 0, 0, 0, 0);
          v28 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v26);
          PlayGuiSound(2);
          break;
        case 162:
          v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v25, 0x1CDu, dword_3ECDD90, 5u, 0, 0, 0);
          v28 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v25);
          PlayGuiSound(2);
          break;
        case 163:
          v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v24, 0x1CDu, dword_3ECDD90, 0xFFFFFFFB, 0, 0, 0);
          v28 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v24);
          PlayGuiSound(2);
          break;
        case 164:
          v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v23, 0x1CDu, dword_3ECDD90, 1u, 0, 0, 0);
          v28 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v23);
          PlayGuiSound(2);
          break;
        case 165:
          v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v22, 0x1CDu, dword_3ECDD90, 0xFFFFFFFF, 0, 0, 0);
          v28 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v22);
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A00F);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368A012);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1373750]
// Decompiled from int UpdateGuiDlgAddStorageBar()
void __cdecl UpdateGuiDlgAddStorageBar(void) {
  
  int result; // eax
  int v1; // [esp+0h] [ebp-8h]
  int i; // [esp+4h] [ebp-4h]

  byte_3ECDE44 = 1;
  for ( i = 0; i < 43; ++i )
  {
    v1 = dword_3ECDD98[byte_3F1F060[2 * i]];
    if ( v1 >= 0 )
    {
      if ( byte_3F1F061[2 * i] == 1 )
        IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 50, v1, 1);
      else
        IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 50, v1, 0);
    }
    result = i + 1;
  }
  byte_3ECDE44 = 0;
  return result;
}


// address=[0x13737e0]
// Decompiled from int InitGuiDlgAddStorageBar()
void __cdecl InitGuiDlgAddStorageBar(void) {
  
  int result; // eax

  if ( !g_pStringEngine )
    return result;
  dword_3ECDD98[22] = 189;
  dword_3ECDD98[7] = 190;
  dword_3ECDD98[32] = 191;
  dword_3ECDD98[21] = 192;
  dword_3ECDD98[20] = 193;
  dword_3ECDD98[15] = 194;
  dword_3ECDD98[14] = 195;
  dword_3ECDD98[10] = 196;
  dword_3ECDD98[4] = 197;
  dword_3ECDD98[18] = 198;
  dword_3ECDD98[25] = 199;
  dword_3ECDD98[27] = 200;
  dword_3ECDD98[29] = 201;
  dword_3ECDD98[31] = 202;
  dword_3ECDD98[28] = 203;
  dword_3ECDD98[34] = 204;
  dword_3ECDD98[8] = 205;
  dword_3ECDD98[3] = 206;
  dword_3ECDD98[33] = 207;
  dword_3ECDD98[9] = 209;
  dword_3ECDD98[11] = 210;
  dword_3ECDD98[24] = 211;
  dword_3ECDD98[12] = 212;
  dword_3ECDD98[16] = 213;
  dword_3ECDD98[36] = 214;
  dword_3ECDD98[30] = -1;
  dword_3ECDD98[26] = -1;
  dword_3ECDD98[13] = -1;
  dword_3ECDD98[39] = -1;
  dword_3ECDD98[40] = -1;
  dword_3ECDD98[38] = -1;
  switch ( dword_3ECDE48 )
  {
    case 1:
      dword_3ECDD98[23] = 218;
      dword_3ECDD98[19] = 220;
      dword_3ECDD98[5] = 219;
      dword_3ECDD98[38] = -1;
      dword_3ECDD98[40] = -1;
      dword_3ECDD98[41] = -1;
      dword_3ECDD98[42] = -1;
      dword_3ECDD98[2] = -1;
      dword_3ECDD98[37] = -1;
      dword_3ECDD98[17] = -1;
      dword_3ECDD98[6] = -1;
      result = 140;
      dword_3ECDD98[35] = -1;
      dword_3ECDD98[1] = -1;
      break;
    case 2:
      dword_3ECDD98[6] = 219;
      dword_3ECDD98[17] = 208;
      dword_3ECDD98[35] = 218;
      dword_3ECDD98[1] = 220;
      dword_3ECDD98[38] = -1;
      dword_3ECDD98[40] = -1;
      dword_3ECDD98[41] = -1;
      dword_3ECDD98[42] = -1;
      dword_3ECDD98[2] = -1;
      dword_3ECDD98[37] = -1;
      dword_3ECDD98[23] = -1;
      dword_3ECDD98[19] = -1;
      result = 4;
      dword_3ECDD98[5] = -1;
      break;
    case 4:
      dword_3ECDD98[38] = 219;
      dword_3ECDD98[40] = 208;
      dword_3ECDD98[41] = 218;
      dword_3ECDD98[42] = 220;
      dword_3ECDD98[1] = -1;
      dword_3ECDD98[35] = -1;
      dword_3ECDD98[6] = -1;
      dword_3ECDD98[2] = -1;
      dword_3ECDD98[37] = -1;
      dword_3ECDD98[23] = -1;
      dword_3ECDD98[19] = -1;
      dword_3ECDD98[5] = -1;
      result = 4;
      dword_3ECDD98[17] = -1;
      break;
    default:
      dword_3ECDD98[2] = 208;
      dword_3ECDD98[37] = 218;
      dword_3ECDD98[38] = -1;
      dword_3ECDD98[40] = -1;
      dword_3ECDD98[41] = -1;
      dword_3ECDD98[42] = -1;
      dword_3ECDD98[17] = -1;
      dword_3ECDD98[6] = -1;
      dword_3ECDD98[35] = -1;
      dword_3ECDD98[1] = -1;
      dword_3ECDD98[23] = -1;
      dword_3ECDD98[19] = -1;
      result = 4;
      dword_3ECDD98[5] = -1;
      break;
  }
  return result;
}


// address=[0x1373e00]
// Decompiled from char __cdecl GuiDlgAddStorageBarProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgAddStorageBarProc(int a1, int a2, int a3) {
  
  int LocalPlayerId; // eax
  char *v5; // eax
  char *v6; // eax
  int v7; // [esp+0h] [ebp-690h]
  CEvn_Logic *v8; // [esp+8h] [ebp-688h]
  CEvn_Logic *v9; // [esp+10h] [ebp-680h]
  CEvn_Logic *v10; // [esp+18h] [ebp-678h]
  CEvn_Logic *v11; // [esp+20h] [ebp-670h]
  CEvn_Logic *v12; // [esp+28h] [ebp-668h]
  CEvn_Logic *v13; // [esp+30h] [ebp-660h]
  CEvn_Logic *v14; // [esp+38h] [ebp-658h]
  CEvn_Logic *v15; // [esp+40h] [ebp-650h]
  CEvn_Logic *v16; // [esp+48h] [ebp-648h]
  CEvn_Logic *v17; // [esp+4Ch] [ebp-644h]
  CEvn_Logic *v18; // [esp+54h] [ebp-63Ch]
  CEvn_Logic *v19; // [esp+5Ch] [ebp-634h]
  CEvn_Logic *v20; // [esp+64h] [ebp-62Ch]
  CEvn_Logic *v21; // [esp+6Ch] [ebp-624h]
  CEvn_Logic *v22; // [esp+74h] [ebp-61Ch]
  CEvn_Logic *v23; // [esp+7Ch] [ebp-614h]
  CEvn_Logic *v24; // [esp+84h] [ebp-60Ch]
  CEvn_Logic *v25; // [esp+8Ch] [ebp-604h]
  CEvn_Logic *v26; // [esp+94h] [ebp-5FCh]
  CEvn_Logic *v27; // [esp+9Ch] [ebp-5F4h]
  CEvn_Logic *v28; // [esp+A4h] [ebp-5ECh]
  CEvn_Logic *v29; // [esp+ACh] [ebp-5E4h]
  CEvn_Logic *v30; // [esp+B4h] [ebp-5DCh]
  CEvn_Logic *v31; // [esp+BCh] [ebp-5D4h]
  CEvn_Logic *v32; // [esp+C4h] [ebp-5CCh]
  CEvn_Logic *v33; // [esp+CCh] [ebp-5C4h]
  CEvn_Logic *v34; // [esp+D4h] [ebp-5BCh]
  CEvn_Logic *v35; // [esp+DCh] [ebp-5B4h]
  CEvn_Logic *v36; // [esp+E4h] [ebp-5ACh]
  CEvn_Logic *v37; // [esp+ECh] [ebp-5A4h]
  CEvn_Logic *v38; // [esp+F4h] [ebp-59Ch]
  CEvn_Logic *v39; // [esp+FCh] [ebp-594h]
  CEvn_Logic *v40; // [esp+104h] [ebp-58Ch]
  CEvn_Logic *v41; // [esp+10Ch] [ebp-584h]
  CEvn_Logic *v42; // [esp+114h] [ebp-57Ch]
  CEvn_Logic *v43; // [esp+11Ch] [ebp-574h]
  CEvn_Logic *v44; // [esp+124h] [ebp-56Ch]
  CEvn_Logic *v45; // [esp+12Ch] [ebp-564h]
  unsigned int v46; // [esp+134h] [ebp-55Ch]
  unsigned int v47; // [esp+138h] [ebp-558h]
  unsigned int v48; // [esp+13Ch] [ebp-554h]
  unsigned int v49; // [esp+140h] [ebp-550h]
  unsigned int v50; // [esp+144h] [ebp-54Ch]
  unsigned int v51; // [esp+148h] [ebp-548h]
  unsigned int v52; // [esp+14Ch] [ebp-544h]
  unsigned int v53; // [esp+150h] [ebp-540h]
  unsigned int v54; // [esp+154h] [ebp-53Ch]
  unsigned int v55; // [esp+158h] [ebp-538h]
  unsigned int v56; // [esp+15Ch] [ebp-534h]
  unsigned int v57; // [esp+160h] [ebp-530h]
  unsigned int v58; // [esp+164h] [ebp-52Ch]
  unsigned int v59; // [esp+168h] [ebp-528h]
  unsigned int v60; // [esp+16Ch] [ebp-524h]
  unsigned int v61; // [esp+170h] [ebp-520h]
  unsigned int v62; // [esp+174h] [ebp-51Ch]
  unsigned int v63; // [esp+178h] [ebp-518h]
  unsigned int v64; // [esp+17Ch] [ebp-514h]
  unsigned int v65; // [esp+180h] [ebp-510h]
  unsigned int v66; // [esp+184h] [ebp-50Ch]
  unsigned int v67; // [esp+188h] [ebp-508h]
  unsigned int v68; // [esp+18Ch] [ebp-504h]
  unsigned int v69; // [esp+190h] [ebp-500h]
  unsigned int v70; // [esp+194h] [ebp-4FCh]
  unsigned int v71; // [esp+1ACh] [ebp-4E4h]
  unsigned int v72; // [esp+1B0h] [ebp-4E0h]
  unsigned int v73; // [esp+1B4h] [ebp-4DCh]
  unsigned int v74; // [esp+1BCh] [ebp-4D4h]
  _BYTE v75[32]; // [esp+1C0h] [ebp-4D0h] BYREF
  _BYTE v76[32]; // [esp+1E0h] [ebp-4B0h] BYREF
  _BYTE v77[32]; // [esp+200h] [ebp-490h] BYREF
  _BYTE v78[32]; // [esp+220h] [ebp-470h] BYREF
  _BYTE v79[32]; // [esp+240h] [ebp-450h] BYREF
  _BYTE v80[32]; // [esp+260h] [ebp-430h] BYREF
  _BYTE v81[32]; // [esp+280h] [ebp-410h] BYREF
  _BYTE v82[32]; // [esp+2A0h] [ebp-3F0h] BYREF
  _BYTE v83[32]; // [esp+2C0h] [ebp-3D0h] BYREF
  _BYTE v84[32]; // [esp+2E0h] [ebp-3B0h] BYREF
  _BYTE v85[32]; // [esp+300h] [ebp-390h] BYREF
  _BYTE v86[32]; // [esp+320h] [ebp-370h] BYREF
  _BYTE v87[32]; // [esp+340h] [ebp-350h] BYREF
  _BYTE v88[32]; // [esp+360h] [ebp-330h] BYREF
  _BYTE v89[32]; // [esp+380h] [ebp-310h] BYREF
  _BYTE v90[32]; // [esp+3A0h] [ebp-2F0h] BYREF
  _BYTE v91[32]; // [esp+3C0h] [ebp-2D0h] BYREF
  _BYTE v92[32]; // [esp+3E0h] [ebp-2B0h] BYREF
  _BYTE v93[32]; // [esp+400h] [ebp-290h] BYREF
  _BYTE v94[32]; // [esp+420h] [ebp-270h] BYREF
  _BYTE v95[32]; // [esp+440h] [ebp-250h] BYREF
  _BYTE v96[32]; // [esp+460h] [ebp-230h] BYREF
  _BYTE v97[32]; // [esp+480h] [ebp-210h] BYREF
  _BYTE v98[32]; // [esp+4A0h] [ebp-1F0h] BYREF
  _BYTE v99[32]; // [esp+4C0h] [ebp-1D0h] BYREF
  _BYTE v100[32]; // [esp+4E0h] [ebp-1B0h] BYREF
  _BYTE v101[32]; // [esp+500h] [ebp-190h] BYREF
  _BYTE v102[32]; // [esp+520h] [ebp-170h] BYREF
  _BYTE v103[32]; // [esp+540h] [ebp-150h] BYREF
  _BYTE v104[32]; // [esp+560h] [ebp-130h] BYREF
  _BYTE v105[32]; // [esp+580h] [ebp-110h] BYREF
  _BYTE v106[32]; // [esp+5A0h] [ebp-F0h] BYREF
  _BYTE v107[32]; // [esp+5C0h] [ebp-D0h] BYREF
  _BYTE v108[32]; // [esp+5E0h] [ebp-B0h] BYREF
  _BYTE v109[32]; // [esp+600h] [ebp-90h] BYREF
  _BYTE v110[32]; // [esp+620h] [ebp-70h] BYREF
  _BYTE v111[32]; // [esp+640h] [ebp-50h] BYREF
  _BYTE v112[32]; // [esp+660h] [ebp-30h] BYREF
  int v113; // [esp+68Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3ECDE44 = 0;
      LocalPlayerId = CPlayerManager::GetLocalPlayerId(v7);
      dword_3ECDE48 = CPlayerManager::Race(LocalPlayerId);
      InitGuiDlgAddStorageBar();
      UpdateGuiDlgAddStorageBar();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0xBDu:
          if ( !byte_3ECDE44 )
          {
            v70 = (S4HiWord(a2) & 1) != 0;
            v45 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v76, 0x1D4u, 0x16u, v70, 0, 0, 0);
            v113 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v45);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v76);
            PlayGuiSound(2);
          }
          break;
        case 0xBEu:
          if ( !byte_3ECDE44 )
          {
            v69 = (S4HiWord(a2) & 1) != 0;
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v77, 0x1D4u, 7u, v69, 0, 0, 0);
            v113 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v77);
            PlayGuiSound(2);
          }
          break;
        case 0xBFu:
          if ( !byte_3ECDE44 )
          {
            v68 = (S4HiWord(a2) & 1) != 0;
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v78, 0x1D4u, 0x20u, v68, 0, 0, 0);
            v113 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v78);
            PlayGuiSound(2);
          }
          break;
        case 0xC0u:
          if ( !byte_3ECDE44 )
          {
            v67 = (S4HiWord(a2) & 1) != 0;
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v79, 0x1D4u, 0x15u, v67, 0, 0, 0);
            v113 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v79);
            PlayGuiSound(2);
          }
          break;
        case 0xC1u:
          if ( !byte_3ECDE44 )
          {
            v66 = (S4HiWord(a2) & 1) != 0;
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v80, 0x1D4u, 0x14u, v66, 0, 0, 0);
            v113 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v80);
            PlayGuiSound(2);
          }
          break;
        case 0xC2u:
          if ( !byte_3ECDE44 )
          {
            v65 = (S4HiWord(a2) & 1) != 0;
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v81, 0x1D4u, 0xFu, v65, 0, 0, 0);
            v113 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v81);
            PlayGuiSound(2);
          }
          break;
        case 0xC3u:
          if ( !byte_3ECDE44 )
          {
            v64 = (S4HiWord(a2) & 1) != 0;
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v82, 0x1D4u, 0xEu, v64, 0, 0, 0);
            v113 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v82);
            PlayGuiSound(2);
          }
          break;
        case 0xC4u:
          if ( !byte_3ECDE44 )
          {
            v63 = (S4HiWord(a2) & 1) != 0;
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v83, 0x1D4u, 0xAu, v63, 0, 0, 0);
            v113 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v83);
            PlayGuiSound(2);
          }
          break;
        case 0xC5u:
          if ( !byte_3ECDE44 )
          {
            v46 = (S4HiWord(a2) & 1) != 0;
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v84, 0x1D4u, 4u, v46, 0, 0, 0);
            v113 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v84);
            PlayGuiSound(2);
          }
          break;
        case 0xC6u:
          if ( !byte_3ECDE44 )
          {
            v62 = (S4HiWord(a2) & 1) != 0;
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v85, 0x1D4u, 0x12u, v62, 0, 0, 0);
            v113 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v85);
            PlayGuiSound(2);
          }
          break;
        case 0xC7u:
          if ( !byte_3ECDE44 )
          {
            v61 = (S4HiWord(a2) & 1) != 0;
            v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v86, 0x1D4u, 0x19u, v61, 0, 0, 0);
            v113 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v86);
            PlayGuiSound(2);
          }
          break;
        case 0xC8u:
          if ( !byte_3ECDE44 )
          {
            v60 = (S4HiWord(a2) & 1) != 0;
            v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v87, 0x1D4u, 0x1Bu, v60, 0, 0, 0);
            v113 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v19);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v87);
            PlayGuiSound(2);
          }
          break;
        case 0xC9u:
          if ( !byte_3ECDE44 )
          {
            v59 = (S4HiWord(a2) & 1) != 0;
            v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v88, 0x1D4u, 0x1Du, v59, 0, 0, 0);
            v113 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v20);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v88);
            PlayGuiSound(2);
          }
          break;
        case 0xCAu:
          if ( !byte_3ECDE44 )
          {
            v58 = (S4HiWord(a2) & 1) != 0;
            v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v107, 0x1D4u, 0x1Fu, v58, 0, 0, 0);
            v113 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v107);
            PlayGuiSound(2);
          }
          break;
        case 0xCBu:
          if ( !byte_3ECDE44 )
          {
            v57 = (S4HiWord(a2) & 1) != 0;
            v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v90, 0x1D4u, 0x1Cu, v57, 0, 0, 0);
            v113 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v22);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v90);
            PlayGuiSound(2);
          }
          break;
        case 0xCCu:
          if ( !byte_3ECDE44 )
          {
            v56 = (S4HiWord(a2) & 1) != 0;
            v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v91, 0x1D4u, 0x22u, v56, 0, 0, 0);
            v113 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v23);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v91);
            PlayGuiSound(2);
          }
          break;
        case 0xCDu:
          if ( !byte_3ECDE44 )
          {
            v55 = (S4HiWord(a2) & 1) != 0;
            v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v92, 0x1D4u, 8u, v55, 0, 0, 0);
            v113 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v24);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v92);
            PlayGuiSound(2);
          }
          break;
        case 0xCEu:
          if ( !byte_3ECDE44 )
          {
            v54 = (S4HiWord(a2) & 1) != 0;
            v44 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v96, 0x1D4u, 3u, v54, 0, 0, 0);
            v113 = 20;
            IEventEngine::SendAMessage(g_pEvnEngine, v44);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v96);
            PlayGuiSound(2);
          }
          break;
        case 0xCFu:
          if ( !byte_3ECDE44 )
          {
            v53 = (S4HiWord(a2) & 1) != 0;
            v43 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v97, 0x1D4u, 0x21u, v53, 0, 0, 0);
            v113 = 21;
            IEventEngine::SendAMessage(g_pEvnEngine, v43);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v97);
            PlayGuiSound(2);
          }
          break;
        case 0xD0u:
          if ( !byte_3ECDE44 )
          {
            v72 = (S4HiWord(a2) & 1) != 0;
            if ( dword_3ECDE48 )
            {
              if ( dword_3ECDE48 == 2 )
              {
                v41 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v99, 0x1D4u, 0x11u, v72, 0, 0, 0);
                v113 = 23;
                IEventEngine::SendAMessage(g_pEvnEngine, v41);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v99);
              }
              else if ( dword_3ECDE48 == 4 )
              {
                v42 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v98, 0x1D4u, 0x28u, v72, 0, 0, 0);
                v113 = 22;
                IEventEngine::SendAMessage(g_pEvnEngine, v42);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v98);
              }
            }
            else
            {
              v40 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v100, 0x1D4u, 2u, v72, 0, 0, 0);
              v113 = 24;
              IEventEngine::SendAMessage(g_pEvnEngine, v40);
              v113 = -1;
              CEvn_Logic::~CEvn_Logic(v100);
            }
            PlayGuiSound(2);
          }
          break;
        case 0xD1u:
          if ( !byte_3ECDE44 )
          {
            v52 = (S4HiWord(a2) & 1) != 0;
            v39 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v101, 0x1D4u, 9u, v52, 0, 0, 0);
            v113 = 25;
            IEventEngine::SendAMessage(g_pEvnEngine, v39);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v101);
            PlayGuiSound(2);
          }
          break;
        case 0xD2u:
          if ( !byte_3ECDE44 )
          {
            v51 = (S4HiWord(a2) & 1) != 0;
            v38 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v112, 0x1D4u, 0xBu, v51, 0, 0, 0);
            v113 = 26;
            IEventEngine::SendAMessage(g_pEvnEngine, v38);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v112);
            PlayGuiSound(2);
          }
          break;
        case 0xD3u:
          if ( !byte_3ECDE44 )
          {
            v50 = (S4HiWord(a2) & 1) != 0;
            v37 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v103, 0x1D4u, 0x18u, v50, 0, 0, 0);
            v113 = 27;
            IEventEngine::SendAMessage(g_pEvnEngine, v37);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v103);
            PlayGuiSound(2);
          }
          break;
        case 0xD4u:
          if ( !byte_3ECDE44 )
          {
            v49 = (S4HiWord(a2) & 1) != 0;
            v36 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v102, 0x1D4u, 0xCu, v49, 0, 0, 0);
            v113 = 28;
            IEventEngine::SendAMessage(g_pEvnEngine, v36);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v102);
            PlayGuiSound(2);
          }
          break;
        case 0xD5u:
          if ( !byte_3ECDE44 )
          {
            v48 = (S4HiWord(a2) & 1) != 0;
            v35 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v104, 0x1D4u, 0x10u, v48, 0, 0, 0);
            v113 = 29;
            IEventEngine::SendAMessage(g_pEvnEngine, v35);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v104);
            PlayGuiSound(2);
          }
          break;
        case 0xD6u:
          if ( !byte_3ECDE44 )
          {
            v47 = (S4HiWord(a2) & 1) != 0;
            v34 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v105, 0x1D4u, 0x24u, v47, 0, 0, 0);
            v113 = 30;
            IEventEngine::SendAMessage(g_pEvnEngine, v34);
            v113 = -1;
            CEvn_Logic::~CEvn_Logic(v105);
            PlayGuiSound(2);
          }
          break;
        case 0xDAu:
          if ( !byte_3ECDE44 )
          {
            v74 = (S4HiWord(a2) & 1) != 0;
            switch ( dword_3ECDE48 )
            {
              case 1:
                v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v89, 0x1D4u, 0x17u, v74, 0, 0, 0);
                v113 = 33;
                IEventEngine::SendAMessage(g_pEvnEngine, v31);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v89);
                break;
              case 2:
                v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v108, 0x1D4u, 0x23u, v74, 0, 0, 0);
                v113 = 32;
                IEventEngine::SendAMessage(g_pEvnEngine, v32);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v108);
                break;
              case 4:
                v33 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v106, 0x1D4u, 0x29u, v74, 0, 0, 0);
                v113 = 31;
                IEventEngine::SendAMessage(g_pEvnEngine, v33);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v106);
                break;
              default:
                v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v109, 0x1D4u, 0x25u, v74, 0, 0, 0);
                v113 = 34;
                IEventEngine::SendAMessage(g_pEvnEngine, v30);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v109);
                break;
            }
            PlayGuiSound(2);
          }
          break;
        case 0xDBu:
          if ( !byte_3ECDE44 )
          {
            v73 = (S4HiWord(a2) & 1) != 0;
            switch ( dword_3ECDE48 )
            {
              case 1:
                v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v94, 0x1D4u, 5u, v73, 0, 0, 0);
                v113 = 19;
                IEventEngine::SendAMessage(g_pEvnEngine, v17);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v94);
                break;
              case 2:
                v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v95, 0x1D4u, 6u, v73, 0, 0, 0);
                v113 = 18;
                IEventEngine::SendAMessage(g_pEvnEngine, v26);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v95);
                break;
              case 4:
                v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v93, 0x1D4u, 0x26u, v73, 0, 0, 0);
                v113 = 17;
                IEventEngine::SendAMessage(g_pEvnEngine, v25);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v93);
                break;
            }
            PlayGuiSound(2);
          }
          break;
        case 0xDCu:
          if ( !byte_3ECDE44 )
          {
            v71 = (S4HiWord(a2) & 1) != 0;
            switch ( dword_3ECDE48 )
            {
              case 1:
                v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v75, 0x1D4u, 0x13u, v71, 0, 0, 0);
                v113 = 37;
                IEventEngine::SendAMessage(g_pEvnEngine, v27);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v75);
                break;
              case 2:
                v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v111, 0x1D4u, 1u, v71, 0, 0, 0);
                v113 = 36;
                IEventEngine::SendAMessage(g_pEvnEngine, v28);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v111);
                break;
              case 4:
                v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v110, 0x1D4u, 0x2Au, v71, 0, 0, 0);
                v113 = 35;
                IEventEngine::SendAMessage(g_pEvnEngine, v29);
                v113 = -1;
                CEvn_Logic::~CEvn_Logic(v110);
                break;
            }
            PlayGuiSound(2);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A0A8);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v5);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368A0A9);
      }
      else
      {
        v6 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v6);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1375e70]
// Decompiled from int __cdecl S4HiWord(unsigned int a1)
unsigned int __cdecl S4HiWord(unsigned int a1) {
  
  return HIWORD(a1);
}


// address=[0x1375e90]
// Decompiled from int __cdecl S4LoWord(unsigned __int16 a1)
unsigned int __cdecl S4LoWord(unsigned int a1) {
  
  return a1;
}


// address=[0x1375ea0]
// Decompiled from char __cdecl SetAmountToolBar(int a1, int a2)
void __cdecl SetAmountToolBar(int a1, int a2) {
  
  char v3; // [esp+3h] [ebp-39h]
  CHAR Str[52]; // [esp+4h] [ebp-38h] BYREF

  if ( a2 <= 0 || a2 >= 100 )
  {
    if ( a2 <= 0 )
    {
      _wsprintfA(Str, "%s", "0");
      v3 = 0;
    }
    else
    {
      _wsprintfA(Str, "%s", "E");
      v3 = 1;
    }
  }
  else
  {
    _wsprintfA(Str, "%u", a2);
    v3 = 1;
  }
  IGuiEngine::SetText((void *)g_pGUIEngine, 47, a1, Str);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 47, a1, v3);
}


// address=[0x1375f60]
// Decompiled from char UpdateGuiDlgAddToolBar()
void __cdecl UpdateGuiDlgAddToolBar(void) {
  
  SetAmountToolBar(234, byte_3F1EF89);
  SetAmountToolBar(235, byte_3F1EF8D);
  SetAmountToolBar(236, byte_3F1EF88);
  SetAmountToolBar(237, byte_3F1EF8E);
  SetAmountToolBar(238, byte_3F1EF8C);
  SetAmountToolBar(239, byte_3F1EF8A);
  return SetAmountToolBar(240, byte_3F1EF8B);
}


// address=[0x1376000]
// Decompiled from char __cdecl GuiDlgAddToolBarProc(int a1, int a2, int a3)
bool __cdecl GuiDlgAddToolBarProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-108h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-100h]
  CEvn_Logic *v8; // [esp+14h] [ebp-F8h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-F0h]
  CEvn_Logic *v10; // [esp+24h] [ebp-E8h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-E0h]
  _BYTE v12[32]; // [esp+3Ch] [ebp-D0h] BYREF
  _BYTE v13[32]; // [esp+5Ch] [ebp-B0h] BYREF
  _BYTE v14[32]; // [esp+7Ch] [ebp-90h] BYREF
  _BYTE v15[32]; // [esp+9Ch] [ebp-70h] BYREF
  _BYTE v16[32]; // [esp+BCh] [ebp-50h] BYREF
  _BYTE v17[32]; // [esp+DCh] [ebp-30h] BYREF
  int v18; // [esp+108h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      dword_3ECDE70 = 0;
      UpdateGuiDlgAddToolBar();
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 47, 228, 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 221:
          if ( dword_3ECDE70 )
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1CEu, dword_3ECDE70, 0x64u, 0, 0, 0);
            v18 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
          }
          PlayGuiSound(2);
          return 1;
        case 222:
          if ( dword_3ECDE70 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1CEu, dword_3ECDE70, 0, 0, 0, 0);
            v18 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v16);
          }
          PlayGuiSound(2);
          return 1;
        case 223:
          if ( dword_3ECDE70 )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1CEu, dword_3ECDE70, 5u, 0, 0, 0);
            v18 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v15);
          }
          PlayGuiSound(2);
          return 1;
        case 224:
          if ( dword_3ECDE70 )
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1CEu, dword_3ECDE70, 0xFFFFFFFB, 0, 0, 0);
            v18 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v14);
          }
          PlayGuiSound(2);
          return 1;
        case 225:
          if ( dword_3ECDE70 )
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1CEu, dword_3ECDE70, 1u, 0, 0, 0);
            v18 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v13);
          }
          PlayGuiSound(2);
          return 1;
        case 226:
          if ( dword_3ECDE70 )
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x1CEu, dword_3ECDE70, 0xFFFFFFFF, 0, 0, 0);
            v18 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v12);
          }
          PlayGuiSound(2);
          return 1;
        case 227:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECDE70 = 4;
          else
            dword_3ECDE70 = 0;
          goto LABEL_36;
        case 228:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECDE70 = 18;
          else
            dword_3ECDE70 = 0;
          goto LABEL_36;
        case 229:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECDE70 = 25;
          else
            dword_3ECDE70 = 0;
          goto LABEL_36;
        case 230:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECDE70 = 27;
          else
            dword_3ECDE70 = 0;
          goto LABEL_36;
        case 231:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECDE70 = 29;
          else
            dword_3ECDE70 = 0;
          goto LABEL_36;
        case 232:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECDE70 = 31;
          else
            dword_3ECDE70 = 0;
          goto LABEL_36;
        case 233:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECDE70 = 28;
          else
            dword_3ECDE70 = 0;
LABEL_36:
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A0AF);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368A0B2);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1376800]
// Decompiled from char __cdecl SetVehicleBuildCosts(int a1, bool a2)
void __cdecl SetVehicleBuildCosts(int a1, bool a2) {
  
  int v3; // [esp+0h] [ebp-40h]
  int v4; // [esp+4h] [ebp-3Ch]
  CHAR Str[52]; // [esp+8h] [ebp-38h] BYREF

  v4 = 0;
  v3 = 0;
  if ( !a2 )
  {
    v4 = byte_3F1EE76[4 * dword_3ECDE7C[a1]];
    v3 = byte_3F1EE77[4 * dword_3ECDE7C[a1]];
  }
  _wsprintfA(Str, "%u", v4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 51, 258, Str);
  _wsprintfA(Str, "%u", v3);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 51, 259, Str);
}


// address=[0x13768c0]
// Decompiled from char __cdecl SetAmountVehicleBar(int a1, int a2)
void __cdecl SetAmountVehicleBar(int a1, int a2) {
  
  char v3; // [esp+Bh] [ebp-39h]
  CHAR Destination; // [esp+Ch] [ebp-38h] BYREF
  char v5; // [esp+Dh] [ebp-37h]

  if ( a2 <= 0 || a2 >= 100 )
  {
    if ( a2 <= 0 )
    {
      j__strncpy(&Destination, "0", 1u);
      v5 = 0;
      v3 = 0;
    }
    else
    {
      j__strncpy(&Destination, "E", 1u);
      v5 = 0;
      v3 = 1;
    }
  }
  else
  {
    _wsprintfA(&Destination, "%u", a2);
    v3 = 1;
  }
  IGuiEngine::SetText((void *)g_pGUIEngine, 51, a1, &Destination);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 51, a1, v3);
}


// address=[0x13769a0]
// Decompiled from char __usercall UpdateGuiDlgAddVehicleBar@<al>(char result@<al>)
void __cdecl UpdateGuiDlgAddVehicleBar(void result) {
  
  char v1; // [esp+0h] [ebp-10h]
  int j; // [esp+8h] [ebp-8h]
  int i; // [esp+Ch] [ebp-4h]

  if ( !g_pGUIEngine )
    return result;
  result = byte_3ECDE78;
  if ( byte_3ECDE78 )
  {
    for ( i = 0; i < 3; ++i )
    {
      result = byte_3F1EE74[4 * i];
      switch ( result )
      {
        case 1:
          SetAmountVehicleBar(243, byte_3F1EE75[4 * i]);
          result = 4;
          dword_3ECDE7C[0] = i;
          break;
        case 2:
          SetAmountVehicleBar(252, byte_3F1EE75[4 * i]);
          result = 8;
          dword_3ECDE7C[2] = i;
          break;
        case 3:
          SetAmountVehicleBar(251, byte_3F1EE75[4 * i]);
          result = i;
          dword_3ECDE7C[1] = i;
          break;
      }
    }
  }
  else
  {
    dword_3ECDE7C[1] = 0;
    for ( j = 0; j < 3; ++j )
    {
      v1 = byte_3F1EE74[4 * j];
      if ( v1 == 4 )
      {
        SetAmountVehicleBar(243, byte_3F1EE75[4 * j]);
        result = j;
        dword_3ECDE7C[1] = j;
      }
      else if ( v1 == 5 )
      {
        result = SetAmountVehicleBar(251, byte_3F1EE75[4 * j]);
        dword_3ECDE7C[2] = j;
      }
      else
      {
        result = SetAmountVehicleBar(252, 0);
      }
    }
  }
  return result;
}


// address=[0x1376b50]
// Decompiled from char __cdecl GuiDlgAddVehicleBarProc(int a1, int a2, int a3)
bool __cdecl GuiDlgAddVehicleBarProc(int a1, int a2, int a3) {
  
  int LocalPlayerId; // eax
  char v5; // al
  char *v6; // eax
  char *v7; // eax
  int v8; // [esp+0h] [ebp-114h]
  CEvn_Logic *v9; // [esp+4h] [ebp-110h]
  CEvn_Logic *v10; // [esp+Ch] [ebp-108h]
  CEvn_Logic *v11; // [esp+14h] [ebp-100h]
  CEvn_Logic *v12; // [esp+1Ch] [ebp-F8h]
  CEvn_Logic *v13; // [esp+24h] [ebp-F0h]
  CEvn_Logic *v14; // [esp+2Ch] [ebp-E8h]
  int v15; // [esp+40h] [ebp-D4h]
  _BYTE v16[32]; // [esp+44h] [ebp-D0h] BYREF
  _BYTE v17[32]; // [esp+64h] [ebp-B0h] BYREF
  _BYTE v18[32]; // [esp+84h] [ebp-90h] BYREF
  _BYTE v19[32]; // [esp+A4h] [ebp-70h] BYREF
  _BYTE v20[32]; // [esp+C4h] [ebp-50h] BYREF
  _BYTE v21[32]; // [esp+E4h] [ebp-30h] BYREF
  int v22; // [esp+110h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      LocalPlayerId = CPlayerManager::GetLocalPlayerId(v8);
      v15 = CPlayerManager::Race(LocalPlayerId);
      dword_3ECDE74 = 0;
      if ( byte_3F1EE74[0] == 4 || byte_3F1EE74[0] == 5 )
      {
        byte_3ECDE78 = 0;
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 51, 255, 0);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 51, 253, dword_368A0C8[35 * v15 + 21], dword_368A0C8[35 * v15 + 22]);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          51,
          253,
          dword_368A0C8[35 * v15 + 23],
          dword_368A0C8[35 * v15 + 24]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 51, 254, dword_368A0C8[35 * v15 + 26], dword_368A0C8[35 * v15 + 27]);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          51,
          254,
          dword_368A0C8[35 * v15 + 28],
          dword_368A0C8[35 * v15 + 29]);
      }
      else
      {
        byte_3ECDE78 = 1;
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 51, 255, 1);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 51, 253, dword_368A0C8[35 * v15 + 6], dword_368A0C8[35 * v15 + 7]);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          51,
          253,
          dword_368A0C8[35 * v15 + 8],
          dword_368A0C8[35 * v15 + 9]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 51, 254, dword_368A0C8[35 * v15 + 16], dword_368A0C8[35 * v15 + 17]);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          51,
          254,
          dword_368A0C8[35 * v15 + 18],
          dword_368A0C8[35 * v15 + 19]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 51, 255, dword_368A0C8[35 * v15 + 11], dword_368A0C8[35 * v15 + 12]);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          51,
          255,
          dword_368A0C8[35 * v15 + 13],
          dword_368A0C8[35 * v15 + 14]);
      }
      v5 = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 51, 253, 1);
      UpdateGuiDlgAddVehicleBar(v5);
      SetVehicleBuildCosts(-1, 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 244:
          if ( dword_3ECDE74 )
          {
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v21, 0x1D5u, dword_3ECDE74, 0x64u, 0, 0, 0);
            v22 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v21);
          }
          PlayGuiSound(2);
          return 1;
        case 245:
          if ( dword_3ECDE74 )
          {
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x1D5u, dword_3ECDE74, 0, 0, 0, 0);
            v22 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v20);
          }
          PlayGuiSound(2);
          return 1;
        case 246:
          if ( dword_3ECDE74 )
          {
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x1D5u, dword_3ECDE74, 5u, 0, 0, 0);
            v22 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v19);
          }
          PlayGuiSound(2);
          return 1;
        case 247:
          if ( dword_3ECDE74 )
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x1D5u, dword_3ECDE74, 0xFFFFFFFB, 0, 0, 0);
            v22 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v18);
          }
          PlayGuiSound(2);
          return 1;
        case 248:
          if ( dword_3ECDE74 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1D5u, dword_3ECDE74, 1u, 0, 0, 0);
            v22 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
          }
          PlayGuiSound(2);
          return 1;
        case 249:
          if ( dword_3ECDE74 )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1D5u, dword_3ECDE74, 0xFFFFFFFF, 0, 0, 0);
            v22 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v16);
          }
          PlayGuiSound(2);
          return 1;
        case 253:
          if ( (a2 & 0x10000) != 0 )
          {
            if ( byte_3ECDE78 )
              dword_3ECDE74 = 1;
            else
              dword_3ECDE74 = 4;
          }
          else
          {
            dword_3ECDE74 = 0;
          }
          goto LABEL_41;
        case 254:
          if ( (a2 & 0x10000) != 0 )
          {
            if ( byte_3ECDE78 )
              dword_3ECDE74 = 3;
            else
              dword_3ECDE74 = 5;
          }
          else
          {
            dword_3ECDE74 = 0;
          }
          goto LABEL_41;
        case 255:
          if ( (a2 & 0x10000) != 0 )
          {
            if ( byte_3ECDE78 )
              dword_3ECDE74 = 2;
            else
              dword_3ECDE74 = 0;
          }
          else
          {
            dword_3ECDE74 = 0;
          }
LABEL_41:
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 5:
      switch ( (unsigned __int16)a2 )
      {
        case 0xFDu:
          SetVehicleBuildCosts(0, 0);
          break;
        case 0xFEu:
          SetVehicleBuildCosts(1, 0);
          break;
        case 0xFFu:
          SetVehicleBuildCosts(2, 0);
          break;
        default:
          goto LABEL_21;
      }
      break;
    case 6:
LABEL_21:
      SetVehicleBuildCosts(-1, 1);
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A387);
      }
      else
      {
        v6 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v6);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A38B);
      }
      else
      {
        v7 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v7);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13778b0]
// Decompiled from char InitGuiDlgAOBriefing()
void __cdecl InitGuiDlgAOBriefing(void) {
  
  int v0; // eax
  char result; // al
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax

  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 7, 3, 0);
  v0 = std::string::c_str(&unk_402C998);
  result = CScrollMultiline::SetText(s_cAOScrolltext, v0);
  if ( !g_pStringEngine )
    return result;
  v2 = g_pStringEngine->GetString(g_pStringEngine, 880);
  IGuiEngine::SetText((void *)g_pGUIEngine, 7, 13, v2);
  v3 = (char *)std::string::c_str(&unk_402C97C);
  IGuiEngine::SetText((void *)g_pGUIEngine, 7, 22, v3);
  v4 = (char *)std::string::c_str(&unk_402C9B4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 7, 15, v4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 7, 6, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 7, 4, 0);
  if ( dword_402C9EC >= 11 )
    IGuiEngine::SetImages((void *)g_pGUIEngine, 7, 6, dword_368A428[12 * dword_402C9EC - 132 + dword_402C9F0], 0);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 7, 19, (char *)&byte_368A548);
}


// address=[0x13779b0]
// Decompiled from char __cdecl GuiDlgAOBriefingProc(int a1, int a2, int a3)
bool __cdecl GuiDlgAOBriefingProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  CEvn_Event *v7; // [esp+4h] [ebp-5Ch]
  CEvn_Event *v8; // [esp+Ch] [ebp-54h]
  CEvn_Event v9; // [esp+20h] [ebp-40h] BYREF
  CEvn_Event v10; // [esp+38h] [ebp-28h] BYREF
  int v11; // [esp+5Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOBriefing();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v10, 0x1F55u, 0, 0, 0);
          v11 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v11 = -1;
          CEvn_Event::~CEvn_Event(&v10);
          break;
        case 2:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v9, 0x1F56u, 0, 0, 0);
          v11 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v11 = -1;
          CEvn_Event::~CEvn_Event(&v9);
          break;
        case 5:
          CScrollMultiline::ScrollDown(s_cAOScrolltext);
          break;
        case 20:
          if ( (a2 & 0x10000) != 0 )
          {
            v6 = (char *)std::string::c_str(&unk_402C9D0);
            IGuiEngine::SetText((void *)g_pGUIEngine, 7, 19, v6);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 7, 6, 1);
          }
          else
          {
            IGuiEngine::SetText((void *)g_pGUIEngine, 7, 19, (char *)&byte_368A54B);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 7, 6, 0);
          }
          break;
        case 21:
          goto LABEL_15;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A549);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A54A);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 )
          CScrollMultiline::ScrollDown(s_cAOScrolltext);
      }
      else
      {
LABEL_15:
        CScrollMultiline::ScrollUp(s_cAOScrolltext);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1377dd0]
// Decompiled from void InitGuiDlgAOCampaignBonus()
void __cdecl InitGuiDlgAOCampaignBonus(void) {
  
  char *v0; // eax
  char *v1; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 112);
    IGuiEngine::SetText((void *)g_pGUIEngine, 6, 25, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 26);
    IGuiEngine::SetText((void *)g_pGUIEngine, 6, 23, v1);
  }
}


// address=[0x1377e40]
// Decompiled from char __cdecl GuiDlgAOCampaignBonusProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgAOCampaignBonusProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-58h]
  CEvn_Event *v7; // [esp+Ch] [ebp-50h]
  CEvn_Event v8; // [esp+1Ch] [ebp-40h] BYREF
  CEvn_Event v9; // [esp+34h] [ebp-28h] BYREF
  int v10; // [esp+58h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOCampaignBonus();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( a2 == 23 )
      {
        PlayGuiSound(2);
        v6 = CEvn_Event::CEvn_Event(&v8, 0x1F53u, 1u, 0, 0);
        v10 = 1;
        IEventEngine::SendAMessage(g_pEvnEngine, v6);
        v10 = -1;
        CEvn_Event::~CEvn_Event(&v8);
      }
      else if ( a2 == 24 )
      {
        PlayGuiSound(2);
        v7 = CEvn_Event::CEvn_Event(&v9, 0x1F54u, 0, 0, 0);
        v10 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v7);
        v10 = -1;
        CEvn_Event::~CEvn_Event(&v9);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A586);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A587);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13780f0]
// Decompiled from void InitGuiDlgAOCampaignMayan()
void __cdecl InitGuiDlgAOCampaignMayan(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  int v5; // [esp+0h] [ebp-8h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 114);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 45, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 35);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 34, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 37);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 35, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 39);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 36, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 41);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 37, v4);
    v5 = dword_402CBBC[13];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 3, 35, v5 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 3, 36, v5 >= 2);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 3, 37, v5 >= 3);
  }
}


// address=[0x1378240]
// Decompiled from char __cdecl GuiDlgAOCampaignMayanProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgAOCampaignMayanProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-B8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-B0h]
  CEvn_Event *v8; // [esp+14h] [ebp-A8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-A0h]
  CEvn_Event *v10; // [esp+24h] [ebp-98h]
  CEvn_Event v11; // [esp+34h] [ebp-88h] BYREF
  CEvn_Event v12; // [esp+4Ch] [ebp-70h] BYREF
  CEvn_Event v13; // [esp+64h] [ebp-58h] BYREF
  CEvn_Event v14; // [esp+7Ch] [ebp-40h] BYREF
  CEvn_Event v15; // [esp+94h] [ebp-28h] BYREF
  int v16; // [esp+B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOCampaignMayan();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case '!':
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v15, 0x1F4Cu, 0, 0, 0);
          v16 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case '"':
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v14, 0x1F4Bu, 0, 0, 0);
          v16 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case '#':
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v13, 0x1F4Bu, 1u, 0, 0);
          v16 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case '$':
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v12, 0x1F4Bu, 2u, 0, 0);
          v16 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case '%':
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v11, 0x1F4Bu, 3u, 0, 0);
          v16 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A588);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A589);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13786f0]
// Decompiled from void InitGuiDlgAOCampaignRoman()
void __cdecl InitGuiDlgAOCampaignRoman(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  int v5; // [esp+0h] [ebp-8h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 119);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 58, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 59);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 47, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 61);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 48, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 63);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 49, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 65);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 50, v4);
    v5 = dword_402CBBC[11];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 1, 48, v5 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 1, 49, v5 >= 2);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 1, 50, v5 >= 3);
  }
}


// address=[0x1378840]
// Decompiled from char __cdecl GuiDlgAOCampaignRomanProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgAOCampaignRomanProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-B8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-B0h]
  CEvn_Event *v8; // [esp+14h] [ebp-A8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-A0h]
  CEvn_Event *v10; // [esp+24h] [ebp-98h]
  CEvn_Event v11; // [esp+34h] [ebp-88h] BYREF
  CEvn_Event v12; // [esp+4Ch] [ebp-70h] BYREF
  CEvn_Event v13; // [esp+64h] [ebp-58h] BYREF
  CEvn_Event v14; // [esp+7Ch] [ebp-40h] BYREF
  CEvn_Event v15; // [esp+94h] [ebp-28h] BYREF
  int v16; // [esp+B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOCampaignRoman();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case '.':
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v15, 0x1F4Au, 0, 0, 0);
          v16 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case '/':
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v14, 0x1F49u, 0, 0, 0);
          v16 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case '0':
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v13, 0x1F49u, 1u, 0, 0);
          v16 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case '1':
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v12, 0x1F49u, 2u, 0, 0);
          v16 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case '2':
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v11, 0x1F49u, 3u, 0, 0);
          v16 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A58A);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A58B);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1378cf0]
// Decompiled from void InitGuiDlgAOCampaigns()
void __cdecl InitGuiDlgAOCampaigns(void) {
  
  char *v0; // eax
  char *v1; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 888);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 75, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 116);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 74, v1);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 76, 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 76, 0);
    IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 0, 65);
    if ( dword_4031CFC )
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 65, 1);
    else
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 64, 1);
  }
}


// address=[0x1378db0]
// Decompiled from char __cdecl GuiDlgAOCampaignsProc(int a1, int a2, int a3)
bool __cdecl GuiDlgAOCampaignsProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-F8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-F0h]
  CEvn_Event *v8; // [esp+14h] [ebp-E8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-E0h]
  CEvn_Event *v10; // [esp+24h] [ebp-D8h]
  CEvn_Event *v11; // [esp+2Ch] [ebp-D0h]
  CEvn_Event *v12; // [esp+34h] [ebp-C8h]
  CEvn_Event v13; // [esp+44h] [ebp-B8h] BYREF
  CEvn_Event v14; // [esp+5Ch] [ebp-A0h] BYREF
  CEvn_Event v15; // [esp+74h] [ebp-88h] BYREF
  CEvn_Event v16; // [esp+8Ch] [ebp-70h] BYREF
  CEvn_Event v17; // [esp+A4h] [ebp-58h] BYREF
  CEvn_Event v18; // [esp+BCh] [ebp-40h] BYREF
  CEvn_Event v19; // [esp+D4h] [ebp-28h] BYREF
  int v20; // [esp+F8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOCampaigns();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case ';':
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v19, 0x1F42u, 0, 0, 0);
          v20 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v19);
          break;
        case '<':
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v17, 0x1F43u, 0, 0, 0);
          v20 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          break;
        case '=':
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v16, 0x1F45u, 0, 0, 0);
          v20 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v16);
          break;
        case '>':
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v18, 0x1F44u, 0, 0, 0);
          v20 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v18);
          break;
        case '?':
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v15, 0x1F51u, 0, 0, 0);
          v20 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case '@':
          PlayGuiSound(2);
          dword_4031CFC = 0;
          break;
        case 'A':
          PlayGuiSound(2);
          dword_4031CFC = 1;
          break;
        case 'B':
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v14, 0x1F46u, 0, 0, 0);
          v20 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 'L':
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v13, 0x1F48u, 0, 0, 0);
          v20 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A58C);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A58D);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13793a0]
// Decompiled from void InitGuiDlgAOCampaignsSettle()
void __cdecl InitGuiDlgAOCampaignsSettle(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  int v5; // [esp+0h] [ebp-8h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 121);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 89, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 69);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 77, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 71);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 78, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 73);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 79, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 75);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 80, v4);
    v5 = dword_402CBBC[14];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 4, 78, v5 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 4, 79, v5 >= 2);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 4, 80, v5 >= 3);
  }
}


// address=[0x13794f0]
// Decompiled from char __cdecl GuiDlgAOCampaignsSettleProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgAOCampaignsSettleProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-B8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-B0h]
  CEvn_Event *v8; // [esp+14h] [ebp-A8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-A0h]
  CEvn_Event *v10; // [esp+24h] [ebp-98h]
  CEvn_Event v11; // [esp+34h] [ebp-88h] BYREF
  CEvn_Event v12; // [esp+4Ch] [ebp-70h] BYREF
  CEvn_Event v13; // [esp+64h] [ebp-58h] BYREF
  CEvn_Event v14; // [esp+7Ch] [ebp-40h] BYREF
  CEvn_Event v15; // [esp+94h] [ebp-28h] BYREF
  int v16; // [esp+B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOCampaignsSettle();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 'M':
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v14, 0x1F47u, 0, 0, 0);
          v16 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 'N':
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v13, 0x1F47u, 1u, 0, 0);
          v16 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case 'O':
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v12, 0x1F47u, 2u, 0, 0);
          v16 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case 'P':
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v11, 0x1F47u, 3u, 0, 0);
          v16 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        case 'Q':
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v15, 0x1F52u, 0, 0, 0);
          v16 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A58E);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A58F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13799a0]
// Decompiled from void InitGuiDlgAOCampaignTrojan()
void __cdecl InitGuiDlgAOCampaignTrojan(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  int v13; // [esp+0h] [ebp-10h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 123);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 110, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 77);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 91, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 79);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 92, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 81);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 93, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 83);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 94, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 85);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 95, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 87);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 96, v6);
    v7 = g_pStringEngine->GetString(g_pStringEngine, 89);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 97, v7);
    v8 = g_pStringEngine->GetString(g_pStringEngine, 91);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 98, v8);
    v9 = g_pStringEngine->GetString(g_pStringEngine, 93);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 99, v9);
    v10 = g_pStringEngine->GetString(g_pStringEngine, 95);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 100, v10);
    v11 = g_pStringEngine->GetString(g_pStringEngine, 97);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 101, v11);
    v12 = g_pStringEngine->GetString(g_pStringEngine, 99);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 102, v12);
    v13 = dword_402CBBC[15];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 92, v13 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 93, v13 >= 2);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 94, v13 >= 3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 95, v13 >= 4);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 96, v13 >= 5);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 97, v13 >= 6);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 98, v13 >= 7);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 99, v13 >= 8);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 100, v13 >= 9);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 101, v13 >= 10);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 102, v13 >= 11);
  }
}


// address=[0x1379d40]
// Decompiled from char __cdecl GuiDlgAOCampaignTrojanProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgAOCampaignTrojanProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+Ch] [ebp-1B0h]
  CEvn_Event *v7; // [esp+14h] [ebp-1A8h]
  CEvn_Event *v8; // [esp+1Ch] [ebp-1A0h]
  CEvn_Event *v9; // [esp+24h] [ebp-198h]
  CEvn_Event *v10; // [esp+2Ch] [ebp-190h]
  CEvn_Event *v11; // [esp+34h] [ebp-188h]
  CEvn_Event *v12; // [esp+38h] [ebp-184h]
  CEvn_Event *v13; // [esp+40h] [ebp-17Ch]
  CEvn_Event *v14; // [esp+48h] [ebp-174h]
  CEvn_Event *v15; // [esp+50h] [ebp-16Ch]
  CEvn_Event *v16; // [esp+54h] [ebp-168h]
  CEvn_Event *v17; // [esp+5Ch] [ebp-160h]
  CEvn_Event *v18; // [esp+64h] [ebp-158h]
  CEvn_Event v19; // [esp+74h] [ebp-148h] BYREF
  CEvn_Event v20; // [esp+8Ch] [ebp-130h] BYREF
  CEvn_Event v21; // [esp+A4h] [ebp-118h] BYREF
  CEvn_Event v22; // [esp+BCh] [ebp-100h] BYREF
  CEvn_Event v23; // [esp+D4h] [ebp-E8h] BYREF
  CEvn_Event v24; // [esp+ECh] [ebp-D0h] BYREF
  CEvn_Event v25; // [esp+104h] [ebp-B8h] BYREF
  CEvn_Event v26; // [esp+11Ch] [ebp-A0h] BYREF
  CEvn_Event v27; // [esp+134h] [ebp-88h] BYREF
  CEvn_Event v28; // [esp+14Ch] [ebp-70h] BYREF
  CEvn_Event v29; // [esp+164h] [ebp-58h] BYREF
  CEvn_Event v30; // [esp+17Ch] [ebp-40h] BYREF
  CEvn_Event v31; // [esp+194h] [ebp-28h] BYREF
  int v32; // [esp+1B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOCampaignTrojan();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 'Z':
          PlayGuiSound(2);
          v18 = CEvn_Event::CEvn_Event(&v24, 0x1F50u, 0, 0, 0);
          v32 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v24);
          break;
        case '[':
          PlayGuiSound(2);
          v17 = CEvn_Event::CEvn_Event(&v25, 0x1F4Fu, 0, 0, 0);
          v32 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v25);
          break;
        case '\\':
          PlayGuiSound(2);
          v16 = CEvn_Event::CEvn_Event(&v26, 0x1F4Fu, 1u, 0, 0);
          v32 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v26);
          break;
        case ']':
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v27, 0x1F4Fu, 2u, 0, 0);
          v32 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v27);
          break;
        case '^':
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v28, 0x1F4Fu, 3u, 0, 0);
          v32 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v28);
          break;
        case '_':
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v29, 0x1F4Fu, 4u, 0, 0);
          v32 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v29);
          break;
        case '`':
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v30, 0x1F4Fu, 5u, 0, 0);
          v32 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v30);
          break;
        case 'a':
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v19, 0x1F4Fu, 6u, 0, 0);
          v32 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v19);
          break;
        case 'b':
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v20, 0x1F4Fu, 7u, 0, 0);
          v32 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v20);
          break;
        case 'c':
          PlayGuiSound(2);
          v15 = CEvn_Event::CEvn_Event(&v21, 0x1F4Fu, 8u, 0, 0);
          v32 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v21);
          break;
        case 'd':
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v22, 0x1F4Fu, 9u, 0, 0);
          v32 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v22);
          break;
        case 'e':
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v23, 0x1F4Fu, 0xAu, 0, 0);
          v32 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v23);
          break;
        case 'f':
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v31, 0x1F4Fu, 0xBu, 0, 0);
          v32 = 12;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v31);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A590);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A591);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137a680]
// Decompiled from void InitGuiDlgAOCampaignViking()
void __cdecl InitGuiDlgAOCampaignViking(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  int v5; // [esp+0h] [ebp-8h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 125);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 123, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 101);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 112, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 103);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 113, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 105);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 114, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 107);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 115, v4);
    v5 = dword_402CBBC[12];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 113, v5 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 114, v5 >= 2);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 115, v5 >= 3);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 2, 112, 658, -1);
  }
}


// address=[0x137a7f0]
// Decompiled from char __cdecl GuiDlgAOCampaignVikingProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgAOCampaignVikingProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-B8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-B0h]
  CEvn_Event *v8; // [esp+14h] [ebp-A8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-A0h]
  CEvn_Event *v10; // [esp+24h] [ebp-98h]
  CEvn_Event v11; // [esp+34h] [ebp-88h] BYREF
  CEvn_Event v12; // [esp+4Ch] [ebp-70h] BYREF
  CEvn_Event v13; // [esp+64h] [ebp-58h] BYREF
  CEvn_Event v14; // [esp+7Ch] [ebp-40h] BYREF
  CEvn_Event v15; // [esp+94h] [ebp-28h] BYREF
  int v16; // [esp+B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOCampaignViking();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 'o':
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v15, 0x1F4Eu, 0, 0, 0);
          v16 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case 'p':
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v14, 0x1F4Du, 0, 0, 0);
          v16 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 'q':
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v13, 0x1F4Du, 1u, 0, 0);
          v16 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case 'r':
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v12, 0x1F4Du, 2u, 0, 0);
          v16 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case 's':
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v11, 0x1F4Du, 3u, 0, 0);
          v16 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v16 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A592);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A593);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137aca0]
// Decompiled from void InitGuiDlgAOSplash()
void __cdecl InitGuiDlgAOSplash(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  const char *v6; // eax
  char *v7; // eax
  const wchar_t *v8; // eax
  const char *v9; // eax
  char v10; // [esp+0h] [ebp-240h]
  int v11; // [esp+10h] [ebp-230h]
  char v12[28]; // [esp+14h] [ebp-22Ch] BYREF
  char Buffer[512]; // [esp+30h] [ebp-210h] BYREF
  int v14; // [esp+23Ch] [ebp-4h]

  if ( !g_bGuiSplashInitDone )
  {
    CSoundManager::StopMusic(g_pSoundManager);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 8, 129, 0);
    if ( g_pStringEngine )
    {
      switch ( g_iAOSplashType )
      {
        case -1:
          IGuiEngine::SetImages((void *)g_pGUIEngine, 8, 127, 146, 0);
          v4 = g_pStringEngine->GetString(g_pStringEngine, 508);
          CScrollMultiline::SetText(s_cAOSplashScrolltext, (int)v4);
          break;
        case 1:
          IGuiEngine::SetImages((void *)g_pGUIEngine, 8, 127, 143, 0);
          v0 = g_pStringEngine->GetString(g_pStringEngine, 503);
          CScrollMultiline::SetText(s_cAOSplashScrolltext, (int)v0);
          break;
        case 3:
          IGuiEngine::SetImages((void *)g_pGUIEngine, 8, 127, 144, 0);
          v1 = g_pStringEngine->GetString(g_pStringEngine, 504);
          CScrollMultiline::SetText(s_cAOSplashScrolltext, (int)v1);
          break;
        case 6:
          IGuiEngine::SetImages((void *)g_pGUIEngine, 8, 127, 145, 0);
          v2 = g_pStringEngine->GetString(g_pStringEngine, 505);
          CScrollMultiline::SetText(s_cAOSplashScrolltext, (int)v2);
          break;
        case 8:
          IGuiEngine::SetImages((void *)g_pGUIEngine, 8, 127, 146, 0);
          v3 = g_pStringEngine->GetString(g_pStringEngine, 506);
          CScrollMultiline::SetText(s_cAOSplashScrolltext, (int)v3);
          break;
        case 9:
          IGuiEngine::SetImages((void *)g_pGUIEngine, 8, 127, 147, 0);
          v5 = g_pStringEngine->GetString(g_pStringEngine, 507);
          CScrollMultiline::SetText(s_cAOSplashScrolltext, (int)v5);
          break;
        default:
          break;
      }
      v11 = 0;
      switch ( g_iAOSplashType )
      {
        case -1:
          v11 = 0;
          break;
        case 1:
          v11 = 1;
          break;
        case 3:
          v11 = 2;
          break;
        case 6:
          v11 = 3;
          break;
        case 8:
          v11 = 4;
          break;
        case 9:
          v11 = 5;
          break;
        default:
          break;
      }
      if ( v11 )
      {
        v6 = (const char *)std::wstring::c_str((_Cnd_internal_imp_t *)&unk_3ECF010);
        j___snwprintf(Buffer, 0xFFu, v6, v11);
      }
      else
      {
        swprintf(Buffer, (char *)L"Snd\\Campaign\\ao_picture4V.mp3", v10);
      }
      std::wstring::wstring(v12);
      v14 = 0;
      if ( (*(unsigned __int8 (__thiscall **)(void *, char *, char *, int))(*(_DWORD *)g_pCDDrive + 8))(
             g_pCDDrive,
             v12,
             Buffer,
             3145744) )
      {
        v8 = (const wchar_t *)std::wstring::c_str((_Cnd_internal_imp_t *)v12);
        if ( !CSoundManager::PlaySoundFile((CSoundManager *)g_pSoundManager, v8, 100, 64) )
        {
          v9 = (const char *)std::wstring::c_str((_Cnd_internal_imp_t *)v12);
          BBSupportTracePrintF(0, "Unable to play briefing file %s", v9);
        }
        g_bGuiSplashInitDone = 1;
        v14 = -1;
        std::wstring::~wstring(v12);
      }
      else
      {
        v7 = g_pStringEngine->GetString(g_pStringEngine, 388);
        std::string::operator=(&g_iMessageBoxStringID, v7);
        IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, 10);
        IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 20, GuiDlgMainMessageBoxProc);
        v14 = -1;
        std::wstring::~wstring(v12);
      }
    }
  }
}


// address=[0x137b0c0]
// Decompiled from char __cdecl GuiDlgAOSplashProc(int a1, int a2, int a3)
bool __cdecl GuiDlgAOSplashProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-3Ch]
  CEvn_Event v7; // [esp+18h] [ebp-28h] BYREF
  int v8; // [esp+3Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgAOSplash();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (unsigned __int16)a2 )
      {
        case 0x7Du:
          goto LABEL_9;
        case 0x7Eu:
          CScrollMultiline::ScrollDown(s_cAOSplashScrolltext);
          break;
        case 0x80u:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v7, 0x1F57u, 0, 0, 0);
          v8 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v8 = -1;
          CEvn_Event::~CEvn_Event(&v7);
          g_bGuiSplashInitDone = 0;
          CSoundManager::StopMusic(g_pSoundManager);
          CSoundManager::StopSounds((CSoundManager *)g_pSoundManager);
          break;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A594);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368A595);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 )
          CScrollMultiline::ScrollDown(s_cAOSplashScrolltext);
      }
      else
      {
LABEL_9:
        CScrollMultiline::ScrollUp(s_cAOSplashScrolltext);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137b4a0]
// Decompiled from char UpdateGuiDlgAvailableGoods()
void __cdecl UpdateGuiDlgAvailableGoods(void) {
  
  char result; // al
  int i; // [esp+0h] [ebp-40h]
  CHAR Str[52]; // [esp+8h] [ebp-38h] BYREF

  byte_3ECF1D0 = 1;
  result = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 27, 323, byte_3F1EC08 == 0);
  for ( i = 0; i < 43; ++i )
  {
    _wsprintfA(Str, "%u", dword_3F1EC10[2 * i]);
    result = IGuiEngine::SetText((void *)g_pGUIEngine, 27, dword_3ECF1D8[dword_3F1EC0C[2 * i]], Str);
  }
  byte_3ECF1D0 = 0;
  return result;
}


// address=[0x137b560]
// Decompiled from int InitGuiDlgAvailableGoods()
void __cdecl InitGuiDlgAvailableGoods(void) {
  
  int result; // eax

  if ( !g_pStringEngine )
    return result;
  dword_3ECF1D8[22] = 293;
  dword_3ECF1D8[7] = 294;
  dword_3ECF1D8[32] = 295;
  dword_3ECF1D8[10] = 296;
  dword_3ECF1D8[21] = 297;
  dword_3ECF1D8[20] = 298;
  dword_3ECF1D8[15] = 299;
  dword_3ECF1D8[14] = 300;
  dword_3ECF1D8[4] = 301;
  dword_3ECF1D8[18] = 302;
  dword_3ECF1D8[25] = 303;
  dword_3ECF1D8[27] = 304;
  dword_3ECF1D8[29] = 305;
  dword_3ECF1D8[31] = 306;
  dword_3ECF1D8[28] = 307;
  dword_3ECF1D8[2] = 308;
  dword_3ECF1D8[3] = 309;
  dword_3ECF1D8[5] = 2893;
  dword_3ECF1D8[34] = 310;
  dword_3ECF1D8[8] = 311;
  dword_3ECF1D8[6] = 312;
  dword_3ECF1D8[17] = 313;
  dword_3ECF1D8[33] = 314;
  dword_3ECF1D8[1] = 315;
  dword_3ECF1D8[9] = 316;
  dword_3ECF1D8[11] = 317;
  dword_3ECF1D8[12] = 318;
  dword_3ECF1D8[16] = 319;
  dword_3ECF1D8[19] = 2894;
  dword_3ECF1D8[23] = 2895;
  dword_3ECF1D8[24] = 320;
  dword_3ECF1D8[35] = 321;
  dword_3ECF1D8[36] = 322;
  dword_3ECF1D8[37] = 2028;
  dword_3ECF1D8[13] = 325;
  dword_3ECF1D8[26] = 327;
  dword_3ECF1D8[30] = 2030;
  dword_3ECF1D8[39] = 2032;
  dword_3ECF1D8[40] = 2866;
  dword_3ECF1D8[38] = 2870;
  result = 164;
  dword_3ECF1D8[41] = 2871;
  dword_3ECF1D8[42] = 2872;
  return result;
}


// address=[0x137b870]
// Decompiled from char __cdecl GuiDlgAvailableGoodsProc(int a1, int a2, int a3)
bool __cdecl GuiDlgAvailableGoodsProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-68h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-60h]
  _BYTE v8[32]; // [esp+1Ch] [ebp-50h] BYREF
  _BYTE v9[32]; // [esp+3Ch] [ebp-30h] BYREF
  int v10; // [esp+68h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3ECF1D0 = 0;
      InitGuiDlgAvailableGoods();
      UpdateGuiDlgAvailableGoods();
      break;
    case 1:
      if ( !byte_3ECF1D0 )
      {
        if ( (a2 & 0x10000) != 0 )
          PlayGuiSound(1);
        else
          PlayGuiSound(0);
      }
      break;
    case 3:
      if ( !byte_3ECF1D0 && (unsigned __int16)a2 == 323 )
      {
        if ( (a2 & 0x10000) != 0 )
        {
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v9, 0x1B8u, 0, 1u, 0, 0, 0);
          v10 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v10 = -1;
          CEvn_Logic::~CEvn_Logic(v9);
        }
        else
        {
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v8, 0x1B8u, 0, 0, 0, 0, 0);
          v10 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v10 = -1;
          CEvn_Logic::~CEvn_Logic(v8);
        }
        PlayGuiSound(2);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A657);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368A658);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137bc40]
// Decompiled from void UpdateGuiDlgBarracksContext()
void __cdecl UpdateGuiDlgBarracksContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int v2; // eax
  int GuiGoodImageID; // eax
  int Number; // [esp+0h] [ebp-4Ch]
  int i; // [esp+8h] [ebp-44h]
  int v6; // [esp+10h] [ebp-3Ch]
  CHAR Str[52]; // [esp+14h] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3ECF2A8 = 1;
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E5ED, byte_3F1E5EC, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 22, 337, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E5ED, byte_3F1E5EC);
    IGuiEngine::SetText((void *)g_pGUIEngine, 22, 331, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E5F4);
    IGuiEngine::SetText((void *)g_pGUIEngine, 22, 332, Str);
    if ( byte_3F1E5F3 <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, 333, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E5F3);
      IGuiEngine::SetText((void *)g_pGUIEngine, 22, 333, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, 333, 1);
    }
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 22, 330, byte_3F1E5F0 == 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, 330, byte_3F1E5EF);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_368A65C[4], 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_368A65C[5], 0);
    for ( i = 0; i < 5; ++i )
    {
      switch ( byte_3F1E5F8[2 * i] )
      {
        case 3:
          v6 = 3;
          break;
        case 5:
        case 6:
        case 38:
          v6 = 2;
          break;
        case 8:
          v6 = 1;
          break;
        case 14:
          v6 = 4;
          break;
        case 34:
          v6 = 0;
          break;
        default:
          v6 = -1;
          break;
      }
      if ( v6 >= 0 )
      {
        Number = byte_3F1E5F9[2 * i];
        v2 = j__abs(Number);
        _wsprintfA(Str, "%u", v2);
        IGuiEngine::SetText((void *)g_pGUIEngine, 22, dword_368A65C[2 * v6], Str);
        GuiGoodImageID = GetGuiGoodImageID(byte_3F1E5F8[2 * i]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_368A65C[2 * v6 + 1], GuiGoodImageID, 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_368A65C[2 * v6], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_368A65C[2 * v6 + 1], 1);
        if ( Number < 0 )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 14, dword_368A65C[2 * v6], 2);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 14, dword_368A65C[2 * v6], 1);
      }
    }
    byte_3ECF2A8 = 0;
    if ( g_bOpenSidebar )
    {
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 22, 344, 1);
      g_bOpenSidebar = 0;
    }
  }
}


// address=[0x137c010]
// Decompiled from char __cdecl GuiDlgBarracksContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBarracksContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-178h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-170h]
  CEvn_Logic *v8; // [esp+14h] [ebp-168h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-160h]
  CEvn_Logic *v10; // [esp+24h] [ebp-158h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-150h]
  CEvn_Logic *v12; // [esp+34h] [ebp-148h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-140h]
  CEvn_Logic *v14; // [esp+44h] [ebp-138h]
  _BYTE v15[32]; // [esp+54h] [ebp-128h] BYREF
  _BYTE v16[32]; // [esp+74h] [ebp-108h] BYREF
  _BYTE v17[32]; // [esp+94h] [ebp-E8h] BYREF
  _BYTE v18[32]; // [esp+B4h] [ebp-C8h] BYREF
  _BYTE v19[32]; // [esp+D4h] [ebp-A8h] BYREF
  _BYTE v20[32]; // [esp+F4h] [ebp-88h] BYREF
  _BYTE v21[32]; // [esp+114h] [ebp-68h] BYREF
  _BYTE v22[32]; // [esp+134h] [ebp-48h] BYREF
  CEvn_Event v23; // [esp+154h] [ebp-28h] BYREF
  int v24; // [esp+178h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3ECF2A8 = 0;
      UpdateGuiDlgBarracksContext();
      break;
    case 1:
      if ( !byte_3ECF2A8 )
      {
        if ( (a3 & 0x10000) != 0 )
          PlayGuiSound(1);
        else
          PlayGuiSound(0);
      }
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 328:
          v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v22, 0x198u, 0, 0, 0, 0, 0);
          v24 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v22);
          PlayGuiSound(2);
          break;
        case 329:
          v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v21, 0x194u, 0, 0, 0, 0, 0);
          v24 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v21);
          PlayGuiSound(2);
          break;
        case 330:
          if ( !byte_3ECF2A8 )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x196u, 0, 0, 0, 0, 0);
              v24 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v11);
              v24 = -1;
              CEvn_Logic::~CEvn_Logic(v19);
            }
            else
            {
              v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x196u, 0, 1u, 0, 0, 0);
              v24 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v10);
              v24 = -1;
              CEvn_Logic::~CEvn_Logic(v18);
            }
            PlayGuiSound(2);
          }
          break;
        case 344:
          if ( (a2 & 0x10000) != 0 )
          {
            if ( byte_3F1E5EC == 24 )
            {
              v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1C3u, 0, 0, 0, 0, 0);
              v24 = 5;
              IEventEngine::SendAMessage(g_pEvnEngine, v9);
              v24 = -1;
              CEvn_Logic::~CEvn_Logic(v17);
            }
            else
            {
              v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1C6u, 0, 0, 0, 0, 0);
              v24 = 6;
              IEventEngine::SendAMessage(g_pEvnEngine, v8);
              v24 = -1;
              CEvn_Logic::~CEvn_Logic(v16);
            }
          }
          else
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1CCu, 0, 0, 0, 0, 0);
            v24 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v24 = -1;
            CEvn_Logic::~CEvn_Logic(v15);
            v6 = CEvn_Event::CEvn_Event(&v23, 0x260u, 0, 0, 0);
            v24 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v24 = -1;
            CEvn_Event::~CEvn_Event(&v23);
          }
          PlayGuiSound(2);
          break;
        case 347:
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x193u, 0, 0, 0, 0, 0);
          v24 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v20);
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A687);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368A68F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137c7d0]
// Decompiled from void InitGuiDlgWinLoss()
void __cdecl InitGuiDlgWinLoss(void) {
  
  ;
}


// address=[0x137c7e0]
// Decompiled from char __cdecl UpdateGuiDlgWinLoss(int a1)
bool __cdecl UpdateGuiDlgWinLoss(int a1) {
  
  char *v1; // eax

  if ( a1 == 1 )
    v1 = g_pStringEngine->GetString(g_pStringEngine, 1964);
  else
    v1 = g_pStringEngine->GetString(g_pStringEngine, 1934);
  IGuiEngine::SetText((void *)g_pGUIEngine, 72, 1795, v1);
  return 1;
}


// address=[0x137c850]
// Decompiled from char __cdecl GuiDlgWinLossProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgWinLossProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgWinLoss();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A69A);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A69B);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137c9c0]
// Decompiled from void InitGuiDlgBriefing()
void __cdecl InitGuiDlgBriefing(void) {
  
  char *v0; // eax
  char *v1; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 880);
    IGuiEngine::SetText((void *)g_pGUIEngine, 35, 369, v0);
    v1 = (char *)std::string::c_str(&unk_402C9B4);
    IGuiEngine::SetText((void *)g_pGUIEngine, 35, 370, v1);
  }
}


// address=[0x137ca20]
// Decompiled from char __cdecl GuiDlgBriefingProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBriefingProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgBriefing();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A69C);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368A69D);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137cb80]
// Decompiled from char __cdecl SetBuildBasicProperties(int a1, int a2, int a3, int a4)
void __cdecl SetBuildBasicProperties(int a1, int a2, int a3, int a4) {
  
  CHAR v5[52]; // [esp+4h] [ebp-6Ch] BYREF
  CHAR Str[52]; // [esp+38h] [ebp-38h] BYREF

  _wsprintfA(Str, "%u", a1);
  IGuiEngine::SetText((void *)g_pGUIEngine, 9, a3, Str);
  _wsprintfA(v5, "+%u", a2);
  IGuiEngine::SetText((void *)g_pGUIEngine, 9, a4, v5);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 9, a4, a2 > 0);
}


// address=[0x137cc20]
// Decompiled from char UpdateGuiDlgBuildBasic()
void __cdecl UpdateGuiDlgBuildBasic(void) {
  
  int v0; // eax
  int i; // [esp+4h] [ebp-10h]
  int v3; // [esp+8h] [ebp-Ch]
  int v4; // [esp+Ch] [ebp-8h]

  if ( !g_pGUIEngine )
    return v0;
  byte_3ECF2A9 = 1;
  LOBYTE(v0) = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 9, 394, byte_3F1E909 == 0);
  for ( i = 0; i < 10; ++i )
  {
    v4 = dword_3F1E914[4 * i];
    v3 = dword_3F1E910[4 * i];
    v0 = dword_3F1E90C[4 * i] - 1;
    switch ( dword_3F1E90C[4 * i] )
    {
      case 1:
        LOBYTE(v0) = SetBuildBasicProperties(v3, v4, 380, 389);
        break;
      case 2:
        LOBYTE(v0) = SetBuildBasicProperties(v3, v4, 376, 388);
        break;
      case 3:
        LOBYTE(v0) = SetBuildBasicProperties(v3, v4, 374, 387);
        break;
      case 4:
        LOBYTE(v0) = SetBuildBasicProperties(v3, v4, 378, 390);
        break;
      case 14:
        LOBYTE(v0) = SetBuildBasicProperties(v3, v4, 402, 403);
        break;
      case 40:
        LOBYTE(v0) = SetBuildBasicProperties(v3, v4, 386, 393);
        break;
      case 41:
        LOBYTE(v0) = SetBuildBasicProperties(v3, v4, 384, 391);
        break;
      case 42:
        LOBYTE(v0) = SetBuildBasicProperties(v3, v4, 385, 392);
        break;
      default:
        continue;
    }
  }
  byte_3ECF2A9 = 0;
  return v0;
}


// address=[0x137ce30]
// Decompiled from char __cdecl SetBasicBuildCosts(int a1, bool a2)
void __cdecl SetBasicBuildCosts(int a1, bool a2) {
  
  int v3; // [esp+0h] [ebp-44h]
  int v4; // [esp+4h] [ebp-40h]
  int v5; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  v5 = 0;
  v4 = 0;
  v3 = 0;
  if ( !a2 )
  {
    v5 = byte_3F1E918[16 * a1];
    v4 = byte_3F1E919[16 * a1];
    v3 = byte_3F1E91A[16 * a1];
  }
  _wsprintfA(Str, "%u", v5);
  IGuiEngine::SetText((void *)g_pGUIEngine, 9, 398, Str);
  _wsprintfA(Str, "%u", v4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 9, 399, Str);
  _wsprintfA(Str, "%u", v3);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 9, 400, Str);
}


// address=[0x137cf20]
// Decompiled from char __cdecl GuiDlgBuildBasicProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBuildBasicProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-574h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-56Ch]
  CEvn_Logic *v8; // [esp+14h] [ebp-564h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-55Ch]
  CEvn_Logic *v10; // [esp+24h] [ebp-554h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-54Ch]
  CEvn_Logic *v12; // [esp+34h] [ebp-544h]
  CEvn_Logic *v13; // [esp+40h] [ebp-538h]
  CEvn_Logic *v14; // [esp+48h] [ebp-530h]
  CEvn_Logic *v15; // [esp+50h] [ebp-528h]
  CEvn_Logic *v16; // [esp+58h] [ebp-520h]
  CEvn_Logic *v17; // [esp+60h] [ebp-518h]
  CEvn_Logic *v18; // [esp+68h] [ebp-510h]
  CEvn_Logic *v19; // [esp+6Ch] [ebp-50Ch]
  CEvn_Logic *v20; // [esp+74h] [ebp-504h]
  CEvn_Logic *v21; // [esp+7Ch] [ebp-4FCh]
  CEvn_Logic *v22; // [esp+84h] [ebp-4F4h]
  CEvn_Logic *v23; // [esp+8Ch] [ebp-4ECh]
  CEvn_Logic *v24; // [esp+94h] [ebp-4E4h]
  CEvn_Logic *v25; // [esp+9Ch] [ebp-4DCh]
  CEvn_Logic *v26; // [esp+A4h] [ebp-4D4h]
  CEvn_Logic *v27; // [esp+ACh] [ebp-4CCh]
  CEvn_Logic *v28; // [esp+B4h] [ebp-4C4h]
  CEvn_Logic *v29; // [esp+BCh] [ebp-4BCh]
  CEvn_Logic *v30; // [esp+C4h] [ebp-4B4h]
  CEvn_Logic *v31; // [esp+CCh] [ebp-4ACh]
  CEvn_Logic *v32; // [esp+D4h] [ebp-4A4h]
  CEvn_Logic *v33; // [esp+DCh] [ebp-49Ch]
  CEvn_Logic *v34; // [esp+E4h] [ebp-494h]
  CEvn_Logic *v35; // [esp+ECh] [ebp-48Ch]
  CEvn_Logic *v36; // [esp+F4h] [ebp-484h]
  CEvn_Logic *v37; // [esp+FCh] [ebp-47Ch]
  CEvn_Logic *v38; // [esp+104h] [ebp-474h]
  CEvn_Logic *v39; // [esp+10Ch] [ebp-46Ch]
  _BYTE v40[32]; // [esp+128h] [ebp-450h] BYREF
  _BYTE v41[32]; // [esp+148h] [ebp-430h] BYREF
  _BYTE v42[32]; // [esp+168h] [ebp-410h] BYREF
  _BYTE v43[32]; // [esp+188h] [ebp-3F0h] BYREF
  _BYTE v44[32]; // [esp+1A8h] [ebp-3D0h] BYREF
  _BYTE v45[32]; // [esp+1C8h] [ebp-3B0h] BYREF
  _BYTE v46[32]; // [esp+1E8h] [ebp-390h] BYREF
  _BYTE v47[32]; // [esp+208h] [ebp-370h] BYREF
  _BYTE v48[32]; // [esp+228h] [ebp-350h] BYREF
  _BYTE v49[32]; // [esp+248h] [ebp-330h] BYREF
  _BYTE v50[32]; // [esp+268h] [ebp-310h] BYREF
  _BYTE v51[32]; // [esp+288h] [ebp-2F0h] BYREF
  _BYTE v52[32]; // [esp+2A8h] [ebp-2D0h] BYREF
  _BYTE v53[32]; // [esp+2C8h] [ebp-2B0h] BYREF
  _BYTE v54[32]; // [esp+2E8h] [ebp-290h] BYREF
  _BYTE v55[32]; // [esp+308h] [ebp-270h] BYREF
  _BYTE v56[32]; // [esp+328h] [ebp-250h] BYREF
  _BYTE v57[32]; // [esp+348h] [ebp-230h] BYREF
  _BYTE v58[32]; // [esp+368h] [ebp-210h] BYREF
  _BYTE v59[32]; // [esp+388h] [ebp-1F0h] BYREF
  _BYTE v60[32]; // [esp+3A8h] [ebp-1D0h] BYREF
  _BYTE v61[32]; // [esp+3C8h] [ebp-1B0h] BYREF
  _BYTE v62[32]; // [esp+3E8h] [ebp-190h] BYREF
  _BYTE v63[32]; // [esp+408h] [ebp-170h] BYREF
  _BYTE v64[32]; // [esp+428h] [ebp-150h] BYREF
  _BYTE v65[32]; // [esp+448h] [ebp-130h] BYREF
  _BYTE v66[32]; // [esp+468h] [ebp-110h] BYREF
  _BYTE v67[32]; // [esp+488h] [ebp-F0h] BYREF
  _BYTE v68[32]; // [esp+4A8h] [ebp-D0h] BYREF
  _BYTE v69[32]; // [esp+4C8h] [ebp-B0h] BYREF
  _BYTE v70[32]; // [esp+4E8h] [ebp-90h] BYREF
  _BYTE v71[32]; // [esp+508h] [ebp-70h] BYREF
  _BYTE v72[32]; // [esp+528h] [ebp-50h] BYREF
  _BYTE v73[32]; // [esp+548h] [ebp-30h] BYREF
  int v74; // [esp+574h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgBuildBasic();
      SetBasicBuildCosts(-1, 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 373:
          if ( (a2 & 0x10000) != 0 )
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v51, 0x1B5u, 0, 3u, 0, 0, 0);
            v74 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v51);
          }
          else
          {
            v39 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v50, 0x191u, 0, 0, 0, 0, 0);
            v74 = 17;
            IEventEngine::SendAMessage(g_pEvnEngine, v39);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v50);
          }
          return 1;
        case 375:
          if ( (a2 & 0x10000) != 0 )
          {
            v38 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v49, 0x1B5u, 0, 2u, 0, 0, 0);
            v74 = 18;
            IEventEngine::SendAMessage(g_pEvnEngine, v38);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v49);
          }
          else
          {
            v37 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v48, 0x191u, 0, 0, 0, 0, 0);
            v74 = 19;
            IEventEngine::SendAMessage(g_pEvnEngine, v37);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v48);
          }
          return 1;
        case 377:
          if ( (a2 & 0x10000) != 0 )
          {
            v36 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v68, 0x1B5u, 0, 4u, 0, 0, 0);
            v74 = 20;
            IEventEngine::SendAMessage(g_pEvnEngine, v36);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v68);
          }
          else
          {
            v35 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v47, 0x191u, 0, 0, 0, 0, 0);
            v74 = 21;
            IEventEngine::SendAMessage(g_pEvnEngine, v35);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v47);
          }
          return 1;
        case 379:
          if ( (a2 & 0x10000) != 0 )
          {
            v34 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v46, 0x1B5u, 0, 1u, 0, 0, 0);
            v74 = 22;
            IEventEngine::SendAMessage(g_pEvnEngine, v34);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v46);
          }
          else
          {
            v33 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v45, 0x191u, 0, 0, 0, 0, 0);
            v74 = 23;
            IEventEngine::SendAMessage(g_pEvnEngine, v33);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v45);
          }
          return 1;
        case 381:
          if ( (a2 & 0x10000) != 0 )
          {
            v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v44, 0x1B5u, 0, 0x28u, 0, 0, 0);
            v74 = 24;
            IEventEngine::SendAMessage(g_pEvnEngine, v32);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v44);
          }
          else
          {
            v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v43, 0x191u, 0, 0, 0, 0, 0);
            v74 = 25;
            IEventEngine::SendAMessage(g_pEvnEngine, v31);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v43);
          }
          return 1;
        case 382:
          if ( (a2 & 0x10000) != 0 )
          {
            v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v42, 0x1B5u, 0, 0x29u, 0, 0, 0);
            v74 = 26;
            IEventEngine::SendAMessage(g_pEvnEngine, v30);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v42);
          }
          else
          {
            v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v41, 0x191u, 0, 0, 0, 0, 0);
            v74 = 27;
            IEventEngine::SendAMessage(g_pEvnEngine, v29);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v41);
          }
          return 1;
        case 383:
          if ( (a2 & 0x10000) != 0 )
          {
            v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v40, 0x1B5u, 0, 0x2Au, 0, 0, 0);
            v74 = 28;
            IEventEngine::SendAMessage(g_pEvnEngine, v28);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v40);
          }
          else
          {
            v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v72, 0x191u, 0, 0, 0, 0, 0);
            v74 = 29;
            IEventEngine::SendAMessage(g_pEvnEngine, v27);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v72);
          }
          return 1;
        case 394:
          if ( byte_3ECF2A9 )
            return 1;
          if ( (a2 & 0x10000) != 0 )
          {
            v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v69, 0x1B8u, 0, 1u, 0, 0, 0);
            v74 = 32;
            IEventEngine::SendAMessage(g_pEvnEngine, v24);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v69);
          }
          else
          {
            v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v54, 0x1B8u, 0, 0, 0, 0, 0);
            v74 = 33;
            IEventEngine::SendAMessage(g_pEvnEngine, v23);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v54);
          }
          break;
        case 401:
          if ( (a2 & 0x10000) != 0 )
          {
            v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v71, 0x1B5u, 0, 0xEu, 0, 0, 0);
            v74 = 30;
            IEventEngine::SendAMessage(g_pEvnEngine, v26);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v71);
          }
          else
          {
            v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v70, 0x191u, 0, 0, 0, 0, 0);
            v74 = 31;
            IEventEngine::SendAMessage(g_pEvnEngine, v25);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v70);
          }
          return 1;
        default:
          return 1;
      }
      break;
    case 5:
      switch ( (__int16)a2 )
      {
        case 373:
          SetBasicBuildCosts(0, 0);
          break;
        case 375:
          SetBasicBuildCosts(1, 0);
          break;
        case 377:
          SetBasicBuildCosts(2, 0);
          break;
        case 379:
          SetBasicBuildCosts(3, 0);
          break;
        case 381:
          SetBasicBuildCosts(4, 0);
          break;
        case 382:
          SetBasicBuildCosts(5, 0);
          break;
        case 383:
          SetBasicBuildCosts(6, 0);
          break;
        case 401:
          SetBasicBuildCosts(7, 0);
          break;
        default:
          goto GuiDlgBuildBasicProc___def_177D07F;
      }
      break;
    case 6:
GuiDlgBuildBasicProc___def_177D07F:
      SetBasicBuildCosts(-1, 1);
      break;
    case 7:
      if ( a3 == 65537 )
      {
        switch ( (__int16)a2 )
        {
          case 373:
            v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v67, 0x1E6u, 0, 3u, 0, 0, 0);
            v74 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v22);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v67);
            break;
          case 375:
            v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v65, 0x1E6u, 0, 2u, 0, 0, 0);
            v74 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v20);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v65);
            break;
          case 377:
            v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v64, 0x1E6u, 0, 4u, 0, 0, 0);
            v74 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v19);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v64);
            break;
          case 379:
            v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v66, 0x1E6u, 0, 1u, 0, 0, 0);
            v74 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v66);
            break;
          case 381:
            v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v63, 0x1E6u, 0, 0x28u, 0, 0, 0);
            v74 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v63);
            break;
          case 382:
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v62, 0x1E6u, 0, 0x29u, 0, 0, 0);
            v74 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v62);
            break;
          case 383:
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v61, 0x1E6u, 0, 0x2Au, 0, 0, 0);
            v74 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v61);
            break;
          case 401:
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v60, 0x1E6u, 0, 0xEu, 0, 0, 0);
            v74 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v60);
            break;
          default:
            return 1;
        }
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 373:
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v59, 0x1B6u, 0, 3u, 0, 0, 0);
            v74 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v59);
            break;
          case 375:
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v58, 0x1B6u, 0, 2u, 0, 0, 0);
            v74 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v58);
            break;
          case 377:
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v57, 0x1B6u, 0, 4u, 0, 0, 0);
            v74 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v57);
            break;
          case 379:
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v56, 0x1B6u, 0, 1u, 0, 0, 0);
            v74 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v56);
            break;
          case 381:
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v55, 0x1B6u, 0, 0x28u, 0, 0, 0);
            v74 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v55);
            break;
          case 382:
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v73, 0x1B6u, 0, 0x29u, 0, 0, 0);
            v74 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v73);
            break;
          case 383:
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v53, 0x1B6u, 0, 0x2Au, 0, 0, 0);
            v74 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v53);
            break;
          case 401:
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v52, 0x1B6u, 0, 0xEu, 0, 0, 0);
            v74 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v52);
            break;
          default:
            return 1;
        }
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368A6A3);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368A6AB);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137e530]
// Decompiled from void UpdateGuiDlgBuildContext()
void __cdecl UpdateGuiDlgBuildContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int v2; // eax
  int GuiGoodImageID; // eax
  int v4; // eax
  int v5; // eax
  int Number; // [esp+0h] [ebp-44h]
  int Numbera; // [esp+0h] [ebp-44h]
  int i; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3ECF2AA = 1;
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E4C9, byte_3F1E4C8, 1);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 14, 420, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E4C9, byte_3F1E4C8);
    IGuiEngine::SetText((void *)g_pGUIEngine, 14, 408, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E4D0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 14, 409, Str);
    if ( byte_3F1E4CF <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, 410, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E4CF);
      IGuiEngine::SetText((void *)g_pGUIEngine, 14, 410, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, 410, 1);
    }
    for ( i = 0; i < 3; ++i )
    {
      if ( byte_3F1E4D4[2 * i] )
      {
        Number = byte_3F1E4D5[2 * i];
        v2 = j__abs(Number);
        _wsprintfA(Str, "%u", v2);
        IGuiEngine::SetText((void *)g_pGUIEngine, 14, dword_368AA14[2 * i], Str);
        GuiGoodImageID = GetGuiGoodImageID(byte_3F1E4D4[2 * i]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 14, dword_368AA14[2 * i + 1], GuiGoodImageID, 0);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          14,
          dword_368AA14[2 * i + 1],
          dword_368A6B8[5 * byte_3F1E4D4[2 * i] + 3],
          dword_368A6B8[5 * byte_3F1E4D4[2 * i] + 4]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, dword_368AA14[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, dword_368AA14[2 * i + 1], 1);
        if ( Number < 0 )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 14, dword_368AA14[2 * i], 2);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 14, dword_368AA14[2 * i], 1);
      }
      else
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, dword_368AA14[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, dword_368AA14[2 * i + 1], 0);
      }
      if ( byte_3F1E4DA[2 * i] )
      {
        Numbera = byte_3F1E4DB[2 * i];
        v4 = j__abs(Numbera);
        _wsprintfA(Str, "%u", v4);
        IGuiEngine::SetText((void *)g_pGUIEngine, 14, dword_368AA2C[2 * i], Str);
        v5 = GetGuiGoodImageID(byte_3F1E4DA[2 * i]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 14, dword_368AA2C[2 * i + 1], v5, 0);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          14,
          dword_368AA14[2 * i + 1],
          dword_368A6B8[5 * byte_3F1E4DA[2 * i] + 3],
          dword_368A6B8[5 * byte_3F1E4DA[2 * i] + 4]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, dword_368AA2C[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, dword_368AA2C[2 * i + 1], 1);
        if ( Numbera < 0 )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 14, dword_368AA2C[2 * i], 2);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 14, dword_368AA2C[2 * i], 1);
      }
      else
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, dword_368AA2C[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, dword_368AA2C[2 * i + 1], 0);
      }
    }
    IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 14, 418, byte_3F1E4CE);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 14, 405, byte_3F1E4CD);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 14, 407, byte_3F1E4CC == 0);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 14, 417, byte_3F1E4E0);
    byte_3ECF2AA = 0;
  }
}


// address=[0x137eaa0]
// Decompiled from char __cdecl GuiDlgBuildContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBuildContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-130h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-128h]
  CEvn_Logic *v8; // [esp+14h] [ebp-120h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-118h]
  CEvn_Logic *v10; // [esp+24h] [ebp-110h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-108h]
  CEvn_Logic *v12; // [esp+34h] [ebp-100h]
  _BYTE v13[32]; // [esp+44h] [ebp-F0h] BYREF
  _BYTE v14[32]; // [esp+64h] [ebp-D0h] BYREF
  _BYTE v15[32]; // [esp+84h] [ebp-B0h] BYREF
  _BYTE v16[32]; // [esp+A4h] [ebp-90h] BYREF
  _BYTE v17[32]; // [esp+C4h] [ebp-70h] BYREF
  _BYTE v18[32]; // [esp+E4h] [ebp-50h] BYREF
  _BYTE v19[32]; // [esp+104h] [ebp-30h] BYREF
  int v20; // [esp+130h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3ECF2AA = 0;
      UpdateGuiDlgBuildContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 404:
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x198u, 0, 0, 0, 0, 0);
          v20 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v19);
          PlayGuiSound(2);
          break;
        case 405:
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x193u, 0, 0, 0, 0, 0);
          v20 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v18);
          PlayGuiSound(2);
          break;
        case 406:
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x194u, 0, 0, 0, 0, 0);
          v20 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v17);
          PlayGuiSound(2);
          break;
        case 407:
          if ( !byte_3ECF2AA )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x196u, 0, 1u, 0, 0, 0);
              v20 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v9);
              v20 = -1;
              CEvn_Logic::~CEvn_Logic(v16);
            }
            else
            {
              v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x196u, 0, 0, 0, 0, 0);
              v20 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v8);
              v20 = -1;
              CEvn_Logic::~CEvn_Logic(v15);
            }
            PlayGuiSound(2);
          }
          break;
        case 417:
          if ( !byte_3ECF2AA )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x197u, 0, 1u, 0, 0, 0);
              v20 = 5;
              IEventEngine::SendAMessage(g_pEvnEngine, v7);
              v20 = -1;
              CEvn_Logic::~CEvn_Logic(v14);
            }
            else
            {
              v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x197u, 0, 0, 0, 0, 0);
              v20 = 6;
              IEventEngine::SendAMessage(g_pEvnEngine, v6);
              v20 = -1;
              CEvn_Logic::~CEvn_Logic(v13);
            }
            PlayGuiSound(2);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AA47);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AA4F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x137f1d0]
// Decompiled from char __cdecl SetEyecatcherProperties(int a1, int a2, int a3, int a4)
void __cdecl SetEyecatcherProperties(int a1, int a2, int a3, int a4) {
  
  CHAR v5[52]; // [esp+4h] [ebp-6Ch] BYREF
  CHAR Str[52]; // [esp+38h] [ebp-38h] BYREF

  _wsprintfA(Str, "%u", a1);
  IGuiEngine::SetText((void *)g_pGUIEngine, 52, a3, Str);
  _wsprintfA(v5, "+%u", a2);
  IGuiEngine::SetText((void *)g_pGUIEngine, 52, a4, v5);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 52, a4, a2 > 0);
}


// address=[0x137f270]
// Decompiled from char __cdecl SetEyecatcherBuildCosts(int a1, bool a2)
void __cdecl SetEyecatcherBuildCosts(int a1, bool a2) {
  
  int v3; // [esp+0h] [ebp-44h]
  int v4; // [esp+4h] [ebp-40h]
  int v5; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  v5 = 0;
  v4 = 0;
  v3 = 0;
  if ( !a2 )
  {
    v5 = byte_3F1EFA4[16 * a1];
    v4 = byte_3F1EFA5[16 * a1];
    v3 = byte_3F1EFA6[16 * a1];
  }
  _wsprintfA(Str, "%u", v5);
  IGuiEngine::SetText((void *)g_pGUIEngine, 52, 702, Str);
  _wsprintfA(Str, "%u", v4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 52, 703, Str);
  _wsprintfA(Str, "%u", v3);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 52, 704, Str);
}


// address=[0x137f360]
// Decompiled from int UpdateGuiDlgBuildEyecatcher()
void __cdecl UpdateGuiDlgBuildEyecatcher(void) {
  
  int result; // eax
  int i; // [esp+4h] [ebp-Ch]
  int v2; // [esp+8h] [ebp-8h]
  int v3; // [esp+Ch] [ebp-4h]

  if ( g_pGUIEngine )
  {
    for ( i = 0; i < 12; ++i )
    {
      v3 = dword_3F1EFA0[4 * i];
      v2 = dword_3F1EF9C[4 * i];
      switch ( dword_3F1EF98[4 * i] )
      {
        case '@':
          SetEyecatcherProperties(v2, v3, 677, 686);
          break;
        case 'A':
          SetEyecatcherProperties(v2, v3, 675, 685);
          break;
        case 'B':
          SetEyecatcherProperties(v2, v3, 673, 684);
          break;
        case 'C':
          SetEyecatcherProperties(v2, v3, 693, 694);
          break;
        case 'D':
          SetEyecatcherProperties(v2, v3, 683, 689);
          break;
        case 'E':
          SetEyecatcherProperties(v2, v3, 681, 687);
          break;
        case 'F':
          SetEyecatcherProperties(v2, v3, 682, 688);
          break;
        case 'G':
          SetEyecatcherProperties(v2, v3, 691, 692);
          break;
        case 'H':
          SetEyecatcherProperties(v2, v3, 696, 697);
          break;
        case 'I':
          SetEyecatcherProperties(v2, v3, 708, 709);
          break;
        case 'J':
          SetEyecatcherProperties(v2, v3, 710, 711);
          break;
        case 'K':
          SetEyecatcherProperties(v2, v3, 712, 713);
          break;
        default:
          break;
      }
      result = i + 1;
    }
  }
  return result;
}


// address=[0x137f590]
// Decompiled from char __cdecl GuiDlgBuildEyecatcherProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBuildEyecatcherProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-5C0h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-5B8h]
  CEvn_Logic *v8; // [esp+14h] [ebp-5B0h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-5A8h]
  CEvn_Logic *v10; // [esp+24h] [ebp-5A0h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-598h]
  CEvn_Logic *v12; // [esp+34h] [ebp-590h]
  CEvn_Logic *v13; // [esp+40h] [ebp-584h]
  CEvn_Logic *v14; // [esp+48h] [ebp-57Ch]
  CEvn_Logic *v15; // [esp+50h] [ebp-574h]
  CEvn_Logic *v16; // [esp+58h] [ebp-56Ch]
  CEvn_Logic *v17; // [esp+60h] [ebp-564h]
  CEvn_Logic *v18; // [esp+68h] [ebp-55Ch]
  CEvn_Logic *v19; // [esp+6Ch] [ebp-558h]
  CEvn_Logic *v20; // [esp+74h] [ebp-550h]
  CEvn_Logic *v21; // [esp+7Ch] [ebp-548h]
  CEvn_Logic *v22; // [esp+84h] [ebp-540h]
  CEvn_Logic *v23; // [esp+8Ch] [ebp-538h]
  CEvn_Logic *v24; // [esp+94h] [ebp-530h]
  CEvn_Logic *v25; // [esp+9Ch] [ebp-528h]
  CEvn_Logic *v26; // [esp+A4h] [ebp-520h]
  CEvn_Logic *v27; // [esp+ACh] [ebp-518h]
  CEvn_Logic *v28; // [esp+B4h] [ebp-510h]
  CEvn_Logic *v29; // [esp+BCh] [ebp-508h]
  CEvn_Logic *v30; // [esp+C4h] [ebp-500h]
  CEvn_Logic *v31; // [esp+CCh] [ebp-4F8h]
  CEvn_Logic *v32; // [esp+D4h] [ebp-4F0h]
  CEvn_Logic *v33; // [esp+DCh] [ebp-4E8h]
  CEvn_Logic *v34; // [esp+E4h] [ebp-4E0h]
  CEvn_Logic *v35; // [esp+ECh] [ebp-4D8h]
  CEvn_Logic *v36; // [esp+F4h] [ebp-4D0h]
  CEvn_Logic *v37; // [esp+FCh] [ebp-4C8h]
  CEvn_Logic *v38; // [esp+104h] [ebp-4C0h]
  CEvn_Logic *v39; // [esp+10Ch] [ebp-4B8h]
  CEvn_Logic *v40; // [esp+114h] [ebp-4B0h]
  CEvn_Logic *v41; // [esp+11Ch] [ebp-4A8h]
  _BYTE v42[32]; // [esp+134h] [ebp-490h] BYREF
  _BYTE v43[32]; // [esp+154h] [ebp-470h] BYREF
  _BYTE v44[32]; // [esp+174h] [ebp-450h] BYREF
  _BYTE v45[32]; // [esp+194h] [ebp-430h] BYREF
  _BYTE v46[32]; // [esp+1B4h] [ebp-410h] BYREF
  _BYTE v47[32]; // [esp+1D4h] [ebp-3F0h] BYREF
  _BYTE v48[32]; // [esp+1F4h] [ebp-3D0h] BYREF
  _BYTE v49[32]; // [esp+214h] [ebp-3B0h] BYREF
  _BYTE v50[32]; // [esp+234h] [ebp-390h] BYREF
  _BYTE v51[32]; // [esp+254h] [ebp-370h] BYREF
  _BYTE v52[32]; // [esp+274h] [ebp-350h] BYREF
  _BYTE v53[32]; // [esp+294h] [ebp-330h] BYREF
  _BYTE v54[32]; // [esp+2B4h] [ebp-310h] BYREF
  _BYTE v55[32]; // [esp+2D4h] [ebp-2F0h] BYREF
  _BYTE v56[32]; // [esp+2F4h] [ebp-2D0h] BYREF
  _BYTE v57[32]; // [esp+314h] [ebp-2B0h] BYREF
  _BYTE v58[32]; // [esp+334h] [ebp-290h] BYREF
  _BYTE v59[32]; // [esp+354h] [ebp-270h] BYREF
  _BYTE v60[32]; // [esp+374h] [ebp-250h] BYREF
  _BYTE v61[32]; // [esp+394h] [ebp-230h] BYREF
  _BYTE v62[32]; // [esp+3B4h] [ebp-210h] BYREF
  _BYTE v63[32]; // [esp+3D4h] [ebp-1F0h] BYREF
  _BYTE v64[32]; // [esp+3F4h] [ebp-1D0h] BYREF
  _BYTE v65[32]; // [esp+414h] [ebp-1B0h] BYREF
  _BYTE v66[32]; // [esp+434h] [ebp-190h] BYREF
  _BYTE v67[32]; // [esp+454h] [ebp-170h] BYREF
  _BYTE v68[32]; // [esp+474h] [ebp-150h] BYREF
  _BYTE v69[32]; // [esp+494h] [ebp-130h] BYREF
  _BYTE v70[32]; // [esp+4B4h] [ebp-110h] BYREF
  _BYTE v71[32]; // [esp+4D4h] [ebp-F0h] BYREF
  _BYTE v72[32]; // [esp+4F4h] [ebp-D0h] BYREF
  _BYTE v73[32]; // [esp+514h] [ebp-B0h] BYREF
  _BYTE v74[32]; // [esp+534h] [ebp-90h] BYREF
  _BYTE v75[32]; // [esp+554h] [ebp-70h] BYREF
  _BYTE v76[32]; // [esp+574h] [ebp-50h] BYREF
  _BYTE v77[32]; // [esp+594h] [ebp-30h] BYREF
  int v78; // [esp+5C0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgBuildEyecatcher();
      SetEyecatcherBuildCosts(-1, 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 672:
          if ( (a2 & 0x10000) != 0 )
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v60, 0x1B5u, 0, 0x41u, 0, 0, 0);
            v78 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v60);
          }
          else
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v59, 0x191u, 0, 0, 0, 0, 0);
            v78 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v59);
          }
          break;
        case 674:
          if ( (a2 & 0x10000) != 0 )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v58, 0x1B5u, 0, 0x44u, 0, 0, 0);
            v78 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v58);
          }
          else
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v77, 0x191u, 0, 0, 0, 0, 0);
            v78 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v77);
          }
          break;
        case 676:
          if ( (a2 & 0x10000) != 0 )
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v56, 0x1B5u, 0, 0x40u, 0, 0, 0);
            v78 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v56);
          }
          else
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v55, 0x191u, 0, 0, 0, 0, 0);
            v78 = 17;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v55);
          }
          break;
        case 678:
          if ( (a2 & 0x10000) != 0 )
          {
            v41 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v54, 0x1B5u, 0, 0x42u, 0, 0, 0);
            v78 = 18;
            IEventEngine::SendAMessage(g_pEvnEngine, v41);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v54);
          }
          else
          {
            v40 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v53, 0x191u, 0, 0, 0, 0, 0);
            v78 = 19;
            IEventEngine::SendAMessage(g_pEvnEngine, v40);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v53);
          }
          break;
        case 679:
          if ( (a2 & 0x10000) != 0 )
          {
            v39 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v52, 0x1B5u, 0, 0x45u, 0, 0, 0);
            v78 = 20;
            IEventEngine::SendAMessage(g_pEvnEngine, v39);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v52);
          }
          else
          {
            v38 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v73, 0x191u, 0, 0, 0, 0, 0);
            v78 = 21;
            IEventEngine::SendAMessage(g_pEvnEngine, v38);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v73);
          }
          break;
        case 680:
          if ( (a2 & 0x10000) != 0 )
          {
            v37 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v51, 0x1B5u, 0, 0x46u, 0, 0, 0);
            v78 = 22;
            IEventEngine::SendAMessage(g_pEvnEngine, v37);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v51);
          }
          else
          {
            v36 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v50, 0x191u, 0, 0, 0, 0, 0);
            v78 = 23;
            IEventEngine::SendAMessage(g_pEvnEngine, v36);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v50);
          }
          break;
        case 690:
          if ( (a2 & 0x10000) != 0 )
          {
            v35 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v49, 0x1B5u, 0, 0x47u, 0, 0, 0);
            v78 = 24;
            IEventEngine::SendAMessage(g_pEvnEngine, v35);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v49);
          }
          else
          {
            v34 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v48, 0x191u, 0, 0, 0, 0, 0);
            v78 = 25;
            IEventEngine::SendAMessage(g_pEvnEngine, v34);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v48);
          }
          break;
        case 695:
          if ( (a2 & 0x10000) != 0 )
          {
            v33 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v47, 0x1B5u, 0, 0x43u, 0, 0, 0);
            v78 = 26;
            IEventEngine::SendAMessage(g_pEvnEngine, v33);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v47);
          }
          else
          {
            v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v46, 0x191u, 0, 0, 0, 0, 0);
            v78 = 27;
            IEventEngine::SendAMessage(g_pEvnEngine, v32);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v46);
          }
          break;
        case 698:
          if ( (a2 & 0x10000) != 0 )
          {
            v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v45, 0x1B5u, 0, 0x48u, 0, 0, 0);
            v78 = 28;
            IEventEngine::SendAMessage(g_pEvnEngine, v31);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v45);
          }
          else
          {
            v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v44, 0x191u, 0, 0, 0, 0, 0);
            v78 = 29;
            IEventEngine::SendAMessage(g_pEvnEngine, v30);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v44);
          }
          break;
        case 705:
          if ( (a2 & 0x10000) != 0 )
          {
            v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v43, 0x1B5u, 0, 0x49u, 0, 0, 0);
            v78 = 30;
            IEventEngine::SendAMessage(g_pEvnEngine, v29);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v43);
          }
          else
          {
            v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v42, 0x191u, 0, 0, 0, 0, 0);
            v78 = 31;
            IEventEngine::SendAMessage(g_pEvnEngine, v28);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v42);
          }
          break;
        case 706:
          if ( (a2 & 0x10000) != 0 )
          {
            v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v76, 0x1B5u, 0, 0x4Au, 0, 0, 0);
            v78 = 32;
            IEventEngine::SendAMessage(g_pEvnEngine, v27);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v76);
          }
          else
          {
            v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v75, 0x191u, 0, 0, 0, 0, 0);
            v78 = 33;
            IEventEngine::SendAMessage(g_pEvnEngine, v26);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v75);
          }
          break;
        case 707:
          if ( (a2 & 0x10000) != 0 )
          {
            v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v74, 0x1B5u, 0, 0x4Bu, 0, 0, 0);
            v78 = 34;
            IEventEngine::SendAMessage(g_pEvnEngine, v25);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v74);
          }
          else
          {
            v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v57, 0x191u, 0, 0, 0, 0, 0);
            v78 = 35;
            IEventEngine::SendAMessage(g_pEvnEngine, v24);
            v78 = -1;
            CEvn_Logic::~CEvn_Logic(v57);
          }
          break;
        default:
          return 1;
      }
      break;
    case 5:
      switch ( (__int16)a2 )
      {
        case 672:
          SetEyecatcherBuildCosts(1, 0);
          break;
        case 674:
          SetEyecatcherBuildCosts(4, 0);
          break;
        case 676:
          SetEyecatcherBuildCosts(0, 0);
          break;
        case 678:
          SetEyecatcherBuildCosts(2, 0);
          break;
        case 679:
          SetEyecatcherBuildCosts(5, 0);
          break;
        case 680:
          SetEyecatcherBuildCosts(6, 0);
          break;
        case 690:
          SetEyecatcherBuildCosts(7, 0);
          break;
        case 695:
          SetEyecatcherBuildCosts(3, 0);
          break;
        case 698:
          SetEyecatcherBuildCosts(8, 0);
          break;
        case 705:
          SetEyecatcherBuildCosts(9, 0);
          break;
        case 706:
          SetEyecatcherBuildCosts(10, 0);
          break;
        case 707:
          SetEyecatcherBuildCosts(11, 0);
          break;
        default:
          goto GuiDlgBuildEyecatcherProc___def_177F6EF;
      }
      break;
    case 6:
GuiDlgBuildEyecatcherProc___def_177F6EF:
      SetEyecatcherBuildCosts(-1, 1);
      break;
    case 7:
      switch ( (__int16)a2 )
      {
        case 672:
          v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v71, 0x1B6u, 0, 0x41u, 0, 0, 0);
          v78 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v22);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v71);
          break;
        case 674:
          v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v68, 0x1B6u, 0, 0x44u, 0, 0, 0);
          v78 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v19);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v68);
          break;
        case 676:
          v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v72, 0x1B6u, 0, 0x40u, 0, 0, 0);
          v78 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v23);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v72);
          break;
        case 678:
          v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v70, 0x1B6u, 0, 0x42u, 0, 0, 0);
          v78 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v21);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v70);
          break;
        case 679:
          v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v67, 0x1B6u, 0, 0x45u, 0, 0, 0);
          v78 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v67);
          break;
        case 680:
          v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v66, 0x1B6u, 0, 0x46u, 0, 0, 0);
          v78 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v66);
          break;
        case 690:
          v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v65, 0x1B6u, 0, 0x47u, 0, 0, 0);
          v78 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v65);
          break;
        case 695:
          v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v69, 0x1B6u, 0, 0x43u, 0, 0, 0);
          v78 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v20);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v69);
          break;
        case 698:
          v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v64, 0x1B6u, 0, 0x48u, 0, 0, 0);
          v78 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v64);
          break;
        case 705:
          v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v63, 0x1B6u, 0, 0x49u, 0, 0, 0);
          v78 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v63);
          break;
        case 706:
          v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v62, 0x1B6u, 0, 0x4Au, 0, 0, 0);
          v78 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v62);
          break;
        case 707:
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v61, 0x1B6u, 0, 0x4Bu, 0, 0, 0);
          v78 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v78 = -1;
          CEvn_Logic::~CEvn_Logic(v61);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AB0F);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AB17);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1380ca0]
// Decompiled from char __cdecl SetBuildFoodProperties(int a1, int a2, int a3, int a4)
void __cdecl SetBuildFoodProperties(int a1, int a2, int a3, int a4) {
  
  CHAR v5[52]; // [esp+4h] [ebp-6Ch] BYREF
  CHAR Str[52]; // [esp+38h] [ebp-38h] BYREF

  _wsprintfA(Str, "%u", a1);
  IGuiEngine::SetText((void *)g_pGUIEngine, 11, a3, Str);
  _wsprintfA(v5, "+%u", a2);
  IGuiEngine::SetText((void *)g_pGUIEngine, 11, a4, v5);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 11, a4, a2 > 0);
}


// address=[0x1380d40]
// Decompiled from char UpdateGuiDlgBuildFood()
void __cdecl UpdateGuiDlgBuildFood(void) {
  
  int v0; // eax
  int i; // [esp+4h] [ebp-10h]
  int v3; // [esp+8h] [ebp-Ch]
  int v4; // [esp+Ch] [ebp-8h]

  if ( !g_pGUIEngine )
    return v0;
  byte_3ECF2AB = 1;
  LOBYTE(v0) = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 11, 458, byte_3F1E909 == 0);
  for ( i = 0; i < 10; ++i )
  {
    v4 = dword_3F1E914[4 * i];
    v3 = dword_3F1E910[4 * i];
    v0 = dword_3F1E90C[4 * i] - 5;
    switch ( dword_3F1E90C[4 * i] )
    {
      case 5:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 447, 448);
        break;
      case 6:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 437, 443);
        break;
      case 7:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 438, 444);
        break;
      case 8:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 439, 445);
        break;
      case 9:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 429, 440);
        break;
      case 10:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 449, 450);
        break;
      case 11:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 433, 442);
        break;
      case 12:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 431, 441);
        break;
      case 35:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 2033, 2034);
        break;
      case 36:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 452, 453);
        break;
      case 37:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 454, 455);
        break;
      case 38:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 2896, 2897);
        break;
      case 39:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 2898, 2899);
        break;
      case 81:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 2878, 2879);
        break;
      case 82:
        LOBYTE(v0) = SetBuildFoodProperties(v3, v4, 2874, 2875);
        break;
      default:
        continue;
    }
  }
  byte_3ECF2AB = 0;
  return v0;
}


// address=[0x1381070]
// Decompiled from char __cdecl SetFoodBuildCosts(int a1, bool a2)
void __cdecl SetFoodBuildCosts(int a1, bool a2) {
  
  int v3; // [esp+0h] [ebp-44h]
  int v4; // [esp+4h] [ebp-40h]
  int v5; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  v5 = 0;
  v4 = 0;
  v3 = 0;
  if ( !a2 )
  {
    v5 = byte_3F1E918[16 * a1];
    v4 = byte_3F1E919[16 * a1];
    v3 = byte_3F1E91A[16 * a1];
  }
  _wsprintfA(Str, "%u", v5);
  IGuiEngine::SetText((void *)g_pGUIEngine, 11, 459, Str);
  _wsprintfA(Str, "%u", v4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 11, 460, Str);
  _wsprintfA(Str, "%u", v3);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 11, 461, Str);
}


// address=[0x1381160]
// Decompiled from char __cdecl GuiDlgBuildFoodProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBuildFoodProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-9D4h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-9CCh]
  CEvn_Logic *v8; // [esp+14h] [ebp-9C4h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-9BCh]
  CEvn_Logic *v10; // [esp+24h] [ebp-9B4h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-9ACh]
  CEvn_Logic *v12; // [esp+34h] [ebp-9A4h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-99Ch]
  CEvn_Logic *v14; // [esp+44h] [ebp-994h]
  CEvn_Logic *v15; // [esp+4Ch] [ebp-98Ch]
  CEvn_Logic *v16; // [esp+54h] [ebp-984h]
  CEvn_Logic *v17; // [esp+5Ch] [ebp-97Ch]
  CEvn_Logic *v18; // [esp+68h] [ebp-970h]
  CEvn_Logic *v19; // [esp+70h] [ebp-968h]
  CEvn_Logic *v20; // [esp+78h] [ebp-960h]
  CEvn_Logic *v21; // [esp+80h] [ebp-958h]
  CEvn_Logic *v22; // [esp+88h] [ebp-950h]
  CEvn_Logic *v23; // [esp+90h] [ebp-948h]
  CEvn_Logic *v24; // [esp+98h] [ebp-940h]
  CEvn_Logic *v25; // [esp+A0h] [ebp-938h]
  CEvn_Logic *v26; // [esp+A8h] [ebp-930h]
  CEvn_Logic *v27; // [esp+B0h] [ebp-928h]
  CEvn_Logic *v28; // [esp+B4h] [ebp-924h]
  CEvn_Logic *v29; // [esp+BCh] [ebp-91Ch]
  CEvn_Logic *v30; // [esp+C4h] [ebp-914h]
  CEvn_Logic *v31; // [esp+CCh] [ebp-90Ch]
  CEvn_Logic *v32; // [esp+D4h] [ebp-904h]
  CEvn_Logic *v33; // [esp+DCh] [ebp-8FCh]
  CEvn_Logic *v34; // [esp+E4h] [ebp-8F4h]
  CEvn_Logic *v35; // [esp+ECh] [ebp-8ECh]
  CEvn_Logic *v36; // [esp+F4h] [ebp-8E4h]
  CEvn_Logic *v37; // [esp+FCh] [ebp-8DCh]
  CEvn_Logic *v38; // [esp+104h] [ebp-8D4h]
  CEvn_Logic *v39; // [esp+10Ch] [ebp-8CCh]
  CEvn_Logic *v40; // [esp+114h] [ebp-8C4h]
  CEvn_Logic *v41; // [esp+11Ch] [ebp-8BCh]
  CEvn_Logic *v42; // [esp+124h] [ebp-8B4h]
  CEvn_Logic *v43; // [esp+12Ch] [ebp-8ACh]
  CEvn_Logic *v44; // [esp+134h] [ebp-8A4h]
  CEvn_Logic *v45; // [esp+13Ch] [ebp-89Ch]
  CEvn_Logic *v46; // [esp+144h] [ebp-894h]
  CEvn_Logic *v47; // [esp+14Ch] [ebp-88Ch]
  CEvn_Logic *v48; // [esp+154h] [ebp-884h]
  CEvn_Logic *v49; // [esp+15Ch] [ebp-87Ch]
  CEvn_Logic *v50; // [esp+164h] [ebp-874h]
  CEvn_Logic *v51; // [esp+16Ch] [ebp-86Ch]
  CEvn_Logic *v52; // [esp+174h] [ebp-864h]
  CEvn_Logic *v53; // [esp+17Ch] [ebp-85Ch]
  CEvn_Logic *v54; // [esp+184h] [ebp-854h]
  CEvn_Logic *v55; // [esp+18Ch] [ebp-84Ch]
  CEvn_Logic *v56; // [esp+194h] [ebp-844h]
  CEvn_Logic *v57; // [esp+19Ch] [ebp-83Ch]
  CEvn_Logic *v58; // [esp+1A4h] [ebp-834h]
  CEvn_Logic *v59; // [esp+1ACh] [ebp-82Ch]
  CEvn_Logic *v60; // [esp+1B4h] [ebp-824h]
  CEvn_Logic *v61; // [esp+1BCh] [ebp-81Ch]
  CEvn_Logic *v62; // [esp+1C4h] [ebp-814h]
  CEvn_Logic *v63; // [esp+1CCh] [ebp-80Ch]
  CEvn_Logic *v64; // [esp+1D4h] [ebp-804h]
  CEvn_Logic *v65; // [esp+1DCh] [ebp-7FCh]
  CEvn_Logic *v66; // [esp+1E4h] [ebp-7F4h]
  CEvn_Logic *v67; // [esp+1ECh] [ebp-7ECh]
  _BYTE v68[32]; // [esp+208h] [ebp-7D0h] BYREF
  _BYTE v69[32]; // [esp+228h] [ebp-7B0h] BYREF
  _BYTE v70[32]; // [esp+248h] [ebp-790h] BYREF
  _BYTE v71[32]; // [esp+268h] [ebp-770h] BYREF
  _BYTE v72[32]; // [esp+288h] [ebp-750h] BYREF
  _BYTE v73[32]; // [esp+2A8h] [ebp-730h] BYREF
  _BYTE v74[32]; // [esp+2C8h] [ebp-710h] BYREF
  _BYTE v75[32]; // [esp+2E8h] [ebp-6F0h] BYREF
  _BYTE v76[32]; // [esp+308h] [ebp-6D0h] BYREF
  _BYTE v77[32]; // [esp+328h] [ebp-6B0h] BYREF
  _BYTE v78[32]; // [esp+348h] [ebp-690h] BYREF
  _BYTE v79[32]; // [esp+368h] [ebp-670h] BYREF
  _BYTE v80[32]; // [esp+388h] [ebp-650h] BYREF
  _BYTE v81[32]; // [esp+3A8h] [ebp-630h] BYREF
  _BYTE v82[32]; // [esp+3C8h] [ebp-610h] BYREF
  _BYTE v83[32]; // [esp+3E8h] [ebp-5F0h] BYREF
  _BYTE v84[32]; // [esp+408h] [ebp-5D0h] BYREF
  _BYTE v85[32]; // [esp+428h] [ebp-5B0h] BYREF
  _BYTE v86[32]; // [esp+448h] [ebp-590h] BYREF
  _BYTE v87[32]; // [esp+468h] [ebp-570h] BYREF
  _BYTE v88[32]; // [esp+488h] [ebp-550h] BYREF
  _BYTE v89[32]; // [esp+4A8h] [ebp-530h] BYREF
  _BYTE v90[32]; // [esp+4C8h] [ebp-510h] BYREF
  _BYTE v91[32]; // [esp+4E8h] [ebp-4F0h] BYREF
  _BYTE v92[32]; // [esp+508h] [ebp-4D0h] BYREF
  _BYTE v93[32]; // [esp+528h] [ebp-4B0h] BYREF
  _BYTE v94[32]; // [esp+548h] [ebp-490h] BYREF
  _BYTE v95[32]; // [esp+568h] [ebp-470h] BYREF
  _BYTE v96[32]; // [esp+588h] [ebp-450h] BYREF
  _BYTE v97[32]; // [esp+5A8h] [ebp-430h] BYREF
  _BYTE v98[32]; // [esp+5C8h] [ebp-410h] BYREF
  _BYTE v99[32]; // [esp+5E8h] [ebp-3F0h] BYREF
  _BYTE v100[32]; // [esp+608h] [ebp-3D0h] BYREF
  _BYTE v101[32]; // [esp+628h] [ebp-3B0h] BYREF
  _BYTE v102[32]; // [esp+648h] [ebp-390h] BYREF
  _BYTE v103[32]; // [esp+668h] [ebp-370h] BYREF
  _BYTE v104[32]; // [esp+688h] [ebp-350h] BYREF
  _BYTE v105[32]; // [esp+6A8h] [ebp-330h] BYREF
  _BYTE v106[32]; // [esp+6C8h] [ebp-310h] BYREF
  _BYTE v107[32]; // [esp+6E8h] [ebp-2F0h] BYREF
  _BYTE v108[32]; // [esp+708h] [ebp-2D0h] BYREF
  _BYTE v109[32]; // [esp+728h] [ebp-2B0h] BYREF
  _BYTE v110[32]; // [esp+748h] [ebp-290h] BYREF
  _BYTE v111[32]; // [esp+768h] [ebp-270h] BYREF
  _BYTE v112[32]; // [esp+788h] [ebp-250h] BYREF
  _BYTE v113[32]; // [esp+7A8h] [ebp-230h] BYREF
  _BYTE v114[32]; // [esp+7C8h] [ebp-210h] BYREF
  _BYTE v115[32]; // [esp+7E8h] [ebp-1F0h] BYREF
  _BYTE v116[32]; // [esp+808h] [ebp-1D0h] BYREF
  _BYTE v117[32]; // [esp+828h] [ebp-1B0h] BYREF
  _BYTE v118[32]; // [esp+848h] [ebp-190h] BYREF
  _BYTE v119[32]; // [esp+868h] [ebp-170h] BYREF
  _BYTE v120[32]; // [esp+888h] [ebp-150h] BYREF
  _BYTE v121[32]; // [esp+8A8h] [ebp-130h] BYREF
  _BYTE v122[32]; // [esp+8C8h] [ebp-110h] BYREF
  _BYTE v123[32]; // [esp+8E8h] [ebp-F0h] BYREF
  _BYTE v124[32]; // [esp+908h] [ebp-D0h] BYREF
  _BYTE v125[32]; // [esp+928h] [ebp-B0h] BYREF
  _BYTE v126[32]; // [esp+948h] [ebp-90h] BYREF
  _BYTE v127[32]; // [esp+968h] [ebp-70h] BYREF
  _BYTE v128[32]; // [esp+988h] [ebp-50h] BYREF
  _BYTE v129[32]; // [esp+9A8h] [ebp-30h] BYREF
  int v130; // [esp+9D4h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgBuildFood();
      SetFoodBuildCosts(-1, 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( (unsigned __int16)a2 > 0x7F3u )
      {
        switch ( (__int16)a2 )
        {
          case 2876:
            if ( (a2 & 0x10000) != 0 )
            {
              v40 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v127, 0x1B5u, 0, 0x52u, 0, 0, 0);
              v130 = 58;
              IEventEngine::SendAMessage(g_pEvnEngine, v40);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v127);
            }
            else
            {
              v39 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v126, 0x191u, 0, 0, 0, 0, 0);
              v130 = 59;
              IEventEngine::SendAMessage(g_pEvnEngine, v39);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v126);
            }
            break;
          case 2877:
            if ( (a2 & 0x10000) != 0 )
            {
              v42 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v68, 0x1B5u, 0, 0x51u, 0, 0, 0);
              v130 = 56;
              IEventEngine::SendAMessage(g_pEvnEngine, v42);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v68);
            }
            else
            {
              v41 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v128, 0x191u, 0, 0, 0, 0, 0);
              v130 = 57;
              IEventEngine::SendAMessage(g_pEvnEngine, v41);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v128);
            }
            break;
          case 2900:
            if ( (a2 & 0x10000) != 0 )
            {
              v46 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v72, 0x1B5u, 0, 0x26u, 0, 0, 0);
              v130 = 52;
              IEventEngine::SendAMessage(g_pEvnEngine, v46);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v72);
            }
            else
            {
              v45 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v71, 0x191u, 0, 0, 0, 0, 0);
              v130 = 53;
              IEventEngine::SendAMessage(g_pEvnEngine, v45);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v71);
            }
            break;
          case 2901:
            if ( (a2 & 0x10000) != 0 )
            {
              v44 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v70, 0x1B5u, 0, 0x27u, 0, 0, 0);
              v130 = 54;
              IEventEngine::SendAMessage(g_pEvnEngine, v44);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v70);
            }
            else
            {
              v43 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v69, 0x191u, 0, 0, 0, 0, 0);
              v130 = 55;
              IEventEngine::SendAMessage(g_pEvnEngine, v43);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v69);
            }
            break;
          default:
            return 1;
        }
      }
      else if ( (unsigned __int16)a2 == 2035 )
      {
        if ( (a2 & 0x10000) != 0 )
        {
          v52 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v78, 0x1B5u, 0, 0x23u, 0, 0, 0);
          v130 = 46;
          IEventEngine::SendAMessage(g_pEvnEngine, v52);
          v130 = -1;
          CEvn_Logic::~CEvn_Logic(v78);
        }
        else
        {
          v51 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v77, 0x191u, 0, 0, 0, 0, 0);
          v130 = 47;
          IEventEngine::SendAMessage(g_pEvnEngine, v51);
          v130 = -1;
          CEvn_Logic::~CEvn_Logic(v77);
        }
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 428:
            if ( (a2 & 0x10000) != 0 )
            {
              v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v93, 0x1B5u, 0, 0xCu, 0, 0, 0);
              v130 = 30;
              IEventEngine::SendAMessage(g_pEvnEngine, v6);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v93);
            }
            else
            {
              v67 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v92, 0x191u, 0, 0, 0, 0, 0);
              v130 = 31;
              IEventEngine::SendAMessage(g_pEvnEngine, v67);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v92);
            }
            return 1;
          case 430:
            if ( (a2 & 0x10000) != 0 )
            {
              v66 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v91, 0x1B5u, 0, 8u, 0, 0, 0);
              v130 = 32;
              IEventEngine::SendAMessage(g_pEvnEngine, v66);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v91);
            }
            else
            {
              v65 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v90, 0x191u, 0, 0, 0, 0, 0);
              v130 = 33;
              IEventEngine::SendAMessage(g_pEvnEngine, v65);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v90);
            }
            return 1;
          case 432:
            if ( (a2 & 0x10000) != 0 )
            {
              v64 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v89, 0x1B5u, 0, 0xBu, 0, 0, 0);
              v130 = 34;
              IEventEngine::SendAMessage(g_pEvnEngine, v64);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v89);
            }
            else
            {
              v63 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v88, 0x191u, 0, 0, 0, 0, 0);
              v130 = 35;
              IEventEngine::SendAMessage(g_pEvnEngine, v63);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v88);
            }
            return 1;
          case 434:
            if ( (a2 & 0x10000) != 0 )
            {
              v62 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v87, 0x1B5u, 0, 9u, 0, 0, 0);
              v130 = 36;
              IEventEngine::SendAMessage(g_pEvnEngine, v62);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v87);
            }
            else
            {
              v61 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v86, 0x191u, 0, 0, 0, 0, 0);
              v130 = 37;
              IEventEngine::SendAMessage(g_pEvnEngine, v61);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v86);
            }
            return 1;
          case 435:
            if ( (a2 & 0x10000) != 0 )
            {
              v60 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v124, 0x1B5u, 0, 6u, 0, 0, 0);
              v130 = 38;
              IEventEngine::SendAMessage(g_pEvnEngine, v60);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v124);
            }
            else
            {
              v59 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v85, 0x191u, 0, 0, 0, 0, 0);
              v130 = 39;
              IEventEngine::SendAMessage(g_pEvnEngine, v59);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v85);
            }
            return 1;
          case 436:
            if ( (a2 & 0x10000) != 0 )
            {
              v58 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v84, 0x1B5u, 0, 7u, 0, 0, 0);
              v130 = 40;
              IEventEngine::SendAMessage(g_pEvnEngine, v58);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v84);
            }
            else
            {
              v57 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v83, 0x191u, 0, 0, 0, 0, 0);
              v130 = 41;
              IEventEngine::SendAMessage(g_pEvnEngine, v57);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v83);
            }
            return 1;
          case 446:
            if ( (a2 & 0x10000) != 0 )
            {
              v56 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v82, 0x1B5u, 0, 5u, 0, 0, 0);
              v130 = 42;
              IEventEngine::SendAMessage(g_pEvnEngine, v56);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v82);
            }
            else
            {
              v55 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v81, 0x191u, 0, 0, 0, 0, 0);
              v130 = 43;
              IEventEngine::SendAMessage(g_pEvnEngine, v55);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v81);
            }
            return 1;
          case 451:
            if ( (a2 & 0x10000) != 0 )
            {
              v54 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v80, 0x1B5u, 0, 0xAu, 0, 0, 0);
              v130 = 44;
              IEventEngine::SendAMessage(g_pEvnEngine, v54);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v80);
            }
            else
            {
              v53 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v79, 0x191u, 0, 0, 0, 0, 0);
              v130 = 45;
              IEventEngine::SendAMessage(g_pEvnEngine, v53);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v79);
            }
            return 1;
          case 456:
            if ( (a2 & 0x10000) != 0 )
            {
              v50 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v76, 0x1B5u, 0, 0x24u, 0, 0, 0);
              v130 = 48;
              IEventEngine::SendAMessage(g_pEvnEngine, v50);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v76);
            }
            else
            {
              v49 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v75, 0x191u, 0, 0, 0, 0, 0);
              v130 = 49;
              IEventEngine::SendAMessage(g_pEvnEngine, v49);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v75);
            }
            return 1;
          case 457:
            if ( (a2 & 0x10000) != 0 )
            {
              v48 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v74, 0x1B5u, 0, 0x25u, 0, 0, 0);
              v130 = 50;
              IEventEngine::SendAMessage(g_pEvnEngine, v48);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v74);
            }
            else
            {
              v47 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v73, 0x191u, 0, 0, 0, 0, 0);
              v130 = 51;
              IEventEngine::SendAMessage(g_pEvnEngine, v47);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v73);
            }
            return 1;
          case 458:
            if ( byte_3ECF2AB )
              return 1;
            if ( (a2 & 0x10000) != 0 )
            {
              v38 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v125, 0x1B8u, 0, 1u, 0, 0, 0);
              v130 = 60;
              IEventEngine::SendAMessage(g_pEvnEngine, v38);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v125);
            }
            else
            {
              v37 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v113, 0x1B8u, 0, 0, 0, 0, 0);
              v130 = 61;
              IEventEngine::SendAMessage(g_pEvnEngine, v37);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v113);
            }
            break;
          default:
            return 1;
        }
      }
      break;
    case 5:
      if ( (unsigned __int16)a2 > 0x7F3u )
      {
        switch ( (__int16)a2 )
        {
          case 2876:
          case 2901:
LABEL_27:
            SetFoodBuildCosts(9, 0);
            break;
          case 2877:
          case 2900:
            goto LABEL_26;
          default:
            goto LABEL_28;
        }
      }
      else if ( (unsigned __int16)a2 == 2035 )
      {
LABEL_26:
        SetFoodBuildCosts(8, 0);
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 428:
            SetFoodBuildCosts(1, 0);
            break;
          case 430:
            SetFoodBuildCosts(4, 0);
            break;
          case 432:
            SetFoodBuildCosts(0, 0);
            break;
          case 434:
            SetFoodBuildCosts(2, 0);
            break;
          case 435:
            SetFoodBuildCosts(5, 0);
            break;
          case 436:
            SetFoodBuildCosts(6, 0);
            break;
          case 446:
            SetFoodBuildCosts(7, 0);
            break;
          case 451:
            SetFoodBuildCosts(3, 0);
            break;
          case 456:
            goto LABEL_26;
          case 457:
            goto LABEL_27;
          default:
            goto LABEL_28;
        }
      }
      break;
    case 6:
LABEL_28:
      SetFoodBuildCosts(-1, 1);
      break;
    case 7:
      if ( a3 == 65537 )
      {
        if ( (unsigned __int16)a2 > 0x7F3u )
        {
          switch ( (__int16)a2 )
          {
            case 2876:
              v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v109, 0x1E6u, 0, 0x52u, 0, 0, 0);
              v130 = 14;
              IEventEngine::SendAMessage(g_pEvnEngine, v22);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v109);
              break;
            case 2877:
              v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v110, 0x1E6u, 0, 0x51u, 0, 0, 0);
              v130 = 13;
              IEventEngine::SendAMessage(g_pEvnEngine, v23);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v110);
              break;
            case 2900:
              v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v112, 0x1E6u, 0, 0x26u, 0, 0, 0);
              v130 = 11;
              IEventEngine::SendAMessage(g_pEvnEngine, v25);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v112);
              break;
            case 2901:
              v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v111, 0x1E6u, 0, 0x27u, 0, 0, 0);
              v130 = 12;
              IEventEngine::SendAMessage(g_pEvnEngine, v24);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v111);
              break;
            default:
              return 1;
          }
        }
        else if ( (unsigned __int16)a2 == 2035 )
        {
          v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v115, 0x1E6u, 0, 0x23u, 0, 0, 0);
          v130 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v28);
          v130 = -1;
          CEvn_Logic::~CEvn_Logic(v115);
        }
        else
        {
          switch ( (__int16)a2 )
          {
            case 428:
              v36 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v123, 0x1E6u, 0, 0xCu, 0, 0, 0);
              v130 = 0;
              IEventEngine::SendAMessage(g_pEvnEngine, v36);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v123);
              break;
            case 430:
              v35 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v122, 0x1E6u, 0, 8u, 0, 0, 0);
              v130 = 1;
              IEventEngine::SendAMessage(g_pEvnEngine, v35);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v122);
              break;
            case 432:
              v34 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v129, 0x1E6u, 0, 0xBu, 0, 0, 0);
              v130 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v34);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v129);
              break;
            case 434:
              v33 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v120, 0x1E6u, 0, 9u, 0, 0, 0);
              v130 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v33);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v120);
              break;
            case 435:
              v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v119, 0x1E6u, 0, 6u, 0, 0, 0);
              v130 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v32);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v119);
              break;
            case 436:
              v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v118, 0x1E6u, 0, 7u, 0, 0, 0);
              v130 = 5;
              IEventEngine::SendAMessage(g_pEvnEngine, v31);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v118);
              break;
            case 446:
              v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v117, 0x1E6u, 0, 5u, 0, 0, 0);
              v130 = 6;
              IEventEngine::SendAMessage(g_pEvnEngine, v30);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v117);
              break;
            case 451:
              v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v116, 0x1E6u, 0, 0xAu, 0, 0, 0);
              v130 = 7;
              IEventEngine::SendAMessage(g_pEvnEngine, v29);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v116);
              break;
            case 456:
              v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v114, 0x1E6u, 0, 0x24u, 0, 0, 0);
              v130 = 9;
              IEventEngine::SendAMessage(g_pEvnEngine, v27);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v114);
              break;
            case 457:
              v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v121, 0x1E6u, 0, 0x25u, 0, 0, 0);
              v130 = 10;
              IEventEngine::SendAMessage(g_pEvnEngine, v26);
              v130 = -1;
              CEvn_Logic::~CEvn_Logic(v121);
              break;
            default:
              return 1;
          }
        }
      }
      else if ( (unsigned __int16)a2 > 0x7F3u )
      {
        switch ( (__int16)a2 )
        {
          case 2876:
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v94, 0x1B6u, 0, 0x52u, 0, 0, 0);
            v130 = 29;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v94);
            break;
          case 2877:
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v95, 0x1B6u, 0, 0x51u, 0, 0, 0);
            v130 = 28;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v95);
            break;
          case 2900:
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v97, 0x1B6u, 0, 0x26u, 0, 0, 0);
            v130 = 26;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v97);
            break;
          case 2901:
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v96, 0x1B6u, 0, 0x27u, 0, 0, 0);
            v130 = 27;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v96);
            break;
          default:
            return 1;
        }
      }
      else if ( (unsigned __int16)a2 == 2035 )
      {
        v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v100, 0x1B6u, 0, 0x23u, 0, 0, 0);
        v130 = 23;
        IEventEngine::SendAMessage(g_pEvnEngine, v13);
        v130 = -1;
        CEvn_Logic::~CEvn_Logic(v100);
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 428:
            v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v108, 0x1B6u, 0, 0xCu, 0, 0, 0);
            v130 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v108);
            break;
          case 430:
            v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v107, 0x1B6u, 0, 8u, 0, 0, 0);
            v130 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v20);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v107);
            break;
          case 432:
            v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v106, 0x1B6u, 0, 0xBu, 0, 0, 0);
            v130 = 17;
            IEventEngine::SendAMessage(g_pEvnEngine, v19);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v106);
            break;
          case 434:
            v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v105, 0x1B6u, 0, 9u, 0, 0, 0);
            v130 = 18;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v105);
            break;
          case 435:
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v104, 0x1B6u, 0, 6u, 0, 0, 0);
            v130 = 19;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v104);
            break;
          case 436:
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v103, 0x1B6u, 0, 7u, 0, 0, 0);
            v130 = 20;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v103);
            break;
          case 446:
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v102, 0x1B6u, 0, 5u, 0, 0, 0);
            v130 = 21;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v102);
            break;
          case 451:
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v101, 0x1B6u, 0, 0xAu, 0, 0, 0);
            v130 = 22;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v101);
            break;
          case 456:
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v99, 0x1B6u, 0, 0x24u, 0, 0, 0);
            v130 = 24;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v99);
            break;
          case 457:
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v98, 0x1B6u, 0, 0x25u, 0, 0, 0);
            v130 = 25;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v130 = -1;
            CEvn_Logic::~CEvn_Logic(v98);
            break;
          default:
            return 1;
        }
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AB27);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AB2F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1383820]
// Decompiled from void UpdateGuiDlgBuildingContext()
void __cdecl UpdateGuiDlgBuildingContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  CHAR Str[52]; // [esp+0h] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E4B5, byte_3F1E4B4, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 15, 470, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E4B5, byte_3F1E4B4);
    IGuiEngine::SetText((void *)g_pGUIEngine, 15, 467, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E4BC);
    IGuiEngine::SetText((void *)g_pGUIEngine, 15, 468, Str);
    if ( byte_3F1E4BB <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 15, 469, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E4BB);
      IGuiEngine::SetText((void *)g_pGUIEngine, 15, 469, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 15, 469, 1);
    }
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 15, 471, byte_3F1E4B6);
    if ( byte_3F1E4B4 == 40 || byte_3F1E4B4 == 41 || byte_3F1E4B4 == 42 )
    {
      _wsprintfA(Str, "%u", (unsigned __int8)byte_3F1E4BF);
      IGuiEngine::SetText((void *)g_pGUIEngine, 15, 472, Str);
    }
  }
}


// address=[0x13839b0]
// Decompiled from char __cdecl GuiDlgBuildingContextProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgBuildingContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-68h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-60h]
  _BYTE v8[32]; // [esp+1Ch] [ebp-50h] BYREF
  _BYTE v9[32]; // [esp+3Ch] [ebp-30h] BYREF
  int v10; // [esp+68h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      if ( byte_3F1E4B4 == 40 || byte_3F1E4B4 == 41 || byte_3F1E4B4 == 42 )
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 15, 473, 1);
      else
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 15, 473, 0);
      UpdateGuiDlgBuildingContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( a2 == 465 )
      {
        v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v9, 0x198u, 0, 0, 0, 0, 0);
        v10 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v7);
        v10 = -1;
        CEvn_Logic::~CEvn_Logic(v9);
        PlayGuiSound(2);
      }
      else if ( a2 == 466 )
      {
        v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v8, 0x194u, 0, 0, 0, 0, 0);
        v10 = 1;
        IEventEngine::SendAMessage(g_pEvnEngine, v6);
        v10 = -1;
        CEvn_Logic::~CEvn_Logic(v8);
        PlayGuiSound(2);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AB3F);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368AB47);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1383d10]
// Decompiled from char __cdecl SetBuildMetalProperties(int a1, int a2, int a3, int a4)
void __cdecl SetBuildMetalProperties(int a1, int a2, int a3, int a4) {
  
  CHAR v5[52]; // [esp+4h] [ebp-6Ch] BYREF
  CHAR Str[52]; // [esp+38h] [ebp-38h] BYREF

  _wsprintfA(Str, "%u", a1);
  IGuiEngine::SetText((void *)g_pGUIEngine, 10, a3, Str);
  _wsprintfA(v5, "+%u", a2);
  IGuiEngine::SetText((void *)g_pGUIEngine, 10, a4, v5);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 10, a4, a2 > 0);
}


// address=[0x1383db0]
// Decompiled from char UpdateGuiDlgBuildMetal()
void __cdecl UpdateGuiDlgBuildMetal(void) {
  
  int v0; // eax
  int i; // [esp+4h] [ebp-10h]
  int v3; // [esp+8h] [ebp-Ch]
  int v4; // [esp+Ch] [ebp-8h]

  if ( !g_pGUIEngine )
    return v0;
  byte_3ECF2AC = 1;
  LOBYTE(v0) = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 10, 495, byte_3F1E909 == 0);
  for ( i = 0; i < 10; ++i )
  {
    v4 = dword_3F1E914[4 * i];
    v3 = dword_3F1E910[4 * i];
    v0 = dword_3F1E90C[4 * i] - 15;
    switch ( dword_3F1E90C[4 * i] )
    {
      case 15:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 477, 487);
        break;
      case 16:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 475, 486);
        break;
      case 17:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 479, 488);
        break;
      case 18:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 496, 497);
        break;
      case 19:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 483, 489);
        break;
      case 20:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 485, 491);
        break;
      case 21:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 484, 490);
        break;
      case 22:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 493, 494);
        break;
      case 25:
        LOBYTE(v0) = SetBuildMetalProperties(v3, v4, 2902, 2903);
        break;
      default:
        continue;
    }
  }
  byte_3ECF2AC = 0;
  return v0;
}


// address=[0x1383fb0]
// Decompiled from char __cdecl SetMetalBuildCosts(int a1, bool a2)
void __cdecl SetMetalBuildCosts(int a1, bool a2) {
  
  int v3; // [esp+0h] [ebp-44h]
  int v4; // [esp+4h] [ebp-40h]
  int v5; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  v5 = 0;
  v4 = 0;
  v3 = 0;
  if ( !a2 )
  {
    v5 = byte_3F1E918[16 * a1];
    v4 = byte_3F1E919[16 * a1];
    v3 = byte_3F1E91A[16 * a1];
  }
  _wsprintfA(Str, "%u", v5);
  IGuiEngine::SetText((void *)g_pGUIEngine, 10, 502, Str);
  _wsprintfA(Str, "%u", v4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 10, 503, Str);
  _wsprintfA(Str, "%u", v3);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 10, 504, Str);
}


// address=[0x13840a0]
// Decompiled from char __cdecl GuiDlgBuildMetalProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBuildMetalProc(int a1, int a2, int a3) {
  
  char result; // al
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-614h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-60Ch]
  CEvn_Logic *v8; // [esp+14h] [ebp-604h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-5FCh]
  CEvn_Logic *v10; // [esp+24h] [ebp-5F4h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-5ECh]
  CEvn_Logic *v12; // [esp+34h] [ebp-5E4h]
  CEvn_Logic *v13; // [esp+40h] [ebp-5D8h]
  CEvn_Logic *v14; // [esp+48h] [ebp-5D0h]
  CEvn_Logic *v15; // [esp+50h] [ebp-5C8h]
  CEvn_Logic *v16; // [esp+58h] [ebp-5C0h]
  CEvn_Logic *v17; // [esp+60h] [ebp-5B8h]
  CEvn_Logic *v18; // [esp+68h] [ebp-5B0h]
  CEvn_Logic *v19; // [esp+70h] [ebp-5A8h]
  CEvn_Logic *v20; // [esp+7Ch] [ebp-59Ch]
  CEvn_Logic *v21; // [esp+84h] [ebp-594h]
  CEvn_Logic *v22; // [esp+8Ch] [ebp-58Ch]
  CEvn_Logic *v23; // [esp+94h] [ebp-584h]
  CEvn_Logic *v24; // [esp+9Ch] [ebp-57Ch]
  CEvn_Logic *v25; // [esp+A4h] [ebp-574h]
  CEvn_Logic *v26; // [esp+ACh] [ebp-56Ch]
  CEvn_Logic *v27; // [esp+B4h] [ebp-564h]
  CEvn_Logic *v28; // [esp+BCh] [ebp-55Ch]
  CEvn_Logic *v29; // [esp+C4h] [ebp-554h]
  CEvn_Logic *v30; // [esp+CCh] [ebp-54Ch]
  CEvn_Logic *v31; // [esp+D4h] [ebp-544h]
  CEvn_Logic *v32; // [esp+DCh] [ebp-53Ch]
  CEvn_Logic *v33; // [esp+E4h] [ebp-534h]
  CEvn_Logic *v34; // [esp+ECh] [ebp-52Ch]
  CEvn_Logic *v35; // [esp+F0h] [ebp-528h]
  CEvn_Logic *v36; // [esp+F4h] [ebp-524h]
  CEvn_Logic *v37; // [esp+FCh] [ebp-51Ch]
  CEvn_Logic *v38; // [esp+104h] [ebp-514h]
  CEvn_Logic *v39; // [esp+10Ch] [ebp-50Ch]
  CEvn_Logic *v40; // [esp+114h] [ebp-504h]
  CEvn_Logic *v41; // [esp+11Ch] [ebp-4FCh]
  CEvn_Logic *v42; // [esp+124h] [ebp-4F4h]
  CEvn_Logic *v43; // [esp+12Ch] [ebp-4ECh]
  _BYTE v44[32]; // [esp+148h] [ebp-4D0h] BYREF
  _BYTE v45[32]; // [esp+168h] [ebp-4B0h] BYREF
  _BYTE v46[32]; // [esp+188h] [ebp-490h] BYREF
  _BYTE v47[32]; // [esp+1A8h] [ebp-470h] BYREF
  _BYTE v48[32]; // [esp+1C8h] [ebp-450h] BYREF
  _BYTE v49[32]; // [esp+1E8h] [ebp-430h] BYREF
  _BYTE v50[32]; // [esp+208h] [ebp-410h] BYREF
  _BYTE v51[32]; // [esp+228h] [ebp-3F0h] BYREF
  _BYTE v52[32]; // [esp+248h] [ebp-3D0h] BYREF
  _BYTE v53[32]; // [esp+268h] [ebp-3B0h] BYREF
  _BYTE v54[32]; // [esp+288h] [ebp-390h] BYREF
  _BYTE v55[32]; // [esp+2A8h] [ebp-370h] BYREF
  _BYTE v56[32]; // [esp+2C8h] [ebp-350h] BYREF
  _BYTE v57[32]; // [esp+2E8h] [ebp-330h] BYREF
  _BYTE v58[32]; // [esp+308h] [ebp-310h] BYREF
  _BYTE v59[32]; // [esp+328h] [ebp-2F0h] BYREF
  _BYTE v60[32]; // [esp+348h] [ebp-2D0h] BYREF
  _BYTE v61[32]; // [esp+368h] [ebp-2B0h] BYREF
  _BYTE v62[32]; // [esp+388h] [ebp-290h] BYREF
  _BYTE v63[32]; // [esp+3A8h] [ebp-270h] BYREF
  _BYTE v64[32]; // [esp+3C8h] [ebp-250h] BYREF
  _BYTE v65[32]; // [esp+3E8h] [ebp-230h] BYREF
  _BYTE v66[32]; // [esp+408h] [ebp-210h] BYREF
  _BYTE v67[32]; // [esp+428h] [ebp-1F0h] BYREF
  _BYTE v68[32]; // [esp+448h] [ebp-1D0h] BYREF
  _BYTE v69[32]; // [esp+468h] [ebp-1B0h] BYREF
  _BYTE v70[32]; // [esp+488h] [ebp-190h] BYREF
  _BYTE v71[32]; // [esp+4A8h] [ebp-170h] BYREF
  _BYTE v72[32]; // [esp+4C8h] [ebp-150h] BYREF
  _BYTE v73[32]; // [esp+4E8h] [ebp-130h] BYREF
  _BYTE v74[32]; // [esp+508h] [ebp-110h] BYREF
  _BYTE v75[32]; // [esp+528h] [ebp-F0h] BYREF
  _BYTE v76[32]; // [esp+548h] [ebp-D0h] BYREF
  _BYTE v77[32]; // [esp+568h] [ebp-B0h] BYREF
  _BYTE v78[32]; // [esp+588h] [ebp-90h] BYREF
  _BYTE v79[32]; // [esp+5A8h] [ebp-70h] BYREF
  _BYTE v80[32]; // [esp+5C8h] [ebp-50h] BYREF
  _BYTE v81[32]; // [esp+5E8h] [ebp-30h] BYREF
  int v82; // [esp+614h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgBuildMetal();
      SetMetalBuildCosts(-1, 1);
      goto GuiDlgBuildMetalProc___def_17840F7;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      goto GuiDlgBuildMetalProc___def_17840F7;
    case 3:
      if ( (unsigned __int16)a2 > 0x1ECu )
      {
        switch ( (unsigned __int16)a2 )
        {
          case 0x1EFu:
            if ( byte_3ECF2AC )
              return 1;
            if ( (a2 & 0x10000) != 0 )
            {
              v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v77, 0x1B8u, 0, 1u, 0, 0, 0);
              v82 = 36;
              IEventEngine::SendAMessage(g_pEvnEngine, v25);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v77);
            }
            else
            {
              v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v71, 0x1B8u, 0, 0, 0, 0, 0);
              v82 = 37;
              IEventEngine::SendAMessage(g_pEvnEngine, v24);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v71);
            }
            break;
          case 0x1F2u:
            if ( (a2 & 0x10000) != 0 )
            {
              v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v44, 0x1B5u, 0, 0x12u, 0, 0, 0);
              v82 = 32;
              IEventEngine::SendAMessage(g_pEvnEngine, v29);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v44);
            }
            else
            {
              v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v80, 0x191u, 0, 0, 0, 0, 0);
              v82 = 33;
              IEventEngine::SendAMessage(g_pEvnEngine, v28);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v80);
            }
            break;
          case 0xB58u:
            if ( (a2 & 0x10000) != 0 )
            {
              v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v79, 0x1B5u, 0, 0x19u, 0, 0, 0);
              v82 = 34;
              IEventEngine::SendAMessage(g_pEvnEngine, v27);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v79);
            }
            else
            {
              v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v78, 0x191u, 0, 0, 0, 0, 0);
              v82 = 35;
              IEventEngine::SendAMessage(g_pEvnEngine, v26);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v78);
            }
            break;
        }
      }
      else if ( (unsigned __int16)a2 == 492 )
      {
        if ( (a2 & 0x10000) != 0 )
        {
          v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v46, 0x1B5u, 0, 0x16u, 0, 0, 0);
          v82 = 30;
          IEventEngine::SendAMessage(g_pEvnEngine, v31);
          v82 = -1;
          CEvn_Logic::~CEvn_Logic(v46);
        }
        else
        {
          v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v45, 0x191u, 0, 0, 0, 0, 0);
          v82 = 31;
          IEventEngine::SendAMessage(g_pEvnEngine, v30);
          v82 = -1;
          CEvn_Logic::~CEvn_Logic(v45);
        }
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 474:
            if ( (a2 & 0x10000) != 0 )
            {
              v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v57, 0x1B5u, 0, 0xFu, 0, 0, 0);
              v82 = 18;
              IEventEngine::SendAMessage(g_pEvnEngine, v6);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v57);
            }
            else
            {
              v43 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v56, 0x191u, 0, 0, 0, 0, 0);
              v82 = 19;
              IEventEngine::SendAMessage(g_pEvnEngine, v43);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v56);
            }
            break;
          case 476:
            if ( (a2 & 0x10000) != 0 )
            {
              v42 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v55, 0x1B5u, 0, 0x14u, 0, 0, 0);
              v82 = 20;
              IEventEngine::SendAMessage(g_pEvnEngine, v42);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v55);
            }
            else
            {
              v41 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v54, 0x191u, 0, 0, 0, 0, 0);
              v82 = 21;
              IEventEngine::SendAMessage(g_pEvnEngine, v41);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v54);
            }
            break;
          case 478:
            if ( (a2 & 0x10000) != 0 )
            {
              v40 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v53, 0x1B5u, 0, 0x11u, 0, 0, 0);
              v82 = 22;
              IEventEngine::SendAMessage(g_pEvnEngine, v40);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v53);
            }
            else
            {
              v39 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v81, 0x191u, 0, 0, 0, 0, 0);
              v82 = 23;
              IEventEngine::SendAMessage(g_pEvnEngine, v39);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v81);
            }
            break;
          case 480:
            if ( (a2 & 0x10000) != 0 )
            {
              v38 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v52, 0x1B5u, 0, 0x10u, 0, 0, 0);
              v82 = 24;
              IEventEngine::SendAMessage(g_pEvnEngine, v38);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v52);
            }
            else
            {
              v37 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v51, 0x191u, 0, 0, 0, 0, 0);
              v82 = 25;
              IEventEngine::SendAMessage(g_pEvnEngine, v37);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v51);
            }
            break;
          case 481:
            if ( (a2 & 0x10000) != 0 )
            {
              v36 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v50, 0x1B5u, 0, 0x13u, 0, 0, 0);
              v82 = 26;
              IEventEngine::SendAMessage(g_pEvnEngine, v36);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v50);
            }
            else
            {
              v34 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v49, 0x191u, 0, 0, 0, 0, 0);
              v82 = 27;
              IEventEngine::SendAMessage(g_pEvnEngine, v34);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v49);
            }
            break;
          case 482:
            if ( (a2 & 0x10000) != 0 )
            {
              v33 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v48, 0x1B5u, 0, 0x15u, 0, 0, 0);
              v82 = 28;
              IEventEngine::SendAMessage(g_pEvnEngine, v33);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v48);
            }
            else
            {
              v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v47, 0x191u, 0, 0, 0, 0, 0);
              v82 = 29;
              IEventEngine::SendAMessage(g_pEvnEngine, v32);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v47);
            }
            break;
          default:
            break;
        }
      }
GuiDlgBuildMetalProc___def_17840F7:
      result = 1;
      break;
    case 5:
      if ( (unsigned __int16)a2 > 0x1ECu )
      {
        if ( (unsigned __int16)a2 == 498 )
        {
          SetMetalBuildCosts(4, 0);
        }
        else if ( (unsigned __int16)a2 == 2904 )
        {
          SetMetalBuildCosts(8, 0);
        }
        else
        {
LABEL_29:
          SetMetalBuildCosts(-1, 1);
        }
      }
      else if ( (unsigned __int16)a2 == 492 )
      {
        SetMetalBuildCosts(7, 0);
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 474:
            SetMetalBuildCosts(0, 0);
            break;
          case 476:
            SetMetalBuildCosts(1, 0);
            break;
          case 478:
            SetMetalBuildCosts(2, 0);
            break;
          case 480:
            SetMetalBuildCosts(3, 0);
            break;
          case 481:
            SetMetalBuildCosts(5, 0);
            break;
          case 482:
            SetMetalBuildCosts(6, 0);
            break;
          default:
            goto LABEL_29;
        }
      }
      goto GuiDlgBuildMetalProc___def_17840F7;
    case 6:
      goto LABEL_29;
    case 7:
      if ( a3 == 65537 )
      {
        if ( (unsigned __int16)a2 > 0x1ECu )
        {
          if ( (unsigned __int16)a2 == 498 )
          {
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v68, 0x1E6u, 0, 0x12u, 0, 0, 0);
            v82 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v82 = -1;
            CEvn_Logic::~CEvn_Logic(v68);
          }
          else if ( (unsigned __int16)a2 == 2904 )
          {
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v67, 0x1E6u, 0, 0x19u, 0, 0, 0);
            v82 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v82 = -1;
            CEvn_Logic::~CEvn_Logic(v67);
          }
        }
        else if ( (unsigned __int16)a2 == 492 )
        {
          g_bOpenSidebar = 1;
          v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v69, 0x1E6u, 0, 0x16u, 0, 0, 0);
          v82 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v82 = -1;
          CEvn_Logic::~CEvn_Logic(v69);
        }
        else
        {
          switch ( (__int16)a2 )
          {
            case 474:
              v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v75, 0x1E6u, 0, 0xFu, 0, 0, 0);
              v82 = 0;
              IEventEngine::SendAMessage(g_pEvnEngine, v23);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v75);
              break;
            case 476:
              v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v74, 0x1E6u, 0, 0x14u, 0, 0, 0);
              v82 = 1;
              IEventEngine::SendAMessage(g_pEvnEngine, v22);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v74);
              break;
            case 478:
              v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v73, 0x1E6u, 0, 0x11u, 0, 0, 0);
              v82 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v21);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v73);
              break;
            case 480:
              v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v72, 0x1E6u, 0, 0x10u, 0, 0, 0);
              v82 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v20);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v72);
              break;
            case 481:
              v35 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v76, 0x1E6u, 0, 0x13u, 0, 0, 0);
              v82 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v35);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v76);
              break;
            case 482:
              g_bOpenSidebar = 1;
              v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v70, 0x1E6u, 0, 0x15u, 0, 0, 0);
              v82 = 5;
              IEventEngine::SendAMessage(g_pEvnEngine, v19);
              v82 = -1;
              CEvn_Logic::~CEvn_Logic(v70);
              break;
            default:
              goto GuiDlgBuildMetalProc___def_17840F7;
          }
        }
      }
      else if ( (unsigned __int16)a2 > 0x1ECu )
      {
        if ( (unsigned __int16)a2 == 498 )
        {
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v59, 0x1B6u, 0, 0x12u, 0, 0, 0);
          v82 = 16;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v82 = -1;
          CEvn_Logic::~CEvn_Logic(v59);
        }
        else if ( (unsigned __int16)a2 == 2904 )
        {
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v58, 0x1B6u, 0, 0x19u, 0, 0, 0);
          v82 = 17;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v82 = -1;
          CEvn_Logic::~CEvn_Logic(v58);
        }
      }
      else if ( (unsigned __int16)a2 == 492 )
      {
        v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v60, 0x1B6u, 0, 0x16u, 0, 0, 0);
        v82 = 15;
        IEventEngine::SendAMessage(g_pEvnEngine, v9);
        v82 = -1;
        CEvn_Logic::~CEvn_Logic(v60);
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 474:
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v66, 0x1B6u, 0, 0xFu, 0, 0, 0);
            v82 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v82 = -1;
            CEvn_Logic::~CEvn_Logic(v66);
            break;
          case 476:
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v65, 0x1B6u, 0, 0x14u, 0, 0, 0);
            v82 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v82 = -1;
            CEvn_Logic::~CEvn_Logic(v65);
            break;
          case 478:
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v64, 0x1B6u, 0, 0x11u, 0, 0, 0);
            v82 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v82 = -1;
            CEvn_Logic::~CEvn_Logic(v64);
            break;
          case 480:
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v63, 0x1B6u, 0, 0x10u, 0, 0, 0);
            v82 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v82 = -1;
            CEvn_Logic::~CEvn_Logic(v63);
            break;
          case 481:
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v62, 0x1B6u, 0, 0x13u, 0, 0, 0);
            v82 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v82 = -1;
            CEvn_Logic::~CEvn_Logic(v62);
            break;
          case 482:
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v61, 0x1B6u, 0, 0x15u, 0, 0, 0);
            v82 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v82 = -1;
            CEvn_Logic::~CEvn_Logic(v61);
            break;
          default:
            goto GuiDlgBuildMetalProc___def_17840F7;
        }
      }
      goto GuiDlgBuildMetalProc___def_17840F7;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AB4F);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      goto GuiDlgBuildMetalProc___def_17840F7;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AB57);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      goto GuiDlgBuildMetalProc___def_17840F7;
    default:
      goto GuiDlgBuildMetalProc___def_17840F7;
  }
  return result;
}


// address=[0x1385930]
// Decompiled from char __cdecl SetBuildMilitaryProperties(int a1, int a2, int a3, int a4)
void __cdecl SetBuildMilitaryProperties(int a1, int a2, int a3, int a4) {
  
  CHAR v5[52]; // [esp+4h] [ebp-6Ch] BYREF
  CHAR Str[52]; // [esp+38h] [ebp-38h] BYREF

  _wsprintfA(Str, "%u", a1);
  IGuiEngine::SetText((void *)g_pGUIEngine, 13, a3, Str);
  _wsprintfA(v5, "+%u", a2);
  IGuiEngine::SetText((void *)g_pGUIEngine, 13, a4, v5);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 13, a4, a2 > 0);
}


// address=[0x13859d0]
// Decompiled from char UpdateGuiDlgBuildMilitary()
void __cdecl UpdateGuiDlgBuildMilitary(void) {
  
  int v0; // eax
  int i; // [esp+4h] [ebp-10h]
  int v3; // [esp+8h] [ebp-Ch]
  int v4; // [esp+Ch] [ebp-8h]

  if ( !g_pGUIEngine )
    return v0;
  byte_3ECF2AD = 1;
  LOBYTE(v0) = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 13, 529, byte_3F1E909 == 0);
  for ( i = 0; i < 10; ++i )
  {
    v4 = dword_3F1E914[4 * i];
    v3 = dword_3F1E910[4 * i];
    v0 = dword_3F1E90C[4 * i] - 23;
    switch ( dword_3F1E90C[4 * i] )
    {
      case 23:
        LOBYTE(v0) = SetBuildMilitaryProperties(v3, v4, 527, 528);
        break;
      case 24:
        LOBYTE(v0) = SetBuildMilitaryProperties(v3, v4, 510, 519);
        break;
      case 27:
        LOBYTE(v0) = SetBuildMilitaryProperties(v3, v4, 515, 521);
        break;
      case 28:
        LOBYTE(v0) = SetBuildMilitaryProperties(v3, v4, 514, 520);
        break;
      case 45:
        LOBYTE(v0) = SetBuildMilitaryProperties(v3, v4, 523, 524);
        break;
      case 46:
        LOBYTE(v0) = SetBuildMilitaryProperties(v3, v4, 508, 518);
        break;
      case 47:
        LOBYTE(v0) = SetBuildMilitaryProperties(v3, v4, 506, 517);
        break;
      case 48:
        LOBYTE(v0) = SetBuildMilitaryProperties(v3, v4, 516, 522);
        break;
      default:
        continue;
    }
  }
  byte_3ECF2AD = 0;
  return v0;
}


// address=[0x1385bd0]
// Decompiled from char __cdecl SetMilitaryBuildCosts(int a1, bool a2)
void __cdecl SetMilitaryBuildCosts(int a1, bool a2) {
  
  int v3; // [esp+0h] [ebp-44h]
  int v4; // [esp+4h] [ebp-40h]
  int v5; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  v5 = 0;
  v4 = 0;
  v3 = 0;
  if ( !a2 )
  {
    v5 = byte_3F1E918[16 * a1];
    v4 = byte_3F1E919[16 * a1];
    v3 = byte_3F1E91A[16 * a1];
  }
  _wsprintfA(Str, "%u", v5);
  IGuiEngine::SetText((void *)g_pGUIEngine, 13, 530, Str);
  _wsprintfA(Str, "%u", v4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 13, 531, Str);
  _wsprintfA(Str, "%u", v3);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 13, 532, Str);
}


// address=[0x1385cc0]
// Decompiled from char __cdecl GuiDlgBuildMilitaryProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBuildMilitaryProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-574h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-56Ch]
  CEvn_Logic *v8; // [esp+14h] [ebp-564h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-55Ch]
  CEvn_Logic *v10; // [esp+24h] [ebp-554h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-54Ch]
  CEvn_Logic *v12; // [esp+34h] [ebp-544h]
  CEvn_Logic *v13; // [esp+40h] [ebp-538h]
  CEvn_Logic *v14; // [esp+48h] [ebp-530h]
  CEvn_Logic *v15; // [esp+50h] [ebp-528h]
  CEvn_Logic *v16; // [esp+58h] [ebp-520h]
  CEvn_Logic *v17; // [esp+60h] [ebp-518h]
  CEvn_Logic *v18; // [esp+68h] [ebp-510h]
  CEvn_Logic *v19; // [esp+6Ch] [ebp-50Ch]
  CEvn_Logic *v20; // [esp+74h] [ebp-504h]
  CEvn_Logic *v21; // [esp+7Ch] [ebp-4FCh]
  CEvn_Logic *v22; // [esp+84h] [ebp-4F4h]
  CEvn_Logic *v23; // [esp+8Ch] [ebp-4ECh]
  CEvn_Logic *v24; // [esp+94h] [ebp-4E4h]
  CEvn_Logic *v25; // [esp+9Ch] [ebp-4DCh]
  CEvn_Logic *v26; // [esp+A4h] [ebp-4D4h]
  CEvn_Logic *v27; // [esp+ACh] [ebp-4CCh]
  CEvn_Logic *v28; // [esp+B4h] [ebp-4C4h]
  CEvn_Logic *v29; // [esp+BCh] [ebp-4BCh]
  CEvn_Logic *v30; // [esp+C4h] [ebp-4B4h]
  CEvn_Logic *v31; // [esp+CCh] [ebp-4ACh]
  CEvn_Logic *v32; // [esp+D4h] [ebp-4A4h]
  CEvn_Logic *v33; // [esp+DCh] [ebp-49Ch]
  CEvn_Logic *v34; // [esp+E4h] [ebp-494h]
  CEvn_Logic *v35; // [esp+ECh] [ebp-48Ch]
  CEvn_Logic *v36; // [esp+F4h] [ebp-484h]
  CEvn_Logic *v37; // [esp+FCh] [ebp-47Ch]
  CEvn_Logic *v38; // [esp+104h] [ebp-474h]
  CEvn_Logic *v39; // [esp+10Ch] [ebp-46Ch]
  _BYTE v40[32]; // [esp+128h] [ebp-450h] BYREF
  _BYTE v41[32]; // [esp+148h] [ebp-430h] BYREF
  _BYTE v42[32]; // [esp+168h] [ebp-410h] BYREF
  _BYTE v43[32]; // [esp+188h] [ebp-3F0h] BYREF
  _BYTE v44[32]; // [esp+1A8h] [ebp-3D0h] BYREF
  _BYTE v45[32]; // [esp+1C8h] [ebp-3B0h] BYREF
  _BYTE v46[32]; // [esp+1E8h] [ebp-390h] BYREF
  _BYTE v47[32]; // [esp+208h] [ebp-370h] BYREF
  _BYTE v48[32]; // [esp+228h] [ebp-350h] BYREF
  _BYTE v49[32]; // [esp+248h] [ebp-330h] BYREF
  _BYTE v50[32]; // [esp+268h] [ebp-310h] BYREF
  _BYTE v51[32]; // [esp+288h] [ebp-2F0h] BYREF
  _BYTE v52[32]; // [esp+2A8h] [ebp-2D0h] BYREF
  _BYTE v53[32]; // [esp+2C8h] [ebp-2B0h] BYREF
  _BYTE v54[32]; // [esp+2E8h] [ebp-290h] BYREF
  _BYTE v55[32]; // [esp+308h] [ebp-270h] BYREF
  _BYTE v56[32]; // [esp+328h] [ebp-250h] BYREF
  _BYTE v57[32]; // [esp+348h] [ebp-230h] BYREF
  _BYTE v58[32]; // [esp+368h] [ebp-210h] BYREF
  _BYTE v59[32]; // [esp+388h] [ebp-1F0h] BYREF
  _BYTE v60[32]; // [esp+3A8h] [ebp-1D0h] BYREF
  _BYTE v61[32]; // [esp+3C8h] [ebp-1B0h] BYREF
  _BYTE v62[32]; // [esp+3E8h] [ebp-190h] BYREF
  _BYTE v63[32]; // [esp+408h] [ebp-170h] BYREF
  _BYTE v64[32]; // [esp+428h] [ebp-150h] BYREF
  _BYTE v65[32]; // [esp+448h] [ebp-130h] BYREF
  _BYTE v66[32]; // [esp+468h] [ebp-110h] BYREF
  _BYTE v67[32]; // [esp+488h] [ebp-F0h] BYREF
  _BYTE v68[32]; // [esp+4A8h] [ebp-D0h] BYREF
  _BYTE v69[32]; // [esp+4C8h] [ebp-B0h] BYREF
  _BYTE v70[32]; // [esp+4E8h] [ebp-90h] BYREF
  _BYTE v71[32]; // [esp+508h] [ebp-70h] BYREF
  _BYTE v72[32]; // [esp+528h] [ebp-50h] BYREF
  _BYTE v73[32]; // [esp+548h] [ebp-30h] BYREF
  int v74; // [esp+574h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgBuildMilitary();
      SetMilitaryBuildCosts(-1, 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 505:
          if ( (a2 & 0x10000) != 0 )
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v51, 0x1B5u, 0, 0x2Eu, 0, 0, 0);
            v74 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v51);
          }
          else
          {
            v39 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v50, 0x191u, 0, 0, 0, 0, 0);
            v74 = 17;
            IEventEngine::SendAMessage(g_pEvnEngine, v39);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v50);
          }
          return 1;
        case 507:
          if ( (a2 & 0x10000) != 0 )
          {
            v38 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v49, 0x1B5u, 0, 0x30u, 0, 0, 0);
            v74 = 18;
            IEventEngine::SendAMessage(g_pEvnEngine, v38);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v49);
          }
          else
          {
            v37 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v48, 0x191u, 0, 0, 0, 0, 0);
            v74 = 19;
            IEventEngine::SendAMessage(g_pEvnEngine, v37);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v48);
          }
          return 1;
        case 509:
          if ( (a2 & 0x10000) != 0 )
          {
            v36 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v68, 0x1B5u, 0, 0x18u, 0, 0, 0);
            v74 = 20;
            IEventEngine::SendAMessage(g_pEvnEngine, v36);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v68);
          }
          else
          {
            v35 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v47, 0x191u, 0, 0, 0, 0, 0);
            v74 = 21;
            IEventEngine::SendAMessage(g_pEvnEngine, v35);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v47);
          }
          return 1;
        case 511:
          if ( (a2 & 0x10000) != 0 )
          {
            v34 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v46, 0x1B5u, 0, 0x2Fu, 0, 0, 0);
            v74 = 22;
            IEventEngine::SendAMessage(g_pEvnEngine, v34);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v46);
          }
          else
          {
            v33 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v45, 0x191u, 0, 0, 0, 0, 0);
            v74 = 23;
            IEventEngine::SendAMessage(g_pEvnEngine, v33);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v45);
          }
          return 1;
        case 512:
          if ( (a2 & 0x10000) != 0 )
          {
            v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v44, 0x1B5u, 0, 0x1Cu, 0, 0, 0);
            v74 = 24;
            IEventEngine::SendAMessage(g_pEvnEngine, v32);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v44);
          }
          else
          {
            v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v43, 0x191u, 0, 0, 0, 0, 0);
            v74 = 25;
            IEventEngine::SendAMessage(g_pEvnEngine, v31);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v43);
          }
          return 1;
        case 513:
          if ( (a2 & 0x10000) != 0 )
          {
            v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v42, 0x1B5u, 0, 0x1Bu, 0, 0, 0);
            v74 = 26;
            IEventEngine::SendAMessage(g_pEvnEngine, v30);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v42);
          }
          else
          {
            v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v41, 0x191u, 0, 0, 0, 0, 0);
            v74 = 27;
            IEventEngine::SendAMessage(g_pEvnEngine, v29);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v41);
          }
          return 1;
        case 525:
          if ( (a2 & 0x10000) != 0 )
          {
            v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v40, 0x1B5u, 0, 0x2Du, 0, 0, 0);
            v74 = 28;
            IEventEngine::SendAMessage(g_pEvnEngine, v28);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v40);
          }
          else
          {
            v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v72, 0x191u, 0, 0, 0, 0, 0);
            v74 = 29;
            IEventEngine::SendAMessage(g_pEvnEngine, v27);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v72);
          }
          return 1;
        case 526:
          if ( (a2 & 0x10000) != 0 )
          {
            v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v71, 0x1B5u, 0, 0x17u, 0, 0, 0);
            v74 = 30;
            IEventEngine::SendAMessage(g_pEvnEngine, v26);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v71);
          }
          else
          {
            v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v70, 0x191u, 0, 0, 0, 0, 0);
            v74 = 31;
            IEventEngine::SendAMessage(g_pEvnEngine, v25);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v70);
          }
          return 1;
        case 529:
          if ( byte_3ECF2AD )
            return 1;
          if ( (a2 & 0x10000) != 0 )
          {
            v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v69, 0x1B8u, 0, 1u, 0, 0, 0);
            v74 = 32;
            IEventEngine::SendAMessage(g_pEvnEngine, v24);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v69);
          }
          else
          {
            v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v54, 0x1B8u, 0, 0, 0, 0, 0);
            v74 = 33;
            IEventEngine::SendAMessage(g_pEvnEngine, v23);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v54);
          }
          break;
        default:
          return 1;
      }
      break;
    case 5:
      switch ( (__int16)a2 )
      {
        case 505:
          SetMilitaryBuildCosts(1, 0);
          break;
        case 507:
          SetMilitaryBuildCosts(4, 0);
          break;
        case 509:
          SetMilitaryBuildCosts(0, 0);
          break;
        case 511:
          SetMilitaryBuildCosts(2, 0);
          break;
        case 512:
          SetMilitaryBuildCosts(9, 0);
          break;
        case 513:
          SetMilitaryBuildCosts(5, 0);
          break;
        case 525:
          SetMilitaryBuildCosts(3, 0);
          break;
        case 526:
          SetMilitaryBuildCosts(6, 0);
          break;
        default:
          goto GuiDlgBuildMilitaryProc___def_1785E1F;
      }
      break;
    case 6:
GuiDlgBuildMilitaryProc___def_1785E1F:
      SetMilitaryBuildCosts(-1, 1);
      break;
    case 7:
      if ( a3 == 65537 )
      {
        switch ( (__int16)a2 )
        {
          case 505:
            v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v67, 0x1E6u, 0, 0x2Eu, 0, 0, 0);
            v74 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v22);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v67);
            break;
          case 507:
            v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v66, 0x1E6u, 0, 0x30u, 0, 0, 0);
            v74 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v66);
            break;
          case 509:
            g_bOpenSidebar = 1;
            v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v65, 0x1E6u, 0, 0x18u, 0, 0, 0);
            v74 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v20);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v65);
            break;
          case 511:
            v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v64, 0x1E6u, 0, 0x2Fu, 0, 0, 0);
            v74 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v19);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v64);
            break;
          case 512:
            v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v63, 0x1E6u, 0, 0x1Cu, 0, 0, 0);
            v74 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v63);
            break;
          case 513:
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v62, 0x1E6u, 0, 0x1Bu, 0, 0, 0);
            v74 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v62);
            break;
          case 525:
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v61, 0x1E6u, 0, 0x2Du, 0, 0, 0);
            v74 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v61);
            break;
          case 526:
            g_bOpenSidebar = 1;
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v60, 0x1E6u, 0, 0x17u, 0, 0, 0);
            v74 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v60);
            break;
          default:
            return 1;
        }
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 505:
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v59, 0x1B6u, 0, 0x2Eu, 0, 0, 0);
            v74 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v59);
            break;
          case 507:
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v58, 0x1B6u, 0, 0x30u, 0, 0, 0);
            v74 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v58);
            break;
          case 509:
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v57, 0x1B6u, 0, 0x18u, 0, 0, 0);
            v74 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v57);
            break;
          case 511:
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v56, 0x1B6u, 0, 0x2Fu, 0, 0, 0);
            v74 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v56);
            break;
          case 512:
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v55, 0x1B6u, 0, 0x1Cu, 0, 0, 0);
            v74 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v55);
            break;
          case 513:
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v73, 0x1B6u, 0, 0x1Bu, 0, 0, 0);
            v74 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v73);
            break;
          case 525:
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v53, 0x1B6u, 0, 0x2Du, 0, 0, 0);
            v74 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v53);
            break;
          case 526:
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v52, 0x1B6u, 0, 0x17u, 0, 0, 0);
            v74 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v74 = -1;
            CEvn_Logic::~CEvn_Logic(v52);
            break;
          default:
            return 1;
        }
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AB67);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AB6F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13872b0]
// Decompiled from char __cdecl GuiDlgBuildSubmenuProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgBuildSubmenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  int LocalPlayerId; // eax
  CPlayerInfo *v7; // eax
  int v8; // eax
  CPlayerInfo *v9; // eax
  int v10; // eax
  CPlayerInfo *v11; // eax
  int v12; // [esp+0h] [ebp-320h]
  CEvn_Event *v13; // [esp+4h] [ebp-31Ch]
  CEvn_Logic *v14; // [esp+Ch] [ebp-314h]
  CEvn_Logic *v15; // [esp+14h] [ebp-30Ch]
  CEvn_Logic *v16; // [esp+1Ch] [ebp-304h]
  CEvn_Event *v17; // [esp+24h] [ebp-2FCh]
  CEvn_Event *v18; // [esp+28h] [ebp-2F8h]
  CEvn_Logic *v19; // [esp+30h] [ebp-2F0h]
  CEvn_Logic *v20; // [esp+38h] [ebp-2E8h]
  CEvn_Logic *v21; // [esp+40h] [ebp-2E0h]
  CEvn_Logic *v22; // [esp+4Ch] [ebp-2D4h]
  CEvn_Logic *v23; // [esp+54h] [ebp-2CCh]
  CEvn_Logic *v24; // [esp+5Ch] [ebp-2C4h]
  CEvn_Event *v25; // [esp+64h] [ebp-2BCh]
  CEvn_Logic *v26; // [esp+6Ch] [ebp-2B4h]
  CEvn_Logic *v27; // [esp+74h] [ebp-2ACh]
  CEvn_Logic *v28; // [esp+7Ch] [ebp-2A4h]
  CEvn_Event *v29; // [esp+84h] [ebp-29Ch]
  CEvn_Logic *v30; // [esp+8Ch] [ebp-294h]
  CEvn_Logic *v31; // [esp+94h] [ebp-28Ch]
  CEvn_Logic *v32; // [esp+9Ch] [ebp-284h]
  DWORD v33; // [esp+A8h] [ebp-278h]
  DWORD v34; // [esp+ACh] [ebp-274h]
  DWORD v35; // [esp+B0h] [ebp-270h]
  _BYTE v36[32]; // [esp+B8h] [ebp-268h] BYREF
  _BYTE v37[32]; // [esp+D8h] [ebp-248h] BYREF
  _BYTE v38[32]; // [esp+F8h] [ebp-228h] BYREF
  _BYTE v39[32]; // [esp+118h] [ebp-208h] BYREF
  _BYTE v40[32]; // [esp+138h] [ebp-1E8h] BYREF
  _BYTE v41[32]; // [esp+158h] [ebp-1C8h] BYREF
  _BYTE v42[32]; // [esp+178h] [ebp-1A8h] BYREF
  _BYTE v43[32]; // [esp+198h] [ebp-188h] BYREF
  _BYTE v44[32]; // [esp+1B8h] [ebp-168h] BYREF
  _BYTE v45[32]; // [esp+1D8h] [ebp-148h] BYREF
  _BYTE v46[32]; // [esp+1F8h] [ebp-128h] BYREF
  _BYTE v47[32]; // [esp+218h] [ebp-108h] BYREF
  _BYTE v48[32]; // [esp+238h] [ebp-E8h] BYREF
  _BYTE v49[32]; // [esp+258h] [ebp-C8h] BYREF
  _BYTE v50[32]; // [esp+278h] [ebp-A8h] BYREF
  CEvn_Event v51; // [esp+298h] [ebp-88h] BYREF
  CEvn_Event v52; // [esp+2B0h] [ebp-70h] BYREF
  CEvn_Event v53; // [esp+2C8h] [ebp-58h] BYREF
  CEvn_Event v54; // [esp+2E0h] [ebp-40h] BYREF
  CEvn_Event v55; // [esp+2F8h] [ebp-28h] BYREF
  int v56; // [esp+31Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 3, 536, 1);
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0x218u:
          if ( *(_DWORD *)(g_pGuiMainEvents + 12) != 9 )
          {
            v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v49, 0x1CCu, 0, 0, 0, 0, 0);
            v56 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v22);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v49);
            v29 = CEvn_Event::CEvn_Event(&v55, 0x260u, 0, 0, 0);
            v56 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v29);
            v56 = -1;
            CEvn_Event::~CEvn_Event(&v55);
            PlayGuiSound(2);
            byte_3F1E908 = 0;
            dword_3F1E904 = 28;
            dword_3F1E90C[0] = 3;
            dword_3F1E90C[4] = 2;
            dword_3F1E90C[8] = 4;
            dword_3F1E90C[12] = 1;
            dword_3F1E90C[16] = 40;
            dword_3F1E90C[20] = 41;
            dword_3F1E90C[24] = 42;
            dword_3F1E90C[28] = 14;
            dword_3F1E90C[32] = 0;
            dword_3F1E90C[36] = 0;
            v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v48, 0x192u, 0, 0, 0, 0, 0);
            v56 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v48);
            v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v47, 0x1ACu, 0, (unsigned int)&g_sBuildingMenu, 0, 0, 0);
            v56 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v20);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v47);
          }
          break;
        case 0x219u:
          if ( *(_DWORD *)(g_pGuiMainEvents + 12) != 10 )
          {
            v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v46, 0x1CCu, 0, 0, 0, 0, 0);
            v56 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v19);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v46);
            v18 = CEvn_Event::CEvn_Event(&v54, 0x260u, 0, 0, 0);
            v56 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v56 = -1;
            CEvn_Event::~CEvn_Event(&v54);
            PlayGuiSound(2);
            byte_3F1E908 = 2;
            dword_3F1E904 = 28;
            dword_3F1E90C[0] = 15;
            dword_3F1E90C[4] = 20;
            dword_3F1E90C[8] = 17;
            dword_3F1E90C[12] = 16;
            dword_3F1E90C[16] = 18;
            dword_3F1E90C[20] = 19;
            dword_3F1E90C[24] = 21;
            dword_3F1E90C[28] = 22;
            dword_3F1E90C[36] = 0;
            LocalPlayerId = CPlayerManager::GetLocalPlayerId(v12);
            v7 = CPlayerManager::PlayerInfo(LocalPlayerId);
            v35 = CPlayerInfo::Race(v7);
            if ( v35 == 1 )
            {
              dword_3F1E90C[32] = 25;
            }
            else if ( v35 == 2 || v35 == 4 )
            {
              dword_3F1E90C[32] = 0;
            }
            else
            {
              dword_3F1E90C[32] = 0;
            }
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v45, 0x192u, 0, 0, 0, 0, 0);
            v56 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v45);
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v44, 0x1ACu, 0, (unsigned int)&g_sBuildingMenu, 0, 0, 0);
            v56 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v44);
          }
          break;
        case 0x21Au:
          if ( *(_DWORD *)(g_pGuiMainEvents + 12) != 11 )
          {
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v50, 0x1CCu, 0, 0, 0, 0, 0);
            v56 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v50);
            v13 = CEvn_Event::CEvn_Event(&v53, 0x260u, 0, 0, 0);
            v56 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v56 = -1;
            CEvn_Event::~CEvn_Event(&v53);
            PlayGuiSound(2);
            byte_3F1E908 = 1;
            dword_3F1E904 = 28;
            dword_3F1E90C[0] = 11;
            dword_3F1E90C[4] = 12;
            dword_3F1E90C[8] = 9;
            dword_3F1E90C[12] = 10;
            dword_3F1E90C[16] = 8;
            dword_3F1E90C[20] = 6;
            dword_3F1E90C[24] = 7;
            dword_3F1E90C[28] = 5;
            v8 = CPlayerManager::GetLocalPlayerId(v12);
            v9 = CPlayerManager::PlayerInfo(v8);
            v34 = CPlayerInfo::Race(v9);
            switch ( v34 )
            {
              case 1u:
                dword_3F1E90C[32] = 38;
                dword_3F1E90C[36] = 39;
                break;
              case 2u:
                dword_3F1E90C[32] = 36;
                dword_3F1E90C[36] = 37;
                break;
              case 4u:
                dword_3F1E90C[32] = 82;
                dword_3F1E90C[36] = 81;
                break;
              default:
                dword_3F1E90C[32] = 35;
                dword_3F1E90C[36] = 0;
                break;
            }
            v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v43, 0x192u, 0, 0, 0, 0, 0);
            v56 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v32);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v43);
            v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v42, 0x1ACu, 0, (unsigned int)&g_sBuildingMenu, 0, 0, 0);
            v56 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v31);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v42);
          }
          break;
        case 0x21Bu:
          if ( *(_DWORD *)(g_pGuiMainEvents + 12) != 12 )
          {
            v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v41, 0x1CCu, 0, 0, 0, 0, 0);
            v56 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v30);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v41);
            v17 = CEvn_Event::CEvn_Event(&v52, 0x260u, 0, 0, 0);
            v56 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v56 = -1;
            CEvn_Event::~CEvn_Event(&v52);
            PlayGuiSound(2);
            byte_3F1E908 = 3;
            dword_3F1E904 = 28;
            dword_3F1E90C[0] = 34;
            dword_3F1E90C[4] = 33;
            dword_3F1E90C[8] = 13;
            dword_3F1E90C[12] = 32;
            dword_3F1E90C[16] = 31;
            dword_3F1E90C[20] = 30;
            dword_3F1E90C[24] = 43;
            dword_3F1E90C[28] = 44;
            dword_3F1E90C[32] = 0;
            dword_3F1E90C[36] = 0;
            v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v40, 0x192u, 0, 0, 0, 0, 0);
            v56 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v28);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v40);
            v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v39, 0x1ACu, 0, (unsigned int)&g_sBuildingMenu, 0, 0, 0);
            v56 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v27);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v39);
            PlayGuiSound(2);
          }
          break;
        case 0x21Cu:
          if ( *(_DWORD *)(g_pGuiMainEvents + 12) != 13 )
          {
            v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v38, 0x1CCu, 0, 0, 0, 0, 0);
            v56 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v26);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v38);
            v25 = CEvn_Event::CEvn_Event(&v51, 0x260u, 0, 0, 0);
            v56 = 17;
            IEventEngine::SendAMessage(g_pEvnEngine, v25);
            v56 = -1;
            CEvn_Event::~CEvn_Event(&v51);
            PlayGuiSound(2);
            byte_3F1E908 = 4;
            dword_3F1E904 = 28;
            dword_3F1E90C[0] = 24;
            dword_3F1E90C[4] = 46;
            dword_3F1E90C[8] = 47;
            dword_3F1E90C[12] = 45;
            dword_3F1E90C[16] = 48;
            dword_3F1E90C[20] = 27;
            dword_3F1E90C[24] = 23;
            dword_3F1E90C[28] = 0;
            dword_3F1E90C[32] = 0;
            v10 = CPlayerManager::GetLocalPlayerId(v12);
            v11 = CPlayerManager::PlayerInfo(v10);
            v33 = CPlayerInfo::Race(v11);
            if ( v33 == 1 )
            {
              dword_3F1E90C[36] = 0;
            }
            else if ( v33 == 2 || v33 == 4 )
            {
              dword_3F1E90C[36] = 28;
            }
            else
            {
              dword_3F1E90C[36] = 28;
            }
            v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v37, 0x192u, 0, 0, 0, 0, 0);
            v56 = 18;
            IEventEngine::SendAMessage(g_pEvnEngine, v24);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v37);
            v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v36, 0x1ACu, 0, (unsigned int)&g_sBuildingMenu, 0, 0, 0);
            v56 = 19;
            IEventEngine::SendAMessage(g_pEvnEngine, v23);
            v56 = -1;
            CEvn_Logic::~CEvn_Logic(v36);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AB7A);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AB7B);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1388490]
// Decompiled from char __cdecl SetBuildTownProperties(int a1, int a2, int a3, int a4)
void __cdecl SetBuildTownProperties(int a1, int a2, int a3, int a4) {
  
  CHAR v5[52]; // [esp+4h] [ebp-6Ch] BYREF
  CHAR Str[52]; // [esp+38h] [ebp-38h] BYREF

  _wsprintfA(Str, "%u", a1);
  IGuiEngine::SetText((void *)g_pGUIEngine, 12, a3, Str);
  _wsprintfA(v5, "+%u", a2);
  IGuiEngine::SetText((void *)g_pGUIEngine, 12, a4, v5);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 12, a4, a2 > 0);
}


// address=[0x1388530]
// Decompiled from char UpdateGuiDlgBuildTown()
void __cdecl UpdateGuiDlgBuildTown(void) {
  
  int v0; // eax
  int i; // [esp+4h] [ebp-10h]
  int v3; // [esp+8h] [ebp-Ch]
  int v4; // [esp+Ch] [ebp-8h]

  if ( !g_pGUIEngine )
    return v0;
  byte_3ECF2AE = 1;
  LOBYTE(v0) = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 12, 563, byte_3F1E909 == 0);
  for ( i = 0; i < 10; ++i )
  {
    v4 = dword_3F1E914[4 * i];
    v3 = dword_3F1E910[4 * i];
    v0 = dword_3F1E90C[4 * i] - 13;
    switch ( dword_3F1E90C[4 * i] )
    {
      case 13:
        LOBYTE(v0) = SetBuildTownProperties(v3, v4, 542, 550);
        break;
      case 31:
        LOBYTE(v0) = SetBuildTownProperties(v3, v4, 549, 553);
        break;
      case 32:
        LOBYTE(v0) = SetBuildTownProperties(v3, v4, 554, 555);
        break;
      case 33:
        LOBYTE(v0) = SetBuildTownProperties(v3, v4, 544, 551);
        break;
      case 34:
        LOBYTE(v0) = SetBuildTownProperties(v3, v4, 546, 552);
        break;
      case 43:
        LOBYTE(v0) = SetBuildTownProperties(v3, v4, 559, 560);
        break;
      case 44:
        LOBYTE(v0) = SetBuildTownProperties(v3, v4, 561, 562);
        break;
      default:
        continue;
    }
  }
  byte_3ECF2AE = 0;
  return v0;
}


// address=[0x1388710]
// Decompiled from char __cdecl SetTownBuildCosts(int a1, bool a2)
void __cdecl SetTownBuildCosts(int a1, bool a2) {
  
  int v3; // [esp+0h] [ebp-44h]
  int v4; // [esp+4h] [ebp-40h]
  int v5; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  v5 = 0;
  v4 = 0;
  v3 = 0;
  if ( !a2 )
  {
    v5 = byte_3F1E918[16 * a1];
    v4 = byte_3F1E919[16 * a1];
    v3 = byte_3F1E91A[16 * a1];
  }
  _wsprintfA(Str, "%u", v5);
  IGuiEngine::SetText((void *)g_pGUIEngine, 12, 567, Str);
  _wsprintfA(Str, "%u", v4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 12, 568, Str);
  _wsprintfA(Str, "%u", v3);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 12, 569, Str);
}


// address=[0x1388800]
// Decompiled from char __cdecl GuiDlgBuildTownProc(int a1, int a2, int a3)
bool __cdecl GuiDlgBuildTownProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-7B4h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-7ACh]
  CEvn_Logic *v8; // [esp+14h] [ebp-7A4h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-79Ch]
  CEvn_Logic *v10; // [esp+24h] [ebp-794h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-78Ch]
  CEvn_Logic *v12; // [esp+34h] [ebp-784h]
  CEvn_Event *v13; // [esp+3Ch] [ebp-77Ch]
  CEvn_Logic *v14; // [esp+44h] [ebp-774h]
  CEvn_Logic *v15; // [esp+4Ch] [ebp-76Ch]
  CEvn_Logic *v16; // [esp+58h] [ebp-760h]
  CEvn_Logic *v17; // [esp+60h] [ebp-758h]
  CEvn_Logic *v18; // [esp+68h] [ebp-750h]
  CEvn_Logic *v19; // [esp+70h] [ebp-748h]
  CEvn_Logic *v20; // [esp+78h] [ebp-740h]
  CEvn_Logic *v21; // [esp+80h] [ebp-738h]
  CEvn_Logic *v22; // [esp+88h] [ebp-730h]
  CEvn_Logic *v23; // [esp+90h] [ebp-728h]
  CEvn_Logic *v24; // [esp+94h] [ebp-724h]
  CEvn_Logic *v25; // [esp+9Ch] [ebp-71Ch]
  CEvn_Logic *v26; // [esp+A4h] [ebp-714h]
  CEvn_Logic *v27; // [esp+ACh] [ebp-70Ch]
  CEvn_Logic *v28; // [esp+B4h] [ebp-704h]
  CEvn_Logic *v29; // [esp+BCh] [ebp-6FCh]
  CEvn_Logic *v30; // [esp+C4h] [ebp-6F4h]
  CEvn_Logic *v31; // [esp+CCh] [ebp-6ECh]
  CEvn_Logic *v32; // [esp+D4h] [ebp-6E4h]
  CEvn_Logic *v33; // [esp+DCh] [ebp-6DCh]
  CEvn_Logic *v34; // [esp+E4h] [ebp-6D4h]
  CEvn_Event *v35; // [esp+ECh] [ebp-6CCh]
  CEvn_Logic *v36; // [esp+F4h] [ebp-6C4h]
  CEvn_Logic *v37; // [esp+FCh] [ebp-6BCh]
  CEvn_Logic *v38; // [esp+104h] [ebp-6B4h]
  CEvn_Event *v39; // [esp+10Ch] [ebp-6ACh]
  CEvn_Logic *v40; // [esp+114h] [ebp-6A4h]
  CEvn_Logic *v41; // [esp+11Ch] [ebp-69Ch]
  CEvn_Logic *v42; // [esp+124h] [ebp-694h]
  CEvn_Event *v43; // [esp+12Ch] [ebp-68Ch]
  CEvn_Logic *v44; // [esp+134h] [ebp-684h]
  CEvn_Logic *v45; // [esp+13Ch] [ebp-67Ch]
  CEvn_Event *v46; // [esp+144h] [ebp-674h]
  CEvn_Logic *v47; // [esp+14Ch] [ebp-66Ch]
  CEvn_Logic *v48; // [esp+154h] [ebp-664h]
  CEvn_Logic *v49; // [esp+15Ch] [ebp-65Ch]
  CEvn_Logic *v50; // [esp+164h] [ebp-654h]
  CEvn_Event *v51; // [esp+16Ch] [ebp-64Ch]
  CEvn_Logic *v52; // [esp+174h] [ebp-644h]
  CEvn_Logic *v53; // [esp+17Ch] [ebp-63Ch]
  CEvn_Logic *v54; // [esp+184h] [ebp-634h]
  CEvn_Event *v55; // [esp+18Ch] [ebp-62Ch]
  _BYTE v56[32]; // [esp+1A8h] [ebp-610h] BYREF
  _BYTE v57[32]; // [esp+1C8h] [ebp-5F0h] BYREF
  _BYTE v58[32]; // [esp+1E8h] [ebp-5D0h] BYREF
  _BYTE v59[32]; // [esp+208h] [ebp-5B0h] BYREF
  _BYTE v60[32]; // [esp+228h] [ebp-590h] BYREF
  _BYTE v61[32]; // [esp+248h] [ebp-570h] BYREF
  _BYTE v62[32]; // [esp+268h] [ebp-550h] BYREF
  _BYTE v63[32]; // [esp+288h] [ebp-530h] BYREF
  _BYTE v64[32]; // [esp+2A8h] [ebp-510h] BYREF
  _BYTE v65[32]; // [esp+2C8h] [ebp-4F0h] BYREF
  _BYTE v66[32]; // [esp+2E8h] [ebp-4D0h] BYREF
  _BYTE v67[32]; // [esp+308h] [ebp-4B0h] BYREF
  _BYTE v68[32]; // [esp+328h] [ebp-490h] BYREF
  _BYTE v69[32]; // [esp+348h] [ebp-470h] BYREF
  _BYTE v70[32]; // [esp+368h] [ebp-450h] BYREF
  _BYTE v71[32]; // [esp+388h] [ebp-430h] BYREF
  _BYTE v72[32]; // [esp+3A8h] [ebp-410h] BYREF
  _BYTE v73[32]; // [esp+3C8h] [ebp-3F0h] BYREF
  _BYTE v74[32]; // [esp+3E8h] [ebp-3D0h] BYREF
  _BYTE v75[32]; // [esp+408h] [ebp-3B0h] BYREF
  _BYTE v76[32]; // [esp+428h] [ebp-390h] BYREF
  _BYTE v77[32]; // [esp+448h] [ebp-370h] BYREF
  _BYTE v78[32]; // [esp+468h] [ebp-350h] BYREF
  _BYTE v79[32]; // [esp+488h] [ebp-330h] BYREF
  _BYTE v80[32]; // [esp+4A8h] [ebp-310h] BYREF
  _BYTE v81[32]; // [esp+4C8h] [ebp-2F0h] BYREF
  _BYTE v82[32]; // [esp+4E8h] [ebp-2D0h] BYREF
  _BYTE v83[32]; // [esp+508h] [ebp-2B0h] BYREF
  _BYTE v84[32]; // [esp+528h] [ebp-290h] BYREF
  _BYTE v85[32]; // [esp+548h] [ebp-270h] BYREF
  _BYTE v86[32]; // [esp+568h] [ebp-250h] BYREF
  _BYTE v87[32]; // [esp+588h] [ebp-230h] BYREF
  _BYTE v88[32]; // [esp+5A8h] [ebp-210h] BYREF
  _BYTE v89[32]; // [esp+5C8h] [ebp-1F0h] BYREF
  _BYTE v90[32]; // [esp+5E8h] [ebp-1D0h] BYREF
  _BYTE v91[32]; // [esp+608h] [ebp-1B0h] BYREF
  _BYTE v92[32]; // [esp+628h] [ebp-190h] BYREF
  _BYTE v93[32]; // [esp+648h] [ebp-170h] BYREF
  _BYTE v94[32]; // [esp+668h] [ebp-150h] BYREF
  _BYTE v95[32]; // [esp+688h] [ebp-130h] BYREF
  _BYTE v96[32]; // [esp+6A8h] [ebp-110h] BYREF
  _BYTE v97[32]; // [esp+6C8h] [ebp-F0h] BYREF
  CEvn_Event v98; // [esp+6E8h] [ebp-D0h] BYREF
  CEvn_Event v99; // [esp+700h] [ebp-B8h] BYREF
  CEvn_Event v100; // [esp+718h] [ebp-A0h] BYREF
  CEvn_Event v101; // [esp+730h] [ebp-88h] BYREF
  CEvn_Event v102; // [esp+748h] [ebp-70h] BYREF
  CEvn_Event v103; // [esp+760h] [ebp-58h] BYREF
  CEvn_Event v104; // [esp+778h] [ebp-40h] BYREF
  CEvn_Event v105; // [esp+790h] [ebp-28h] BYREF
  int v106; // [esp+7B4h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgBuildTown();
      SetTownBuildCosts(-1, 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 541:
          if ( (a2 & 0x10000) != 0 )
          {
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v75, 0x1CCu, 0, 0, 0, 0, 0);
            v106 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v75);
            v13 = CEvn_Event::CEvn_Event(&v105, 0x260u, 0, 0, 0);
            v106 = 17;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v106 = -1;
            CEvn_Event::~CEvn_Event(&v105);
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v74, 0x1B5u, 0, 0x21u, 0, 0, 0);
            v106 = 18;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v74);
          }
          else
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v73, 0x191u, 0, 0, 0, 0, 0);
            v106 = 19;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v73);
          }
          return 1;
        case 543:
          if ( (a2 & 0x10000) != 0 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v72, 0x1CCu, 0, 0, 0, 0, 0);
            v106 = 20;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v72);
            v9 = CEvn_Event::CEvn_Event(&v98, 0x260u, 0, 0, 0);
            v106 = 21;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v106 = -1;
            CEvn_Event::~CEvn_Event(&v98);
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v71, 0x1B5u, 0, 0x1Fu, 0, 0, 0);
            v106 = 22;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v71);
          }
          else
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v70, 0x191u, 0, 0, 0, 0, 0);
            v106 = 23;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v70);
          }
          return 1;
        case 545:
          if ( (a2 & 0x10000) != 0 )
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v93, 0x1CCu, 0, 0, 0, 0, 0);
            v106 = 24;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v93);
            v55 = CEvn_Event::CEvn_Event(&v104, 0x260u, 0, 0, 0);
            v106 = 25;
            IEventEngine::SendAMessage(g_pEvnEngine, v55);
            v106 = -1;
            CEvn_Event::~CEvn_Event(&v104);
            v54 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v69, 0x1B5u, 0, 0x22u, 0, 0, 0);
            v106 = 26;
            IEventEngine::SendAMessage(g_pEvnEngine, v54);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v69);
          }
          else
          {
            v53 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v68, 0x191u, 0, 0, 0, 0, 0);
            v106 = 27;
            IEventEngine::SendAMessage(g_pEvnEngine, v53);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v68);
          }
          return 1;
        case 547:
          if ( (a2 & 0x10000) != 0 )
          {
            v52 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v67, 0x1CCu, 0, 0, 0, 0, 0);
            v106 = 28;
            IEventEngine::SendAMessage(g_pEvnEngine, v52);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v67);
            v51 = CEvn_Event::CEvn_Event(&v103, 0x260u, 0, 0, 0);
            v106 = 29;
            IEventEngine::SendAMessage(g_pEvnEngine, v51);
            v106 = -1;
            CEvn_Event::~CEvn_Event(&v103);
            v50 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v66, 0x1B5u, 0, 0xDu, 0, 0, 0);
            v106 = 30;
            IEventEngine::SendAMessage(g_pEvnEngine, v50);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v66);
          }
          else
          {
            v49 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v65, 0x191u, 0, 0, 0, 0, 0);
            v106 = 31;
            IEventEngine::SendAMessage(g_pEvnEngine, v49);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v65);
          }
          return 1;
        case 548:
          if ( (a2 & 0x10000) != 0 )
          {
            dword_3F1EF94 = 27;
            dword_3F1EF98[0] = 64;
            dword_3F1EF98[4] = 65;
            dword_3F1EF98[8] = 66;
            dword_3F1EF98[12] = 67;
            dword_3F1EF98[16] = 68;
            dword_3F1EF98[20] = 69;
            dword_3F1EF98[24] = 70;
            dword_3F1EF98[28] = 71;
            dword_3F1EF98[32] = 72;
            dword_3F1EF98[36] = 73;
            dword_3F1EF98[40] = 74;
            dword_3F1EF98[44] = 75;
            v48 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v64, 0x1CAu, 0, (unsigned int)&g_cEyeCatcherBarInfo, 0, 0, 0);
            v106 = 32;
            IEventEngine::SendAMessage(g_pEvnEngine, v48);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v64);
          }
          else
          {
            v47 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v63, 0x1CCu, 0, 0, 0, 0, 0);
            v106 = 33;
            IEventEngine::SendAMessage(g_pEvnEngine, v47);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v63);
            v46 = CEvn_Event::CEvn_Event(&v102, 0x260u, 0, 0, 0);
            v106 = 34;
            IEventEngine::SendAMessage(g_pEvnEngine, v46);
            v106 = -1;
            CEvn_Event::~CEvn_Event(&v102);
            v45 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v62, 0x191u, 0, 0, 0, 0, 0);
            v106 = 35;
            IEventEngine::SendAMessage(g_pEvnEngine, v45);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v62);
          }
          return 1;
        case 556:
          if ( (a2 & 0x10000) != 0 )
          {
            v44 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v61, 0x1CCu, 0, 0, 0, 0, 0);
            v106 = 36;
            IEventEngine::SendAMessage(g_pEvnEngine, v44);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v61);
            v43 = CEvn_Event::CEvn_Event(&v101, 0x260u, 0, 0, 0);
            v106 = 37;
            IEventEngine::SendAMessage(g_pEvnEngine, v43);
            v106 = -1;
            CEvn_Event::~CEvn_Event(&v101);
            v42 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v60, 0x1B5u, 0, 0x20u, 0, 0, 0);
            v106 = 38;
            IEventEngine::SendAMessage(g_pEvnEngine, v42);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v60);
          }
          else
          {
            v41 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v59, 0x191u, 0, 0, 0, 0, 0);
            v106 = 39;
            IEventEngine::SendAMessage(g_pEvnEngine, v41);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v59);
          }
          return 1;
        case 557:
          if ( (a2 & 0x10000) != 0 )
          {
            v40 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v58, 0x1CCu, 0, 0, 0, 0, 0);
            v106 = 40;
            IEventEngine::SendAMessage(g_pEvnEngine, v40);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v58);
            v39 = CEvn_Event::CEvn_Event(&v99, 0x260u, 0, 0, 0);
            v106 = 41;
            IEventEngine::SendAMessage(g_pEvnEngine, v39);
            v106 = -1;
            CEvn_Event::~CEvn_Event(&v99);
            v38 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v57, 0x1B5u, 0, 0x2Bu, 0, 0, 0);
            v106 = 42;
            IEventEngine::SendAMessage(g_pEvnEngine, v38);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v57);
          }
          else
          {
            v37 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v56, 0x191u, 0, 0, 0, 0, 0);
            v106 = 43;
            IEventEngine::SendAMessage(g_pEvnEngine, v37);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v56);
          }
          return 1;
        case 558:
          if ( (a2 & 0x10000) != 0 )
          {
            v36 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v97, 0x1CCu, 0, 0, 0, 0, 0);
            v106 = 44;
            IEventEngine::SendAMessage(g_pEvnEngine, v36);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v97);
            v35 = CEvn_Event::CEvn_Event(&v100, 0x260u, 0, 0, 0);
            v106 = 45;
            IEventEngine::SendAMessage(g_pEvnEngine, v35);
            v106 = -1;
            CEvn_Event::~CEvn_Event(&v100);
            v34 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v96, 0x1B5u, 0, 0x2Cu, 0, 0, 0);
            v106 = 46;
            IEventEngine::SendAMessage(g_pEvnEngine, v34);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v96);
          }
          else
          {
            v33 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v95, 0x191u, 0, 0, 0, 0, 0);
            v106 = 47;
            IEventEngine::SendAMessage(g_pEvnEngine, v33);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v95);
          }
          return 1;
        case 563:
          if ( byte_3ECF2AE )
            return 1;
          if ( (a2 & 0x10000) != 0 )
          {
            v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v94, 0x1B8u, 0, 1u, 0, 0, 0);
            v106 = 48;
            IEventEngine::SendAMessage(g_pEvnEngine, v32);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v94);
          }
          else
          {
            v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v92, 0x1B8u, 0, 0, 0, 0, 0);
            v106 = 49;
            IEventEngine::SendAMessage(g_pEvnEngine, v31);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v92);
          }
          break;
        default:
          return 1;
      }
      break;
    case 5:
      switch ( (__int16)a2 )
      {
        case 541:
          SetTownBuildCosts(1, 0);
          break;
        case 543:
          SetTownBuildCosts(4, 0);
          break;
        case 545:
          SetTownBuildCosts(0, 0);
          break;
        case 547:
          SetTownBuildCosts(2, 0);
          break;
        case 556:
          SetTownBuildCosts(3, 0);
          break;
        case 557:
          SetTownBuildCosts(6, 0);
          break;
        case 558:
          SetTownBuildCosts(7, 0);
          break;
        default:
          goto GuiDlgBuildTownProc___def_178895B;
      }
      break;
    case 6:
GuiDlgBuildTownProc___def_178895B:
      SetTownBuildCosts(-1, 1);
      break;
    case 7:
      if ( a3 == 65537 )
      {
        switch ( (__int16)a2 )
        {
          case 541:
            v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v91, 0x1E6u, 0, 0x21u, 0, 0, 0);
            v106 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v30);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v91);
            break;
          case 543:
            v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v90, 0x1E6u, 0, 0x1Fu, 0, 0, 0);
            v106 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v29);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v90);
            v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v89, 0x1CBu, 0, 0, 0, 0, 0);
            v106 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v28);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v89);
            break;
          case 545:
            v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v88, 0x1E6u, 0, 0x22u, 0, 0, 0);
            v106 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v27);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v88);
            v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v87, 0x1C9u, 0, 0, 0, 0, 0);
            v106 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v26);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v87);
            break;
          case 547:
            v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v86, 0x1E6u, 0, 0xDu, 0, 0, 0);
            v106 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v25);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v86);
            break;
          case 556:
            v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v85, 0x1E6u, 0, 0x20u, 0, 0, 0);
            v106 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v24);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v85);
            break;
          case 557:
            v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v84, 0x1E6u, 0, 0x2Bu, 0, 0, 0);
            v106 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v23);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v84);
            break;
          case 558:
            v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v83, 0x1E6u, 0, 0x2Cu, 0, 0, 0);
            v106 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v22);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v83);
            break;
          default:
            return 1;
        }
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 541:
            v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v82, 0x1B6u, 0, 0x21u, 0, 0, 0);
            v106 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v82);
            break;
          case 543:
            v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v81, 0x1B6u, 0, 0x1Fu, 0, 0, 0);
            v106 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v20);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v81);
            break;
          case 545:
            v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v80, 0x1B6u, 0, 0x22u, 0, 0, 0);
            v106 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v19);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v80);
            break;
          case 547:
            v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v79, 0x1B6u, 0, 0xDu, 0, 0, 0);
            v106 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v79);
            break;
          case 556:
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v78, 0x1B6u, 0, 0x20u, 0, 0, 0);
            v106 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v78);
            break;
          case 557:
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v77, 0x1B6u, 0, 0x2Bu, 0, 0, 0);
            v106 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v77);
            break;
          case 558:
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v76, 0x1B6u, 0, 0x2Cu, 0, 0, 0);
            v106 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v106 = -1;
            CEvn_Logic::~CEvn_Logic(v76);
            break;
          default:
            return 1;
        }
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AB7F);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AB87);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x138a580]
// Decompiled from void UpdateGuiDlgChat()
void __cdecl UpdateGuiDlgChat(void) {
  
  char *v0; // eax
  int v1; // [esp+0h] [ebp-Ch]
  int i; // [esp+4h] [ebp-8h]
  bool v3; // [esp+Bh] [ebp-1h]

  if ( g_pGUIEngine )
  {
    byte_3ECF2AF = 1;
    if ( *(int *)(g_pGame + 400) < 0 )
      *(_DWORD *)(g_pGame + 400) = 0;
    v3 = 0;
    for ( i = 0; i < 8; ++i )
    {
      if ( i >= *(_DWORD *)(g_pGame + 396) )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i + 1], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i + 2], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i + 3], 0);
      }
      else
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i + 1], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i + 2], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i + 3], 1);
        v1 = *(_DWORD *)(g_pGame + 40 * i + 432);
        v0 = (char *)std::string::c_str((void *)(g_pGame + 40 * i + 404));
        IGuiEngine::SetText((void *)g_pGUIEngine, 58, dword_3D88360[4 * i], v0);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 58, dword_3D88360[4 * i + 2], dword_3D883E0[v1], 0);
        if ( *(_BYTE *)(g_pGame + 40 * i + 441) )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 58, dword_3D88360[4 * i], 13);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 58, dword_3D88360[4 * i], 11);
        IGuiEngine::SetImages(
          (void *)g_pGUIEngine,
          58,
          dword_3D88360[4 * i + 3],
          dword_3D88400[*(_DWORD *)(g_pGame + 40 * i + 436)],
          0);
        IGuiEngine::SelectControl(
          (IGuiEngine *)g_pGUIEngine,
          58,
          dword_3D88360[4 * i + 1],
          *(_BYTE *)(g_pGame + 40 * i + 440));
        if ( i == *(_DWORD *)(g_pGame + 400) || *(int *)(g_pGame + 40 * i + 436) > 2 )
        {
          IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 58, dword_3D88360[4 * i + 1], 0);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 58, dword_3D88360[4 * i + 1], 0);
        }
        else
        {
          v3 = 1;
        }
      }
    }
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 58, 587, v3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 58, 588, v3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 58, 589, v3);
    byte_3ECF2AF = 0;
  }
}


// address=[0x138a950]
// Decompiled from char __cdecl GuiDlgChatProc(int a1, int a2, int a3)
bool __cdecl GuiDlgChatProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-198h]
  CEvn_Event *v7; // [esp+Ch] [ebp-190h]
  CEvn_Event *v8; // [esp+14h] [ebp-188h]
  CEvn_Event *v9; // [esp+18h] [ebp-184h]
  CEvn_Event *v10; // [esp+20h] [ebp-17Ch]
  CEvn_Event *v11; // [esp+28h] [ebp-174h]
  CEvn_Event *v12; // [esp+30h] [ebp-16Ch]
  CEvn_Event *v13; // [esp+38h] [ebp-164h]
  CEvn_Event *v14; // [esp+40h] [ebp-15Ch]
  CEvn_Event *v15; // [esp+48h] [ebp-154h]
  CEvn_Event *v16; // [esp+50h] [ebp-14Ch]
  CEvn_Event v17; // [esp+84h] [ebp-118h] BYREF
  CEvn_Event v18; // [esp+9Ch] [ebp-100h] BYREF
  CEvn_Event v19; // [esp+B4h] [ebp-E8h] BYREF
  CEvn_Event v20; // [esp+CCh] [ebp-D0h] BYREF
  CEvn_Event v21; // [esp+E4h] [ebp-B8h] BYREF
  CEvn_Event v22; // [esp+FCh] [ebp-A0h] BYREF
  CEvn_Event v23; // [esp+114h] [ebp-88h] BYREF
  CEvn_Event v24; // [esp+12Ch] [ebp-70h] BYREF
  CEvn_Event v25; // [esp+144h] [ebp-58h] BYREF
  CEvn_Event v26; // [esp+15Ch] [ebp-40h] BYREF
  CEvn_Event v27; // [esp+174h] [ebp-28h] BYREF
  int v28; // [esp+198h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3ECF2B0 = 1;
      byte_3ECF2AF = 0;
      UpdateGuiDlgChat();
      byte_3ECF2B0 = 0;
      break;
    case 1:
      if ( !byte_3ECF2B0 )
      {
        if ( (a2 & 0x10000) != 0 )
          PlayGuiSound(1);
        else
          PlayGuiSound(0);
      }
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 579:
          if ( !byte_3ECF2AF )
          {
            *(_BYTE *)(g_pGame + 440) = (a2 & 0x10000) != 0;
            v6 = CEvn_Event::CEvn_Event(&v18, 0x23u, 0, 0, 0);
            v28 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v18);
            PlayGuiSound(2);
          }
          break;
        case 580:
          if ( !byte_3ECF2AF )
          {
            *(_BYTE *)(g_pGame + 480) = (a2 & 0x10000) != 0;
            v7 = CEvn_Event::CEvn_Event(&v19, 0x23u, 0, 0, 0);
            v28 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v19);
            PlayGuiSound(2);
          }
          break;
        case 581:
          if ( !byte_3ECF2AF )
          {
            *(_BYTE *)(g_pGame + 520) = (a2 & 0x10000) != 0;
            v8 = CEvn_Event::CEvn_Event(&v20, 0x23u, 0, 0, 0);
            v28 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v20);
            PlayGuiSound(2);
          }
          break;
        case 582:
          if ( !byte_3ECF2AF )
          {
            *(_BYTE *)(g_pGame + 560) = (a2 & 0x10000) != 0;
            v10 = CEvn_Event::CEvn_Event(&v21, 0x23u, 0, 0, 0);
            v28 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v21);
            PlayGuiSound(2);
          }
          break;
        case 583:
          if ( !byte_3ECF2AF )
          {
            *(_BYTE *)(g_pGame + 600) = (a2 & 0x10000) != 0;
            v11 = CEvn_Event::CEvn_Event(&v22, 0x23u, 0, 0, 0);
            v28 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v22);
            PlayGuiSound(2);
          }
          break;
        case 584:
          if ( !byte_3ECF2AF )
          {
            *(_BYTE *)(g_pGame + 640) = (a2 & 0x10000) != 0;
            v9 = CEvn_Event::CEvn_Event(&v23, 0x23u, 0, 0, 0);
            v28 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v23);
            PlayGuiSound(2);
          }
          break;
        case 585:
          if ( !byte_3ECF2AF )
          {
            *(_BYTE *)(g_pGame + 680) = (a2 & 0x10000) != 0;
            v16 = CEvn_Event::CEvn_Event(&v24, 0x23u, 0, 0, 0);
            v28 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v24);
            PlayGuiSound(2);
          }
          break;
        case 586:
          if ( !byte_3ECF2AF )
          {
            *(_BYTE *)(g_pGame + 720) = (a2 & 0x10000) != 0;
            v15 = CEvn_Event::CEvn_Event(&v25, 0x23u, 0, 0, 0);
            v28 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v25);
            PlayGuiSound(2);
          }
          break;
        case 587:
          v14 = CEvn_Event::CEvn_Event(&v26, 0x24u, 0, 0, 0);
          v28 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v26);
          PlayGuiSound(2);
          break;
        case 588:
          v13 = CEvn_Event::CEvn_Event(&v27, 0x24u, 1u, 0, 0);
          v28 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v27);
          PlayGuiSound(2);
          break;
        case 589:
          v12 = CEvn_Event::CEvn_Event(&v17, 0x24u, 2u, 0, 0);
          v28 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AB92);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AB93);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x138b520]
// Decompiled from int __cdecl GuiDlgClockSetCountdown(int a1)
void __cdecl GuiDlgClockSetCountdown(unsigned int a1) {
  
  int result; // eax

  result = a1;
  dword_3ECF2B4 = a1;
  byte_3ECF2B8 = a1 != 0;
  *(_BYTE *)(g_pGuiMainEvents + 66) = a1 != 0;
  return result;
}


// address=[0x138b560]
// Decompiled from char __cdecl UpdateGuiDlgClock(int a1)
void __cdecl UpdateGuiDlgClock(unsigned int a1) {
  
  float v2; // [esp+Ch] [ebp-40h]
  int v3; // [esp+10h] [ebp-3Ch]
  char Str[52]; // [esp+14h] [ebp-38h] BYREF

  v2 = 71.0 / 1000.0;
  if ( byte_3ECF2B8 )
  {
    v3 = (int)(float)((float)dword_3ECF2B4 - (float)((float)a1 * v2));
    if ( v3 < 0 )
      v3 = 0;
    if ( v3 < 60 )
    {
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 74, 139, 2);
      j___snprintf(Str, 0x32u, "%d", v3);
      return IGuiEngine::SetText((void *)g_pGUIEngine, 74, 139, Str);
    }
  }
  else
  {
    v3 = (int)(float)((float)a1 * v2);
  }
  j___snprintf(Str, 0x32u, "%02u:%02u:%02u", v3 / 3600, v3 / 60 % 60, v3 % 60);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 74, 139, Str);
}


// address=[0x138b6a0]
// Decompiled from char __cdecl GuiDlgClockProc(int a1)
bool __cdecl GuiDlgClockProc(int a1, int a2, int a3) {
  
  if ( !g_pEvnEngine )
    return 0;
  if ( a1 )
  {
    if ( a1 == 8 )
    {
      IGuiEngine::SetTooltip((char *)&byte_368AB97);
    }
    else if ( a1 == 9 )
    {
      IGuiEngine::SetTooltipExt((char *)byte_368ABA7);
    }
  }
  else
  {
    dword_3ECF2B4 = 0;
    byte_3ECF2B8 = 0;
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 74, 139, 7);
  }
  return 1;
}


// address=[0x138b7a0]
// Decompiled from void InitGuiDlgEconomy()
void __cdecl InitGuiDlgEconomy(void) {
  
  char *v0; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2042);
    IGuiEngine::SetText((void *)g_pGUIEngine, 77, 646, v0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 77, 670, "I");
    IGuiEngine::SetText((void *)g_pGUIEngine, 77, 671, "II");
  }
}


// address=[0x138b810]
// Decompiled from void UpdateGuiDlgEconomy()
void __cdecl UpdateGuiDlgEconomy(void) {
  
  int GuiGoodImageID; // eax
  int v1; // [esp+0h] [ebp-4Ch]
  int v2; // [esp+4h] [ebp-48h]
  int v3; // [esp+8h] [ebp-44h]
  int v4; // [esp+Ch] [ebp-40h]
  int i; // [esp+10h] [ebp-3Ch]
  CHAR Str[52]; // [esp+14h] [ebp-38h] BYREF

  for ( i = 0; i < 7; ++i )
  {
    v2 = dword_3F1EE8C[3 * i];
    v1 = dword_3F1EE90[3 * i];
    if ( v2 >= v1 )
    {
      if ( v2 <= v1 )
        v4 = 2;
      else
        v4 = 1;
      v3 = 2;
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 77, dword_368AF18[3 * i], v4);
    }
    else
    {
      v3 = 1;
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 77, dword_368AF18[3 * i], 2);
    }
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 77, dword_368AF18[3 * i + 1], v3);
    _wsprintfA(Str, "%u", v2);
    IGuiEngine::SetText((void *)g_pGUIEngine, 77, dword_368AF18[3 * i], Str);
    _wsprintfA(Str, "%u", v1);
    IGuiEngine::SetText((void *)g_pGUIEngine, 77, dword_368AF18[3 * i + 1], Str);
    GuiGoodImageID = GetGuiGoodImageID(dword_3F1EE88[3 * i]);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 77, dword_368AF18[3 * i + 2], GuiGoodImageID, 0);
    IGuiEngine::SetTooltipID(
      (IGuiEngine *)g_pGUIEngine,
      77,
      dword_368AF18[3 * i + 2],
      dword_368ABB8[5 * dword_3F1EE88[3 * i] + 3],
      dword_368ABB8[5 * dword_3F1EE88[3 * i] + 4]);
  }
}


// address=[0x138ba10]
// Decompiled from char __cdecl GuiDlgEconomyProc(int a1, int a2, int a3)
bool __cdecl GuiDlgEconomyProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgEconomy();
      UpdateGuiDlgEconomy();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368AF16);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368AF17);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x138bc00]
// Decompiled from void UpdateGuiDlgFerryLoadContext()
void __cdecl UpdateGuiDlgFerryLoadContext(void) {
  
  char *v0; // eax
  int i; // [esp+0h] [ebp-3Ch]
  int j; // [esp+0h] [ebp-3Ch]
  int k; // [esp+0h] [ebp-3Ch]
  CHAR Str[52]; // [esp+4h] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 1287);
    IGuiEngine::SetText((void *)g_pGUIEngine, 42, 715, v0);
    for ( i = 0; i < 5; ++i )
    {
      _wsprintfA(Str, "%u", dword_3F1E894[i]);
      IGuiEngine::SetText((void *)g_pGUIEngine, 42, dword_368B060[2 * i], Str);
    }
    for ( j = 0; j < 5; ++j )
    {
      _wsprintfA(Str, "%u", dword_3F1E8A8[j]);
      IGuiEngine::SetText((void *)g_pGUIEngine, 42, dword_368B038[2 * j], Str);
    }
    for ( k = 0; k < 2; ++k )
    {
      _wsprintfA(Str, "%u", dword_3F1E8BC[k]);
      IGuiEngine::SetText((void *)g_pGUIEngine, 42, dword_368B088[2 * k], Str);
    }
  }
}


// address=[0x138bd70]
// Decompiled from char __cdecl GuiDlgFerryLoadContextProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgFerryLoadContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-90h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-88h]
  CEvn_Logic *v8; // [esp+14h] [ebp-80h]
  _BYTE v9[32]; // [esp+24h] [ebp-70h] BYREF
  _BYTE v10[32]; // [esp+44h] [ebp-50h] BYREF
  _BYTE v11[32]; // [esp+64h] [ebp-30h] BYREF
  int v12; // [esp+90h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgFerryLoadContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 714:
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v11, 0x1ABu, 0, 0, 0, 0, 0);
          v12 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v12 = -1;
          CEvn_Logic::~CEvn_Logic(v11);
          PlayGuiSound(2);
          break;
        case 730:
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v10, 0x1A1u, 0, 0, 0, 0, 0);
          v12 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v12 = -1;
          CEvn_Logic::~CEvn_Logic(v10);
          PlayGuiSound(2);
          break;
        case 742:
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v9, 0x1A6u, 0, 0, 0, 0, 0);
          v12 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v12 = -1;
          CEvn_Logic::~CEvn_Logic(v9);
          PlayGuiSound(2);
          break;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B09B);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368B09F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x138c100]
// Decompiled from char __cdecl GuiDlgFiguresSubmenuProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgFiguresSubmenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  int LocalPlayerId; // eax
  CPlayerInfo *v7; // eax
  int v8; // [esp+0h] [ebp-138h]
  CEvn_Logic *v9; // [esp+4h] [ebp-134h]
  CEvn_Logic *v10; // [esp+Ch] [ebp-12Ch]
  CEvn_Logic *v11; // [esp+14h] [ebp-124h]
  CEvn_Logic *v12; // [esp+1Ch] [ebp-11Ch]
  CEvn_Logic *v13; // [esp+24h] [ebp-114h]
  CEvn_Logic *v14; // [esp+2Ch] [ebp-10Ch]
  CEvn_Logic *v15; // [esp+34h] [ebp-104h]
  DWORD v16; // [esp+40h] [ebp-F8h]
  _BYTE v17[32]; // [esp+48h] [ebp-F0h] BYREF
  _BYTE v18[32]; // [esp+68h] [ebp-D0h] BYREF
  _BYTE v19[32]; // [esp+88h] [ebp-B0h] BYREF
  _BYTE v20[32]; // [esp+A8h] [ebp-90h] BYREF
  _BYTE v21[32]; // [esp+C8h] [ebp-70h] BYREF
  _BYTE v22[32]; // [esp+E8h] [ebp-50h] BYREF
  _BYTE v23[32]; // [esp+108h] [ebp-30h] BYREF
  int v24; // [esp+134h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 4, 747, 1);
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0x2E9u:
          PlayGuiSound(2);
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x192u, 0, 0, 0, 0, 0);
          v24 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v19);
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x1AFu, 0, 0, 0, 0, 0);
          v24 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v18);
          break;
        case 0x2EAu:
          PlayGuiSound(2);
          v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v21, 0x192u, 0, 0, 0, 0, 0);
          v24 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v21);
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x1AEu, 0, 0, 0, 0, 0);
          v24 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v20);
          break;
        case 0x2EBu:
          dword_3F1E9E4 = 29;
          dword_3F1EA08 = 1;
          *(&dword_3F1EA08 + 2) = 2;
          *(&dword_3F1EA08 + 4) = 3;
          *(&dword_3F1EA08 + 6) = 4;
          *(&dword_3F1EA08 + 8) = 6;
          *(&dword_3F1EA08 + 10) = 12;
          *(&dword_3F1EA08 + 12) = 14;
          *(&dword_3F1EA08 + 14) = 5;
          *(&dword_3F1EA08 + 16) = 13;
          *(&dword_3F1EA08 + 18) = 15;
          *(&dword_3F1EA08 + 20) = 8;
          *(&dword_3F1EA08 + 22) = 7;
          *(&dword_3F1EA08 + 24) = 11;
          *(&dword_3F1EA08 + 26) = 18;
          *(&dword_3F1EA08 + 28) = 9;
          *(&dword_3F1EA08 + 30) = 16;
          *(&dword_3F1EA08 + 32) = 17;
          *(&dword_3F1EA08 + 34) = 10;
          *(&dword_3F1EA08 + 36) = 19;
          *(&dword_3F1EA08 + 38) = 23;
          *(&dword_3F1EA08 + 40) = 56;
          *(&dword_3F1EA08 + 42) = 20;
          *(&dword_3F1EA08 + 50) = 0;
          *(&dword_3F1EA08 + 52) = 50;
          *(&dword_3F1EA08 + 54) = 49;
          *(&dword_3F1EA08 + 56) = 48;
          *(&dword_3F1EA08 + 58) = 47;
          *(&dword_3F1EA08 + 60) = 46;
          *(&dword_3F1EA08 + 62) = 29;
          *(&dword_3F1EA08 + 64) = 32;
          *(&dword_3F1EA08 + 68) = 44;
          *(&dword_3F1EA08 + 70) = 45;
          LocalPlayerId = CPlayerManager::GetLocalPlayerId(v8);
          v7 = CPlayerManager::PlayerInfo(LocalPlayerId);
          v16 = CPlayerInfo::Race(v7);
          switch ( v16 )
          {
            case 1u:
              *(&dword_3F1EA08 + 44) = 25;
              *(&dword_3F1EA08 + 46) = 26;
              *(&dword_3F1EA08 + 48) = 21;
              *(&dword_3F1EA08 + 66) = 38;
              break;
            case 2u:
              *(&dword_3F1EA08 + 44) = 27;
              *(&dword_3F1EA08 + 46) = 28;
              *(&dword_3F1EA08 + 48) = 22;
              *(&dword_3F1EA08 + 66) = 41;
              break;
            case 4u:
              *(&dword_3F1EA08 + 44) = 64;
              *(&dword_3F1EA08 + 46) = 65;
              *(&dword_3F1EA08 + 48) = 22;
              *(&dword_3F1EA08 + 66) = 61;
              break;
            default:
              *(&dword_3F1EA08 + 44) = 24;
              *(&dword_3F1EA08 + 46) = 22;
              *(&dword_3F1EA08 + 48) = 0;
              *(&dword_3F1EA08 + 66) = 35;
              break;
          }
          PlayGuiSound(2);
          v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v23, 0x192u, 0, 0, 0, 0, 0);
          v24 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v23);
          v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v22, 0x1ADu, 0, 0, 0, 0, 0);
          v24 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v22);
          break;
        case 0x2ECu:
          PlayGuiSound(2);
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x192u, 0, 0, 0, 0, 0);
          v24 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v24 = -1;
          CEvn_Logic::~CEvn_Logic(v17);
          if ( g_pGuiMainEvents )
          {
            if ( *(_DWORD *)(g_pGuiMainEvents + 12) != -1 )
            {
              IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 12));
              *(_DWORD *)(g_pGuiMainEvents + 12) = -1;
            }
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 29, GuiDlgSettlerFindMenuProc);
            *(_DWORD *)(g_pGuiMainEvents + 12) = 29;
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B0B8);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368B0B9);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x138cb60]
// Decompiled from char UpdateGuiDlgFreeCarrierMenu()
void __cdecl UpdateGuiDlgFreeCarrierMenu(void) {
  
  char result; // al
  CHAR Str[52]; // [esp+0h] [ebp-38h] BYREF

  if ( !g_pGUIEngine )
    return result;
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 32, 755, byte_3F1EBFC);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 32, 756, byte_3F1EBFC);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 32, 757, byte_3F1EBFC);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 32, 758, byte_3F1EBFC);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 32, 759, byte_3F1EBFC);
  if ( dword_3F1EBD8 <= 0 )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 752, 0);
  }
  else
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 752, 1);
    _wsprintfA(Str, "%u", dword_3F1EBD8);
    IGuiEngine::SetText((void *)g_pGUIEngine, 32, 752, Str);
  }
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 762, 1);
  _wsprintfA(Str, "%u", dword_3F1EBDC);
  IGuiEngine::SetText((void *)g_pGUIEngine, 32, 762, Str);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 772, 1);
  if ( dword_3F1EBE0 >= 0 )
    _wsprintfA(Str, "+%d", dword_3F1EBE0);
  else
    _wsprintfA(Str, "%d", dword_3F1EBE0);
  IGuiEngine::SetText((void *)g_pGUIEngine, 32, 772, Str);
  _wsprintfA(Str, "%d", dword_3F1EBE8);
  IGuiEngine::SetText((void *)g_pGUIEngine, 32, 775, Str);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 763, 1);
  _wsprintfA(Str, "%u", dword_3F1EBEC);
  IGuiEngine::SetText((void *)g_pGUIEngine, 32, 763, Str);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 773, 1);
  if ( dword_3F1EBF0 >= 0 )
    _wsprintfA(Str, "+%d", dword_3F1EBF0);
  else
    _wsprintfA(Str, "%d", dword_3F1EBF0);
  IGuiEngine::SetText((void *)g_pGUIEngine, 32, 773, Str);
  _wsprintfA(Str, "%d", dword_3F1EBF8);
  IGuiEngine::SetText((void *)g_pGUIEngine, 32, 774, Str);
  if ( dword_3F1EBD0 <= 0 )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 766, 0);
  }
  else
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 766, 1);
    _wsprintfA(Str, "%u", dword_3F1EBD0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 32, 766, Str);
  }
  if ( dword_3F1EBD4 <= 0 )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 767, 0);
  }
  else
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 767, 1);
    _wsprintfA(Str, "%u", dword_3F1EBD4);
    IGuiEngine::SetText((void *)g_pGUIEngine, 32, 767, Str);
  }
  if ( byte_3F1EBF4 )
    IGuiEngine::SetImages((void *)g_pGUIEngine, 32, 753, 443, 0);
  else
    IGuiEngine::SetImages((void *)g_pGUIEngine, 32, 753, 502, 0);
  if ( byte_3F1EBE4 )
    return IGuiEngine::SetImages((void *)g_pGUIEngine, 32, 754, 437, 0);
  else
    return IGuiEngine::SetImages((void *)g_pGUIEngine, 32, 754, 500, 0);
  return result;
}


// address=[0x138cf60]
// Decompiled from char __cdecl GuiDlgFreeCarrierMenuProc(int a1, int a2, int a3)
bool __cdecl GuiDlgFreeCarrierMenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-E0h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-D8h]
  CEvn_Logic *v8; // [esp+14h] [ebp-D0h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-C8h]
  CEvn_Logic *v10; // [esp+24h] [ebp-C0h]
  _BYTE v11[32]; // [esp+34h] [ebp-B0h] BYREF
  _BYTE v12[32]; // [esp+54h] [ebp-90h] BYREF
  _BYTE v13[32]; // [esp+74h] [ebp-70h] BYREF
  _BYTE v14[32]; // [esp+94h] [ebp-50h] BYREF
  _BYTE v15[32]; // [esp+B4h] [ebp-30h] BYREF
  int v16; // [esp+E0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      dword_3ECF2BC = 0;
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 32, 755, 0);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 32, 765, 1);
      UpdateGuiDlgFreeCarrierMenu();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 755:
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1BAu, dword_3ECF2BC, 0xFFFFFFFF, 0, 0, 0);
          v16 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          PlayGuiSound(2);
          break;
        case 756:
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1BAu, dword_3ECF2BC, 5u, 0, 0, 0);
          v16 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v14);
          PlayGuiSound(2);
          break;
        case 757:
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1BAu, dword_3ECF2BC, 0xFFFFFFFB, 0, 0, 0);
          v16 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v13);
          PlayGuiSound(2);
          break;
        case 758:
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x1BAu, dword_3ECF2BC, 1u, 0, 0, 0);
          v16 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v12);
          PlayGuiSound(2);
          break;
        case 759:
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v11, 0x1BAu, dword_3ECF2BC, 0xFFFFFFFF, 0, 0, 0);
          v16 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v11);
          PlayGuiSound(2);
          break;
        case 760:
          dword_3ECF2BC = 3;
          break;
        case 761:
          dword_3ECF2BC = 2;
          break;
        case 765:
          dword_3ECF2BC = 1;
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B0BF);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368B0C3);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x138d590]
// Decompiled from void GetGoodSliderVals()
void __cdecl GetGoodSliderVals(void) {
  
  int SliderPosition; // [esp+0h] [ebp-40h]
  int i; // [esp+4h] [ebp-3Ch]
  CHAR Str[52]; // [esp+8h] [ebp-38h] BYREF

  for ( i = 0; i < dword_3F1EE30; ++i )
  {
    SliderPosition = IGuiEngine::GetSliderPosition((IGuiEngine *)g_pGUIEngine, 26, dword_3D8844C[i]);
    if ( SliderPosition < 0 )
      SliderPosition = 0;
    dword_3ECF2C0[i] = SliderPosition;
    _wsprintfA(Str, "%u%%", SliderPosition);
    IGuiEngine::SetText((void *)g_pGUIEngine, 26, dword_3D88438[i], Str);
  }
}


// address=[0x138d640]
// Decompiled from void UpdateGuiDlgGoodDistribution()
void __cdecl UpdateGuiDlgGoodDistribution(void) {
  
  int GuiHouseButtonID; // eax
  char *GuiHouseString; // eax
  int i; // [esp+4h] [ebp-8h]
  bool v3; // [esp+Bh] [ebp-1h]

  if ( g_pGUIEngine )
  {
    v3 = dword_3F1EE30 > 0;
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 26, 776, dword_3F1EE30 > 0);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 26, 777, v3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 26, 2880, v3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 26, 778, v3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 26, 779, v3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 26, 780, v3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 26, 781, v3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 26, 782, v3);
    for ( i = 0; i < 5; ++i )
    {
      if ( i >= dword_3F1EE30 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 26, dword_3D88474[i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 26, dword_3D88438[i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 26, dword_3D8844C[i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 26, dword_3D88460[i], 0);
        IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 26, dword_3D8844C[i], 0);
      }
      else
      {
        dword_3ECF2C0[i] = dword_3F1EE3C[2 * i];
        GuiHouseButtonID = GetGuiHouseButtonID(dword_3F1EE34, dword_3F1EE38[2 * i]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 26, dword_3D88474[i], GuiHouseButtonID, 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 26, dword_3D88474[i], 1);
        GuiHouseString = (char *)GetGuiHouseString(dword_3F1EE34, dword_3F1EE38[2 * i]);
        IGuiEngine::SetText((void *)g_pGUIEngine, 26, dword_3D88438[i], GuiHouseString);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 26, dword_3D88438[i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 26, dword_3D88460[i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 26, dword_3D8844C[i], 1);
        IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 26, dword_3D8844C[i], dword_3F1EE3C[2 * i]);
      }
    }
  }
}


// address=[0x138d8f0]
// Decompiled from char InitGuiDlgGoodDistribution()
void __cdecl InitGuiDlgGoodDistribution(void) {
  
  char result; // al
  int i; // [esp+0h] [ebp-4h]

  if ( !g_pStringEngine )
    return result;
  for ( i = 0; i < 5; ++i )
  {
    dword_3ECF2C0[i] = 0;
    IGuiEngine::SetImages((void *)g_pGUIEngine, 26, dword_3D8844C[i], 287, 337);
  }
  return IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 26, 776, 1);
}


// address=[0x138d970]
// Decompiled from char __cdecl GuiDlgGoodDistributionProc(int a1, int a2, int a3)
bool __cdecl GuiDlgGoodDistributionProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-184h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-17Ch]
  CEvn_Logic *v8; // [esp+14h] [ebp-174h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-16Ch]
  CEvn_Logic *v10; // [esp+24h] [ebp-164h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-15Ch]
  CEvn_Logic *v12; // [esp+34h] [ebp-154h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-14Ch]
  CEvn_Logic *v14; // [esp+44h] [ebp-144h]
  int i; // [esp+50h] [ebp-138h]
  _BYTE v16[32]; // [esp+58h] [ebp-130h] BYREF
  _BYTE v17[32]; // [esp+78h] [ebp-110h] BYREF
  _BYTE v18[32]; // [esp+98h] [ebp-F0h] BYREF
  _BYTE v19[32]; // [esp+B8h] [ebp-D0h] BYREF
  _BYTE v20[32]; // [esp+D8h] [ebp-B0h] BYREF
  _BYTE v21[32]; // [esp+F8h] [ebp-90h] BYREF
  _BYTE v22[32]; // [esp+118h] [ebp-70h] BYREF
  _BYTE v23[32]; // [esp+138h] [ebp-50h] BYREF
  _BYTE v24[32]; // [esp+158h] [ebp-30h] BYREF
  int v25; // [esp+184h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgGoodDistribution();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 2:
      GetGoodSliderVals();
      break;
    case 3:
      if ( (unsigned __int16)a2 > 0x31Fu )
      {
        if ( (unsigned __int16)a2 == 2880 )
        {
          dword_3F1EE68 = -1;
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v22, 0x1B2u, 0x16u, 0, 0, 0, 0);
          v25 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v25 = -1;
          CEvn_Logic::~CEvn_Logic(v22);
          PlayGuiSound(2);
        }
      }
      else if ( (unsigned __int16)a2 >= 0x31Bu )
      {
        GetGoodSliderVals();
        for ( i = 0; i < dword_3F1EE30; ++i )
          dword_3F1EE3C[2 * i] = dword_3ECF2C0[i];
        v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1BDu, 0, 0, 0, 0, 0);
        v25 = 8;
        IEventEngine::SendAMessage(g_pEvnEngine, v6);
        v25 = -1;
        CEvn_Logic::~CEvn_Logic(v16);
        UpdateGuiDlgGoodDistribution();
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 776:
            dword_3F1EE68 = -1;
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v24, 0x1B2u, 0xAu, 0, 0, 0, 0);
            v25 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v25 = -1;
            CEvn_Logic::~CEvn_Logic(v24);
            PlayGuiSound(2);
            break;
          case 777:
            dword_3F1EE68 = -1;
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v23, 0x1B2u, 0x14u, 0, 0, 0, 0);
            v25 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v25 = -1;
            CEvn_Logic::~CEvn_Logic(v23);
            PlayGuiSound(2);
            break;
          case 778:
            dword_3F1EE68 = -1;
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v21, 0x1B2u, 0x10u, 0, 0, 0, 0);
            v25 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v25 = -1;
            CEvn_Logic::~CEvn_Logic(v21);
            PlayGuiSound(2);
            break;
          case 779:
            dword_3F1EE68 = -1;
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x1B2u, 0x24u, 0, 0, 0, 0);
            v25 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v25 = -1;
            CEvn_Logic::~CEvn_Logic(v20);
            PlayGuiSound(2);
            break;
          case 780:
            dword_3F1EE68 = -1;
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x1B2u, 9u, 0, 0, 0, 0);
            v25 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v25 = -1;
            CEvn_Logic::~CEvn_Logic(v19);
            PlayGuiSound(2);
            break;
          case 781:
            dword_3F1EE68 = -1;
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x1B2u, 0x18u, 0, 0, 0, 0);
            v25 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v25 = -1;
            CEvn_Logic::~CEvn_Logic(v18);
            PlayGuiSound(2);
            break;
          case 782:
            dword_3F1EE68 = -1;
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1B2u, 0xBu, 0, 0, 0, 0);
            v25 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v25 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
            PlayGuiSound(2);
            break;
          default:
            return 1;
        }
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B0F5);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368B0F6);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x138e1f0]
// Decompiled from char GoodsoutBarDisplaySubmenu()
void __cdecl GoodsoutBarDisplaySubmenu(void) {
  
  char result; // al
  int i; // [esp+0h] [ebp-4h]
  int j; // [esp+0h] [ebp-4h]

  for ( i = 0; i < 9; ++i )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, dword_3D88498[i], 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, dword_3D884BC[i], 0);
    result = i + 1;
  }
  for ( j = 1; j < 43; ++j )
  {
    result = 16 * j;
    if ( dword_3ECF2F8[4 * j] == dword_3ECF5AC )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, 53, dword_3ECF2FC[4 * j], (char *)&byte_368B454);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, dword_3ECF2FC[4 * j], 1);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, dword_3ECF300[4 * j], 1);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        53,
        dword_3ECF300[4 * j],
        dword_368B0F8[5 * j + 1],
        dword_368B0F8[5 * j + 2]);
      result = IGuiEngine::SetTooltipID(
                 (IGuiEngine *)g_pGUIEngine,
                 53,
                 dword_3ECF300[4 * j],
                 dword_368B0F8[5 * j + 3],
                 dword_368B0F8[5 * j + 4]);
    }
  }
  return result;
}


// address=[0x138e360]
// Decompiled from char UpdateGuiDlgGoodsoutBar()
void __cdecl UpdateGuiDlgGoodsoutBar(void) {
  
  char v1; // [esp+7h] [ebp-3Dh]
  int i; // [esp+8h] [ebp-3Ch]
  CHAR Destination[52]; // [esp+Ch] [ebp-38h] BYREF

  byte_3ECF2D8[0] = 1;
  byte_3ECF2D8[16] = 1;
  byte_3ECF2D8[24] = 1;
  byte_3ECF2D8[8] = 1;
  for ( i = 1; i < 43; ++i )
  {
    if ( byte_3F1E9B4[i] )
    {
      byte_3ECF2D8[8 * dword_3ECF2F8[4 * i]] = 0;
      dword_3ECF304[4 * i] = byte_3F1E9B4[i];
      v1 = 1;
    }
    else
    {
      v1 = 0;
    }
    if ( dword_3ECF2F8[4 * i] == dword_3ECF5AC )
    {
      if ( v1 )
      {
        if ( dword_3ECF304[4 * i] <= 0 || dword_3ECF304[4 * i] >= 100 )
        {
          if ( dword_3ECF304[4 * i] <= 0 )
          {
            j__strcpy_0(Destination, "0");
          }
          else
          {
            j__strcpy_0(Destination, "E");
            Destination[1] = 0;
          }
        }
        else
        {
          _wsprintfA(Destination, "%u", dword_3ECF304[4 * i]);
        }
        IGuiEngine::SetText((void *)g_pGUIEngine, 53, dword_3ECF2FC[4 * i], Destination);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, dword_3ECF2FC[4 * i], 1);
      }
      else
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, dword_3ECF2FC[4 * i], 0);
      }
    }
  }
  if ( byte_3ECF2D8[0] )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, 818, 0);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, 818, 1);
  if ( byte_3ECF2D8[8] )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, 819, 0);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, 819, 1);
  if ( byte_3ECF2D8[16] )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, 820, 0);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, 820, 1);
  if ( byte_3ECF2D8[24] )
    return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, 821, 0);
  else
    return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 53, 821, 1);
}


// address=[0x138e630]
// Decompiled from int InitGuiDlgGoodsoutBar()
void __cdecl InitGuiDlgGoodsoutBar(void) {
  
  int LocalPlayerId; // eax
  int v1; // eax
  int v2; // eax
  int result; // eax
  int v4; // [esp+0h] [ebp-10h]
  int v5; // [esp+0h] [ebp-10h]
  int v6; // [esp+0h] [ebp-10h]
  int v7; // [esp+0h] [ebp-10h]
  int v8; // [esp+4h] [ebp-Ch]
  int v9; // [esp+8h] [ebp-8h]
  int i; // [esp+Ch] [ebp-4h]

  for ( i = 0; i < 43; ++i )
    dword_3ECF300[4 * i] = -1;
  byte_3ECF2D8[0] = 1;
  dword_3ECF2DC[0] = 824;
  byte_3ECF2D8[16] = 1;
  dword_3ECF2DC[4] = 826;
  byte_3ECF2D8[24] = 1;
  dword_3ECF2DC[6] = 827;
  byte_3ECF2D8[8] = 1;
  dword_3ECF2DC[2] = 825;
  LocalPlayerId = CPlayerManager::GetLocalPlayerId(v4);
  v9 = CPlayerManager::Race(LocalPlayerId);
  if ( v9 == 1 )
  {
    byte_3ECF2D9 = 8;
    *(&byte_3ECF2D9 + 16) = 7;
    *(&byte_3ECF2D9 + 24) = 5;
    *(&byte_3ECF2D9 + 8) = 8;
  }
  else if ( v9 == 2 )
  {
    byte_3ECF2D9 = 8;
    *(&byte_3ECF2D9 + 16) = 7;
    *(&byte_3ECF2D9 + 24) = 6;
    *(&byte_3ECF2D9 + 8) = 8;
  }
  else
  {
    byte_3ECF2D9 = 8;
    *(&byte_3ECF2D9 + 16) = 7;
    if ( v9 == 4 )
    {
      *(&byte_3ECF2D9 + 24) = 6;
      *(&byte_3ECF2D9 + 8) = 8;
    }
    else
    {
      *(&byte_3ECF2D9 + 24) = 5;
      *(&byte_3ECF2D9 + 8) = 7;
    }
  }
  dword_3ECF2F8[36] = 1;
  dword_3ECF2FC[36] = 811;
  dword_3ECF300[36] = 829;
  dword_3ECF2F8[44] = 1;
  dword_3ECF2FC[44] = 812;
  dword_3ECF300[44] = 830;
  dword_3ECF2F8[96] = 1;
  dword_3ECF2FC[96] = 813;
  dword_3ECF300[96] = 831;
  dword_3ECF2F8[48] = 1;
  dword_3ECF2FC[48] = 814;
  dword_3ECF300[48] = 832;
  dword_3ECF2F8[64] = 1;
  dword_3ECF2FC[64] = 815;
  dword_3ECF300[64] = 833;
  dword_3ECF2F8[144] = 1;
  dword_3ECF2FC[144] = 816;
  dword_3ECF300[144] = 834;
  v1 = CPlayerManager::GetLocalPlayerId(v5);
  v8 = CPlayerManager::Race(v1);
  switch ( v8 )
  {
    case 1:
      dword_3ECF2F8[92] = 1;
      dword_3ECF2FC[92] = 817;
      dword_3ECF300[92] = 835;
      dword_3ECF2F8[76] = 1;
      dword_3ECF2FC[76] = 822;
      dword_3ECF300[76] = 836;
      break;
    case 2:
      dword_3ECF2F8[140] = 1;
      dword_3ECF2FC[140] = 817;
      dword_3ECF300[140] = 835;
      dword_3ECF2F8[4] = 1;
      dword_3ECF2FC[4] = 822;
      dword_3ECF300[4] = 836;
      break;
    case 4:
      dword_3ECF2F8[164] = 1;
      dword_3ECF2FC[164] = 817;
      dword_3ECF300[164] = 835;
      dword_3ECF2F8[168] = 1;
      dword_3ECF2FC[168] = 822;
      dword_3ECF300[168] = 836;
      break;
    default:
      dword_3ECF2F8[148] = 1;
      dword_3ECF2FC[148] = 817;
      dword_3ECF300[148] = 835;
      break;
  }
  dword_3ECF2F8[136] = 3;
  dword_3ECF2FC[136] = 811;
  dword_3ECF300[136] = 829;
  dword_3ECF2F8[32] = 3;
  dword_3ECF2FC[32] = 812;
  dword_3ECF300[32] = 830;
  dword_3ECF2F8[12] = 3;
  dword_3ECF2FC[12] = 814;
  dword_3ECF300[12] = 832;
  dword_3ECF2F8[132] = 3;
  dword_3ECF2FC[132] = 817;
  dword_3ECF300[132] = 835;
  v2 = CPlayerManager::GetLocalPlayerId(v6);
  v7 = CPlayerManager::Race(v2);
  switch ( v7 )
  {
    case 1:
      dword_3ECF2F8[20] = 3;
      dword_3ECF2FC[20] = 813;
      dword_3ECF300[20] = 831;
      break;
    case 2:
      dword_3ECF2F8[68] = 3;
      dword_3ECF2FC[68] = 822;
      dword_3ECF300[68] = 836;
      dword_3ECF2F8[24] = 3;
      dword_3ECF2FC[24] = 813;
      dword_3ECF300[24] = 831;
      break;
    case 4:
      dword_3ECF2F8[160] = 3;
      dword_3ECF2FC[160] = 822;
      dword_3ECF300[160] = 836;
      dword_3ECF2F8[152] = 3;
      dword_3ECF2FC[152] = 813;
      dword_3ECF300[152] = 831;
      break;
    default:
      dword_3ECF2F8[8] = 3;
      dword_3ECF2FC[8] = 822;
      dword_3ECF300[8] = 836;
      break;
  }
  dword_3ECF2F8[28] = 0;
  dword_3ECF2FC[28] = 812;
  dword_3ECF300[28] = 830;
  dword_3ECF2F8[40] = 0;
  dword_3ECF2FC[40] = 822;
  dword_3ECF300[40] = 836;
  dword_3ECF2F8[56] = 0;
  dword_3ECF2FC[56] = 814;
  dword_3ECF300[56] = 832;
  dword_3ECF2F8[60] = 0;
  dword_3ECF2FC[60] = 817;
  dword_3ECF300[60] = 835;
  dword_3ECF2F8[80] = 0;
  dword_3ECF2FC[80] = 815;
  dword_3ECF300[80] = 833;
  dword_3ECF2F8[84] = 0;
  dword_3ECF2FC[84] = 816;
  dword_3ECF300[84] = 834;
  dword_3ECF2F8[88] = 0;
  dword_3ECF2FC[88] = 811;
  dword_3ECF300[88] = 829;
  dword_3ECF2F8[128] = 0;
  dword_3ECF2FC[128] = 813;
  dword_3ECF300[128] = 831;
  dword_3ECF2F8[72] = 2;
  dword_3ECF2FC[72] = 811;
  dword_3ECF300[72] = 829;
  dword_3ECF2F8[100] = 2;
  dword_3ECF2FC[100] = 816;
  dword_3ECF300[100] = 834;
  dword_3ECF2F8[108] = 2;
  dword_3ECF2FC[108] = 817;
  dword_3ECF300[108] = 835;
  dword_3ECF2F8[112] = 2;
  dword_3ECF2FC[112] = 814;
  dword_3ECF300[112] = 832;
  dword_3ECF2F8[116] = 2;
  dword_3ECF2FC[116] = 815;
  dword_3ECF300[116] = 833;
  dword_3ECF2F8[124] = 2;
  dword_3ECF2FC[124] = 812;
  dword_3ECF300[124] = 830;
  dword_3ECF2F8[16] = 2;
  result = 64;
  dword_3ECF2FC[16] = 813;
  dword_3ECF300[16] = 831;
  return result;
}


// address=[0x138f080]
// Decompiled from int __cdecl GoodsoutBarGoodSelected(int a1)
void __cdecl GoodsoutBarGoodSelected(int a1) {
  
  int result; // eax
  int i; // [esp+0h] [ebp-4h]

  for ( i = 1; i < 43; ++i )
  {
    if ( dword_3ECF2F8[4 * i] == dword_3ECF5AC )
    {
      result = 16 * i;
      if ( a1 == dword_3ECF300[4 * i] )
      {
        dword_3ECF5A8 = i;
        return result;
      }
    }
    result = i + 1;
  }
  dword_3ECF5A8 = 0;
  return result;
}


// address=[0x138f0e0]
// Decompiled from char __cdecl GuiDlgGoodsoutBarProc(int a1, int a2, int a3)
bool __cdecl GuiDlgGoodsoutBarProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-108h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-100h]
  CEvn_Logic *v8; // [esp+14h] [ebp-F8h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-F0h]
  CEvn_Logic *v10; // [esp+24h] [ebp-E8h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-E0h]
  _BYTE v12[32]; // [esp+3Ch] [ebp-D0h] BYREF
  _BYTE v13[32]; // [esp+5Ch] [ebp-B0h] BYREF
  _BYTE v14[32]; // [esp+7Ch] [ebp-90h] BYREF
  _BYTE v15[32]; // [esp+9Ch] [ebp-70h] BYREF
  _BYTE v16[32]; // [esp+BCh] [ebp-50h] BYREF
  _BYTE v17[32]; // [esp+DCh] [ebp-30h] BYREF
  int v18; // [esp+108h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgGoodsoutBar();
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 53, 824, 1);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 805:
          if ( dword_3ECF5A8 )
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1D1u, dword_3ECF5A8, 0x64u, 0, 0, 0);
            v18 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
          }
          PlayGuiSound(2);
          break;
        case 806:
          if ( dword_3ECF5A8 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1D1u, dword_3ECF5A8, 0, 0, 0, 0);
            v18 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v16);
          }
          PlayGuiSound(2);
          break;
        case 807:
          if ( dword_3ECF5A8 )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1D1u, dword_3ECF5A8, 5u, 0, 0, 0);
            v18 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v15);
          }
          PlayGuiSound(2);
          break;
        case 808:
          if ( dword_3ECF5A8 )
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1D1u, dword_3ECF5A8, 0xFFFFFFFB, 0, 0, 0);
            v18 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v14);
          }
          PlayGuiSound(2);
          break;
        case 809:
          if ( dword_3ECF5A8 )
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1D1u, dword_3ECF5A8, 1u, 0, 0, 0);
            v18 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v13);
          }
          PlayGuiSound(2);
          break;
        case 810:
          if ( dword_3ECF5A8 )
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x1D1u, dword_3ECF5A8, 0xFFFFFFFF, 0, 0, 0);
            v18 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v18 = -1;
            CEvn_Logic::~CEvn_Logic(v12);
          }
          PlayGuiSound(2);
          break;
        case 824:
          dword_3ECF5AC = 0;
          GoodsoutBarDisplaySubmenu();
          IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 53, 829, 1);
          dword_3ECF5A8 = 22;
          UpdateGuiDlgGoodsoutBar();
          PlayGuiSound(2);
          break;
        case 825:
          dword_3ECF5AC = (a2 & 0x10000) != 0;
          GoodsoutBarDisplaySubmenu();
          IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 53, 829, 1);
          dword_3ECF5A8 = 9;
          UpdateGuiDlgGoodsoutBar();
          PlayGuiSound(2);
          break;
        case 826:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECF5AC = 2;
          else
            dword_3ECF5AC = 0;
          GoodsoutBarDisplaySubmenu();
          IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 53, 829, 1);
          dword_3ECF5A8 = 18;
          UpdateGuiDlgGoodsoutBar();
          PlayGuiSound(2);
          break;
        case 827:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECF5AC = 3;
          else
            dword_3ECF5AC = 0;
          GoodsoutBarDisplaySubmenu();
          IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 53, 829, 1);
          dword_3ECF5A8 = 34;
          UpdateGuiDlgGoodsoutBar();
          PlayGuiSound(2);
          break;
        case 829:
        case 830:
        case 831:
        case 832:
        case 833:
        case 834:
        case 835:
        case 836:
        case 837:
          if ( (a2 & 0x10000) != 0 )
            GoodsoutBarGoodSelected((unsigned __int16)a2);
          else
            dword_3ECF5A8 = 0;
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B455);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368B456);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x138fca0]
// Decompiled from char UpdateGuiDlgGoodstradeBar()
void __cdecl UpdateGuiDlgGoodstradeBar(void) {
  
  char result; // al
  int v1; // [esp+0h] [ebp-18h]
  int v2; // [esp+8h] [ebp-10h]
  int i; // [esp+10h] [ebp-8h]
  int j; // [esp+10h] [ebp-8h]
  char v5; // [esp+17h] [ebp-1h]

  v1 = 8;
  byte_3ECF91C = 1;
  byte_3ECF648[0] = 1;
  byte_3ECF648[16] = 1;
  byte_3ECF648[24] = 1;
  byte_3ECF648[8] = 1;
  for ( i = 1; i < 43; ++i )
  {
    if ( byte_3F1ED75[i] <= 0 )
    {
      v5 = 0;
    }
    else
    {
      byte_3ECF648[8 * dword_3ECF668[4 * i]] = 0;
      dword_3ECF674[4 * i] = byte_3F1ED75[i];
      v5 = 1;
    }
    if ( dword_3ECF668[4 * i] == dword_3ECF918 )
    {
      if ( v5 )
      {
        if ( (dword_3ECF674[4 * i] & 4) != 0 )
        {
          IGuiEngine::SetImages((void *)g_pGUIEngine, 54, dword_3ECF66C[4 * i], 161, 0);
        }
        else if ( dword_3ECF674[4 * i] == 8 )
        {
          IGuiEngine::SetImages((void *)g_pGUIEngine, 54, dword_3ECF66C[4 * i], 160, 0);
        }
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, dword_3ECF66C[4 * i], 1);
      }
      else
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, dword_3ECF66C[4 * i], 0);
      }
    }
  }
  if ( byte_3ECF648[0] )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, 838, 0);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, 838, 1);
  if ( byte_3ECF648[8] )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, 839, 0);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, 839, 1);
  if ( byte_3ECF648[16] )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, 840, 0);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, 840, 1);
  if ( byte_3ECF648[24] )
    result = IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, 841, 0);
  else
    result = IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, 841, 1);
  for ( j = 0; j < 9; ++j )
  {
    if ( j >= CPlayerManager::NumberOfPlayers() || CPlayerManager::GetLocalPlayerId(v1) == j + 1 )
    {
      result = IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, dword_3D884F0[j], 0);
    }
    else
    {
      v2 = CPlayerManager::Color(j + 1);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        54,
        dword_3D884F0[j],
        dword_3D88510[2 * v2 + 1],
        dword_3D88510[2 * v2]);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 54, dword_3D884F0[j], byte_3F1ED6D[j]);
      result = IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, dword_3D884F0[j], 1);
    }
  }
  byte_3ECF91C = 0;
  return result;
}


// address=[0x1390020]
// Decompiled from char GoodstradeBarDisplaySubmenu()
void __cdecl GoodstradeBarDisplaySubmenu(void) {
  
  char result; // al
  int i; // [esp+0h] [ebp-4h]
  int j; // [esp+0h] [ebp-4h]

  for ( i = 0; i < 9; ++i )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, dword_3D88550[i], 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, dword_3D88574[i], 0);
    result = i + 1;
  }
  for ( j = 0; j < 43; ++j )
  {
    result = 16 * j;
    if ( dword_3ECF668[4 * j] == dword_3ECF918 && dword_3ECF670[4 * j] != -1 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, dword_3ECF66C[4 * j], 1);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 54, dword_3ECF670[4 * j], 1);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        54,
        dword_3ECF670[4 * j],
        dword_368B510[5 * j + 1],
        dword_368B510[5 * j + 2]);
      result = IGuiEngine::SetTooltipID(
                 (IGuiEngine *)g_pGUIEngine,
                 54,
                 dword_3ECF670[4 * j],
                 dword_368B510[5 * j + 3],
                 dword_368B510[5 * j + 4]);
    }
  }
  return result;
}


// address=[0x1390180]
// Decompiled from int InitGuiDlgGoodstradeBar()
void __cdecl InitGuiDlgGoodstradeBar(void) {
  
  int LocalPlayerId; // eax
  int v1; // eax
  int v2; // eax
  int result; // eax
  int v4; // [esp+0h] [ebp-10h]
  int v5; // [esp+0h] [ebp-10h]
  int v6; // [esp+0h] [ebp-10h]
  int v7; // [esp+0h] [ebp-10h]
  int v8; // [esp+4h] [ebp-Ch]
  int v9; // [esp+8h] [ebp-8h]
  int i; // [esp+Ch] [ebp-4h]

  for ( i = 0; i < 43; ++i )
    dword_3ECF670[4 * i] = -1;
  byte_3ECF648[0] = 1;
  dword_3ECF64C[0] = 842;
  byte_3ECF648[16] = 1;
  dword_3ECF64C[4] = 844;
  byte_3ECF648[24] = 1;
  dword_3ECF64C[6] = 845;
  byte_3ECF648[8] = 1;
  dword_3ECF64C[2] = 843;
  LocalPlayerId = CPlayerManager::GetLocalPlayerId(v4);
  v9 = CPlayerManager::Race(LocalPlayerId);
  switch ( v9 )
  {
    case 1:
      byte_3ECF649 = 8;
      *(&byte_3ECF649 + 16) = 7;
      *(&byte_3ECF649 + 24) = 5;
      *(&byte_3ECF649 + 8) = 8;
      break;
    case 2:
LABEL_8:
      byte_3ECF649 = 8;
      *(&byte_3ECF649 + 16) = 7;
      *(&byte_3ECF649 + 24) = 6;
      *(&byte_3ECF649 + 8) = 8;
      break;
    case 4:
      byte_3ECF649 = 8;
      *(&byte_3ECF649 + 16) = 7;
      *(&byte_3ECF649 + 24) = 6;
      *(&byte_3ECF649 + 8) = 8;
      goto LABEL_8;
    default:
      byte_3ECF649 = 8;
      *(&byte_3ECF649 + 16) = 7;
      *(&byte_3ECF649 + 24) = 5;
      *(&byte_3ECF649 + 8) = 7;
      break;
  }
  dword_3ECF668[36] = 1;
  dword_3ECF66C[36] = 854;
  dword_3ECF670[36] = 864;
  dword_3ECF668[44] = 1;
  dword_3ECF66C[44] = 855;
  dword_3ECF670[44] = 865;
  dword_3ECF668[96] = 1;
  dword_3ECF66C[96] = 856;
  dword_3ECF670[96] = 866;
  dword_3ECF668[48] = 1;
  dword_3ECF66C[48] = 857;
  dword_3ECF670[48] = 867;
  dword_3ECF668[64] = 1;
  dword_3ECF66C[64] = 858;
  dword_3ECF670[64] = 868;
  dword_3ECF668[144] = 1;
  dword_3ECF66C[144] = 859;
  dword_3ECF670[144] = 869;
  v1 = CPlayerManager::GetLocalPlayerId(v5);
  v8 = CPlayerManager::Race(v1);
  switch ( v8 )
  {
    case 1:
      dword_3ECF668[92] = 1;
      dword_3ECF66C[92] = 860;
      dword_3ECF670[92] = 870;
      dword_3ECF668[76] = 1;
      dword_3ECF66C[76] = 861;
      dword_3ECF670[76] = 871;
      break;
    case 2:
      dword_3ECF668[140] = 1;
      dword_3ECF66C[140] = 860;
      dword_3ECF670[140] = 870;
      dword_3ECF668[4] = 1;
      dword_3ECF66C[4] = 861;
      dword_3ECF670[4] = 871;
      break;
    case 4:
      dword_3ECF668[164] = 1;
      dword_3ECF66C[164] = 860;
      dword_3ECF670[164] = 870;
      dword_3ECF668[168] = 1;
      dword_3ECF66C[168] = 861;
      dword_3ECF670[168] = 871;
      break;
    default:
      dword_3ECF668[148] = 1;
      dword_3ECF66C[148] = 860;
      dword_3ECF670[148] = 870;
      break;
  }
  dword_3ECF668[136] = 3;
  dword_3ECF66C[136] = 854;
  dword_3ECF670[136] = 864;
  dword_3ECF668[32] = 3;
  dword_3ECF66C[32] = 855;
  dword_3ECF670[32] = 865;
  dword_3ECF668[12] = 3;
  dword_3ECF66C[12] = 857;
  dword_3ECF670[12] = 867;
  dword_3ECF668[132] = 3;
  dword_3ECF66C[132] = 860;
  dword_3ECF670[132] = 870;
  v2 = CPlayerManager::GetLocalPlayerId(v6);
  v7 = CPlayerManager::Race(v2);
  switch ( v7 )
  {
    case 1:
      dword_3ECF668[20] = 3;
      dword_3ECF66C[20] = 856;
      dword_3ECF670[20] = 866;
      break;
    case 2:
      dword_3ECF668[68] = 3;
      dword_3ECF66C[68] = 861;
      dword_3ECF670[68] = 871;
      dword_3ECF668[24] = 3;
      dword_3ECF66C[24] = 856;
      dword_3ECF670[24] = 866;
      break;
    case 4:
      dword_3ECF668[160] = 3;
      dword_3ECF66C[160] = 861;
      dword_3ECF670[160] = 871;
      dword_3ECF668[152] = 3;
      dword_3ECF66C[152] = 856;
      dword_3ECF670[152] = 866;
      break;
    default:
      dword_3ECF668[8] = 3;
      dword_3ECF66C[8] = 861;
      dword_3ECF670[8] = 871;
      break;
  }
  dword_3ECF668[28] = 0;
  dword_3ECF66C[28] = 855;
  dword_3ECF670[28] = 865;
  dword_3ECF668[40] = 0;
  dword_3ECF66C[40] = 861;
  dword_3ECF670[40] = 871;
  dword_3ECF668[56] = 0;
  dword_3ECF66C[56] = 857;
  dword_3ECF670[56] = 867;
  dword_3ECF668[60] = 0;
  dword_3ECF66C[60] = 860;
  dword_3ECF670[60] = 870;
  dword_3ECF668[80] = 0;
  dword_3ECF66C[80] = 858;
  dword_3ECF670[80] = 868;
  dword_3ECF668[84] = 0;
  dword_3ECF66C[84] = 859;
  dword_3ECF670[84] = 869;
  dword_3ECF668[88] = 0;
  dword_3ECF66C[88] = 854;
  dword_3ECF670[88] = 864;
  dword_3ECF668[128] = 0;
  dword_3ECF66C[128] = 856;
  dword_3ECF670[128] = 866;
  dword_3ECF668[72] = 2;
  dword_3ECF66C[72] = 854;
  dword_3ECF670[72] = 864;
  dword_3ECF668[100] = 2;
  dword_3ECF66C[100] = 859;
  dword_3ECF670[100] = 869;
  dword_3ECF668[108] = 2;
  dword_3ECF66C[108] = 860;
  dword_3ECF670[108] = 870;
  dword_3ECF668[112] = 2;
  dword_3ECF66C[112] = 857;
  dword_3ECF670[112] = 867;
  dword_3ECF668[116] = 2;
  dword_3ECF66C[116] = 858;
  dword_3ECF670[116] = 868;
  dword_3ECF668[124] = 2;
  dword_3ECF66C[124] = 855;
  dword_3ECF670[124] = 865;
  dword_3ECF668[16] = 2;
  result = 64;
  dword_3ECF66C[16] = 856;
  dword_3ECF670[16] = 866;
  return result;
}


// address=[0x1390bc0]
// Decompiled from void __cdecl GoodstradeBarGoodSelected(int a1)
void __cdecl GoodstradeBarGoodSelected(int a1) {
  
  CEvn_Logic *v1; // [esp+4h] [ebp-3Ch]
  signed int i; // [esp+Ch] [ebp-34h]
  _BYTE v3[32]; // [esp+10h] [ebp-30h] BYREF
  int v4; // [esp+3Ch] [ebp-4h]

  for ( i = 1; i < 43; ++i )
  {
    if ( dword_3ECF668[4 * i] == dword_3ECF918 && a1 == dword_3ECF670[4 * i] )
    {
      v1 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v3, 0x1D3u, i, 0, 0, 0, 0);
      v4 = 0;
      IEventEngine::SendAMessage(g_pEvnEngine, v1);
      v4 = -1;
      CEvn_Logic::~CEvn_Logic(v3);
      PlayGuiSound(2);
      return;
    }
  }
}


// address=[0x1390ca0]
// Decompiled from char __cdecl GuiDlgGoodstradeBarProc(int a1, int a2, int a3)
bool __cdecl GuiDlgGoodstradeBarProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-160h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-158h]
  CEvn_Logic *v8; // [esp+14h] [ebp-150h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-148h]
  CEvn_Logic *v10; // [esp+24h] [ebp-140h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-138h]
  CEvn_Logic *v12; // [esp+34h] [ebp-130h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-128h]
  _BYTE v14[32]; // [esp+54h] [ebp-110h] BYREF
  _BYTE v15[32]; // [esp+74h] [ebp-F0h] BYREF
  _BYTE v16[32]; // [esp+94h] [ebp-D0h] BYREF
  _BYTE v17[32]; // [esp+B4h] [ebp-B0h] BYREF
  _BYTE v18[32]; // [esp+D4h] [ebp-90h] BYREF
  _BYTE v19[32]; // [esp+F4h] [ebp-70h] BYREF
  _BYTE v20[32]; // [esp+114h] [ebp-50h] BYREF
  _BYTE v21[32]; // [esp+134h] [ebp-30h] BYREF
  int v22; // [esp+160h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgGoodstradeBar();
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 54, 842, 1);
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 842:
          dword_3ECF918 = 0;
          GoodstradeBarDisplaySubmenu();
          UpdateGuiDlgGoodstradeBar();
          PlayGuiSound(2);
          break;
        case 843:
          dword_3ECF918 = (a2 & 0x10000) != 0;
          GoodstradeBarDisplaySubmenu();
          UpdateGuiDlgGoodstradeBar();
          PlayGuiSound(2);
          break;
        case 844:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECF918 = 2;
          else
            dword_3ECF918 = 0;
          goto LABEL_21;
        case 845:
          if ( (a2 & 0x10000) != 0 )
            dword_3ECF918 = 3;
          else
            dword_3ECF918 = 0;
LABEL_21:
          GoodstradeBarDisplaySubmenu();
          UpdateGuiDlgGoodstradeBar();
          PlayGuiSound(2);
          break;
        case 846:
          if ( !byte_3ECF91C )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v21, 0x1E3u, 8u, BYTE2(a2) & 1, 0, 0, 0);
            v22 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v21);
          }
          break;
        case 847:
          if ( !byte_3ECF91C )
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x1E3u, 7u, BYTE2(a2) & 1, 0, 0, 0);
            v22 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v18);
          }
          break;
        case 848:
          if ( !byte_3ECF91C )
          {
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1E3u, 6u, BYTE2(a2) & 1, 0, 0, 0);
            v22 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
          }
          break;
        case 849:
          if ( !byte_3ECF91C )
          {
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1E3u, 5u, BYTE2(a2) & 1, 0, 0, 0);
            v22 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v16);
          }
          break;
        case 850:
          if ( !byte_3ECF91C )
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1E3u, 4u, BYTE2(a2) & 1, 0, 0, 0);
            v22 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v15);
          }
          break;
        case 851:
          if ( !byte_3ECF91C )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1E3u, 3u, BYTE2(a2) & 1, 0, 0, 0);
            v22 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v14);
          }
          break;
        case 852:
          if ( !byte_3ECF91C )
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x1E3u, 2u, BYTE2(a2) & 1, 0, 0, 0);
            v22 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v20);
          }
          break;
        case 853:
          if ( !byte_3ECF91C )
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x1E3u, 1u, BYTE2(a2) & 1, 0, 0, 0);
            v22 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v19);
          }
          break;
        case 864:
        case 865:
        case 866:
        case 867:
        case 868:
        case 869:
        case 870:
        case 871:
        case 872:
          GoodstradeBarGoodSelected((unsigned __int16)a2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B86C);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368B86D);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1391a40]
// Decompiled from int UpdateGuiDlgGroup()
void __cdecl UpdateGuiDlgGroup(void) {
  
  int result; // eax
  int i; // [esp+4h] [ebp-4h]

  if ( g_pGUIEngine )
  {
    for ( i = 0; i < 9; ++i )
    {
      switch ( dword_3F1E764[i] )
      {
        case 0:
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 55, dword_368B91C[i], 0);
          break;
        case 1:
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 55, dword_368B91C[i], 1);
          IGuiEngine::SetImages((void *)g_pGUIEngine, 55, dword_368B91C[i], 355, 0);
          break;
        case 2:
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 55, dword_368B91C[i], 1);
          IGuiEngine::SetImages((void *)g_pGUIEngine, 55, dword_368B91C[i], 354, 0);
          break;
        case 3:
        case 4:
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 55, dword_368B91C[i], 1);
          IGuiEngine::SetImages((void *)g_pGUIEngine, 55, dword_368B91C[i], 356, 0);
          break;
        default:
          break;
      }
      result = i + 1;
    }
  }
  return result;
}


// address=[0x1391bc0]
// Decompiled from char __cdecl GuiDlgGroupProc(int a1, unsigned int a2, unsigned int a3)
bool __cdecl GuiDlgGroupProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+8h] [ebp-450h]
  CEvn_Logic *v7; // [esp+10h] [ebp-448h]
  CEvn_Logic *v8; // [esp+18h] [ebp-440h]
  CEvn_Logic *v9; // [esp+20h] [ebp-438h]
  CEvn_Logic *v10; // [esp+28h] [ebp-430h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-42Ch]
  CEvn_Logic *v12; // [esp+34h] [ebp-424h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-41Ch]
  CEvn_Logic *v14; // [esp+44h] [ebp-414h]
  CEvn_Logic *v15; // [esp+4Ch] [ebp-40Ch]
  CEvn_Logic *v16; // [esp+58h] [ebp-400h]
  CEvn_Logic *v17; // [esp+60h] [ebp-3F8h]
  CEvn_Logic *v18; // [esp+68h] [ebp-3F0h]
  CEvn_Logic *v19; // [esp+70h] [ebp-3E8h]
  CEvn_Logic *v20; // [esp+78h] [ebp-3E0h]
  CEvn_Logic *v21; // [esp+80h] [ebp-3D8h]
  CEvn_Logic *v22; // [esp+88h] [ebp-3D0h]
  CEvn_Logic *v23; // [esp+90h] [ebp-3C8h]
  CEvn_Logic *v24; // [esp+98h] [ebp-3C0h]
  CEvn_Logic *v25; // [esp+A0h] [ebp-3B8h]
  CEvn_Logic *v26; // [esp+A8h] [ebp-3B0h]
  CEvn_Logic *v27; // [esp+B0h] [ebp-3A8h]
  CEvn_Logic *v28; // [esp+B8h] [ebp-3A0h]
  CEvn_Logic *v29; // [esp+C0h] [ebp-398h]
  CEvn_Logic *v30; // [esp+C8h] [ebp-390h]
  CEvn_Logic *v31; // [esp+D0h] [ebp-388h]
  CEvn_Logic *v32; // [esp+D8h] [ebp-380h]
  _BYTE v33[32]; // [esp+E8h] [ebp-370h] BYREF
  _BYTE v34[32]; // [esp+108h] [ebp-350h] BYREF
  _BYTE v35[32]; // [esp+128h] [ebp-330h] BYREF
  _BYTE v36[32]; // [esp+148h] [ebp-310h] BYREF
  _BYTE v37[32]; // [esp+168h] [ebp-2F0h] BYREF
  _BYTE v38[32]; // [esp+188h] [ebp-2D0h] BYREF
  _BYTE v39[32]; // [esp+1A8h] [ebp-2B0h] BYREF
  _BYTE v40[32]; // [esp+1C8h] [ebp-290h] BYREF
  _BYTE v41[32]; // [esp+1E8h] [ebp-270h] BYREF
  _BYTE v42[32]; // [esp+208h] [ebp-250h] BYREF
  _BYTE v43[32]; // [esp+228h] [ebp-230h] BYREF
  _BYTE v44[32]; // [esp+248h] [ebp-210h] BYREF
  _BYTE v45[32]; // [esp+268h] [ebp-1F0h] BYREF
  _BYTE v46[32]; // [esp+288h] [ebp-1D0h] BYREF
  _BYTE v47[32]; // [esp+2A8h] [ebp-1B0h] BYREF
  _BYTE v48[32]; // [esp+2C8h] [ebp-190h] BYREF
  _BYTE v49[32]; // [esp+2E8h] [ebp-170h] BYREF
  _BYTE v50[32]; // [esp+308h] [ebp-150h] BYREF
  _BYTE v51[32]; // [esp+328h] [ebp-130h] BYREF
  _BYTE v52[32]; // [esp+348h] [ebp-110h] BYREF
  _BYTE v53[32]; // [esp+368h] [ebp-F0h] BYREF
  _BYTE v54[32]; // [esp+388h] [ebp-D0h] BYREF
  _BYTE v55[32]; // [esp+3A8h] [ebp-B0h] BYREF
  _BYTE v56[32]; // [esp+3C8h] [ebp-90h] BYREF
  _BYTE v57[32]; // [esp+3E8h] [ebp-70h] BYREF
  _BYTE v58[32]; // [esp+408h] [ebp-50h] BYREF
  _BYTE v59[32]; // [esp+428h] [ebp-30h] BYREF
  int v60; // [esp+454h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgGroup();
      break;
    case 1:
      if ( (S4HiWord(a3) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0x369u:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v58, 0x1D6u, 1u, 0, 0, 0, 0);
            v60 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v58);
          }
          else
          {
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v57, 0x1D8u, 1u, 0, 0, 0, 0);
            v60 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v57);
          }
          PlayGuiSound(2);
          break;
        case 0x36Au:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v56, 0x1D6u, 2u, 0, 0, 0, 0);
            v60 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v56);
          }
          else
          {
            v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v55, 0x1D8u, 2u, 0, 0, 0, 0);
            v60 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v26);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v55);
          }
          PlayGuiSound(2);
          break;
        case 0x36Bu:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v54, 0x1D6u, 3u, 0, 0, 0, 0);
            v60 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v54);
          }
          else
          {
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v53, 0x1D8u, 3u, 0, 0, 0, 0);
            v60 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v53);
          }
          PlayGuiSound(2);
          break;
        case 0x36Cu:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v52, 0x1D6u, 4u, 0, 0, 0, 0);
            v60 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v52);
          }
          else
          {
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v51, 0x1D8u, 4u, 0, 0, 0, 0);
            v60 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v51);
          }
          PlayGuiSound(2);
          break;
        case 0x36Du:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v50, 0x1D6u, 5u, 0, 0, 0, 0);
            v60 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v50);
          }
          else
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v49, 0x1D8u, 5u, 0, 0, 0, 0);
            v60 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v49);
          }
          PlayGuiSound(2);
          break;
        case 0x36Eu:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v48, 0x1D6u, 6u, 0, 0, 0, 0);
            v60 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v48);
          }
          else
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v47, 0x1D8u, 6u, 0, 0, 0, 0);
            v60 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v47);
          }
          PlayGuiSound(2);
          break;
        case 0x36Fu:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v46, 0x1D6u, 7u, 0, 0, 0, 0);
            v60 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v46);
          }
          else
          {
            v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v45, 0x1D8u, 7u, 0, 0, 0, 0);
            v60 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v32);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v45);
          }
          PlayGuiSound(2);
          break;
        case 0x370u:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v44, 0x1D6u, 8u, 0, 0, 0, 0);
            v60 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v31);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v44);
          }
          else
          {
            v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v43, 0x1D8u, 8u, 0, 0, 0, 0);
            v60 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v30);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v43);
          }
          PlayGuiSound(2);
          break;
        case 0x371u:
          if ( (S4HiWord(a3) & 0x10001) != 0 )
          {
            v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v59, 0x1D6u, 9u, 0, 0, 0, 0);
            v60 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v29);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v59);
          }
          else
          {
            v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v42, 0x1D8u, 9u, 0, 0, 0, 0);
            v60 = 17;
            IEventEngine::SendAMessage(g_pEvnEngine, v28);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v42);
          }
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 7:
      switch ( S4LoWord(a2) )
      {
        case 0x369u:
          v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v41, 0x1D9u, 1u, 0, 0, 0, 0);
          v60 = 18;
          IEventEngine::SendAMessage(g_pEvnEngine, v27);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v41);
          PlayGuiSound(2);
          break;
        case 0x36Au:
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v40, 0x1D8u, 2u, 0, 0, 0, 0);
          v60 = 19;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v40);
          PlayGuiSound(2);
          break;
        case 0x36Bu:
          v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v39, 0x1D9u, 3u, 0, 0, 0, 0);
          v60 = 20;
          IEventEngine::SendAMessage(g_pEvnEngine, v25);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v39);
          PlayGuiSound(2);
          break;
        case 0x36Cu:
          v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v38, 0x1D9u, 4u, 0, 0, 0, 0);
          v60 = 21;
          IEventEngine::SendAMessage(g_pEvnEngine, v24);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v38);
          PlayGuiSound(2);
          break;
        case 0x36Du:
          v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v37, 0x1D9u, 5u, 0, 0, 0, 0);
          v60 = 22;
          IEventEngine::SendAMessage(g_pEvnEngine, v23);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v37);
          PlayGuiSound(2);
          break;
        case 0x36Eu:
          v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v36, 0x1D9u, 6u, 0, 0, 0, 0);
          v60 = 23;
          IEventEngine::SendAMessage(g_pEvnEngine, v22);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v36);
          PlayGuiSound(2);
          break;
        case 0x36Fu:
          v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v35, 0x1D9u, 7u, 0, 0, 0, 0);
          v60 = 24;
          IEventEngine::SendAMessage(g_pEvnEngine, v21);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v35);
          PlayGuiSound(2);
          break;
        case 0x370u:
          v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v34, 0x1D9u, 8u, 0, 0, 0, 0);
          v60 = 25;
          IEventEngine::SendAMessage(g_pEvnEngine, v20);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v34);
          PlayGuiSound(2);
          break;
        case 0x371u:
          v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v33, 0x1D9u, 9u, 0, 0, 0, 0);
          v60 = 26;
          IEventEngine::SendAMessage(g_pEvnEngine, v19);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v33);
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B940);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368B941);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1392c60]
// Decompiled from char __cdecl GuiDlgIncomingMessageProc(int a1, int a2, int a3)
bool __cdecl GuiDlgIncomingMessageProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-58h]
  CEvn_Event *v7; // [esp+Ch] [ebp-50h]
  CEvn_Event v8; // [esp+1Ch] [ebp-40h] BYREF
  CEvn_Event v9; // [esp+34h] [ebp-28h] BYREF
  int v10; // [esp+58h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( (unsigned __int16)a2 == 891 )
      {
        v7 = CEvn_Event::CEvn_Event(&v9, 0x269u, 0, 0, 0);
        v10 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v7);
        v10 = -1;
        CEvn_Event::~CEvn_Event(&v9);
        v6 = CEvn_Event::CEvn_Event(&v8, 0x1773u, 1u, 0, 0);
        v10 = 1;
        IEventEngine::SendAMessage(g_pEvnEngine, v6);
        v10 = -1;
        CEvn_Event::~CEvn_Event(&v8);
        PlayGuiSound(2);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B949);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368B94A);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1392ee0]
// Decompiled from int __cdecl GuiDlgLanLobbyJoingame(int a1)
void __cdecl GuiDlgLanLobbyJoingame(int a1) {
  
  int v2; // [esp+4h] [ebp-34h]
  _BYTE v3[24]; // [esp+10h] [ebp-28h] BYREF
  int v4; // [esp+34h] [ebp-4h]

  dword_4030718 = dword_3ECF9B0 + a1;
  PlayGuiSound(2);
  v2 = CEvn_Event::CEvn_Event(60, 0, 0, 0);
  IEventEngine::SendAMessage(v2);
  v4 = -1;
  return CEvn_Event::~CEvn_Event(v3);
}


// address=[0x1392f90]
// Decompiled from void GuiDlgLanLobbyConnectFillList()
void __cdecl GuiDlgLanLobbyConnectFillList(void) {
  
  const wchar_t *v0; // eax
  char *v1; // eax
  int v2; // [esp+8h] [ebp-1B8h]
  int j; // [esp+Ch] [ebp-1B4h]
  int v4; // [esp+14h] [ebp-1ACh]
  int i; // [esp+1Ch] [ebp-1A4h]
  char v6[88]; // [esp+20h] [ebp-1A0h] BYREF
  char v7[28]; // [esp+78h] [ebp-148h] BYREF
  CHAR v8[28]; // [esp+94h] [ebp-12Ch] BYREF
  CHAR Dest[256]; // [esp+B0h] [ebp-110h] BYREF
  int v10; // [esp+1BCh] [ebp-4h]

  String::String((char *)&byte_368B9B2, -1);
  v10 = 0;
  for ( i = 0; i < 8; ++i )
  {
    v4 = i + dword_3ECF9B0;
    if ( i >= dword_4030714 || !dword_403071C )
    {
      for ( j = 0; j < 5; ++j )
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + j], 0);
      continue;
    }
    v0 = (const wchar_t *)std::wstring::c_str(*(_Cnd_internal_imp_t **)(dword_403071C + 4 * v4));
    j__wcstombs(Dest, v0, 0x100u);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i], Dest);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i], 1);
    if ( *(_DWORD *)(*(_DWORD *)(dword_403071C + 4 * v4) + 84) >= *(_DWORD *)(*(_DWORD *)(dword_403071C + 4 * v4) + 88) )
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, dword_368BFE8[5 * i], 0);
    else
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, dword_368BFE8[5 * i], 1);
    if ( !(*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
      && !(*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
    {
      IGuiEngine::EnableControl(
        (IGuiEngine *)g_pGUIEngine,
        2,
        dword_368BFE8[5 * i],
        (*(_BYTE *)(*(_DWORD *)(dword_403071C + 4 * v4) + 106) & 1) == 0);
    }
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v6);
    LOBYTE(v10) = 1;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
      v8,
      *(_DWORD *)(dword_403071C + 4 * v4) + 28);
    LOBYTE(v10) = 2;
    v1 = (char *)std::string::c_str(v8);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 1], v1);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 1], 1);
    _wsprintfA(
      Dest,
      " %d - %d",
      *(_DWORD *)(*(_DWORD *)(dword_403071C + 4 * v4) + 84),
      *(_DWORD *)(*(_DWORD *)(dword_403071C + 4 * v4) + 88));
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 2], Dest);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 2], 1);
    v2 = *(_DWORD *)(*(_DWORD *)(dword_403071C + 4 * v4) + 92);
    if ( v2 )
    {
      if ( v2 == 1 )
      {
        IGuiEngine::SetImages((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 3], 31, 0);
        goto LABEL_19;
      }
      if ( v2 == 2 )
      {
        IGuiEngine::SetImages((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 3], 30, 0);
        goto LABEL_19;
      }
    }
    IGuiEngine::SetImages((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 3], 29, 0);
LABEL_19:
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 3], 1);
    if ( *(_BYTE *)(*(_DWORD *)(dword_403071C + 4 * v4) + 96) )
      IGuiEngine::SetImages((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 4], 89, 0);
    else
      IGuiEngine::SetImages((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 4], 87, 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 2, dword_368BFE8[5 * i + 4], 1);
    LOBYTE(v10) = 1;
    std::string::~string(v8);
    LOBYTE(v10) = 0;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v6);
  }
  v10 = -1;
  String::~String((String *)v7);
}


// address=[0x13934c0]
// Decompiled from void GuiDlgLanLobbyConnectUpdate()
void __cdecl GuiDlgLanLobbyConnectUpdate(void) {
  
  const wchar_t *v0; // eax
  char *v1; // eax
  char *v2; // eax
  int Instance; // [esp+8h] [ebp-130h]
  char v4[28]; // [esp+Ch] [ebp-12Ch] BYREF
  char Dest[256]; // [esp+28h] [ebp-110h] BYREF
  int v6; // [esp+134h] [ebp-4h]

  String::String((char *)&byte_368B9B3, -1);
  v6 = 0;
  if ( dword_403071C )
  {
    v0 = (const wchar_t *)std::wstring::c_str((_Cnd_internal_imp_t *)&unk_4030720);
    j__wcstombs(Dest, v0, 0x100u);
    IGuiEngine::SetTypeAsText((IGuiEngine *)g_pGUIEngine, 2, 2312);
    Instance = UPlay::UPlayManager::GetInstance();
    v1 = (char *)(*(int (__thiscall **)(int))(*(_DWORD *)Instance + 16))(Instance);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 2312, v1);
    v2 = (char *)std::string::c_str(&unk_403073C);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 2313, v2);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 2, 2313, 0);
    GuiDlgLanLobbyConnectFillList();
  }
  v6 = -1;
  String::~String((String *)v4);
}


// address=[0x13935f0]
// Decompiled from void InitGuiDlgLanLobbyConnect()
void __cdecl InitGuiDlgLanLobbyConnect(void) {
  
  char *v0; // eax
  char *v1; // eax
  OnlineManager *Instance; // eax
  char *v3; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 1999);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 2311, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 3838);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 2276, v1);
    Instance = (OnlineManager *)OnlineManager::GetInstance();
    if ( !OnlineManager::IsNATReady(Instance) )
    {
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 2276, 0);
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 2311, 0);
    }
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2102);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 2274, v3);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 2275, "IP");
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 2, 2275, 0);
    IGuiEngine::SetEditProperties((IGuiEngine *)g_pGUIEngine, 2, 2312, 32, 4u);
    IGuiEngine::SetEditProperties((IGuiEngine *)g_pGUIEngine, 2, 2313, 32, 0xCu);
  }
}


// address=[0x1393720]
// Decompiled from char __cdecl GuiDlgLanLobbyConnectMenuProc(int a1, int a2, int a3)
bool __cdecl GuiDlgLanLobbyConnectMenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  CEvn_Event *v5; // [esp+8h] [ebp-290h]
  CEvn_Event *v6; // [esp+10h] [ebp-288h]
  CEvn_Event *v7; // [esp+18h] [ebp-280h]
  char *Str; // [esp+20h] [ebp-278h]
  char *Source; // [esp+28h] [ebp-270h]
  int Instance; // [esp+2Ch] [ebp-26Ch]
  _DWORD v11[6]; // [esp+40h] [ebp-258h] BYREF
  _DWORD v12[6]; // [esp+58h] [ebp-240h] BYREF
  _DWORD v13[6]; // [esp+70h] [ebp-228h] BYREF
  wchar_t Dest[256]; // [esp+88h] [ebp-210h] BYREF
  int v15; // [esp+294h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgLanLobbyConnect();
      GuiDlgLanLobbyConnectUpdate();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 2:
      if ( (unsigned __int16)a2 == 2312 )
      {
        Instance = UPlay::UPlayManager::GetInstance();
        Source = (char *)(*(int (__thiscall **)(int))(*(_DWORD *)Instance + 16))(Instance);
        if ( Source )
        {
          j__mbstowcs(Dest, Source, 0x100u);
          Dest[31] = 0;
          std::wstring::operator=(&unk_4030720, Dest);
          PlayGuiSound(2);
        }
      }
      else if ( (unsigned __int16)a2 == 2313 )
      {
        PlayGuiSound(2);
        Str = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, 2, 2313);
        if ( Str )
          std::string::operator=(&unk_403073C, Str);
      }
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 2273:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event((CEvn_Event *)v13, 0x3Au, 0, 0, 0);
          v15 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v15 = -1;
          CEvn_Event::~CEvn_Event(v13);
          break;
        case 2276:
          PlayGuiSound(2);
          v5 = CEvn_Event::CEvn_Event((CEvn_Event *)v11, 0x3Eu, 0, 0, 0);
          v15 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v5);
          v15 = -1;
          CEvn_Event::~CEvn_Event(v11);
          break;
        case 2277:
          GuiDlgLanLobbyJoingame(0);
          break;
        case 2278:
          GuiDlgLanLobbyJoingame(1);
          break;
        case 2279:
          GuiDlgLanLobbyJoingame(2);
          break;
        case 2280:
          GuiDlgLanLobbyJoingame(3);
          break;
        case 2281:
          GuiDlgLanLobbyJoingame(4);
          break;
        case 2282:
          GuiDlgLanLobbyJoingame(5);
          break;
        case 2283:
          GuiDlgLanLobbyJoingame(6);
          break;
        case 2284:
          GuiDlgLanLobbyJoingame(7);
          break;
        case 2309:
          if ( dword_3ECF9B0 > 0 )
          {
            --dword_3ECF9B0;
            PlayGuiSound(2);
            GuiDlgLanLobbyConnectFillList();
          }
          break;
        case 2310:
          if ( dword_3ECF9B0 + 8 < dword_4030714 )
          {
            ++dword_3ECF9B0;
            PlayGuiSound(2);
            GuiDlgLanLobbyConnectFillList();
          }
          break;
        case 2311:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event((CEvn_Event *)v12, 0x3Du, 0, 0, 0);
          v15 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v15 = -1;
          CEvn_Event::~CEvn_Event(v12);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368B9C7);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 && dword_3ECF9B0 + 8 < dword_4030714 )
        {
          ++dword_3ECF9B0;
          PlayGuiSound(2);
          GuiDlgLanLobbyConnectFillList();
        }
      }
      else if ( dword_3ECF9B0 > 0 )
      {
        --dword_3ECF9B0;
        PlayGuiSound(2);
        GuiDlgLanLobbyConnectFillList();
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1393fd0]
// Decompiled from void InitGuiDlgLoadSave()
void __cdecl InitGuiDlgLoadSave(void) {
  
  char *v0; // eax
  bool v1; // [esp+4h] [ebp-90h]
  int i; // [esp+8h] [ebp-8Ch]
  char v3[88]; // [esp+10h] [ebp-84h] BYREF
  _BYTE v4[28]; // [esp+68h] [ebp-2Ch] BYREF
  int v5; // [esp+90h] [ebp-4h]

  if ( g_pStringEngine )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 33, 927, 0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 33, 914, (char *)&byte_368D8B0);
    if ( !byte_4030398 )
      std::wstring::operator=(&unk_403037C, (wchar_t *)&word_368D8B4);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, 912, 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 33, 913, 0);
    dword_3ECFA2C = 0;
    IGuiEngine::SetEditProperties((IGuiEngine *)g_pGUIEngine, 33, 914, 0x10u, 4u);
    GuiDlgLoadSaveFillList();
    if ( byte_4030398 )
    {
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, 914, 1);
      std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v3);
      v5 = 0;
      std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
        v4,
        &unk_403037C);
      LOBYTE(v5) = 1;
      v0 = (char *)std::string::c_str(v4);
      IGuiEngine::SetText((void *)g_pGUIEngine, 33, 914, v0);
      v1 = g_pGameData && !CGameData::IsLadder(g_pGameData);
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, 912, v1);
      for ( i = 0; i < 10; ++i )
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, dword_368E904[i], 1);
      LOBYTE(v5) = 0;
      std::string::~string(v4);
      v5 = -1;
      std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v3);
    }
  }
}


// address=[0x13941e0]
// Decompiled from char __cdecl GuiDlgLoadSaveUpdateProgress(signed int a1)
void __cdecl GuiDlgLoadSaveUpdateProgress(int a1) {
  
  if ( a1 <= 0 )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 33, 927, 0);
  }
  else
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 33, 927, 1);
    IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 33, 927, a1);
  }
  IGuiEngine::RenderGui((IGuiEngine *)g_pGUIEngine);
  IGfxEngine::RenderFrame((IGfxEngine *)g_pGfxEngine, 0, 0);
  return IGfxEngine::ShowFrame((IGfxEngine *)g_pGfxEngine);
}


// address=[0x1394250]
// Decompiled from int __cdecl GuiDlgLoadSaveNameSelected(int a1)
void __cdecl GuiDlgLoadSaveNameSelected(int a1) {
  
  int result; // eax
  char *v2; // eax
  wchar_t *v3; // eax
  int v4; // [esp+4h] [ebp-8Ch]
  char v5[88]; // [esp+Ch] [ebp-84h] BYREF
  _BYTE v6[28]; // [esp+64h] [ebp-2Ch] BYREF
  int v7; // [esp+8Ch] [ebp-4h]

  result = a1 + dword_3ECFA2C;
  v4 = a1 + dword_3ECFA2C;
  if ( a1 + dword_3ECFA2C >= dword_4030378 )
    return result;
  std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v5);
  v7 = 0;
  std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
    v6,
    *(_DWORD *)(dword_4030374 + 4 * v4) + 28);
  LOBYTE(v7) = 1;
  v2 = (char *)std::string::c_str(v6);
  IGuiEngine::SetText((void *)g_pGUIEngine, 33, 914, v2);
  v3 = (wchar_t *)std::wstring::c_str((_Cnd_internal_imp_t *)(*(_DWORD *)(dword_4030374 + 4 * v4) + 28));
  std::wstring::operator=(&unk_403037C, v3);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, 912, 1);
  LOBYTE(v7) = 0;
  std::string::~string(v6);
  v7 = -1;
  return std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v5);
}


// address=[0x1394370]
// Decompiled from void GuiDlgLoadSaveFillList()
void __cdecl GuiDlgLoadSaveFillList(void) {
  
  char *v0; // eax
  int v1; // [esp+4h] [ebp-90h]
  int i; // [esp+8h] [ebp-8Ch]
  bool v3; // [esp+Fh] [ebp-85h]
  char v4[88]; // [esp+10h] [ebp-84h] BYREF
  _BYTE v5[28]; // [esp+68h] [ebp-2Ch] BYREF
  int v6; // [esp+90h] [ebp-4h]

  if ( g_pGame )
  {
    v3 = dword_4030378 > 10;
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, 925, dword_4030378 > 10);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, 926, v3);
    for ( i = 0; i < 10; ++i )
    {
      v1 = i + dword_3ECFA2C;
      if ( i >= dword_4030378 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 33, dword_368E904[i], 0);
      }
      else
      {
        std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v4);
        v6 = 0;
        std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
          v5,
          *(_DWORD *)(dword_4030374 + 4 * v1) + 28);
        LOBYTE(v6) = 1;
        v0 = (char *)std::string::c_str(v5);
        IGuiEngine::SetText((void *)g_pGUIEngine, 33, dword_368E904[i], v0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 33, dword_368E904[i], 1);
        LOBYTE(v6) = 0;
        std::string::~string(v5);
        v6 = -1;
        std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v4);
      }
    }
  }
}


// address=[0x1394530]
// Decompiled from void UpdateGuiDlgLoadSave()
void __cdecl UpdateGuiDlgLoadSave(void) {
  
  if ( g_pGUIEngine )
    InitGuiDlgLoadSave();
}


// address=[0x1394550]
// Decompiled from char __cdecl GuiDlgLoadSaveProc(int a1, int a2, int a3)
bool __cdecl GuiDlgLoadSaveProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+Ch] [ebp-D8h]
  CEvn_Event *v7; // [esp+14h] [ebp-D0h]
  char *Str; // [esp+1Ch] [ebp-C8h]
  char v9[88]; // [esp+30h] [ebp-B4h] BYREF
  CEvn_Event v10; // [esp+88h] [ebp-5Ch] BYREF
  CEvn_Event v11; // [esp+A0h] [ebp-44h] BYREF
  int v12[7]; // [esp+B8h] [ebp-2Ch] BYREF
  int v13; // [esp+E0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgLoadSave();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 2:
      if ( (unsigned __int16)a2 == 914 )
      {
        PlayGuiSound(2);
        Str = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, 33, 914);
        if ( j__strlen(Str) )
        {
          IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, 912, 1);
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v9);
          v13 = 2;
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::from_bytes(
            (int)v12,
            Str);
          LOBYTE(v13) = 3;
          std::wstring::operator=((int)v12);
          LOBYTE(v13) = 2;
          std::wstring::~wstring(v12);
          v13 = -1;
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v9);
        }
        else
        {
          IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 33, 912, 0);
          std::wstring::operator=(&unk_403037C, (wchar_t *)&word_368D8C4);
        }
      }
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 912:
        case 914:
          if ( (unsigned __int8)std::operator!=<wchar_t>(&unk_403037C, word_368D8B8)
            && (unsigned __int8)std::operator!=<wchar_t>(&unk_403037C, word_368D8BC) )
          {
            if ( byte_4030398 )
            {
              if ( g_pGame && CStateGame::CanSave((CStateGame *)g_pGame) )
                CStateGame::SaveGame((void *)g_pGame, 0);
            }
            else
            {
              v7 = CEvn_Event::CEvn_Event(&v11, 0x29u, 0, 0, 0);
              v13 = 0;
              IEventEngine::SendAMessage(g_pEvnEngine, v7);
              v13 = -1;
              CEvn_Event::~CEvn_Event(&v11);
            }
          }
          PlayGuiSound(2);
          break;
        case 913:
          if ( (unsigned __int8)std::operator!=<wchar_t>(&unk_403037C, word_368D8C0) )
          {
            v6 = CEvn_Event::CEvn_Event(&v10, 0x2Au, 0, 0, 0);
            v13 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v13 = -1;
            CEvn_Event::~CEvn_Event(&v10);
          }
          PlayGuiSound(2);
          break;
        case 915:
          GuiDlgLoadSaveNameSelected(0);
          break;
        case 916:
          GuiDlgLoadSaveNameSelected(1);
          break;
        case 917:
          GuiDlgLoadSaveNameSelected(2);
          break;
        case 918:
          GuiDlgLoadSaveNameSelected(3);
          break;
        case 919:
          GuiDlgLoadSaveNameSelected(4);
          break;
        case 920:
          GuiDlgLoadSaveNameSelected(5);
          break;
        case 921:
          GuiDlgLoadSaveNameSelected(6);
          break;
        case 922:
          GuiDlgLoadSaveNameSelected(7);
          break;
        case 923:
          GuiDlgLoadSaveNameSelected(8);
          break;
        case 924:
          GuiDlgLoadSaveNameSelected(9);
          break;
        case 925:
          if ( dword_3ECFA2C > 0 )
          {
            --dword_3ECFA2C;
            PlayGuiSound(2);
            GuiDlgLoadSaveFillList();
          }
          break;
        case 926:
          if ( dword_3ECFA2C + 10 < dword_4030378 )
          {
            ++dword_3ECFA2C;
            PlayGuiSound(2);
            GuiDlgLoadSaveFillList();
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368D8B1);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368D8B2);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 && dword_3ECFA2C + 10 < dword_4030378 )
        {
          ++dword_3ECFA2C;
          PlayGuiSound(2);
          GuiDlgLoadSaveFillList();
        }
      }
      else if ( dword_3ECFA2C > 0 )
      {
        --dword_3ECFA2C;
        PlayGuiSound(2);
        GuiDlgLoadSaveFillList();
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13950f0]
// Decompiled from char __cdecl GuiDlgLoadSaveSubmenuProc(int a1, int a2, int a3)
bool __cdecl GuiDlgLoadSaveSubmenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-134h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-12Ch]
  CEvn_Logic *v8; // [esp+14h] [ebp-124h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-11Ch]
  CEvn_Logic *v10; // [esp+24h] [ebp-114h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-10Ch]
  CEvn_Logic *v12; // [esp+34h] [ebp-104h]
  _BYTE v13[32]; // [esp+48h] [ebp-F0h] BYREF
  _BYTE v14[32]; // [esp+68h] [ebp-D0h] BYREF
  _BYTE v15[32]; // [esp+88h] [ebp-B0h] BYREF
  _BYTE v16[32]; // [esp+A8h] [ebp-90h] BYREF
  _BYTE v17[32]; // [esp+C8h] [ebp-70h] BYREF
  _BYTE v18[32]; // [esp+E8h] [ebp-50h] BYREF
  _BYTE v19[32]; // [esp+108h] [ebp-30h] BYREF
  int v20; // [esp+134h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 8, 928, 1);
      byte_3ECFA3B = CGameData::GetMode(g_pGameData) == 3;
      if ( (unsigned __int8)std::operator!=<char>(&unk_402C9B4, (char *)&unk_368F798) || byte_3ECFA3B )
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 8, 929, 1);
      else
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 8, 929, 0);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 928:
          PlayGuiSound(2);
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x192u, 0, 0, 0, 0, 0);
          v20 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v19);
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x28u, 0, 0, 0, 0, 0);
          v20 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v18);
          break;
        case 929:
          PlayGuiSound(2);
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x192u, 0, 0, 0, 0, 0);
          v20 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v17);
          if ( byte_3ECFA3B )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1B4u, 0, 0, 0, 0, 0);
            v20 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v20 = -1;
            CEvn_Logic::~CEvn_Logic(v16);
          }
          else if ( g_pGuiMainEvents )
          {
            if ( *(_DWORD *)(g_pGuiMainEvents + 12) != -1 )
            {
              IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 12));
              *(_DWORD *)(g_pGuiMainEvents + 12) = -1;
            }
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 35, (bool (__cdecl *)(int, int, int))GuiDlgBriefingProc);
            *(_DWORD *)(g_pGuiMainEvents + 12) = 35;
          }
          break;
        case 930:
          PlayGuiSound(2);
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x192u, 0, 0, 0, 0, 0);
          v20 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          if ( g_pGuiMainEvents )
          {
            if ( *(_DWORD *)(g_pGuiMainEvents + 12) != -1 )
            {
              IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 12));
              *(_DWORD *)(g_pGuiMainEvents + 12) = -1;
            }
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 34, GuiDlgQuitGameProc);
            *(_DWORD *)(g_pGuiMainEvents + 12) = 34;
          }
          break;
        case 931:
          PlayGuiSound(2);
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x192u, 0, 0, 0, 0, 0);
          v20 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v14);
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1Eu, 0, 0, 0, 0, 0);
          v20 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v13);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368F799);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368F79A);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1395990]
// Decompiled from int UpdateGuiDlgMagicSpellBar()
void __cdecl UpdateGuiDlgMagicSpellBar(void) {
  
  int result; // eax
  int i; // [esp+4h] [ebp-70h]
  CHAR v2[52]; // [esp+8h] [ebp-6Ch] BYREF
  CHAR Str[52]; // [esp+3Ch] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    for ( i = 0; i < 8; ++i )
    {
      _wsprintfA(Str, "%u", dword_3F1EEEC[4 * i]);
      _wsprintfA(v2, "%u", dword_3F1EEF4[4 * i]);
      switch ( dword_3F1EEE8[4 * i] )
      {
        case 0:
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 940, Str);
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 948, v2);
          break;
        case 1:
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 941, Str);
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 949, v2);
          break;
        case 2:
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 942, Str);
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 950, v2);
          break;
        case 3:
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 943, Str);
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 951, v2);
          break;
        case 4:
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 944, Str);
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 952, v2);
          break;
        case 5:
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 945, Str);
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 953, v2);
          break;
        case 6:
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 946, Str);
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 954, v2);
          break;
        case 7:
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 947, Str);
          IGuiEngine::SetText((void *)g_pGUIEngine, 56, 955, v2);
          break;
        default:
          break;
      }
      result = i + 1;
    }
  }
  return result;
}


// address=[0x1395be0]
// Decompiled from char __cdecl GuiDlgMagicSpellBarProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMagicSpellBarProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-298h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-290h]
  CEvn_Logic *v8; // [esp+14h] [ebp-288h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-280h]
  CEvn_Logic *v10; // [esp+20h] [ebp-27Ch]
  CEvn_Logic *v11; // [esp+28h] [ebp-274h]
  CEvn_Logic *v12; // [esp+30h] [ebp-26Ch]
  CEvn_Logic *v13; // [esp+34h] [ebp-268h]
  CEvn_Logic *v14; // [esp+3Ch] [ebp-260h]
  CEvn_Logic *v15; // [esp+44h] [ebp-258h]
  CEvn_Logic *v16; // [esp+4Ch] [ebp-250h]
  CEvn_Logic *v17; // [esp+54h] [ebp-248h]
  CEvn_Logic *v18; // [esp+5Ch] [ebp-240h]
  CEvn_Logic *v19; // [esp+6Ch] [ebp-230h]
  CEvn_Logic *v20; // [esp+74h] [ebp-228h]
  CEvn_Logic *v21; // [esp+7Ch] [ebp-220h]
  _BYTE v22[32]; // [esp+8Ch] [ebp-210h] BYREF
  _BYTE v23[32]; // [esp+ACh] [ebp-1F0h] BYREF
  _BYTE v24[32]; // [esp+CCh] [ebp-1D0h] BYREF
  _BYTE v25[32]; // [esp+ECh] [ebp-1B0h] BYREF
  _BYTE v26[32]; // [esp+10Ch] [ebp-190h] BYREF
  _BYTE v27[32]; // [esp+12Ch] [ebp-170h] BYREF
  _BYTE v28[32]; // [esp+14Ch] [ebp-150h] BYREF
  _BYTE v29[32]; // [esp+16Ch] [ebp-130h] BYREF
  _BYTE v30[32]; // [esp+18Ch] [ebp-110h] BYREF
  _BYTE v31[32]; // [esp+1ACh] [ebp-F0h] BYREF
  _BYTE v32[32]; // [esp+1CCh] [ebp-D0h] BYREF
  _BYTE v33[32]; // [esp+1ECh] [ebp-B0h] BYREF
  _BYTE v34[32]; // [esp+20Ch] [ebp-90h] BYREF
  _BYTE v35[32]; // [esp+22Ch] [ebp-70h] BYREF
  _BYTE v36[32]; // [esp+24Ch] [ebp-50h] BYREF
  _BYTE v37[32]; // [esp+26Ch] [ebp-30h] BYREF
  int v38; // [esp+298h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgMagicSpellBar();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 932:
          if ( (a2 & 0x10000) != 0 )
          {
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v36, 0x1DAu, 0, 0, 0, 0, 0);
            v38 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v36);
          }
          else
          {
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v35, 0x1DAu, 0xFFFFFFFF, 0, 0, 0, 0);
            v38 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v35);
          }
          PlayGuiSound(0);
          break;
        case 933:
          if ( (a2 & 0x10000) != 0 )
          {
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v34, 0x1DAu, 1u, 0, 0, 0, 0);
            v38 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v34);
          }
          else
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v33, 0x1DAu, 0xFFFFFFFF, 0, 0, 0, 0);
            v38 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v33);
          }
          PlayGuiSound(0);
          break;
        case 934:
          if ( (a2 & 0x10000) != 0 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v32, 0x1DAu, 2u, 0, 0, 0, 0);
            v38 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v32);
          }
          else
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v31, 0x1DAu, 0xFFFFFFFF, 0, 0, 0, 0);
            v38 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v31);
          }
          PlayGuiSound(0);
          break;
        case 935:
          if ( (a2 & 0x10000) != 0 )
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v30, 0x1DAu, 3u, 0, 0, 0, 0);
            v38 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v30);
          }
          else
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v29, 0x1DAu, 0xFFFFFFFF, 0, 0, 0, 0);
            v38 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v29);
          }
          PlayGuiSound(0);
          break;
        case 936:
          if ( (a2 & 0x10000) != 0 )
          {
            v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v28, 0x1DAu, 4u, 0, 0, 0, 0);
            v38 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v28);
          }
          else
          {
            v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v37, 0x1DAu, 0xFFFFFFFF, 0, 0, 0, 0);
            v38 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v20);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v37);
          }
          PlayGuiSound(0);
          break;
        case 937:
          if ( (a2 & 0x10000) != 0 )
          {
            v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v27, 0x1DAu, 5u, 0, 0, 0, 0);
            v38 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v19);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v27);
          }
          else
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v26, 0x1DAu, 0xFFFFFFFF, 0, 0, 0, 0);
            v38 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v26);
          }
          PlayGuiSound(0);
          break;
        case 938:
          if ( (a2 & 0x10000) != 0 )
          {
            v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v25, 0x1DAu, 6u, 0, 0, 0, 0);
            v38 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v25);
          }
          else
          {
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v24, 0x1DAu, 0xFFFFFFFF, 0, 0, 0, 0);
            v38 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v24);
          }
          PlayGuiSound(0);
          break;
        case 939:
          if ( (a2 & 0x10000) != 0 )
          {
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v23, 0x1DAu, 7u, 0, 0, 0, 0);
            v38 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v23);
          }
          else
          {
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v22, 0x1DAu, 0xFFFFFFFF, 0, 0, 0, 0);
            v38 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v38 = -1;
            CEvn_Logic::~CEvn_Logic(v22);
          }
          PlayGuiSound(0);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368F79F);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368F7A3);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13966b0]
// Decompiled from void InitGuiDlgMain3x3Campaign()
void __cdecl InitGuiDlgMain3x3Campaign(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  int v10; // [esp+0h] [ebp-Ch]
  int v11; // [esp+4h] [ebp-8h]
  int v12; // [esp+8h] [ebp-4h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2324);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2036, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2103);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2038, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2104);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2039, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2105);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2040, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2036);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2041, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2037);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2042, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 2038);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2043, v6);
    v7 = g_pStringEngine->GetString(g_pStringEngine, 2065);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2044, v7);
    v8 = g_pStringEngine->GetString(g_pStringEngine, 2066);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2045, v8);
    v9 = g_pStringEngine->GetString(g_pStringEngine, 2067);
    IGuiEngine::SetText((void *)g_pGUIEngine, 8, 2046, v9);
    v12 = dword_402CBBC[1];
    if ( v12 )
    {
      if ( v12 != 1 )
      {
LABEL_7:
        v11 = dword_402CBBC[3];
        if ( v11 )
        {
          if ( v11 != 1 )
          {
LABEL_12:
            v10 = dword_402CBBC[2];
            if ( v10 )
            {
              if ( v10 != 1 )
                return;
            }
            else
            {
              IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 8, 2039, 0);
            }
            IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 8, 2040, 0);
            return;
          }
        }
        else
        {
          IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 8, 2042, 0);
        }
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 8, 2043, 0);
        goto LABEL_12;
      }
    }
    else
    {
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 8, 2045, 0);
    }
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 8, 2046, 0);
    goto LABEL_7;
  }
}


// address=[0x1396950]
// Decompiled from char __cdecl GuiDlgMain3x3CampaignProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgMain3x3CampaignProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-158h]
  CEvn_Event *v7; // [esp+Ch] [ebp-150h]
  CEvn_Event *v8; // [esp+14h] [ebp-148h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-140h]
  CEvn_Event *v10; // [esp+24h] [ebp-138h]
  CEvn_Event *v11; // [esp+2Ch] [ebp-130h]
  CEvn_Event *v12; // [esp+34h] [ebp-128h]
  CEvn_Event *v13; // [esp+3Ch] [ebp-120h]
  CEvn_Event *v14; // [esp+44h] [ebp-118h]
  CEvn_Event *v15; // [esp+4Ch] [ebp-110h]
  CEvn_Event v16; // [esp+5Ch] [ebp-100h] BYREF
  CEvn_Event v17; // [esp+74h] [ebp-E8h] BYREF
  CEvn_Event v18; // [esp+8Ch] [ebp-D0h] BYREF
  CEvn_Event v19; // [esp+A4h] [ebp-B8h] BYREF
  CEvn_Event v20; // [esp+BCh] [ebp-A0h] BYREF
  CEvn_Event v21; // [esp+D4h] [ebp-88h] BYREF
  CEvn_Event v22; // [esp+ECh] [ebp-70h] BYREF
  CEvn_Event v23; // [esp+104h] [ebp-58h] BYREF
  CEvn_Event v24; // [esp+11Ch] [ebp-40h] BYREF
  CEvn_Event v25; // [esp+134h] [ebp-28h] BYREF
  int v26; // [esp+158h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMain3x3Campaign();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 2037:
          PlayGuiSound(2);
          v15 = CEvn_Event::CEvn_Event(&v25, 0x67u, 0, 0, 0);
          v26 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v25);
          break;
        case 2038:
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v24, 0x66u, 0, 1u, 0);
          v26 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v24);
          break;
        case 2039:
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v23, 0x66u, 1u, 1u, 0);
          v26 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v23);
          break;
        case 2040:
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v22, 0x66u, 2u, 1u, 0);
          v26 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v22);
          break;
        case 2041:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v21, 0x66u, 0, 2u, 0);
          v26 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v21);
          break;
        case 2042:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v20, 0x66u, 1u, 2u, 0);
          v26 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v20);
          break;
        case 2043:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v19, 0x66u, 2u, 2u, 0);
          v26 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v19);
          break;
        case 2044:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v18, 0x66u, 0, 0, 0);
          v26 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v18);
          break;
        case 2045:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v17, 0x66u, 1u, 0, 0);
          v26 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          break;
        case 2046:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v16, 0x66u, 2u, 0, 0);
          v26 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v26 = -1;
          CEvn_Event::~CEvn_Event(&v16);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368F7A5);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368F7A6);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13970b0]
// Decompiled from char InitGuiDlgMainBarExt1()
void __cdecl InitGuiDlgMainBarExt1(void) {
  
  char result; // al

  if ( !g_pStringEngine )
    return result;
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 622, "0");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 623, "0");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 624, "0");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 625, "0");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 630, "0");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 631, "0");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 632, "0");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 633, "0");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 637, "0%");
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 638, "0%");
  return IGuiEngine::SetText((void *)g_pGUIEngine, 1, 639, "0");
}


// address=[0x13971c0]
// Decompiled from char UpdateGuiDlgMainBarExt1()
void __cdecl UpdateGuiDlgMainBarExt1(void) {
  
  CHAR Str[52]; // [esp+0h] [ebp-38h] BYREF

  _wsprintfA(Str, "%u", dword_3F1E63C);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 622, Str);
  _wsprintfA(Str, "%u", dword_3F1E640);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 623, Str);
  _wsprintfA(Str, "%u", dword_3F1E648);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 624, Str);
  _wsprintfA(Str, "%u", dword_3F1E644);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 625, Str);
  _wsprintfA(Str, "%u", dword_3F1E64C);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 630, Str);
  _wsprintfA(Str, "%u", dword_3F1E634);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 631, Str);
  _wsprintfA(Str, "%u", dword_3F1E638);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 632, Str);
  _wsprintfA(Str, "%u", dword_3F1E650);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 633, Str);
  _wsprintfA(Str, "%u%%", dword_3F1E654);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 637, Str);
  _wsprintfA(Str, "%u%%", dword_3F1E658);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 638, Str);
  _wsprintfA(Str, "%u", dword_3F1E65C);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 1, 639, Str);
}


// address=[0x13973e0]
// Decompiled from char __cdecl GuiDlgMainBarExt1Proc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainBarExt1Proc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainBarExt1();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368F7AA);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368F7AB);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1397600]
// Decompiled from void InitGuiDlgMainBarExt2()
void __cdecl InitGuiDlgMainBarExt2(void) {
  
  if ( g_pStringEngine )
  {
    g_uCamWndEntityId = 0;
    g_iCamWndUniqueId = 0;
    pCamWndEntity = 0;
    g_iCamWndScale = 24;
    IGfxEngine::SetCameraTriangleSize((IGfxEngine *)g_pGfxEngine, 1572864);
  }
}


// address=[0x1397650]
// Decompiled from char __cdecl GuiDlgMainBarExt2Proc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainBarExt2Proc(int a1, int a2, int a3) {
  
  CPlayerInfo *v4; // eax
  pairNode *v5; // eax
  char *v6; // eax
  char *v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // [esp-8h] [ebp-94h]
  int v10; // [esp+0h] [ebp-8Ch]
  CEvn_Event *v11; // [esp+4h] [ebp-88h]
  CEvn_Event *v12; // [esp+Ch] [ebp-80h]
  CEvn_Logic *v13; // [esp+18h] [ebp-74h]
  int LocalPlayerId; // [esp+20h] [ebp-6Ch]
  _BYTE v15[32]; // [esp+2Ch] [ebp-60h] BYREF
  CEvn_Event v16; // [esp+4Ch] [ebp-40h] BYREF
  CEvn_Event v17; // [esp+64h] [ebp-28h] BYREF
  int v18; // [esp+88h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      LocalPlayerId = CPlayerManager::GetLocalPlayerId(v10);
      v4 = CPlayerManager::PlayerInfo(LocalPlayerId);
      g_iCamWndX = CPlayerInfo::StartX(v4);
      v5 = (pairNode *)CPlayerManager::PlayerInfo(LocalPlayerId);
      g_iCamWndY = CPlayerInfo::StartY(v5);
      InitGuiDlgMainBarExt2();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 642:
          v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1E7u, 0, 0, 0, 0, 0);
          v18 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v18 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          break;
        case 643:
          g_iCamWndScale = 10;
          IGfxEngine::SetCameraTriangleSize((IGfxEngine *)g_pGfxEngine, 655360);
          break;
        case 644:
          g_iCamWndScale = 24;
          IGfxEngine::SetCameraTriangleSize((IGfxEngine *)g_pGfxEngine, 1572864);
          break;
        case 645:
          g_iCamWndScale = 48;
          IGfxEngine::SetCameraTriangleSize((IGfxEngine *)g_pGfxEngine, 3145728);
          break;
        default:
          return 1;
      }
      break;
    case 7:
      if ( (unsigned __int16)a2 == 642 )
      {
        if ( CMapObjectMgr::GetUniqueId((unsigned __int16)g_uCamWndEntityId) == g_iCamWndUniqueId )
        {
          pCamWndEntity = (int)CMapObjectMgr::EntityPtr((unsigned __int16)g_uCamWndEntityId);
          if ( !CMapObjectMgr::GetUniqueId((unsigned __int16)g_uCamWndEntityId) )
            pCamWndEntity = 0;
        }
        if ( pCamWndEntity )
        {
          v9 = IEntity::X((_DWORD *)pCamWndEntity);
          v8 = IEntity::Y((void *)pCamWndEntity);
          v12 = CEvn_Event::CEvn_Event(&v17, 0x13u, v8, v9, 0);
          v18 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v17);
        }
        else
        {
          v11 = CEvn_Event::CEvn_Event(&v16, 0x13u, g_iCamWndY, g_iCamWndX, 0);
          v18 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v16);
        }
      }
      goto LABEL_26;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368F81A);
      }
      else
      {
        v6 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v6);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368F81B);
      }
      else
      {
        v7 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v7);
      }
      break;
    case 11:
LABEL_26:
      IGfxEngine::EnableCameraWindow((IGfxEngine *)g_pGfxEngine, 1, 16, 818, 174, 190);
      IGfxEngine::SetCameraTriangleSize((IGfxEngine *)g_pGfxEngine, g_iCamWndScale << 16);
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1397b60]
// Decompiled from char InitGuiDlgMainBriefing()
void __cdecl InitGuiDlgMainBriefing(void) {
  
  int v0; // eax
  char result; // al
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax

  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 10, 2072, 0);
  v0 = std::string::c_str(&unk_402C998);
  result = CScrollMultiline::SetText(s_cScrolltext, v0);
  if ( !g_pStringEngine )
    return result;
  v2 = g_pStringEngine->GetString(g_pStringEngine, 880);
  IGuiEngine::SetText((void *)g_pGUIEngine, 10, 2054, v2);
  v3 = (char *)std::string::c_str(&unk_402C97C);
  IGuiEngine::SetText((void *)g_pGUIEngine, 10, 2068, v3);
  v4 = (char *)std::string::c_str(&unk_402C9B4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 10, 2069, v4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 10, 2074, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 10, 2075, 0);
  IGuiEngine::SetImages((void *)g_pGUIEngine, 10, 2074, dword_368F820[12 * dword_402C9EC - 12 + dword_402C9F0], 0);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 10, 2058, (char *)&byte_368F8E0);
}


// address=[0x1397c70]
// Decompiled from char __cdecl GuiDlgMainBriefingProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainBriefingProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  CEvn_Event *v7; // [esp+4h] [ebp-7Ch]
  CEvn_Event *v8; // [esp+Ch] [ebp-74h]
  CEvn_Event *v9; // [esp+14h] [ebp-6Ch]
  CEvn_Event v10; // [esp+28h] [ebp-58h] BYREF
  CEvn_Event v11; // [esp+40h] [ebp-40h] BYREF
  CEvn_Event v12; // [esp+58h] [ebp-28h] BYREF
  int v13; // [esp+7Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainBriefing();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 2055:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v11, 0x70u, 0, 0, 0);
          v13 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v13 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        case 2056:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v10, 0x71u, 0, 0, 0);
          v13 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v13 = -1;
          CEvn_Event::~CEvn_Event(&v10);
          break;
        case 2070:
          goto LABEL_15;
        case 2071:
          CScrollMultiline::ScrollDown(s_cScrolltext);
          break;
        case 2073:
          if ( (a2 & 0x10000) != 0 )
          {
            v6 = (char *)std::string::c_str(&unk_402C9D0);
            IGuiEngine::SetText((void *)g_pGUIEngine, 10, 2058, v6);
            if ( byte_402C9F4 )
            {
              IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 10, 2074, 1);
            }
            else
            {
              IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 10, 2075, 1);
              byte_402C9F5 = 1;
            }
          }
          else
          {
            IGuiEngine::SetText((void *)g_pGUIEngine, 10, 2058, (char *)&byte_368F8E3);
            if ( byte_402C9F4 )
            {
              IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 10, 2074, 0);
            }
            else
            {
              IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 10, 2075, 0);
              byte_402C9F5 = 0;
            }
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368F8E1);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368F8E2);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 )
          CScrollMultiline::ScrollDown(s_cScrolltext);
      }
      else
      {
LABEL_15:
        CScrollMultiline::ScrollUp(s_cScrolltext);
      }
      break;
    case 11:
      v9 = CEvn_Event::CEvn_Event(&v12, 0x78u, 0, 0, 0);
      v13 = 0;
      IEventEngine::SendAMessage(g_pEvnEngine, v9);
      v13 = -1;
      CEvn_Event::~CEvn_Event(&v12);
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1398150]
// Decompiled from void GuiDlgMainCreditsInitText()
void __cdecl GuiDlgMainCreditsInitText(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  int v3; // [esp+0h] [ebp-8h]
  char v4; // [esp+5h] [ebp-3h]
  char v5; // [esp+6h] [ebp-2h]
  char v6; // [esp+7h] [ebp-1h]

  if ( g_pStringEngine )
  {
    v4 = (*(int (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2);
    v5 = (*(int (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn);
    v6 = (*(int (__thiscall **)(int))(*(_DWORD *)g_pMissionCD + 4))(g_pMissionCD);
    if ( v4 )
    {
      v3 = 0;
    }
    else if ( v5 )
    {
      v3 = 24;
    }
    else if ( v6 )
    {
      v3 = 63;
    }
    else
    {
      v3 = 101;
    }
    if ( dword_3ED03F4 >= 0 )
      ++dword_3ED03F4;
    else
      dword_3ED03F4 = v3;
    if ( dword_3ED03F4 >= 24 && dword_3ED03F4 < 63 && !v5 )
      dword_3ED03F4 = 63;
    if ( dword_3ED03F4 >= 63 && dword_3ED03F4 < 101 && !v6 )
      dword_3ED03F4 = 101;
    if ( dword_3ED03F4 == 62 && v6 )
      ++dword_3ED03F4;
    if ( dword_3ED03F4 >= 158 )
      dword_3ED03F4 = v3;
    if ( dword_3D885C0[4 * dword_3ED03F4] <= 0 )
    {
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 17, 2076, 16);
      IGuiEngine::SetText((void *)g_pGUIEngine, 17, 2077, (char *)&byte_368F90E);
    }
    else
    {
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 17, 2076, 15);
      v0 = g_pStringEngine->GetString(g_pStringEngine, dword_3D885C0[4 * dword_3ED03F4]);
      IGuiEngine::SetText((void *)g_pGUIEngine, 17, 2077, v0);
    }
    if ( dword_3D885C4[4 * dword_3ED03F4] <= 0 )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, 17, 2078, (char *)&byte_368F90F);
    }
    else
    {
      v1 = g_pStringEngine->GetString(g_pStringEngine, dword_3D885C4[4 * dword_3ED03F4]);
      IGuiEngine::SetText((void *)g_pGUIEngine, 17, 2078, v1);
    }
    v2 = g_pStringEngine->GetString(g_pStringEngine, dword_3D885C8[4 * dword_3ED03F4]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 17, 2076, v2);
  }
}


// address=[0x13983a0]
// Decompiled from char GuiDlgMainCreditsBottomProc()
bool __cdecl GuiDlgMainCreditsBottomProc(int,int,int) {
  
  return 1;
}


// address=[0x13983b0]
// Decompiled from char GuiDlgMainCreditsTopProc()
bool __cdecl GuiDlgMainCreditsTopProc(int,int,int) {
  
  return 1;
}


// address=[0x13983c0]
// Decompiled from char __cdecl GuiDlgMainCreditsPaperProc(int a1)
bool __cdecl GuiDlgMainCreditsPaperProc(int a1, int a2, int a3) {
  
  if ( a1 )
    return 1;
  IGuiEngine::SetText((void *)g_pGUIEngine, 17, 2076, " ");
  IGuiEngine::SetText((void *)g_pGUIEngine, 17, 2078, " ");
  dword_3ED03F4 = -1;
  GuiDlgMainCreditsInitText();
  return 1;
}


// address=[0x1398420]
// Decompiled from int __cdecl ConvertXCoord(int a1, const struct SGuiRect *a2)
int __cdecl ConvertXCoord(int a1, struct SGuiRect const & a2) {
  
  return (int)(float)((float)((float)((float)*((int *)a2 + 2) - (float)*(int *)a2)
                            * (float)((float)a1 / *(float *)&dword_3D8919C))
                    + 0.5);
}


// address=[0x1398480]
// Decompiled from int __cdecl ConvertYCoord(int a1, const struct SGuiRect *a2)
int __cdecl ConvertYCoord(int a1, struct SGuiRect const & a2) {
  
  return (int)(float)((float)((float)((float)*((int *)a2 + 3) - (float)*((int *)a2 + 1))
                            * (float)((float)a1 / *(float *)&dword_3D891A0))
                    + 0.5);
}


// address=[0x13984e0]
// Decompiled from char ApplyCreditYPosToDialogs()
void __cdecl ApplyCreditYPosToDialogs(void) {
  
  int v1; // [esp+0h] [ebp-2Ch]
  int v2; // [esp+4h] [ebp-28h]
  int v3; // [esp+8h] [ebp-24h]
  int v4; // [esp+Ch] [ebp-20h]
  int v5; // [esp+10h] [ebp-1Ch]
  int v6; // [esp+14h] [ebp-18h]
  _BYTE v7[16]; // [esp+18h] [ebp-14h] BYREF

  IGuiEngine::GetDialogRenderRect((IGuiEngine *)g_pGUIEngine, 14, (struct SGuiRect *)v7);
  v5 = ConvertXCoord(100, (const struct SGuiRect *)v7);
  v6 = ConvertYCoord(dword_3ED03E0 + 20, (const struct SGuiRect *)v7);
  v3 = ConvertXCoord(123, (const struct SGuiRect *)v7);
  v4 = ConvertYCoord(dword_3ED03E0 + 74, (const struct SGuiRect *)v7);
  v1 = ConvertXCoord(87, (const struct SGuiRect *)v7);
  v2 = ConvertYCoord(510, (const struct SGuiRect *)v7);
  IGuiEngine::MoveDialogTo((IGuiEngine *)g_pGUIEngine, 16, v5, v6);
  IGuiEngine::MoveDialogTo((IGuiEngine *)g_pGUIEngine, 17, v3, v4);
  return IGuiEngine::MoveDialogTo((IGuiEngine *)g_pGUIEngine, 15, v1, v2);
}


// address=[0x13985d0]
// Decompiled from char UpdateGuiDlgMainCredits()
void __cdecl UpdateGuiDlgMainCredits(void) {
  
  if ( dword_3ED03F0 <= 0 )
  {
    if ( ++dword_3ED03E8 >= 15 )
    {
      *(float *)&dword_3D891A4 = *(float *)&dword_3D891A4 - 1.3;
      if ( *(float *)&dword_3D891A4 < 1.0 )
        dword_3D891A4 = LODWORD(FLOAT_1_0);
    }
    else
    {
      dword_3D891A4 = LODWORD(FLOAT_20_0);
    }
    dword_3ED03E0 += dword_3ED03E4 * (int)*(float *)&dword_3D891A4;
    if ( dword_3ED03E0 >= 1 )
    {
      if ( dword_3ED03E0 > 440 )
      {
        dword_3ED03E8 = dword_3ED03EC;
        dword_3ED03E0 = 440;
      }
    }
    else
    {
      dword_3ED03E0 = 1;
    }
    if ( dword_3ED03E8 >= dword_3ED03EC )
    {
      dword_3ED03E8 = 0;
      dword_3ED03E4 = -dword_3ED03E4;
      dword_3ED03F0 = dword_3D885CC[4 * dword_3ED03F4] >> 1;
      if ( dword_3ED03E0 >= 440 )
      {
        dword_3ED03F0 = 20;
        GuiDlgMainCreditsInitText();
      }
    }
  }
  else
  {
    --dword_3ED03F0;
  }
  return ApplyCreditYPosToDialogs();
}


// address=[0x1398700]
// Decompiled from char __cdecl GuiDlgMainCreditsProc(int a1, int a2, unsigned int a3)
bool __cdecl GuiDlgMainCreditsProc(int a1, int a2, int a3) {
  
  char *v4; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      dword_3ED03F0 = 60;
      dword_3ED03F4 = 0;
      dword_3ED03E0 = 440;
      dword_3ED03E4 = -2;
      dword_3ED03E8 = 0;
      dword_3ED03EC = 100;
      ApplyCreditYPosToDialogs();
      break;
    case 1:
      if ( (S4HiWord(a3) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 8:
      IGuiEngine::SetTooltip((char *)&byte_368F912);
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368F913);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v4);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13989d0]
// Decompiled from void InitGuiDlgMainDarktribeCampaign()
void __cdecl InitGuiDlgMainDarktribeCampaign(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2264);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2079, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 792);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2081, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 793);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2082, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 796);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2083, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 797);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2084, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 798);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2085, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 799);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2086, v6);
    v7 = g_pStringEngine->GetString(g_pStringEngine, 3739);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2087, v7);
    v8 = g_pStringEngine->GetString(g_pStringEngine, 3740);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2088, v8);
    v9 = g_pStringEngine->GetString(g_pStringEngine, 3741);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2089, v9);
    v10 = g_pStringEngine->GetString(g_pStringEngine, 3742);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2090, v10);
    v11 = g_pStringEngine->GetString(g_pStringEngine, 3743);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2091, v11);
    v12 = g_pStringEngine->GetString(g_pStringEngine, 3744);
    IGuiEngine::SetText((void *)g_pGUIEngine, 9, 2092, v12);
    switch ( dword_402CBBC[4] )
    {
      case 0:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2082, 0);
        goto LABEL_4;
      case 1:
LABEL_4:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2083, 0);
        goto LABEL_5;
      case 2:
LABEL_5:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2084, 0);
        goto LABEL_6;
      case 3:
LABEL_6:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2085, 0);
        goto LABEL_7;
      case 4:
LABEL_7:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2086, 0);
        goto LABEL_8;
      case 5:
LABEL_8:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2087, 0);
        goto LABEL_9;
      case 6:
LABEL_9:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2088, 0);
        goto LABEL_10;
      case 7:
LABEL_10:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2089, 0);
        goto LABEL_11;
      case 8:
LABEL_11:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2090, 0);
        goto LABEL_12;
      case 9:
LABEL_12:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2091, 0);
        goto LABEL_13;
      case 10:
LABEL_13:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 9, 2092, 0);
        break;
      default:
        return;
    }
  }
}


// address=[0x1398d50]
// Decompiled from char __cdecl GuiDlgMainDarktribeCampaignProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgMainDarktribeCampaignProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+Ch] [ebp-1B0h]
  CEvn_Event *v7; // [esp+14h] [ebp-1A8h]
  CEvn_Event *v8; // [esp+1Ch] [ebp-1A0h]
  CEvn_Event *v9; // [esp+24h] [ebp-198h]
  CEvn_Event *v10; // [esp+2Ch] [ebp-190h]
  CEvn_Event *v11; // [esp+34h] [ebp-188h]
  CEvn_Event *v12; // [esp+38h] [ebp-184h]
  CEvn_Event *v13; // [esp+40h] [ebp-17Ch]
  CEvn_Event *v14; // [esp+48h] [ebp-174h]
  CEvn_Event *v15; // [esp+50h] [ebp-16Ch]
  CEvn_Event *v16; // [esp+54h] [ebp-168h]
  CEvn_Event *v17; // [esp+5Ch] [ebp-160h]
  CEvn_Event *v18; // [esp+64h] [ebp-158h]
  CEvn_Event v19; // [esp+74h] [ebp-148h] BYREF
  CEvn_Event v20; // [esp+8Ch] [ebp-130h] BYREF
  CEvn_Event v21; // [esp+A4h] [ebp-118h] BYREF
  CEvn_Event v22; // [esp+BCh] [ebp-100h] BYREF
  CEvn_Event v23; // [esp+D4h] [ebp-E8h] BYREF
  CEvn_Event v24; // [esp+ECh] [ebp-D0h] BYREF
  CEvn_Event v25; // [esp+104h] [ebp-B8h] BYREF
  CEvn_Event v26; // [esp+11Ch] [ebp-A0h] BYREF
  CEvn_Event v27; // [esp+134h] [ebp-88h] BYREF
  CEvn_Event v28; // [esp+14Ch] [ebp-70h] BYREF
  CEvn_Event v29; // [esp+164h] [ebp-58h] BYREF
  CEvn_Event v30; // [esp+17Ch] [ebp-40h] BYREF
  CEvn_Event v31; // [esp+194h] [ebp-28h] BYREF
  int v32; // [esp+1B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainDarktribeCampaign();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 2080:
          PlayGuiSound(2);
          v18 = CEvn_Event::CEvn_Event(&v24, 0x65u, 0, 0, 0);
          v32 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v24);
          break;
        case 2081:
          PlayGuiSound(2);
          v17 = CEvn_Event::CEvn_Event(&v25, 0x64u, 0, 0, 0);
          v32 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v25);
          break;
        case 2082:
          PlayGuiSound(2);
          v16 = CEvn_Event::CEvn_Event(&v26, 0x64u, 1u, 0, 0);
          v32 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v26);
          break;
        case 2083:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v27, 0x64u, 2u, 0, 0);
          v32 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v27);
          break;
        case 2084:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v28, 0x64u, 3u, 0, 0);
          v32 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v28);
          break;
        case 2085:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v29, 0x64u, 4u, 0, 0);
          v32 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v29);
          break;
        case 2086:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v30, 0x64u, 5u, 0, 0);
          v32 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v30);
          break;
        case 2087:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v19, 0x64u, 6u, 0, 0);
          v32 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v19);
          break;
        case 2088:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v20, 0x64u, 7u, 0, 0);
          v32 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v20);
          break;
        case 2089:
          PlayGuiSound(2);
          v15 = CEvn_Event::CEvn_Event(&v21, 0x64u, 8u, 0, 0);
          v32 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v21);
          break;
        case 2090:
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v22, 0x64u, 9u, 0, 0);
          v32 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v22);
          break;
        case 2091:
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v23, 0x64u, 0xAu, 0, 0);
          v32 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v23);
          break;
        case 2092:
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v31, 0x64u, 0xBu, 0, 0);
          v32 = 12;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v31);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368F924);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_368F925);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x1399650]
// Decompiled from int GuiDlgDeteilStatisticFillList()
void __cdecl GuiDlgDeteilStatisticFillList(void) {
  
  int result; // eax
  char *v1; // eax
  char *v2; // eax
  int i; // [esp+0h] [ebp-4h]

  result = s_iMainDeteilStatisticTopOffset;
  for ( i = s_iMainDeteilStatisticTopOffset; i < s_iMainDeteilStatisticTopOffset + 10; ++i )
  {
    if ( i - s_iMainDeteilStatisticTopOffset >= 10 )
    {
      IGuiEngine::SetFontTemplate(
        (IGuiEngine *)g_pGUIEngine,
        21,
        dword_368FA7C[i - s_iMainDeteilStatisticTopOffset],
        dword_3ED0440[15 * i]);
      IGuiEngine::SetText(
        (void *)g_pGUIEngine,
        21,
        dword_368FA7C[i - s_iMainDeteilStatisticTopOffset],
        (char *)&byte_368FA3F);
      LOBYTE(result) = IGuiEngine::SetText(
                         (void *)g_pGUIEngine,
                         21,
                         dword_368FAAC[i - s_iMainDeteilStatisticTopOffset],
                         (char *)byte_368FA40);
    }
    else
    {
      IGuiEngine::SetFontTemplate(
        (IGuiEngine *)g_pGUIEngine,
        21,
        dword_368FA7C[i - s_iMainDeteilStatisticTopOffset],
        dword_3ED0440[15 * i]);
      v1 = (char *)std::string::c_str((char *)&sDetailStatisticList + 60 * i);
      IGuiEngine::SetText((void *)g_pGUIEngine, 21, dword_368FA7C[i - s_iMainDeteilStatisticTopOffset], v1);
      v2 = (char *)std::string::c_str((char *)&unk_3ED0424 + 60 * i);
      LOBYTE(result) = IGuiEngine::SetText(
                         (void *)g_pGUIEngine,
                         21,
                         dword_368FAAC[i - s_iMainDeteilStatisticTopOffset],
                         v2);
    }
  }
  return result;
}


// address=[0x1399790]
// Decompiled from void InitGuiDlgMainDetailStatistic()
void __cdecl InitGuiDlgMainDetailStatistic(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2347);
    IGuiEngine::SetText((void *)g_pGUIEngine, 21, 2107, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2349);
    IGuiEngine::SetText((void *)g_pGUIEngine, 21, 2109, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2351);
    IGuiEngine::SetText((void *)g_pGUIEngine, 21, 2108, v2);
  }
}


// address=[0x1399830]
// Decompiled from void __cdecl UpdateGuiDlgMainDetailStatistic(int a1)
void __cdecl UpdateGuiDlgMainDetailStatistic(int a1) {
  
  char *v1; // eax
  char *v2; // eax
  int TotalProducedSettler; // eax
  char *v4; // eax
  char *v5; // eax
  int TotalProducedBuildings; // eax
  char *v7; // eax
  char *v8; // eax
  int MaxLandSize; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  int TotalMineProduction; // eax
  char *v14; // eax
  char *v15; // eax
  int ProducedGoods; // eax
  char *v17; // eax
  char *v18; // eax
  int v19; // eax
  char *v20; // eax
  char *v21; // eax
  int v22; // eax
  char *v23; // eax
  char *v24; // eax
  int v25; // eax
  char *v26; // eax
  char *v27; // eax
  int TotalFood; // eax
  char *v29; // eax
  char *v30; // eax
  int v31; // eax
  char *v32; // eax
  char *v33; // eax
  int v34; // eax
  char *v35; // eax
  char *v36; // eax
  int v37; // eax
  char *v38; // eax
  char *v39; // eax
  int ProducedMana; // eax
  char *v41; // eax
  char *v42; // eax
  char *v43; // eax
  char *v44; // eax
  int v45; // eax
  char *v46; // eax
  char *v47; // eax
  int v48; // eax
  char *v49; // eax
  char *v50; // eax
  int v51; // eax
  char *v52; // eax
  char *v53; // eax
  char *v54; // eax
  int v55; // eax
  char *v56; // eax
  char *v57; // eax
  int v58; // eax
  char *v59; // eax
  char *v60; // eax
  int v61; // eax
  char *v62; // eax
  char *v63; // eax
  int ProducedBuildings; // eax
  char *v65; // eax
  char *v66; // eax
  char *v67; // eax
  int v68; // eax
  char *v69; // eax
  char *v70; // eax
  int v71; // eax
  char *v72; // eax
  char *v73; // eax
  int v74; // eax
  char *v75; // eax
  char *v76; // eax
  int ProducedSettler; // eax
  char *v78; // eax
  char *v79; // eax
  char *v80; // eax
  int v81; // eax
  char *v82; // eax
  char *v83; // eax
  int v84; // eax
  char *v85; // eax
  char *v86; // eax
  int v87; // eax
  char *v88; // eax
  char *v89; // eax
  int v90; // eax
  char *v91; // eax
  char *v92; // eax
  char *v93; // eax
  int v94; // eax
  char *v95; // eax
  char *v96; // eax
  int v97; // eax
  char *v98; // eax
  char *v99; // eax
  int v100; // eax
  char *v101; // eax
  char *v102; // eax
  char *v103; // eax
  int v104; // eax
  char *v105; // eax
  char *v106; // eax
  int v107; // eax
  char *v108; // eax
  char *v109; // eax
  int v110; // eax
  char *v111; // eax
  char *v112; // eax
  char *v113; // eax
  int v114; // eax
  char *v115; // eax
  char *v116; // eax
  int v117; // eax
  char *v118; // eax
  char *v119; // eax
  int v120; // eax
  char *v121; // eax
  char *v122; // eax
  char *v123; // eax
  int v124; // eax
  char *v125; // eax
  char *v126; // eax
  int v127; // eax
  char *v128; // eax
  char *v129; // eax
  int v130; // eax
  char *v131; // eax
  char *v132; // eax
  int v133; // eax
  char *v134; // eax
  char *v135; // eax
  int v136; // eax
  char *v137; // eax
  char *v138; // eax
  int v139; // eax
  char *v140; // eax
  char *v141; // eax
  int v142; // eax
  char *v143; // eax
  char *v144; // eax
  char *v145; // eax
  int ProducedVehicle; // eax
  char *v147; // eax
  char *v148; // eax
  int v149; // eax
  char *v150; // eax
  char *v151; // eax
  int v152; // eax
  char *v153; // eax
  char *v154; // eax
  int Kills; // eax
  char *v156; // eax
  char *v157; // eax
  int Losses; // eax
  char *v159; // eax
  char *v160; // eax
  int KillsVehicle; // eax
  char *v162; // eax
  char *v163; // eax
  int LossesVehicle; // eax
  char *v165; // eax
  char *v166; // eax
  int CapturedTowers; // eax
  char *v168; // eax
  char *v169; // eax
  int LossesTowers; // eax
  char *v171; // eax
  int v172; // eax
  int v173; // eax
  const wchar_t *v174; // eax
  float v175; // xmm0_4
  int PlayerColor; // eax
  int PlayerRace; // eax
  int PlayerAlliance; // eax
  size_t v179; // [esp-4h] [ebp-1A8h]
  char *v180; // [esp+Ch] [ebp-198h]
  char *v181; // [esp+24h] [ebp-180h]
  char *v182; // [esp+28h] [ebp-17Ch]
  char *v183; // [esp+2Ch] [ebp-178h]
  char *v184; // [esp+30h] [ebp-174h]
  char *v185; // [esp+34h] [ebp-170h]
  char *v186; // [esp+38h] [ebp-16Ch]
  char *v187; // [esp+3Ch] [ebp-168h]
  char *v188; // [esp+40h] [ebp-164h]
  char *v189; // [esp+44h] [ebp-160h]
  char *v190; // [esp+48h] [ebp-15Ch]
  char *v191; // [esp+4Ch] [ebp-158h]
  char *v192; // [esp+54h] [ebp-150h]
  char *v193; // [esp+58h] [ebp-14Ch]
  char *v194; // [esp+5Ch] [ebp-148h]
  char *v195; // [esp+60h] [ebp-144h]
  char *v196; // [esp+64h] [ebp-140h]
  char *v197; // [esp+68h] [ebp-13Ch]
  char *v198; // [esp+6Ch] [ebp-138h]
  char *v199; // [esp+70h] [ebp-134h]
  char *v200; // [esp+74h] [ebp-130h]
  char *v201; // [esp+78h] [ebp-12Ch]
  char *v202; // [esp+7Ch] [ebp-128h]
  char *v203; // [esp+80h] [ebp-124h]
  char *v204; // [esp+84h] [ebp-120h]
  char *v205; // [esp+88h] [ebp-11Ch]
  char *v206; // [esp+8Ch] [ebp-118h]
  char *v207; // [esp+90h] [ebp-114h]
  char *v208; // [esp+98h] [ebp-10Ch]
  char *v209; // [esp+9Ch] [ebp-108h]
  char *v210; // [esp+A0h] [ebp-104h]
  char *v211; // [esp+A4h] [ebp-100h]
  char *v212; // [esp+A8h] [ebp-FCh]
  char *v213; // [esp+ACh] [ebp-F8h]
  char *v214; // [esp+B0h] [ebp-F4h]
  char *v215; // [esp+B4h] [ebp-F0h]
  char *v216; // [esp+B8h] [ebp-ECh]
  char *v217; // [esp+BCh] [ebp-E8h]
  char *v218; // [esp+C0h] [ebp-E4h]
  char *Dest; // [esp+124h] [ebp-80h]
  int i; // [esp+128h] [ebp-7Ch]
  int PlayerExitTime; // [esp+12Ch] [ebp-78h]
  int v222; // [esp+134h] [ebp-70h]
  int v223; // [esp+134h] [ebp-70h]
  int v224; // [esp+134h] [ebp-70h]
  int v225; // [esp+134h] [ebp-70h]
  int v226; // [esp+134h] [ebp-70h]
  int v227; // [esp+134h] [ebp-70h]
  int v228; // [esp+134h] [ebp-70h]
  int v229; // [esp+134h] [ebp-70h]
  int v230; // [esp+134h] [ebp-70h]
  int v231; // [esp+134h] [ebp-70h]
  int v232; // [esp+134h] [ebp-70h]
  int v233; // [esp+134h] [ebp-70h]
  int v234; // [esp+134h] [ebp-70h]
  char v235[28]; // [esp+138h] [ebp-6Ch] BYREF
  char Str[52]; // [esp+154h] [ebp-50h] BYREF
  char Buffer[12]; // [esp+188h] [ebp-1Ch] BYREF
  int v238; // [esp+1A0h] [ebp-4h]

  if ( g_pStringEngine )
  {
    InitGuiDlgMainDetailStatistic();
    for ( i = 0; i < 100; ++i )
    {
      dword_3ED0440[15 * i] = 1;
      std::string::operator=((char *)&sDetailStatisticList + 60 * i, (char *)&byte_368F928);
      std::string::operator=((char *)&unk_3ED0424 + 60 * i, (char *)&byte_368F929);
    }
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2353);
    std::string::operator=(&sDetailStatisticList, v1);
    dword_3ED0440[0] = 17;
    std::string::operator=(
      (char *)&sDetailStatisticList + 60,
      "----------------------------------------------------------------------------------------------------------------------");
    dword_3ED0440[15] = 12;
    std::string::operator=((char *)&unk_3ED0424 + 60, (char *)&byte_368F92A);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2355);
    std::string::operator=((char *)&sDetailStatisticList + 120, v2);
    TotalProducedSettler = CStatistic::GetTotalProducedSettler((CStatistic *)&g_cEndStatistic, a1);
    v4 = j___itoa(TotalProducedSettler, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 120, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2357);
    std::string::operator=((char *)&sDetailStatisticList + 180, v5);
    TotalProducedBuildings = CStatistic::GetTotalProducedBuildings((CStatistic *)&g_cEndStatistic, a1);
    v7 = j___itoa(TotalProducedBuildings, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 180, v7);
    v8 = g_pStringEngine->GetString(g_pStringEngine, 2359);
    std::string::operator=((char *)&sDetailStatisticList + 240, v8);
    MaxLandSize = CStatistic::GetMaxLandSize((CStatistic *)&g_cEndStatistic, a1);
    v10 = j___itoa(MaxLandSize, Buffer, 10);
    v11 = j__strcat(v10, "%");
    std::string::operator=((char *)&unk_3ED0424 + 240, v11);
    v12 = g_pStringEngine->GetString(g_pStringEngine, 2361);
    std::string::operator=((char *)&sDetailStatisticList + 300, v12);
    TotalMineProduction = CStatistic::GetTotalMineProduction((CStatistic *)&g_cEndStatistic, a1);
    v14 = j___itoa(TotalMineProduction, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 300, v14);
    v15 = g_pStringEngine->GetString(g_pStringEngine, 2363);
    std::string::operator=((char *)&sDetailStatisticList + 360, v15);
    ProducedGoods = CStatistic::GetProducedGoods((CStatistic *)&g_cEndStatistic, a1, 10);
    v17 = j___itoa(ProducedGoods, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 360, v17);
    v18 = g_pStringEngine->GetString(g_pStringEngine, 2365);
    std::string::operator=((char *)&sDetailStatisticList + 420, v18);
    v19 = CStatistic::GetProducedGoods((CStatistic *)&g_cEndStatistic, a1, 21);
    v20 = j___itoa(v19, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 420, v20);
    v21 = g_pStringEngine->GetString(g_pStringEngine, 2371);
    std::string::operator=((char *)&sDetailStatisticList + 480, v21);
    v22 = CStatistic::GetProducedGoods((CStatistic *)&g_cEndStatistic, a1, 15);
    v23 = j___itoa(v22, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 480, v23);
    v24 = g_pStringEngine->GetString(g_pStringEngine, 2369);
    std::string::operator=((char *)&sDetailStatisticList + 540, v24);
    v25 = CStatistic::GetProducedGoods((CStatistic *)&g_cEndStatistic, a1, 33);
    v26 = j___itoa(v25, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 540, v26);
    v27 = g_pStringEngine->GetString(g_pStringEngine, 2373);
    std::string::operator=((char *)&sDetailStatisticList + 600, v27);
    TotalFood = CStatistic::GetTotalFood((CStatistic *)&g_cEndStatistic, a1);
    v29 = j___itoa(TotalFood, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 600, v29);
    v30 = g_pStringEngine->GetString(g_pStringEngine, 2377);
    std::string::operator=((char *)&sDetailStatisticList + 660, v30);
    v31 = CStatistic::GetProducedGoods((CStatistic *)&g_cEndStatistic, a1, 11);
    v32 = j___itoa(v31, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 660, v32);
    v33 = g_pStringEngine->GetString(g_pStringEngine, 2375);
    std::string::operator=((char *)&sDetailStatisticList + 720, v33);
    v34 = CStatistic::GetProducedGoods((CStatistic *)&g_cEndStatistic, a1, 9);
    v35 = j___itoa(v34, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 720, v35);
    v36 = g_pStringEngine->GetString(g_pStringEngine, 2379);
    std::string::operator=((char *)&sDetailStatisticList + 780, v36);
    v37 = CStatistic::GetProducedGoods((CStatistic *)&g_cEndStatistic, a1, 24);
    v38 = j___itoa(v37, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 780, v38);
    v39 = g_pStringEngine->GetString(g_pStringEngine, 2381);
    std::string::operator=((char *)&sDetailStatisticList + 840, v39);
    ProducedMana = CStatistic::GetProducedMana((CStatistic *)&g_cEndStatistic, a1);
    v41 = j___itoa(ProducedMana, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 840, v41);
    std::string::operator=((char *)&sDetailStatisticList + 900, (char *)&byte_368F92B);
    std::string::operator=((char *)&unk_3ED0424 + 900, (char *)&byte_368F92E);
    v42 = g_pStringEngine->GetString(g_pStringEngine, 2385);
    std::string::operator=((char *)&sDetailStatisticList + 960, v42);
    dword_3ED0440[240] = 17;
    std::string::operator=(
      (char *)&sDetailStatisticList + 1020,
      "----------------------------------------------------------------------------------------------------------------------");
    dword_3ED0440[255] = 12;
    std::string::operator=((char *)&unk_3ED0424 + 1020, (char *)&byte_368F92F);
    if ( CEndStatistic::GetPlayerRace((CEndStatistic *)&g_cEndStatistic, a1) == 3 )
    {
      v63 = g_pStringEngine->GetString(g_pStringEngine, 2407);
      std::string::operator=((char *)&sDetailStatisticList + 1080, v63);
      v222 = 19;
      ProducedBuildings = CStatistic::GetProducedBuildings((CStatistic *)&g_cEndStatistic, a1, 49);
      v65 = j___itoa(ProducedBuildings, Buffer, 10);
      std::string::operator=((char *)&unk_3ED0424 + 1080, v65);
    }
    else
    {
      v43 = g_pStringEngine->GetString(g_pStringEngine, 2391);
      std::string::operator=((char *)&sDetailStatisticList + 1080, v43);
      dword_3ED0440[270] = 0;
      v44 = g_pStringEngine->GetString(g_pStringEngine, 2389);
      std::string::operator=((char *)&sDetailStatisticList + 1140, v44);
      v45 = CStatistic::GetProducedBuildings((CStatistic *)&g_cEndStatistic, a1, 46);
      v46 = j___itoa(v45, Buffer, 10);
      std::string::operator=((char *)&unk_3ED0424 + 1140, v46);
      v47 = g_pStringEngine->GetString(g_pStringEngine, 2393);
      std::string::operator=((char *)&sDetailStatisticList + 1200, v47);
      v48 = CStatistic::GetProducedBuildings((CStatistic *)&g_cEndStatistic, a1, 47);
      v49 = j___itoa(v48, Buffer, 10);
      std::string::operator=((char *)&unk_3ED0424 + 1200, v49);
      v50 = g_pStringEngine->GetString(g_pStringEngine, 2397);
      std::string::operator=((char *)&sDetailStatisticList + 1260, v50);
      v51 = CStatistic::GetProducedBuildings((CStatistic *)&g_cEndStatistic, a1, 48);
      v52 = j___itoa(v51, Buffer, 10);
      std::string::operator=((char *)&unk_3ED0424 + 1260, v52);
      std::string::operator=((char *)&sDetailStatisticList + 1320, (char *)&byte_368F9A7);
      std::string::operator=((char *)&unk_3ED0424 + 1320, (char *)&byte_368FA1F);
      v53 = g_pStringEngine->GetString(g_pStringEngine, 2399);
      std::string::operator=((char *)&sDetailStatisticList + 1380, v53);
      dword_3ED0440[345] = 0;
      v54 = g_pStringEngine->GetString(g_pStringEngine, 2401);
      std::string::operator=((char *)&sDetailStatisticList + 1440, v54);
      v55 = CStatistic::GetProducedBuildings((CStatistic *)&g_cEndStatistic, a1, 20);
      v56 = j___itoa(v55, Buffer, 10);
      std::string::operator=((char *)&unk_3ED0424 + 1440, v56);
      v57 = g_pStringEngine->GetString(g_pStringEngine, 2403);
      std::string::operator=((char *)&sDetailStatisticList + 1500, v57);
      v58 = CStatistic::GetProducedBuildings((CStatistic *)&g_cEndStatistic, a1, 19);
      v59 = j___itoa(v58, Buffer, 10);
      std::string::operator=((char *)&unk_3ED0424 + 1500, v59);
      v60 = g_pStringEngine->GetString(g_pStringEngine, 2405);
      std::string::operator=((char *)&sDetailStatisticList + 1560, v60);
      v222 = 27;
      v61 = CStatistic::GetProducedBuildings((CStatistic *)&g_cEndStatistic, a1, 22);
      v62 = j___itoa(v61, Buffer, 10);
      std::string::operator=((char *)&unk_3ED0424 + 1560, v62);
    }
    std::string::operator=((char *)&sDetailStatisticList + 60 * v222, (char *)&byte_368FA20);
    v218 = (char *)&unk_3ED0424 + 60 * v222;
    v223 = v222 + 1;
    std::string::operator=(v218, (char *)&byte_368FA21);
    if ( CEndStatistic::GetPlayerRace((CEndStatistic *)&g_cEndStatistic, a1) == 3 )
    {
      v76 = g_pStringEngine->GetString(g_pStringEngine, 2417);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v223, v76);
      v214 = (char *)&unk_3ED0424 + 60 * v223;
      v225 = v223 + 1;
      ProducedSettler = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 29);
      v78 = j___itoa(ProducedSettler, Buffer, 10);
      std::string::operator=(v214, v78);
    }
    else
    {
      v66 = g_pStringEngine->GetString(g_pStringEngine, 2409);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v223, v66);
      dword_3ED0440[15 * v223] = 0;
      v224 = v223 + 1;
      v67 = g_pStringEngine->GetString(g_pStringEngine, 2411);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v224, v67);
      v217 = (char *)&unk_3ED0424 + 60 * v224++;
      v68 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 29);
      v69 = j___itoa(v68, Buffer, 10);
      std::string::operator=(v217, v69);
      v70 = g_pStringEngine->GetString(g_pStringEngine, 2413);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v224, v70);
      v216 = (char *)&unk_3ED0424 + 60 * v224++;
      v71 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 30);
      v72 = j___itoa(v71, Buffer, 10);
      std::string::operator=(v216, v72);
      v73 = g_pStringEngine->GetString(g_pStringEngine, 2415);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v224, v73);
      v215 = (char *)&unk_3ED0424 + 60 * v224;
      v225 = v224 + 1;
      v74 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 31);
      v75 = j___itoa(v74, Buffer, 10);
      std::string::operator=(v215, v75);
    }
    std::string::operator=((char *)&sDetailStatisticList + 60 * v225, (char *)&byte_368FA22);
    v213 = (char *)&unk_3ED0424 + 60 * v225;
    v226 = v225 + 1;
    std::string::operator=(v213, (char *)&byte_368FA23);
    if ( CEndStatistic::GetPlayerRace((CEndStatistic *)&g_cEndStatistic, a1) == 3 )
    {
      v89 = g_pStringEngine->GetString(g_pStringEngine, 2421);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v226, v89);
      v209 = (char *)&unk_3ED0424 + 60 * v226;
      v228 = v226 + 1;
      v90 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 32);
      v91 = j___itoa(v90, Buffer, 10);
      std::string::operator=(v209, v91);
    }
    else
    {
      v79 = g_pStringEngine->GetString(g_pStringEngine, 2419);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v226, v79);
      dword_3ED0440[15 * v226] = 0;
      v227 = v226 + 1;
      v80 = g_pStringEngine->GetString(g_pStringEngine, 2411);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v227, v80);
      v212 = (char *)&unk_3ED0424 + 60 * v227++;
      v81 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 32);
      v82 = j___itoa(v81, Buffer, 10);
      std::string::operator=(v212, v82);
      v83 = g_pStringEngine->GetString(g_pStringEngine, 2413);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v227, v83);
      v211 = (char *)&unk_3ED0424 + 60 * v227++;
      v84 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 33);
      v85 = j___itoa(v84, Buffer, 10);
      std::string::operator=(v211, v85);
      v86 = g_pStringEngine->GetString(g_pStringEngine, 2415);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v227, v86);
      v210 = (char *)&unk_3ED0424 + 60 * v227;
      v228 = v227 + 1;
      v87 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 34);
      v88 = j___itoa(v87, Buffer, 10);
      std::string::operator=(v210, v88);
    }
    std::string::operator=((char *)&sDetailStatisticList + 60 * v228, (char *)&byte_368FA24);
    v208 = (char *)&unk_3ED0424 + 60 * v228;
    v229 = v228 + 1;
    std::string::operator=(v208, (char *)&byte_368FA25);
    switch ( CEndStatistic::GetPlayerRace((CEndStatistic *)&g_cEndStatistic, a1) )
    {
      case 0:
        v122 = g_pStringEngine->GetString(g_pStringEngine, 2350);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v229, v122);
        dword_3ED0440[15 * v229] = 0;
        v233 = v229 + 1;
        v123 = g_pStringEngine->GetString(g_pStringEngine, 2411);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v233, v123);
        v198 = (char *)&unk_3ED0424 + 60 * v233++;
        v124 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 35);
        v125 = j___itoa(v124, Buffer, 10);
        std::string::operator=(v198, v125);
        v126 = g_pStringEngine->GetString(g_pStringEngine, 2413);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v233, v126);
        v197 = (char *)&unk_3ED0424 + 60 * v233++;
        v127 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 36);
        v128 = j___itoa(v127, Buffer, 10);
        std::string::operator=(v197, v128);
        v129 = g_pStringEngine->GetString(g_pStringEngine, 2415);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v233, v129);
        v196 = (char *)&unk_3ED0424 + 60 * v233;
        v229 = v233 + 1;
        v130 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 37);
        v131 = j___itoa(v130, Buffer, 10);
        std::string::operator=(v196, v131);
        break;
      case 1:
        v92 = g_pStringEngine->GetString(g_pStringEngine, 2423);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v229, v92);
        dword_3ED0440[15 * v229] = 0;
        v230 = v229 + 1;
        v93 = g_pStringEngine->GetString(g_pStringEngine, 2411);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v230, v93);
        v207 = (char *)&unk_3ED0424 + 60 * v230++;
        v94 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 38);
        v95 = j___itoa(v94, Buffer, 10);
        std::string::operator=(v207, v95);
        v96 = g_pStringEngine->GetString(g_pStringEngine, 2413);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v230, v96);
        v206 = (char *)&unk_3ED0424 + 60 * v230++;
        v97 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 39);
        v98 = j___itoa(v97, Buffer, 10);
        std::string::operator=(v206, v98);
        v99 = g_pStringEngine->GetString(g_pStringEngine, 2415);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v230, v99);
        v205 = (char *)&unk_3ED0424 + 60 * v230;
        v229 = v230 + 1;
        v100 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 40);
        v101 = j___itoa(v100, Buffer, 10);
        std::string::operator=(v205, v101);
        break;
      case 2:
        v112 = g_pStringEngine->GetString(g_pStringEngine, 2348);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v229, v112);
        dword_3ED0440[15 * v229] = 0;
        v232 = v229 + 1;
        v113 = g_pStringEngine->GetString(g_pStringEngine, 2411);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v232, v113);
        v201 = (char *)&unk_3ED0424 + 60 * v232++;
        v114 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 41);
        v115 = j___itoa(v114, Buffer, 10);
        std::string::operator=(v201, v115);
        v116 = g_pStringEngine->GetString(g_pStringEngine, 2413);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v232, v116);
        v200 = (char *)&unk_3ED0424 + 60 * v232++;
        v117 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 42);
        v118 = j___itoa(v117, Buffer, 10);
        std::string::operator=(v200, v118);
        v119 = g_pStringEngine->GetString(g_pStringEngine, 2415);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v232, v119);
        v199 = (char *)&unk_3ED0424 + 60 * v232;
        v229 = v232 + 1;
        v120 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 43);
        v121 = j___itoa(v120, Buffer, 10);
        std::string::operator=(v199, v121);
        break;
      case 3:
        if ( CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 54) > 0 )
        {
          v132 = g_pStringEngine->GetString(g_pStringEngine, 2352);
          std::string::operator=((char *)&sDetailStatisticList + 60 * v229, v132);
          v195 = (char *)&unk_3ED0424 + 60 * v229++;
          v133 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 54);
          v134 = j___itoa(v133, Buffer, 10);
          std::string::operator=(v195, v134);
        }
        if ( CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 52) > 0 )
        {
          v135 = g_pStringEngine->GetString(g_pStringEngine, 2354);
          std::string::operator=((char *)&sDetailStatisticList + 60 * v229, v135);
          v194 = (char *)&unk_3ED0424 + 60 * v229++;
          v136 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 52);
          v137 = j___itoa(v136, Buffer, 10);
          std::string::operator=(v194, v137);
        }
        if ( CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 55) > 0 )
        {
          v138 = g_pStringEngine->GetString(g_pStringEngine, 2356);
          std::string::operator=((char *)&sDetailStatisticList + 60 * v229, v138);
          v193 = (char *)&unk_3ED0424 + 60 * v229++;
          v139 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 55);
          v140 = j___itoa(v139, Buffer, 10);
          std::string::operator=(v193, v140);
        }
        break;
      case 4:
        v102 = g_pStringEngine->GetString(g_pStringEngine, 282);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v229, v102);
        dword_3ED0440[15 * v229] = 0;
        v231 = v229 + 1;
        v103 = g_pStringEngine->GetString(g_pStringEngine, 2411);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v231, v103);
        v204 = (char *)&unk_3ED0424 + 60 * v231++;
        v104 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 61);
        v105 = j___itoa(v104, Buffer, 10);
        std::string::operator=(v204, v105);
        v106 = g_pStringEngine->GetString(g_pStringEngine, 2413);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v231, v106);
        v203 = (char *)&unk_3ED0424 + 60 * v231++;
        v107 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 62);
        v108 = j___itoa(v107, Buffer, 10);
        std::string::operator=(v203, v108);
        v109 = g_pStringEngine->GetString(g_pStringEngine, 2415);
        std::string::operator=((char *)&sDetailStatisticList + 60 * v231, v109);
        v202 = (char *)&unk_3ED0424 + 60 * v231;
        v229 = v231 + 1;
        v110 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 63);
        v111 = j___itoa(v110, Buffer, 10);
        std::string::operator=(v202, v111);
        break;
      default:
        break;
    }
    if ( CEndStatistic::GetPlayerRace((CEndStatistic *)&g_cEndStatistic, a1) != 3 )
    {
      v141 = g_pStringEngine->GetString(g_pStringEngine, 2358);
      std::string::operator=((char *)&sDetailStatisticList + 60 * v229, v141);
      v192 = (char *)&unk_3ED0424 + 60 * v229++;
      v142 = CStatistic::GetProducedSettler((CStatistic *)&g_cEndStatistic, a1, 44);
      v143 = j___itoa(v142, Buffer, 10);
      std::string::operator=(v192, v143);
    }
    std::string::operator=((char *)&sDetailStatisticList + 60 * v229, (char *)&byte_368FA26);
    v183 = (char *)&unk_3ED0424 + 60 * v229;
    v234 = v229 + 1;
    std::string::operator=(v183, (char *)&byte_368FA27);
    v144 = g_pStringEngine->GetString(g_pStringEngine, 2360);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v144);
    dword_3ED0440[15 * v234++] = 0;
    v145 = g_pStringEngine->GetString(g_pStringEngine, 2362);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v145);
    v191 = (char *)&unk_3ED0424 + 60 * v234++;
    ProducedVehicle = CStatistic::GetProducedVehicle((CStatistic *)&g_cEndStatistic, a1, 1);
    v147 = j___itoa(ProducedVehicle, Buffer, 10);
    std::string::operator=(v191, v147);
    v148 = g_pStringEngine->GetString(g_pStringEngine, 2364);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v148);
    v190 = (char *)&unk_3ED0424 + 60 * v234++;
    v149 = CStatistic::GetProducedVehicle((CStatistic *)&g_cEndStatistic, a1, 3);
    v150 = j___itoa(v149, Buffer, 10);
    std::string::operator=(v190, v150);
    v151 = g_pStringEngine->GetString(g_pStringEngine, 2366);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v151);
    v189 = (char *)&unk_3ED0424 + 60 * v234++;
    v152 = CStatistic::GetProducedVehicle((CStatistic *)&g_cEndStatistic, a1, 4);
    v153 = j___itoa(v152, Buffer, 10);
    std::string::operator=(v189, v153);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, (char *)&byte_368FA28);
    v188 = (char *)&unk_3ED0424 + 60 * v234++;
    std::string::operator=(v188, (char *)&byte_368FA29);
    v154 = g_pStringEngine->GetString(g_pStringEngine, 2372);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v154);
    v187 = (char *)&unk_3ED0424 + 60 * v234++;
    Kills = CStatistic::GetKills((CStatistic *)&g_cEndStatistic, a1);
    v156 = j___itoa(Kills, Buffer, 10);
    std::string::operator=(v187, v156);
    v157 = g_pStringEngine->GetString(g_pStringEngine, 2370);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v157);
    v186 = (char *)&unk_3ED0424 + 60 * v234++;
    Losses = CStatistic::GetLosses((CStatistic *)&g_cEndStatistic, a1);
    v159 = j___itoa(Losses, Buffer, 10);
    std::string::operator=(v186, v159);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, (char *)&byte_368FA2A);
    v185 = (char *)&unk_3ED0424 + 60 * v234++;
    std::string::operator=(v185, (char *)&byte_368FA2B);
    v160 = g_pStringEngine->GetString(g_pStringEngine, 2374);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v160);
    v184 = (char *)&unk_3ED0424 + 60 * v234++;
    KillsVehicle = CStatistic::GetKillsVehicle((CStatistic *)&g_cEndStatistic, a1);
    v162 = j___itoa(KillsVehicle, Buffer, 10);
    std::string::operator=(v184, v162);
    v163 = g_pStringEngine->GetString(g_pStringEngine, 2378);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v163);
    v180 = (char *)&unk_3ED0424 + 60 * v234++;
    LossesVehicle = CStatistic::GetLossesVehicle((CStatistic *)&g_cEndStatistic, a1);
    v165 = j___itoa(LossesVehicle, Buffer, 10);
    std::string::operator=(v180, v165);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, (char *)&byte_368FA2C);
    v182 = (char *)&unk_3ED0424 + 60 * v234++;
    std::string::operator=(v182, (char *)&byte_368FA2D);
    v166 = g_pStringEngine->GetString(g_pStringEngine, 2376);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v166);
    v181 = (char *)&unk_3ED0424 + 60 * v234++;
    CapturedTowers = CStatistic::GetCapturedTowers((CStatistic *)&g_cEndStatistic, a1);
    v168 = j___itoa(CapturedTowers, Buffer, 10);
    std::string::operator=(v181, v168);
    v169 = g_pStringEngine->GetString(g_pStringEngine, 2380);
    std::string::operator=((char *)&sDetailStatisticList + 60 * v234, v169);
    LossesTowers = CStatistic::GetLossesTowers((CStatistic *)&g_cEndStatistic, a1);
    v171 = j___itoa(LossesTowers, Buffer, 10);
    std::string::operator=((char *)&unk_3ED0424 + 60 * v234, v171);
    iItemNumber = v234 + 1;
    CEndStatistic::GetPlayerName(&g_cEndStatistic, (int)v235, a1);
    v238 = 0;
    v172 = std::wstring::length(v235);
    Dest = (char *)operator new[](v172 + 1);
    v173 = std::wstring::length(v235);
    v174 = (const wchar_t *)std::wstring::data(v173);
    j__wcstombs(Dest, v174, v179);
    Dest[std::wstring::length(v235)] = 0;
    IGuiEngine::SetText((void *)g_pGUIEngine, 21, 2110, Dest);
    operator delete(Dest);
    PlayerExitTime = CStatistic::GetPlayerExitTime((CStatistic *)&g_cEndStatistic, a1);
    if ( !PlayerExitTime )
      PlayerExitTime = CEndStatistic::GetTickCounter((CEndStatistic *)&g_cEndStatistic);
    v175 = (float)(unsigned int)(71 * PlayerExitTime);
    j___snprintf(
      Str,
      0x32u,
      "%02u:%02u:%02u",
      (unsigned int)(float)(v175 / 1000.0) / 0xE10,
      (unsigned int)(float)(v175 / 1000.0) / 0x3C % 0x3C,
      (unsigned int)(float)(v175 / 1000.0) % 0x3C);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 21, 2106, 850, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 21, 2111, 861, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 21, 2107, 875, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 21, 2139, 853, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 21, 2137, 873, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 21, 2138, 874, 0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 21, 2111, Str);
    PlayerColor = CEndStatistic::GetPlayerColor((CEndStatistic *)&g_cEndStatistic, a1);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 21, 2139, dword_368FADC[PlayerColor], 0);
    PlayerRace = CEndStatistic::GetPlayerRace((CEndStatistic *)&g_cEndStatistic, a1);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 21, 2137, dword_368FB2C[PlayerRace], 0);
    PlayerAlliance = CEndStatistic::GetPlayerAlliance((CEndStatistic *)&g_cEndStatistic, a1);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 21, 2138, dword_368FB00[PlayerAlliance], 0);
    GuiDlgDeteilStatisticFillList();
    v238 = -1;
    std::wstring::~wstring(v235);
  }
}


// address=[0x139b890]
// Decompiled from char __cdecl GuiDlgMainDetailStatisticProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainDetailStatisticProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-3Ch]
  CEvn_Event v7; // [esp+18h] [ebp-28h] BYREF
  int v8; // [esp+3Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainDetailStatistic();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (unsigned __int16)a2 )
      {
        case 0x83Au:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v7, 0x75u, 0, 0, 0);
          v8 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v8 = -1;
          CEvn_Event::~CEvn_Event(&v7);
          break;
        case 0x857u:
          sub_139B850();
          break;
        case 0x858u:
          goto LABEL_15;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_368FA2E);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_368FA2F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 )
          sub_139B850();
      }
      else
      {
LABEL_15:
        sub_139B820();
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13a05a0]
// Decompiled from void __cdecl GuiDlgMainGameSettingsAddChatline(char *Str)
void __cdecl GuiDlgMainGameSettingsAddChatline(char const * Str) {
  
  int v1; // eax

  CGuiChatMsgList::AddListItem(Str);
  v1 = CGuiChatMsgList::Listcount((CGuiChatMsgList *)&s_cMsgLst);
  CGuiChatMsgList::SetTopindex((CGuiChatMsgList *)&s_cMsgLst, v1 - 1);
  PlayGuiSound(1);
}


// address=[0x13a05e0]
// Decompiled from char __cdecl GuiDlgMainGameSettingsUpdateChangeSlot(int a1)
void __cdecl GuiDlgMainGameSettingsUpdateChangeSlot(int a1) {
  
  char result; // al
  CHAR v2[4]; // [esp+0h] [ebp-18h] BYREF
  CHAR Str[4]; // [esp+4h] [ebp-14h] BYREF
  int v4; // [esp+8h] [ebp-10h]
  int v5; // [esp+Ch] [ebp-Ch]
  int i; // [esp+10h] [ebp-8h]
  char v7; // [esp+17h] [ebp-1h]

  for ( i = 0; i < 8; ++i )
  {
    if ( *(_BYTE *)(g_pGameType + *(_DWORD *)(g_pGameType + 4 * i + 564) + 440) )
      *(_DWORD *)(g_pGameType + 4 * i + 564) = -1;
  }
  v7 = 0;
  for ( i = 0; i < 8; ++i )
  {
    if ( *(_DWORD *)(g_pGameType + 4 * i + 564) == a1 )
      v7 = 1;
  }
  if ( *(_DWORD *)(g_pGameType + 4 * a1 + 564) == -1 || *(_BYTE *)(a1 + g_pGameType + 440) )
  {
    if ( *(_BYTE *)(a1 + g_pGameType + 440) || !v7 || (result = a1, *(_DWORD *)(g_pGameType + 4 * a1 + 564) == a1) )
    {
      _wsprintfA(v2, "%u", a1 + 1);
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * a1], 1);
      return IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * a1], v2);
    }
  }
  else
  {
    v5 = a1;
    v4 = *(_DWORD *)(g_pGameType + 4 * a1 + 564);
    _wsprintfA(Str, "%u-%u", a1 + 1, v4 + 1);
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * v5], 18);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * v5], Str);
    _wsprintfA(Str, "%u-%u", v4 + 1, v5 + 1);
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * v4], 18);
    return IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * v4], Str);
  }
  return result;
}


// address=[0x13a0840]
// Decompiled from void GuiDlgMainGameSettingstUpdate()
void __cdecl GuiDlgMainGameSettingstUpdate(void) {
  
  const wchar_t *v0; // eax
  char *v1; // eax
  char *v2; // eax
  const wchar_t *v3; // eax
  char v4; // [esp+8h] [ebp-1F4h]
  BOOL v5; // [esp+14h] [ebp-1E8h]
  int v6; // [esp+30h] [ebp-1CCh]
  int v7; // [esp+34h] [ebp-1C8h]
  int n; // [esp+38h] [ebp-1C4h]
  int j; // [esp+3Ch] [ebp-1C0h]
  int m; // [esp+40h] [ebp-1BCh]
  int k; // [esp+44h] [ebp-1B8h]
  bool v12; // [esp+57h] [ebp-1A5h]
  int i; // [esp+58h] [ebp-1A4h]
  char v14[88]; // [esp+5Ch] [ebp-1A0h] BYREF
  _BYTE v15[28]; // [esp+B4h] [ebp-148h] BYREF
  CHAR v16[28]; // [esp+D0h] [ebp-12Ch] BYREF
  CHAR Destination[256]; // [esp+ECh] [ebp-110h] BYREF
  int v18; // [esp+1F8h] [ebp-4h]

  String::String((char *)byte_368FCC2, -1);
  v18 = 0;
  byte_3ED2031 = 1;
  if ( byte_4030852 && !byte_4030853 )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, 2244, 0);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2244, byte_40308A1);
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2244, byte_40308A2);
  if ( *(_DWORD *)(g_pGameType + 4 * dword_3D891AC + 116) == 1
    || !byte_4030852
    || INetworkEngine::StormDidEnterSession((INetworkEngine *)g_pNetworkEngine) )
  {
    dword_3D891AC = (char)CPlayerManager::GetLocalSlot();
  }
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2141, byte_40308A4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, 2245, byte_403088D);
  if ( byte_4030850 || byte_40308A0 || byte_40308A3 )
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2183, 0);
  else
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2183, 1);
  if ( byte_4030850 || byte_40308A0 || byte_40308A3 )
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2182, 0);
  else
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2182, 1);
  if ( byte_4030851 || byte_40308A0 || byte_40308A3 )
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2181, 0);
  else
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2181, 1);
  if ( byte_4030851 || byte_40308A0 || byte_40308A3 )
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2180, 0);
  else
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2180, 1);
  if ( byte_40308A0 || byte_40308A3 )
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2185, 0);
  else
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2185, 1);
  if ( byte_40308A0 || byte_40308A3 )
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2184, 0);
  else
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2184, 1);
  if ( byte_40308A0
    || byte_40308A3
    || dword_3D891AC < 0
    || *(_DWORD *)(dword_403083C + 2116 * dword_3D891AC + 60) == 2
    || *(_DWORD *)(dword_403083C + 2116 * dword_3D891AC + 60) == 3 )
  {
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2186, 0);
  }
  else
  {
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2186, 1);
  }
  if ( byte_40308A0
    || byte_40308A3
    || dword_3D891AC < 0
    || *(_DWORD *)(dword_403083C + 2116 * dword_3D891AC + 60) == 2
    || *(_DWORD *)(dword_403083C + 2116 * dword_3D891AC + 60) == 3 )
  {
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2187, 0);
  }
  else
  {
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2187, 1);
  }
  if ( byte_4030852 )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, 2142, 1);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, 2142, 0);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2142, byte_403088C);
  if ( !byte_4030852 )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, 2141, byte_4030854 != 1);
  v0 = (const wchar_t *)std::wstring::c_str((_Cnd_internal_imp_t *)&unk_40307CC);
  j__wcstombs(Destination, v0, 0x100u);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2145, Destination);
  std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v14);
  LOBYTE(v18) = 1;
  std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
    v16,
    &unk_40307E8);
  LOBYTE(v18) = 2;
  v1 = (char *)std::string::c_str(v16);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2152, v1);
  _wsprintfA(Destination, "%u", dword_403084C);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2146, Destination);
  v2 = g_pStringEngine->GetString(g_pStringEngine, 3839);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2144, v2);
  _wsprintfA(Destination, "%u / %u", dword_4030840, dword_4030844);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2143, Destination);
  if ( dword_3D891AC >= 0 )
    IGuiEngine::SetImages(
      (void *)g_pGUIEngine,
      dword_403089C,
      2189,
      dword_3690424[*(_DWORD *)(dword_403083C + 2116 * dword_3D891AC + 36)],
      0);
  else
    IGuiEngine::SetImages((void *)g_pGUIEngine, dword_403089C, 2189, 0, 0);
  if ( dword_3D891AC >= 0 )
    IGuiEngine::SetImages(
      (void *)g_pGUIEngine,
      dword_403089C,
      2179,
      dword_36904BC[*(_DWORD *)(dword_403083C + 2116 * dword_3D891AC + 40)],
      0);
  else
    IGuiEngine::SetImages((void *)g_pGUIEngine, dword_403089C, 2179, 0, 0);
  if ( dword_3D891AC >= 0 )
    IGuiEngine::SetImages(
      (void *)g_pGUIEngine,
      dword_403089C,
      2188,
      dword_3690404[*(_DWORD *)(dword_403083C + 2116 * dword_3D891AC + 4)],
      0);
  else
    IGuiEngine::SetImages((void *)g_pGUIEngine, dword_403089C, 2188, 0, 0);
  if ( dword_3D891AC >= 0 )
    IGuiEngine::SetUserLogoImage(
      (IGuiEngine *)g_pGUIEngine,
      dword_403089C,
      2256,
      *(_DWORD *)(dword_403083C + 2116 * dword_3D891AC + 44));
  else
    IGuiEngine::SetUserLogoImage((IGuiEngine *)g_pGUIEngine, dword_403089C, 2256, 0);
  for ( i = 0; i < 8; ++i )
  {
    if ( i >= dword_4030848 )
    {
      for ( j = 0; j < 11; ++j )
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + j], 0);
      continue;
    }
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i], 1);
    v7 = -1;
    for ( k = 0; k < 8; ++k )
    {
      if ( *(_DWORD *)(g_pGameType + 4 * k + 564) == (char)CPlayerManager::GetLocalSlot() )
        v7 = k;
    }
    if ( v7 == -1 )
    {
      if ( !CGameType::IsSlotChangable((CGameType *)g_pGameType, i, 0)
        || *(_DWORD *)(g_pGameType + 4 * (char)CPlayerManager::GetLocalSlot() + 452) == 6
        || *(_DWORD *)(g_pGameType + 4 * i + 452) == 6
        && *(_DWORD *)(g_pGameType + 4 * i + 116) != 2
        && *(_DWORD *)(g_pGameType + 4 * i + 116) != 3
        && !*(_BYTE *)(i + g_pGameType + 440)
        || (!(unsigned __int8)CGameType::IsClanGame(g_pGameType)
          ? (v5 = 1)
          : (v5 = *(_DWORD *)(dword_403083C + 2116 * (char)CPlayerManager::GetLocalSlot() + 4) == *(_DWORD *)(dword_403083C + 2116 * i + 4)),
            !v5) )
      {
        if ( i != (char)CPlayerManager::GetLocalSlot() )
        {
LABEL_93:
          IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i], 0);
          goto LABEL_95;
        }
      }
    }
    else if ( *(_DWORD *)(g_pGameType + 4 * (char)CPlayerManager::GetLocalSlot() + 452) == 6
           || i != (char)CPlayerManager::GetLocalSlot() && i != v7 )
    {
      goto LABEL_93;
    }
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i], 1);
LABEL_95:
    if ( *(_BYTE *)(dword_403083C + 2116 * i) )
    {
      for ( m = 1; m < 11; ++m )
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + m], 0);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 9],
        dword_36906D8[3 * *(_DWORD *)(dword_403083C + 2116 * i + 60)],
        dword_36906D8[3 * *(_DWORD *)(dword_403083C + 2116 * i + 60) + 1]);
      IGuiEngine::SetTooltipID(
        (IGuiEngine *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 9],
        dword_36906D8[3 * *(_DWORD *)(dword_403083C + 2116 * i + 60) + 2],
        0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 9], 1);
      if ( byte_4030852 && *(_BYTE *)(dword_403083C + 2116 * i + 2113) )
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 9], 1);
      else
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 9], 0);
      GuiDlgMainGameSettingsUpdateChangeSlot(i);
    }
    else
    {
      v12 = 0;
      if ( dword_3D891AC >= 0 )
      {
        v6 = *(_DWORD *)(dword_403083C + 2116 * i + 60);
        if ( v6 == 2 || v6 == 3 )
        {
          if ( byte_4030852 )
            v12 = 1;
        }
        else if ( v6 == 1 )
        {
          v12 = i == (char)CPlayerManager::GetLocalSlot();
        }
      }
      if ( i == dword_3D891AC || !v12 )
        IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 2], 7);
      else
        IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 2], 9);
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 2], v12);
      for ( n = 0; n < 11; ++n )
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + n], 1);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 1],
        dword_3690404[*(_DWORD *)(dword_403083C + 2116 * i + 4)],
        0);
      v3 = (const wchar_t *)std::wstring::c_str((_Cnd_internal_imp_t *)(dword_403083C + 2116 * i + 8));
      j__wcstombs(Destination, v3, 0x100u);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 2], Destination);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 3],
        dword_36904BC[*(_DWORD *)(dword_403083C + 2116 * i + 40)],
        0);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 4],
        dword_3690424[*(_DWORD *)(dword_403083C + 2116 * i + 36)],
        0);
      if ( byte_4030853 )
        IGuiEngine::SetUserLogoImage(
          (IGuiEngine *)g_pGUIEngine,
          dword_403089C,
          dword_3690578[11 * i + 5],
          dword_4030858[i]);
      else
        IGuiEngine::SetUserLogoImage((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 5], i);
      if ( *(_DWORD *)(dword_403083C + 2116 * i + 48) )
        _wsprintfA(Destination, "%u", *(_DWORD *)(dword_403083C + 2116 * i + 48));
      else
        j__strcpy_0(Destination, "-");
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 6], Destination);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 7],
        dword_3690564[*(_DWORD *)(dword_403083C + 2116 * i + 52)],
        0);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 8],
        dword_36904D4[*(_DWORD *)(dword_403083C + 2116 * i + 56)],
        0);
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 9],
        dword_36906D8[3 * *(_DWORD *)(dword_403083C + 2116 * i + 60)],
        dword_36906D8[3 * *(_DWORD *)(dword_403083C + 2116 * i + 60) + 1]);
      IGuiEngine::SetTooltipID(
        (IGuiEngine *)g_pGUIEngine,
        dword_403089C,
        dword_3690578[11 * i + 9],
        dword_36906D8[3 * *(_DWORD *)(dword_403083C + 2116 * i + 60) + 2],
        0);
      if ( v12
        && !*(_BYTE *)(dword_403083C + 2116 * i + 64)
        && *(_BYTE *)(dword_403083C + 2116 * i + 2113)
        && byte_4030852 )
      {
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 9], 1);
      }
      else
      {
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 9], 0);
      }
      GuiDlgMainGameSettingsUpdateChangeSlot(i);
      v4 = *(_DWORD *)(dword_403083C + 2116 * i + 60) == 1 && !*(_BYTE *)(dword_403083C + 2116 * i + 64) && byte_4030852;
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 10], byte_4030852);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 10], v4);
    }
  }
  byte_3ED2031 = 0;
  LOBYTE(v18) = 1;
  std::string::~string(v16);
  LOBYTE(v18) = 0;
  std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v14);
  v18 = -1;
  String::~String((String *)v15);
}


// address=[0x13a1af0]
// Decompiled from void InitGuiDlgMainGameSettings()
void __cdecl InitGuiDlgMainGameSettings(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  int j; // [esp+0h] [ebp-13Ch]
  int i; // [esp+4h] [ebp-138h]
  _DWORD v8[12]; // [esp+8h] [ebp-134h] BYREF
  CHAR Str[256]; // [esp+38h] [ebp-104h] BYREF

  byte_3ED2030 = 1;
  dword_3D891AC = -1;
  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2022);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2147, v0);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2148, (char *)&byte_368FCCB);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2023);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2149, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2018);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2150, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2021);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2151, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2019);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2154, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2064);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2244, v5);
    IGuiEngine::SetTypeAsButton((IGuiEngine *)g_pGUIEngine, dword_403089C, 2144);
    IGuiEngine::SetWidth((IGuiEngine *)g_pGUIEngine, dword_403089C, 2143, 0x28u);
    if ( !byte_4030852 )
    {
      for ( i = 0; i < 8; ++i )
      {
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 9], 0);
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 10], 0);
      }
    }
    for ( j = 0; j < 8; ++j )
    {
      _wsprintfA(Str, "%u", j + 1);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, dword_3690578[11 * j], Str);
    }
    v8[0] = dword_403089C;
    v8[1] = 2240;
    v8[3] = dword_403089C;
    v8[4] = 2241;
    v8[6] = dword_403089C;
    v8[7] = 2242;
    v8[9] = dword_403089C;
    v8[10] = 2243;
    CGuiChatMsgList::SetOutputControls((CGuiChatMsgList *)&s_cMsgLst, 4, (struct CGuiChatMsgList::SControl *)v8);
    CGuiChatMsgList::Clear((CGuiChatMsgList *)&s_cMsgLst);
    CGuiChatMsgList::SetTopindex((CGuiChatMsgList *)&s_cMsgLst, 0);
    IGuiEngine::SetEditProperties((IGuiEngine *)g_pGUIEngine, dword_403089C, 2153, 0x60u, 0x7Fu);
    IGuiEngine::SetUserLogoImage((IGuiEngine *)g_pGUIEngine, dword_403089C, 2256, dword_4030878);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2244, byte_40308A2);
  }
}


// address=[0x13a1eb0]
// Decompiled from char __cdecl GuiDlgMainGameSettingsProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainGameSettingsProc(int a1, int a2, int a3) {
  
  char LocalSlot; // al
  int Instance; // eax
  char *v6; // eax
  char *v7; // eax
  int v8; // eax
  int v9; // eax
  signed __int8 v10; // al
  int Topindex; // eax
  int v12; // ecx
  CEvn_Event *v13; // [esp+4h] [ebp-44Ch]
  CEvn_Event *v14; // [esp+Ch] [ebp-444h]
  CEvn_Event *v15; // [esp+14h] [ebp-43Ch]
  CEvn_Event *v16; // [esp+1Ch] [ebp-434h]
  CEvn_Event *v17; // [esp+24h] [ebp-42Ch]
  CEvn_Event *v18; // [esp+2Ch] [ebp-424h]
  CEvn_Event *v19; // [esp+34h] [ebp-41Ch]
  CEvn_Event *v20; // [esp+40h] [ebp-410h]
  CEvn_Event *v21; // [esp+48h] [ebp-408h]
  CEvn_Event *v22; // [esp+50h] [ebp-400h]
  CEvn_Event *v23; // [esp+58h] [ebp-3F8h]
  CEvn_Event *v24; // [esp+60h] [ebp-3F0h]
  CEvn_Event *v25; // [esp+68h] [ebp-3E8h]
  CEvn_Event *v26; // [esp+70h] [ebp-3E0h]
  CEvn_Event *v27; // [esp+78h] [ebp-3D8h]
  CEvn_Event *v28; // [esp+80h] [ebp-3D0h]
  CEvn_Event *v29; // [esp+8Ch] [ebp-3C4h]
  CEvn_Event *v30; // [esp+94h] [ebp-3BCh]
  CEvn_Event *v31; // [esp+9Ch] [ebp-3B4h]
  CEvn_Event *v32; // [esp+A4h] [ebp-3ACh]
  CEvn_Event *v33; // [esp+ACh] [ebp-3A4h]
  CEvn_Event *v34; // [esp+B4h] [ebp-39Ch]
  CEvn_Event *v35; // [esp+BCh] [ebp-394h]
  CEvn_Event *v36; // [esp+C4h] [ebp-38Ch]
  CEvn_Event *v37; // [esp+CCh] [ebp-384h]
  CEvn_Event *v38; // [esp+D4h] [ebp-37Ch]
  CEvn_Event *v39; // [esp+DCh] [ebp-374h]
  CEvn_Event *v40; // [esp+E4h] [ebp-36Ch]
  CEvn_Event *v41; // [esp+ECh] [ebp-364h]
  CEvn_Event *v42; // [esp+F4h] [ebp-35Ch]
  CEvn_Event *v43; // [esp+FCh] [ebp-354h]
  CEvn_Event *v44; // [esp+104h] [ebp-34Ch]
  int v45; // [esp+10Ch] [ebp-344h]
  const char *Text; // [esp+110h] [ebp-340h]
  unsigned int v47; // [esp+118h] [ebp-338h]
  int j; // [esp+120h] [ebp-330h]
  int k; // [esp+124h] [ebp-32Ch]
  int i; // [esp+12Ch] [ebp-324h]
  int v51; // [esp+130h] [ebp-320h]
  unsigned int v52; // [esp+134h] [ebp-31Ch]
  int v53; // [esp+138h] [ebp-318h]
  bool v54; // [esp+13Fh] [ebp-311h] BYREF
  CEvn_Event v55; // [esp+140h] [ebp-310h] BYREF
  CEvn_Event v56; // [esp+158h] [ebp-2F8h] BYREF
  CEvn_Event v57; // [esp+170h] [ebp-2E0h] BYREF
  CEvn_Event v58; // [esp+188h] [ebp-2C8h] BYREF
  CEvn_Event v59; // [esp+1A0h] [ebp-2B0h] BYREF
  CEvn_Event v60; // [esp+1B8h] [ebp-298h] BYREF
  CEvn_Event v61; // [esp+1D0h] [ebp-280h] BYREF
  CEvn_Event v62; // [esp+1E8h] [ebp-268h] BYREF
  CEvn_Event v63; // [esp+200h] [ebp-250h] BYREF
  CEvn_Event v64; // [esp+218h] [ebp-238h] BYREF
  CEvn_Event v65; // [esp+230h] [ebp-220h] BYREF
  CEvn_Event v66; // [esp+248h] [ebp-208h] BYREF
  CEvn_Event v67; // [esp+260h] [ebp-1F0h] BYREF
  CEvn_Event v68; // [esp+278h] [ebp-1D8h] BYREF
  CEvn_Event v69; // [esp+290h] [ebp-1C0h] BYREF
  CEvn_Event v70; // [esp+2A8h] [ebp-1A8h] BYREF
  CEvn_Event v71; // [esp+2C0h] [ebp-190h] BYREF
  CEvn_Event v72; // [esp+2D8h] [ebp-178h] BYREF
  CEvn_Event v73; // [esp+2F0h] [ebp-160h] BYREF
  CEvn_Event v74; // [esp+308h] [ebp-148h] BYREF
  CEvn_Event v75; // [esp+320h] [ebp-130h] BYREF
  CEvn_Event v76; // [esp+338h] [ebp-118h] BYREF
  CEvn_Event v77; // [esp+350h] [ebp-100h] BYREF
  CEvn_Event v78; // [esp+368h] [ebp-E8h] BYREF
  CEvn_Event v79; // [esp+380h] [ebp-D0h] BYREF
  CEvn_Event v80; // [esp+398h] [ebp-B8h] BYREF
  CEvn_Event v81; // [esp+3B0h] [ebp-A0h] BYREF
  CEvn_Event v82; // [esp+3C8h] [ebp-88h] BYREF
  CEvn_Event v83; // [esp+3E0h] [ebp-70h] BYREF
  CEvn_Event v84; // [esp+3F8h] [ebp-58h] BYREF
  CEvn_Event v85; // [esp+410h] [ebp-40h] BYREF
  CEvn_Event v86; // [esp+428h] [ebp-28h] BYREF
  int v87; // [esp+44Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  if ( a1 && dword_3D891AC < 0 )
  {
    LocalSlot = CPlayerManager::GetLocalSlot();
    v51 = LocalSlot;
    if ( LocalSlot <= 0 )
    {
      if ( byte_4030853 && !byte_4030852 )
      {
        if ( LocalSlot >= 0 )
        {
          if ( g_pGameType )
          {
            Instance = StormManager::GetInstance();
            if ( *(_DWORD *)(g_pGameType + 4 * v51 + 224) == StormManager::GetLocalPeerId(Instance) )
              dword_3D891AC = v51;
          }
        }
      }
      else
      {
        dword_3D891AC = LocalSlot;
      }
    }
    else
    {
      dword_3D891AC = LocalSlot;
    }
    if ( dword_3D891AC >= 0 )
      GuiDlgMainGameSettingstUpdate();
  }
  if ( a1 )
  {
    if ( byte_3ED2030 )
    {
      switch ( a1 )
      {
        case 0:
          goto LABEL_17;
        case 1:
          if ( !byte_3ED2031 && (a2 & 0x10000) != 0 )
            PlayGuiSound(1);
          break;
        case 2:
          if ( (unsigned __int16)a2 == 2153 )
            PlayGuiSound(1);
          break;
        case 3:
          switch ( (__int16)a2 )
          {
            case 2141:
              PlayGuiSound(2);
              v27 = CEvn_Event::CEvn_Event(&v71, 0x4Du, 0, 0, 0);
              v87 = 1;
              IEventEngine::SendAMessage(g_pEvnEngine, v27);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v71);
              break;
            case 2142:
              byte_3ED2030 = 0;
              IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2244, 0);
              for ( i = 0; i < 8; ++i )
              {
                if ( !*(_BYTE *)(i + g_pGameType + 440) )
                {
                  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 9], 0);
                  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_403089C, dword_3690578[11 * i + 10], 0);
                }
              }
              PlayGuiSound(2);
              v26 = CEvn_Event::CEvn_Event(&v70, 0x4Eu, 0, 0, 0);
              v87 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v26);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v70);
              break;
            case 2144:
              PlayGuiSound(2);
              v45 = UPlay::UPlayManager::GetInstance(v12);
              (*(void (__thiscall **)(int))(*(_DWORD *)v45 + 20))(v45);
              break;
            case 2153:
              Text = IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, dword_403089C, 2153);
              if ( Text )
              {
                v29 = CEvn_Event::CEvn_Event(&v74, 0x26u, (unsigned int)Text, 0, 0);
                v87 = 31;
                IEventEngine::SendAMessage(g_pEvnEngine, v29);
                v87 = -1;
                CEvn_Event::~CEvn_Event(&v74);
              }
              IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2153, (char *)&byte_368FC5D);
              IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_403089C, 2153, 1);
              break;
            case 2155:
            case 2156:
            case 2157:
            case 2158:
            case 2159:
            case 2160:
            case 2161:
            case 2162:
              v52 = (char)CPlayerManager::GetLocalSlot();
              v53 = (unsigned __int16)a2 - 2155;
              v54 = 0;
              if ( v52 != v53 && CGameType::IsSlotChangable((CGameType *)g_pGameType, v53, &v54) )
                *(_DWORD *)(g_pGameType + 4 * v52 + 564) = v53;
              if ( v52 == v53 )
              {
                for ( j = 0; j < 9; ++j )
                {
                  if ( *(_DWORD *)(g_pGameType + 4 * j + 564) == v52 )
                    *(_DWORD *)(g_pGameType + 4 * j + 564) = -1;
                }
                *(_DWORD *)(g_pGameType + 4 * v52 + 564) = -1;
              }
              if ( v54 || *(_DWORD *)(g_pGameType + 4 * v53 + 564) == v52 )
              {
                dword_3D891AC = (unsigned __int16)a2 - 2155;
                v23 = CEvn_Event::CEvn_Event(&v67, 0x51u, v52, v53, 0);
                v87 = 5;
                IEventEngine::SendAMessage(g_pEvnEngine, v23);
                v87 = -1;
                CEvn_Event::~CEvn_Event(&v67);
                *(_DWORD *)(g_pGameType + 4 * v52 + 564) = -1;
                *(_DWORD *)(g_pGameType + 4 * v53 + 564) = -1;
              }
              else
              {
                v22 = CEvn_Event::CEvn_Event(&v66, 0x1F58u, v52, v53, 0);
                v87 = 6;
                IEventEngine::SendAMessage(g_pEvnEngine, v22);
                v87 = -1;
                CEvn_Event::~CEvn_Event(&v66);
                GuiDlgMainGameSettingstUpdate();
              }
              PlayGuiSound(2);
              break;
            case 2180:
              v21 = CEvn_Event::CEvn_Event(&v65, 0x52u, 1u, dword_3D891AC, 0);
              v87 = 7;
              IEventEngine::SendAMessage(g_pEvnEngine, v21);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v65);
              PlayGuiSound(2);
              break;
            case 2181:
              v20 = CEvn_Event::CEvn_Event(&v81, 0x52u, 0, dword_3D891AC, 0);
              v87 = 8;
              IEventEngine::SendAMessage(g_pEvnEngine, v20);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v81);
              PlayGuiSound(2);
              break;
            case 2182:
              v19 = CEvn_Event::CEvn_Event(&v63, 0x53u, 1u, dword_3D891AC, 0);
              v87 = 9;
              IEventEngine::SendAMessage(g_pEvnEngine, v19);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v63);
              PlayGuiSound(2);
              break;
            case 2183:
              v18 = CEvn_Event::CEvn_Event(&v62, 0x53u, 0, dword_3D891AC, 0);
              v87 = 10;
              IEventEngine::SendAMessage(g_pEvnEngine, v18);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v62);
              PlayGuiSound(2);
              break;
            case 2184:
              v17 = CEvn_Event::CEvn_Event(&v61, 0x54u, 1u, dword_3D891AC, 0);
              v87 = 11;
              IEventEngine::SendAMessage(g_pEvnEngine, v17);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v61);
              PlayGuiSound(2);
              break;
            case 2185:
              v16 = CEvn_Event::CEvn_Event(&v60, 0x54u, 0, dword_3D891AC, 0);
              v87 = 12;
              IEventEngine::SendAMessage(g_pEvnEngine, v16);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v60);
              PlayGuiSound(2);
              break;
            case 2186:
              v15 = CEvn_Event::CEvn_Event(&v59, 0x55u, 1u, dword_3D891AC, 0);
              v87 = 13;
              IEventEngine::SendAMessage(g_pEvnEngine, v15);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v59);
              PlayGuiSound(2);
              break;
            case 2187:
              v14 = CEvn_Event::CEvn_Event(&v58, 0x55u, 0, dword_3D891AC, 0);
              v87 = 14;
              IEventEngine::SendAMessage(g_pEvnEngine, v14);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v58);
              PlayGuiSound(2);
              break;
            case 2222:
              v13 = CEvn_Event::CEvn_Event(&v57, 0x57u, 0, 0, 0);
              v87 = 15;
              IEventEngine::SendAMessage(g_pEvnEngine, v13);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v57);
              PlayGuiSound(2);
              break;
            case 2223:
              v44 = CEvn_Event::CEvn_Event(&v56, 0x57u, 1u, 0, 0);
              v87 = 16;
              IEventEngine::SendAMessage(g_pEvnEngine, v44);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v56);
              PlayGuiSound(2);
              break;
            case 2224:
              v43 = CEvn_Event::CEvn_Event(&v55, 0x57u, 2u, 0, 0);
              v87 = 17;
              IEventEngine::SendAMessage(g_pEvnEngine, v43);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v55);
              PlayGuiSound(2);
              break;
            case 2225:
              v42 = CEvn_Event::CEvn_Event(&v73, 0x57u, 3u, 0, 0);
              v87 = 18;
              IEventEngine::SendAMessage(g_pEvnEngine, v42);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v73);
              PlayGuiSound(2);
              break;
            case 2226:
              v41 = CEvn_Event::CEvn_Event(&v86, 0x57u, 4u, 0, 0);
              v87 = 19;
              IEventEngine::SendAMessage(g_pEvnEngine, v41);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v86);
              PlayGuiSound(2);
              break;
            case 2227:
              v40 = CEvn_Event::CEvn_Event(&v85, 0x57u, 5u, 0, 0);
              v87 = 20;
              IEventEngine::SendAMessage(g_pEvnEngine, v40);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v85);
              PlayGuiSound(2);
              break;
            case 2228:
              v39 = CEvn_Event::CEvn_Event(&v84, 0x57u, 6u, 0, 0);
              v87 = 21;
              IEventEngine::SendAMessage(g_pEvnEngine, v39);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v84);
              PlayGuiSound(2);
              break;
            case 2229:
              v38 = CEvn_Event::CEvn_Event(&v83, 0x57u, 7u, 0, 0);
              v87 = 22;
              IEventEngine::SendAMessage(g_pEvnEngine, v38);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v83);
              PlayGuiSound(2);
              break;
            case 2230:
              v37 = CEvn_Event::CEvn_Event(&v82, 0x58u, 0, 0, 0);
              v87 = 23;
              IEventEngine::SendAMessage(g_pEvnEngine, v37);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v82);
              PlayGuiSound(2);
              break;
            case 2231:
              v36 = CEvn_Event::CEvn_Event(&v80, 0x58u, 1u, 0, 0);
              v87 = 24;
              IEventEngine::SendAMessage(g_pEvnEngine, v36);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v80);
              PlayGuiSound(2);
              break;
            case 2232:
              v35 = CEvn_Event::CEvn_Event(&v79, 0x58u, 2u, 0, 0);
              v87 = 25;
              IEventEngine::SendAMessage(g_pEvnEngine, v35);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v79);
              PlayGuiSound(2);
              break;
            case 2233:
              v34 = CEvn_Event::CEvn_Event(&v64, 0x58u, 3u, 0, 0);
              v87 = 26;
              IEventEngine::SendAMessage(g_pEvnEngine, v34);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v64);
              PlayGuiSound(2);
              break;
            case 2234:
              v33 = CEvn_Event::CEvn_Event(&v78, 0x58u, 4u, 0, 0);
              v87 = 27;
              IEventEngine::SendAMessage(g_pEvnEngine, v33);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v78);
              PlayGuiSound(2);
              break;
            case 2235:
              v32 = CEvn_Event::CEvn_Event(&v77, 0x58u, 5u, 0, 0);
              v87 = 28;
              IEventEngine::SendAMessage(g_pEvnEngine, v32);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v77);
              PlayGuiSound(2);
              break;
            case 2236:
              v31 = CEvn_Event::CEvn_Event(&v76, 0x58u, 6u, 0, 0);
              v87 = 29;
              IEventEngine::SendAMessage(g_pEvnEngine, v31);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v76);
              PlayGuiSound(2);
              break;
            case 2237:
              v30 = CEvn_Event::CEvn_Event(&v75, 0x58u, 7u, 0, 0);
              v87 = 30;
              IEventEngine::SendAMessage(g_pEvnEngine, v30);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v75);
              PlayGuiSound(2);
              break;
            case 2238:
              goto LABEL_27;
            case 2239:
              Topindex = CGuiChatMsgList::GetTopindex((CGuiChatMsgList *)&s_cMsgLst);
              CGuiChatMsgList::SetTopindex((CGuiChatMsgList *)&s_cMsgLst, Topindex + 1);
              PlayGuiSound(2);
              break;
            case 2244:
              v47 = (char)CPlayerManager::GetLocalSlot();
              for ( k = 0; k < 9; ++k )
              {
                if ( *(_DWORD *)(g_pGameType + 4 * k + 564) == v47 )
                  *(_DWORD *)(g_pGameType + 4 * k + 564) = -1;
              }
              *(_DWORD *)(g_pGameType + 4 * v47 + 564) = -1;
              v25 = CEvn_Event::CEvn_Event(&v69, 0x1F58u, v47, v47, 0);
              v87 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v25);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v69);
              v10 = CPlayerManager::GetLocalSlot();
              CGameType::ChangeLocalSlot((CGameType *)g_pGameType, v10);
              v24 = CEvn_Event::CEvn_Event(&v68, 0x56u, BYTE2(a2) & 1, 0, 0);
              v87 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v24);
              v87 = -1;
              CEvn_Event::~CEvn_Event(&v68);
              PlayGuiSound(2);
              break;
            case 2265:
              PlayGuiSound(2);
              dword_3D891AC = 0;
              GuiDlgMainGameSettingstUpdate();
              break;
            case 2266:
              PlayGuiSound(2);
              dword_3D891AC = 1;
              GuiDlgMainGameSettingstUpdate();
              break;
            case 2267:
              PlayGuiSound(2);
              dword_3D891AC = 2;
              GuiDlgMainGameSettingstUpdate();
              break;
            case 2268:
              PlayGuiSound(2);
              dword_3D891AC = 3;
              GuiDlgMainGameSettingstUpdate();
              break;
            case 2269:
              PlayGuiSound(2);
              dword_3D891AC = 4;
              GuiDlgMainGameSettingstUpdate();
              break;
            case 2270:
              PlayGuiSound(2);
              dword_3D891AC = 5;
              GuiDlgMainGameSettingstUpdate();
              break;
            case 2271:
              PlayGuiSound(2);
              dword_3D891AC = 6;
              GuiDlgMainGameSettingstUpdate();
              break;
            case 2272:
              PlayGuiSound(2);
              dword_3D891AC = 7;
              GuiDlgMainGameSettingstUpdate();
              break;
            default:
              return 1;
          }
          break;
        case 4:
          if ( (unsigned __int16)a2 == 2153 )
            IGuiEngine::SetText((void *)g_pGUIEngine, dword_403089C, 2153, (char *)&byte_368FC5E);
          break;
        case 8:
          if ( a3 == -1 )
          {
            IGuiEngine::SetTooltip((char *)&byte_368FC3A);
          }
          else
          {
            v6 = g_pStringEngine->GetString(g_pStringEngine, a3);
            IGuiEngine::SetTooltip(v6);
          }
          break;
        case 9:
          if ( a3 == -1 )
          {
            IGuiEngine::SetTooltipExt((char *)&byte_368FC3B);
          }
          else
          {
            v7 = g_pStringEngine->GetString(g_pStringEngine, a3);
            IGuiEngine::SetTooltipExt(v7);
          }
          break;
        case 10:
          if ( SHIWORD(a2) <= 0 )
          {
            if ( a2 < 0 )
            {
              v9 = CGuiChatMsgList::GetTopindex((CGuiChatMsgList *)&s_cMsgLst);
              CGuiChatMsgList::SetTopindex((CGuiChatMsgList *)&s_cMsgLst, v9 + 1);
              PlayGuiSound(2);
            }
          }
          else
          {
LABEL_27:
            v8 = CGuiChatMsgList::GetTopindex((CGuiChatMsgList *)&s_cMsgLst);
            CGuiChatMsgList::SetTopindex((CGuiChatMsgList *)&s_cMsgLst, v8 - 1);
            PlayGuiSound(2);
          }
          break;
        case 11:
          v28 = CEvn_Event::CEvn_Event(&v72, 0x78u, 0, 0, 0);
          v87 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v28);
          v87 = -1;
          CEvn_Event::~CEvn_Event(&v72);
          break;
        default:
          return 1;
      }
    }
  }
  else
  {
LABEL_17:
    byte_3ED2031 = 1;
    InitGuiDlgMainGameSettings();
    GuiDlgMainGameSettingstUpdate();
    byte_3ED2031 = 0;
  }
  return 1;
}


// address=[0x13a4270]
// Decompiled from void GuiDlgLoadFillList()
void __cdecl GuiDlgLoadFillList(void) {
  
  char *v0; // eax
  char *v1; // eax
  int v2; // [esp+8h] [ebp-94h]
  int j; // [esp+Ch] [ebp-90h]
  int v4; // [esp+10h] [ebp-8Ch]
  int i; // [esp+14h] [ebp-88h]
  char v6[88]; // [esp+18h] [ebp-84h] BYREF
  _BYTE v7[28]; // [esp+70h] [ebp-2Ch] BYREF
  int v8; // [esp+98h] [ebp-4h]

  for ( i = 0; i < 18; ++i )
  {
    v4 = i + s_iMainLoadTopOffset;
    if ( i < dword_4030378 && dword_4030374 )
    {
      if ( v4 == dword_3EDDCA4 )
      {
        std::wstring::operator=(*(_DWORD *)(dword_4030374 + 4 * v4) + 28);
        v2 = 2;
      }
      else
      {
        v2 = 1;
      }
      std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v6);
      v8 = 0;
      std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
        v7,
        *(_DWORD *)(dword_4030374 + 4 * v4) + 28);
      LOBYTE(v8) = 1;
      v0 = (char *)std::string::c_str(v7);
      IGuiEngine::SetText((void *)g_pGUIEngine, 6, dword_3691FA0[2 * i], v0);
      v1 = (char *)std::string::c_str((void *)(*(_DWORD *)(dword_4030374 + 4 * v4) + 56));
      IGuiEngine::SetText((void *)g_pGUIEngine, 6, dword_3691FA0[2 * i + 1], v1);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 6, dword_3691FA0[2 * i], 1);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 6, dword_3691FA0[2 * i + 1], 1);
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 6, dword_3691FA0[2 * i], v2);
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 6, dword_3691FA0[2 * i + 1], 12);
      LOBYTE(v8) = 0;
      std::string::~string(v7);
      v8 = -1;
      std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v6);
    }
    else
    {
      for ( j = 0; j < 2; ++j )
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 6, dword_3691FA0[2 * i + j], 0);
    }
  }
}


// address=[0x13a4520]
// [Decompilation failed for void __cdecl HighlightEntryDlgMainLoad(int,int,bool)]

// address=[0x13a45b0]
// Decompiled from void InitGuiDlgMainLoad()
void __cdecl InitGuiDlgMainLoad(void) {
  
  char *v0; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 1232);
    IGuiEngine::SetText((void *)g_pGUIEngine, 6, 2338, v0);
  }
}


// address=[0x13a45f0]
// Decompiled from char __cdecl GuiDlgMainLoadProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainLoadProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-60h]
  CEvn_Event *v7; // [esp+Ch] [ebp-58h]
  bool v8; // [esp+23h] [ebp-41h]
  CEvn_Event v9; // [esp+24h] [ebp-40h] BYREF
  CEvn_Event v10; // [esp+3Ch] [ebp-28h] BYREF
  int v11; // [esp+60h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      v8 = 0;
      InitGuiDlgMainLoad();
      dword_3EDDCA4 = 0;
      if ( dword_4030378 > 0 )
      {
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 6, 2342, 1);
        v8 = dword_4030378 > 18;
        GuiDlgLoadFillList();
      }
      else
      {
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 6, 2342, 0);
      }
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 6, 2340, v8);
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 6, 2341, v8);
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 2339:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v10, 0x5Eu, 0, 0, 0);
          v11 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v11 = -1;
          CEvn_Event::~CEvn_Event(&v10);
          break;
        case 2340:
          if ( s_iMainLoadTopOffset > 0 )
          {
            --s_iMainLoadTopOffset;
            PlayGuiSound(2);
            GuiDlgLoadFillList();
          }
          break;
        case 2341:
          if ( s_iMainLoadTopOffset + 18 < dword_4030378 )
          {
            ++s_iMainLoadTopOffset;
            PlayGuiSound(2);
            GuiDlgLoadFillList();
          }
          break;
        case 2342:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v9, 0x5Fu, dword_3EDDCA4, 0, 0);
          v11 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v11 = -1;
          CEvn_Event::~CEvn_Event(&v9);
          break;
        case 2343:
        case 2344:
          dword_3EDDCA4 = s_iMainLoadTopOffset;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2345:
        case 2362:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 1;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2346:
        case 2363:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 2;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2347:
        case 2364:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 3;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2348:
        case 2365:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 4;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2349:
        case 2366:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 5;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2350:
        case 2367:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 6;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2351:
        case 2368:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 7;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2352:
        case 2369:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 8;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2353:
        case 2370:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 9;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2354:
        case 2371:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 10;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2355:
        case 2372:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 11;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2356:
        case 2373:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 12;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2357:
        case 2374:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 13;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2358:
        case 2375:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 14;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2359:
        case 2376:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 15;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2360:
        case 2377:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 16;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        case 2361:
        case 2378:
          dword_3EDDCA4 = s_iMainLoadTopOffset + 17;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3691F98);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3691F99);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 && s_iMainLoadTopOffset + 18 < dword_4030378 )
        {
          ++s_iMainLoadTopOffset;
          PlayGuiSound(2);
          GuiDlgLoadFillList();
        }
      }
      else if ( s_iMainLoadTopOffset > 0 )
      {
        --s_iMainLoadTopOffset;
        PlayGuiSound(2);
        GuiDlgLoadFillList();
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13a4ec0]
// Decompiled from void InitGuiDlgMainLoadType()
void __cdecl InitGuiDlgMainLoadType(void) {
  
  char *v0; // eax
  int v1; // ecx
  int Instance; // eax
  bool v3; // [esp+7h] [ebp-1h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 1232);
    IGuiEngine::SetText((void *)g_pGUIEngine, 5, 2388, v0);
    Instance = UPlay::UPlayManager::GetInstance(v1);
    v3 = (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)Instance + 32))(Instance, Instance) == 0;
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 5, 2391, v3);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 5, 2391, 1258, 0);
  }
}


// address=[0x13a4f60]
// Decompiled from char __cdecl GuiDlgMainLoadTypeProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgMainLoadTypeProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-98h]
  CEvn_Event *v7; // [esp+Ch] [ebp-90h]
  CEvn_Event *v8; // [esp+14h] [ebp-88h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-80h]
  CEvn_Event v10; // [esp+2Ch] [ebp-70h] BYREF
  CEvn_Event v11; // [esp+44h] [ebp-58h] BYREF
  CEvn_Event v12; // [esp+5Ch] [ebp-40h] BYREF
  CEvn_Event v13; // [esp+74h] [ebp-28h] BYREF
  int v14; // [esp+98h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainLoadType();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0x955u:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v12, 0x5Du, 0, 0, 0);
          v14 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case 0x956u:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v11, 0x5Bu, 0, 0, 0);
          v14 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        case 0x957u:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v10, 0x5Cu, 0, 0, 0);
          v14 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v10);
          break;
        case 0x95Fu:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v13, 0x5Au, 0, 0, 0);
          v14 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)dword_369204C + 2);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)dword_369204C + 3);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13a5340]
// Decompiled from void InitGuiDlgMainLocalType()
void __cdecl InitGuiDlgMainLocalType(void) {
  
  char *v0; // eax
  char *v1; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 888);
    IGuiEngine::SetText((void *)g_pGUIEngine, 7, 2405, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2071);
    IGuiEngine::SetText((void *)g_pGUIEngine, 7, 2402, v1);
    IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 7, 2414);
    if ( dword_4031CFC )
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 7, 2414, 1);
    else
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 7, 2413, 1);
  }
}


// address=[0x13a53f0]
// Decompiled from char __cdecl GuiDlgMainLocalTypeProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainLocalTypeProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-98h]
  CEvn_Event *v7; // [esp+Ch] [ebp-90h]
  CEvn_Event *v8; // [esp+14h] [ebp-88h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-80h]
  CEvn_Event v10; // [esp+2Ch] [ebp-70h] BYREF
  CEvn_Event v11; // [esp+44h] [ebp-58h] BYREF
  CEvn_Event v12; // [esp+5Ch] [ebp-40h] BYREF
  CEvn_Event v13; // [esp+74h] [ebp-28h] BYREF
  int v14; // [esp+98h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainLocalType();
      break;
    case 1:
      if ( ((a2 >> 16) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 2400:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v13, 0x60u, 0, 0, 0);
          v14 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case 2401:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v12, 0x61u, 0, 0, 0);
          v14 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case 2403:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v11, 0x63u, 0, 0, 0);
          v14 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        case 2404:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v10, 0x62u, 0, 0, 0);
          v14 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v10);
          break;
        case 2413:
          PlayGuiSound(2);
          dword_4031CFC = 0;
          break;
        case 2414:
          PlayGuiSound(2);
          dword_4031CFC = 1;
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&dword_369204C[1]);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&dword_369204C[1] + 1);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13a5820]
// Decompiled from char GuiDlgMapSettingsFillPlayerTeams()
void __cdecl GuiDlgMapSettingsFillPlayerTeams(void) {
  
  CHAR Str[256]; // [esp+4h] [ebp-104h] BYREF

  _wsprintfA(Str, "%d", dword_4031924);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2443, Str);
  _wsprintfA(Str, "%d", dword_4031928);
  return IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2447, Str);
}


// address=[0x13a58c0]
// Decompiled from void GuiDlgMapSettingsFillList()
void __cdecl GuiDlgMapSettingsFillList(void) {
  
  char *v0; // eax
  int j; // [esp+8h] [ebp-140h]
  int v2; // [esp+Ch] [ebp-13Ch]
  int v3; // [esp+10h] [ebp-138h]
  int i; // [esp+18h] [ebp-130h]
  char v5[28]; // [esp+1Ch] [ebp-12Ch] BYREF
  CHAR Str[256]; // [esp+38h] [ebp-110h] BYREF
  int v7; // [esp+144h] [ebp-4h]

  String::String((char *)&byte_3692103, -1);
  v7 = 0;
  byte_3EDDCEC = 1;
  for ( i = 0; i < 7; ++i )
  {
    v3 = i + g_iMapListTopOffset;
    if ( i >= dword_4031918 )
    {
      for ( j = 0; j < 6; ++j )
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i + j], 0);
    }
    else
    {
      if ( v3 == dword_403192C )
        v2 = 2;
      else
        v2 = 1;
      v0 = (char *)std::string::c_str(*(void **)(dword_4031920 + 4 * v3));
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i], v0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i], 1);
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i], v2);
      _wsprintfA(Str, " %d ", *(_DWORD *)(*(_DWORD *)(dword_4031920 + 4 * v3) + 60));
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i + 1], Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i + 1], 1);
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i + 1], v2);
      if ( *(_BYTE *)(*(_DWORD *)(dword_4031920 + 4 * v3) + 79) )
        _wsprintfA(Str, "%d", *(_DWORD *)(*(_DWORD *)(dword_4031920 + 4 * v3) + 56));
      else
        _wsprintfA(Str, "%d-%d", 1, *(_DWORD *)(*(_DWORD *)(dword_4031920 + 4 * v3) + 56));
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i + 2], Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i + 2], 1);
      IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, dword_4031998, dword_3692058[6 * i + 2], v2);
      IGuiEngine::SetControlVisibility(
        (void *)g_pGUIEngine,
        dword_4031998,
        dword_3692058[6 * i + 3],
        *(_BYTE *)(*(_DWORD *)(dword_4031920 + 4 * v3) + 72));
      if ( byte_4031914 )
        IGuiEngine::SetControlVisibility(
          (void *)g_pGUIEngine,
          dword_4031998,
          dword_3692058[6 * i + 4],
          *(_BYTE *)(*(_DWORD *)(dword_4031920 + 4 * v3) + 76));
      else
        IGuiEngine::SetControlVisibility(
          (void *)g_pGUIEngine,
          dword_4031998,
          dword_3692058[6 * i + 4],
          *(_BYTE *)(*(_DWORD *)(dword_4031920 + 4 * v3) + 73));
      IGuiEngine::SetControlVisibility(
        (void *)g_pGUIEngine,
        dword_4031998,
        dword_3692058[6 * i + 5],
        *(_BYTE *)(*(_DWORD *)(dword_4031920 + 4 * v3) + 74));
    }
  }
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2442, byte_403195A);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2441, byte_403195A);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2446, byte_403195B);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2445, byte_403195B);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2489, byte_4031959);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2490, byte_4031959);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2491, byte_403195C);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2492, byte_403195C);
  byte_3EDDCEC = 0;
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2487, byte_4031958);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2488, byte_4031958);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2433, dword_4031918 > 0);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2506, (char *)&byte_3692107);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2505, 0);
  v7 = -1;
  String::~String((String *)v5);
}


// address=[0x13a5f00]
// Decompiled from void __cdecl GuiDlgMapSettingsMapSelect(int a1)
void __cdecl GuiDlgMapSettingsMapSelect(int a1) {
  
  CEvn_Event *v1; // [esp+4h] [ebp-34h]
  CEvn_Event v2; // [esp+10h] [ebp-28h] BYREF
  int v3; // [esp+34h] [ebp-4h]

  dword_3EDDCF0 = g_iMapListTopOffset + a1;
  v1 = CEvn_Event::CEvn_Event(&v2, 0x47u, g_iMapListTopOffset + a1, 0, 0);
  v3 = 0;
  IEventEngine::SendAMessage(g_pEvnEngine, v1);
  v3 = -1;
  CEvn_Event::~CEvn_Event(&v2);
  PlayGuiSound(2);
}


// address=[0x13a5fb0]
// Decompiled from bool GuiDlgMapSettingsUpdate()
void __cdecl GuiDlgMapSettingsUpdate(void) {
  
  const wchar_t *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char Dest[256]; // [esp+14h] [ebp-104h] BYREF

  v0 = (const wchar_t *)std::wstring::c_str((_Cnd_internal_imp_t *)&unk_4031960);
  j__wcstombs(Dest, v0, 0x100u);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2452, Dest);
  switch ( dword_403191C )
  {
    case 0:
      goto LABEL_4;
    case 1:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2450, 1);
      break;
    case 2:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2451, 1);
      break;
    default:
LABEL_4:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2449, 1);
      break;
  }
  GuiDlgMapSettingsFillPlayerTeams();
  GuiDlgMapSettingsFillList();
  switch ( dword_4031930 )
  {
    case 1:
      v1 = g_pStringEngine->GetString(g_pStringEngine, 2056);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2485, v1);
      break;
    case 2:
      v2 = g_pStringEngine->GetString(g_pStringEngine, 2049);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2485, v2);
      break;
    case 3:
      v3 = g_pStringEngine->GetString(g_pStringEngine, 2046);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2485, v3);
      break;
  }
  switch ( dword_4031934 )
  {
    case 1:
      v4 = g_pStringEngine->GetString(g_pStringEngine, 2040);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2484, v4);
      break;
    case 2:
      v6 = g_pStringEngine->GetString(g_pStringEngine, 2041);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2484, v6);
      break;
    case 3:
      v5 = g_pStringEngine->GetString(g_pStringEngine, 2042);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2484, v5);
      break;
    case 4:
      v7 = g_pStringEngine->GetString(g_pStringEngine, 2309);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2484, v7);
      break;
    case 5:
      v8 = g_pStringEngine->GetString(g_pStringEngine, 2043);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2484, v8);
      break;
    default:
      break;
  }
  v9 = (char *)std::string::c_str(&unk_403193C);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2486, v9);
  v10 = (char *)std::string::c_str(&unk_403197C);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2494, v10);
  if ( CGameType::IsAddOnMap((CGameType *)g_pGameType) )
  {
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2508, 1);
    return IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2508, 0);
  }
  else if ( CGameType::IsEmptyMap((CGameType *)g_pGameType) )
  {
    return IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2508, 1);
  }
  else
  {
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2508, 1);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2508, 0);
    return IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2508, 0);
  }
}


// address=[0x13a63a0]
// Decompiled from void InitGuiDlgMainMapSettings()
void __cdecl InitGuiDlgMainMapSettings(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  int Instance; // eax
  int v8; // eax
  int v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *Str; // [esp+0h] [ebp-Ch]
  char v13; // [esp+Ah] [ebp-2h]
  bool v14; // [esp+Bh] [ebp-1h]

  if ( g_pStringEngine )
  {
    if ( !g_pAddOn && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 690, "g_pAddOn") == 1 )
      __debugbreak();
    if ( !g_pMissionCD2 && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 691, "g_pMissionCD2") == 1 )
      __debugbreak();
    if ( !g_pMissionCD3 && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 692, "g_pMissionCD3") == 1 )
      __debugbreak();
    if ( g_pAddOn )
    {
      if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn) )
        g_uiExtrasAllowed |= 1u;
      else
        g_uiExtrasAllowed &= ~1u;
    }
    if ( (g_uiExtrasAllowed & 1) == 0 && g_pMissionCD2 )
    {
      if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
        g_uiExtrasAllowed |= 1u;
      else
        g_uiExtrasAllowed &= ~1u;
    }
    if ( (g_uiExtrasAllowed & 1) == 0
      && g_pMissionCD3
      && (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD3 + 4))(g_pMissionCD3) )
    {
      g_uiExtrasAllowed |= 1u;
    }
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2017);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2416, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2062);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2444, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2073);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2448, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2033);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2474, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2053);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2482, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2050);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2481, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 2055);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2483, v6);
    IGuiEngine::SetTypeAsRadio((IGuiEngine *)g_pGUIEngine, dword_4031998, 2494, 0xE9u, 0xEAu);
    IGuiEngine::SetRadioCheckPressedState((IGuiEngine *)g_pGUIEngine, dword_4031998, 2494, g_bIsPrivateSession);
    IGuiEngine::SetPosition((IGuiEngine *)g_pGUIEngine, dword_4031998, 2494, 0x264u, 0x1E4u);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2494, g_bIsPrivateSession);
    Instance = OnlineManager::GetInstance();
    v14 = (unsigned __int8)OnlineManager::IsQuickMatchFlow(Instance) == 0;
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2494, v14);
    v8 = OnlineManager::GetInstance();
    if ( (unsigned __int8)OnlineManager::IsQuickMatchFlow(v8) )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2493, (char *)&unk_369210D);
    }
    else
    {
      Str = g_pStringEngine->GetString(g_pStringEngine, 3836);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2493, Str);
    }
    v9 = OnlineManager::GetInstance();
    v13 = (unsigned __int8)OnlineManager::IsQuickMatchFlow(v9) == 0;
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2494, v13);
    IGuiEngine::SetEditProperties((IGuiEngine *)g_pGUIEngine, dword_4031998, 2452, 0x20u, 4u);
    v10 = g_pStringEngine->GetString(g_pStringEngine, 2052);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2506, v10);
    v11 = g_pStringEngine->GetString(g_pStringEngine, 297);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2509, v11);
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
      || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2509, 1);
    }
    else
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2509, 0);
    }
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
      || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2508, 1);
    }
    else
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2508, 0);
    }
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2508, g_uiExtrasAllowed & 1);
    if ( !g_pMissionCD && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 844, "g_pMissionCD") == 1 )
      __debugbreak();
    if ( !g_pAddOn && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 845, "g_pAddOn") == 1 )
      __debugbreak();
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD + 4))(g_pMissionCD)
      || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
      || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2)
      || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD3 + 4))(g_pMissionCD3) )
    {
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2507, 1);
    }
    else
    {
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2507, 0);
    }
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, dword_4031998, 2507, 3837, 3837);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2449, dword_4031998 == 18);
  }
}


// address=[0x13a6a40]
// Decompiled from char __cdecl GuiDlgMainMapSettingsProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainMapSettingsProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  int Instance; // eax
  OnlineManager *v7; // eax
  CEvn_Event *v8; // [esp+8h] [ebp-58Ch]
  CEvn_Event *v9; // [esp+10h] [ebp-584h]
  CEvn_Event *v10; // [esp+18h] [ebp-57Ch]
  CEvn_Event *v11; // [esp+20h] [ebp-574h]
  CEvn_Event *v12; // [esp+28h] [ebp-56Ch]
  CEvn_Event *v13; // [esp+34h] [ebp-560h]
  CEvn_Event *v14; // [esp+3Ch] [ebp-558h]
  CEvn_Event *v15; // [esp+44h] [ebp-550h]
  CEvn_Event *v16; // [esp+4Ch] [ebp-548h]
  CEvn_Event *v17; // [esp+54h] [ebp-540h]
  int v18; // [esp+5Ch] [ebp-538h]
  CEvn_Event *v19; // [esp+60h] [ebp-534h]
  CEvn_Event *v20; // [esp+6Ch] [ebp-528h]
  CEvn_Event *v21; // [esp+7Ch] [ebp-518h]
  CEvn_Event *v22; // [esp+84h] [ebp-510h]
  CEvn_Event *v23; // [esp+8Ch] [ebp-508h]
  CEvn_Event *v24; // [esp+94h] [ebp-500h]
  CEvn_Event *v25; // [esp+9Ch] [ebp-4F8h]
  CEvn_Event *v26; // [esp+A4h] [ebp-4F0h]
  CEvn_Event *v27; // [esp+ACh] [ebp-4E8h]
  CEvn_Event *v28; // [esp+B4h] [ebp-4E0h]
  CEvn_Event *v29; // [esp+B8h] [ebp-4DCh]
  CEvn_Event *v30; // [esp+BCh] [ebp-4D8h]
  CEvn_Event *v31; // [esp+C4h] [ebp-4D0h]
  CEvn_Event *v32; // [esp+CCh] [ebp-4C8h]
  CEvn_Event *v33; // [esp+D4h] [ebp-4C0h]
  CEvn_Event *v34; // [esp+DCh] [ebp-4B8h]
  char *Source; // [esp+E0h] [ebp-4B4h]
  char v36; // [esp+F7h] [ebp-49Dh]
  int v37[7]; // [esp+F8h] [ebp-49Ch] BYREF
  CEvn_Event v38; // [esp+114h] [ebp-480h] BYREF
  CEvn_Event v39; // [esp+12Ch] [ebp-468h] BYREF
  CEvn_Event v40; // [esp+144h] [ebp-450h] BYREF
  CEvn_Event v41; // [esp+15Ch] [ebp-438h] BYREF
  CEvn_Event v42; // [esp+174h] [ebp-420h] BYREF
  CEvn_Event v43; // [esp+18Ch] [ebp-408h] BYREF
  CEvn_Event v44; // [esp+1A4h] [ebp-3F0h] BYREF
  CEvn_Event v45; // [esp+1BCh] [ebp-3D8h] BYREF
  CEvn_Event v46; // [esp+1D4h] [ebp-3C0h] BYREF
  CEvn_Event v47; // [esp+1ECh] [ebp-3A8h] BYREF
  CEvn_Event v48; // [esp+204h] [ebp-390h] BYREF
  CEvn_Event v49; // [esp+21Ch] [ebp-378h] BYREF
  CEvn_Event v50; // [esp+234h] [ebp-360h] BYREF
  CEvn_Event v51; // [esp+24Ch] [ebp-348h] BYREF
  CEvn_Event v52; // [esp+264h] [ebp-330h] BYREF
  CEvn_Event v53; // [esp+27Ch] [ebp-318h] BYREF
  CEvn_Event v54; // [esp+294h] [ebp-300h] BYREF
  CEvn_Event v55; // [esp+2ACh] [ebp-2E8h] BYREF
  CEvn_Event v56; // [esp+2C4h] [ebp-2D0h] BYREF
  CEvn_Event v57; // [esp+2DCh] [ebp-2B8h] BYREF
  CEvn_Event v58; // [esp+2F4h] [ebp-2A0h] BYREF
  CEvn_Event v59; // [esp+30Ch] [ebp-288h] BYREF
  CEvn_Event v60; // [esp+324h] [ebp-270h] BYREF
  CEvn_Event v61; // [esp+33Ch] [ebp-258h] BYREF
  CEvn_Event v62; // [esp+354h] [ebp-240h] BYREF
  CEvn_Event v63; // [esp+36Ch] [ebp-228h] BYREF
  wchar_t Dest[256]; // [esp+384h] [ebp-210h] BYREF
  int v65; // [esp+590h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      dword_3EDDCF0 = 0;
      g_iMapListTopOffset = 0;
      byte_3EDDCEC = 1;
      InitGuiDlgMainMapSettings();
      GuiDlgMapSettingsUpdate();
      byte_3EDDCEC = 0;
      break;
    case 1:
      if ( (unsigned __int16)a2 == 2494 )
        g_bIsPrivateSession = BYTE2(a2) & 1;
      if ( !byte_3EDDCEC )
      {
        if ( ((a2 >> 16) & 1) != 0 )
          PlayGuiSound(1);
        else
          PlayGuiSound(0);
      }
      break;
    case 2:
      if ( (unsigned __int16)a2 == 2452 )
      {
        PlayGuiSound(2);
        Source = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, dword_4031998, 2452);
        if ( Source )
        {
          j__mbstowcs(Dest, Source, 0x100u);
          std::wstring::operator=(&unk_4031960, Dest);
          PlayGuiSound(2);
        }
      }
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 2415:
          if ( !g_pAddOn && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 1023, "g_pAddOn") == 1 )
            __debugbreak();
          if ( !g_pMissionCD2 && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 1024, "g_pMissionCD2") == 1 )
            __debugbreak();
          if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
            || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
          {
            g_uiExtrasAllowed |= 1u;
          }
          else
          {
            g_uiExtrasAllowed &= ~1u;
          }
          v19 = CEvn_Event::CEvn_Event(&v52, 0x3Fu, 0, 0, 0);
          v65 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v19);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v52);
          break;
        case 2417:
          GuiDlgMapSettingsMapSelect(0);
          break;
        case 2418:
          GuiDlgMapSettingsMapSelect(1);
          break;
        case 2419:
          GuiDlgMapSettingsMapSelect(2);
          break;
        case 2420:
          GuiDlgMapSettingsMapSelect(3);
          break;
        case 2421:
          GuiDlgMapSettingsMapSelect(4);
          break;
        case 2422:
          GuiDlgMapSettingsMapSelect(5);
          break;
        case 2423:
          GuiDlgMapSettingsMapSelect(6);
          break;
        case 2431:
          if ( g_iMapListTopOffset > 0 )
          {
            --g_iMapListTopOffset;
            PlayGuiSound(2);
            GuiDlgMapSettingsFillList();
          }
          break;
        case 2432:
          if ( g_iMapListTopOffset + 7 < dword_4031918 )
          {
            ++g_iMapListTopOffset;
            PlayGuiSound(2);
            GuiDlgMapSettingsFillList();
          }
          break;
        case 2433:
          Instance = OnlineManager::GetInstance();
          if ( (unsigned __int8)OnlineManager::IsQuickMatchFlow(Instance) )
            v36 = 0;
          else
            v36 = g_bIsPrivateSession;
          v7 = (OnlineManager *)OnlineManager::GetInstance();
          OnlineManager::SetPrivate(v7, v36);
          byte_403199C = g_uiExtrasAllowed;
          if ( g_uiExtrasAllowed && byte_4031914 )
          {
            v18 = std::operator+<wchar_t>((int)v37, (wchar_t *)L"(Troja) ", (int)&unk_4031960);
            std::wstring::operator=(v18);
            std::wstring::~wstring(v37);
          }
          if ( (unsigned int)std::wstring::length(&unk_4031960) >= 0x1F )
            std::wstring::resize(32, 0);
          PlayGuiSound(2);
          v17 = CEvn_Event::CEvn_Event(&v51, 0x40u, 0, 0, 0);
          v65 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v51);
          break;
        case 2441:
          PlayGuiSound(2);
          v16 = CEvn_Event::CEvn_Event(&v50, 0x44u, 1u, 0, 0);
          v65 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v50);
          break;
        case 2442:
          PlayGuiSound(2);
          v15 = CEvn_Event::CEvn_Event(&v55, 0x44u, 0, 0, 0);
          v65 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v55);
          break;
        case 2445:
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v49, 0x43u, 1u, 0, 0);
          v65 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v49);
          break;
        case 2446:
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v48, 0x43u, 0, 0, 0);
          v65 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v48);
          break;
        case 2449:
          if ( dword_403191C )
          {
            g_iMapListTopOffset = 0;
            v12 = CEvn_Event::CEvn_Event(&v47, 0x41u, 0, 0, 0);
            v65 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v65 = -1;
            CEvn_Event::~CEvn_Event(&v47);
          }
          break;
        case 2450:
          if ( dword_403191C != 1 )
          {
            g_iMapListTopOffset = 0;
            v11 = CEvn_Event::CEvn_Event(&v63, 0x41u, 1u, 0, 0);
            v65 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v65 = -1;
            CEvn_Event::~CEvn_Event(&v63);
          }
          break;
        case 2451:
          if ( dword_403191C != 2 )
          {
            g_iMapListTopOffset = 0;
            v10 = CEvn_Event::CEvn_Event(&v45, 0x41u, 2u, 0, 0);
            v65 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v65 = -1;
            CEvn_Event::~CEvn_Event(&v45);
          }
          break;
        case 2475:
          goto LABEL_89;
        case 2476:
          v34 = CEvn_Event::CEvn_Event(&v42, 0x48u, 1u, 0, 0);
          v65 = 13;
          IEventEngine::SendAMessage(g_pEvnEngine, v34);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v42);
          break;
        case 2477:
          v33 = CEvn_Event::CEvn_Event(&v41, 0x48u, 2u, 0, 0);
          v65 = 14;
          IEventEngine::SendAMessage(g_pEvnEngine, v33);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v41);
          break;
        case 2478:
          v32 = CEvn_Event::CEvn_Event(&v40, 0x48u, 3u, 0, 0);
          v65 = 15;
          IEventEngine::SendAMessage(g_pEvnEngine, v32);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v40);
          break;
        case 2479:
          v31 = CEvn_Event::CEvn_Event(&v46, 0x48u, 4u, 0, 0);
          v65 = 16;
          IEventEngine::SendAMessage(g_pEvnEngine, v31);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v46);
          break;
        case 2480:
          v30 = CEvn_Event::CEvn_Event(&v39, 0x48u, 5u, 0, 0);
          v65 = 17;
          IEventEngine::SendAMessage(g_pEvnEngine, v30);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v39);
          break;
        case 2487:
          PlayGuiSound(2);
          v28 = CEvn_Event::CEvn_Event(&v38, 0x45u, 0, 0, 0);
          v65 = 18;
          IEventEngine::SendAMessage(g_pEvnEngine, v28);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v38);
          break;
        case 2488:
          PlayGuiSound(2);
          v27 = CEvn_Event::CEvn_Event(&v62, 0x45u, 1u, 0, 0);
          v65 = 19;
          IEventEngine::SendAMessage(g_pEvnEngine, v27);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v62);
          break;
        case 2489:
          PlayGuiSound(2);
          v26 = CEvn_Event::CEvn_Event(&v61, 0x46u, 0, 0, 0);
          v65 = 20;
          IEventEngine::SendAMessage(g_pEvnEngine, v26);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v61);
          break;
        case 2490:
          PlayGuiSound(2);
          v25 = CEvn_Event::CEvn_Event(&v60, 0x46u, 1u, 0, 0);
          v65 = 21;
          IEventEngine::SendAMessage(g_pEvnEngine, v25);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v60);
          break;
        case 2491:
          PlayGuiSound(2);
          v24 = CEvn_Event::CEvn_Event(&v59, 0x42u, 0, 0, 0);
          v65 = 22;
          IEventEngine::SendAMessage(g_pEvnEngine, v24);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v59);
          break;
        case 2492:
          PlayGuiSound(2);
          v23 = CEvn_Event::CEvn_Event(&v58, 0x42u, 1u, 0, 0);
          v65 = 23;
          IEventEngine::SendAMessage(g_pEvnEngine, v23);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v58);
          break;
        case 2505:
          if ( ((a2 >> 16) & 1) != 0 )
          {
            v22 = CEvn_Event::CEvn_Event(&v57, 0x49u, 1u, 0, 0);
            v65 = 24;
            IEventEngine::SendAMessage(g_pEvnEngine, v22);
            v65 = -1;
            CEvn_Event::~CEvn_Event(&v57);
          }
          else
          {
            v21 = CEvn_Event::CEvn_Event(&v56, 0x49u, 0, 0, 0);
            v65 = 25;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v65 = -1;
            CEvn_Event::~CEvn_Event(&v56);
          }
          PlayGuiSound(2);
          break;
        case 2507:
          v9 = CEvn_Event::CEvn_Event(&v44, 0x1B69u, 0, 0, 0);
          v65 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v44);
LABEL_89:
          v8 = CEvn_Event::CEvn_Event(&v43, 0x48u, 0, 0, 0);
          v65 = 12;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v65 = -1;
          CEvn_Event::~CEvn_Event(&v43);
          break;
        case 2508:
          if ( !g_pAddOn && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 1000, "g_pAddOn") == 1 )
            __debugbreak();
          if ( !g_pMissionCD2 && BBSupportDbgReport(2, "gui\\GUI_MainMapSettings.cpp", 1001, "g_pMissionCD2") == 1 )
            __debugbreak();
          if ( g_pAddOn
            && g_pMissionCD2
            && ((*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
             || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2)) )
          {
            if ( ((a2 >> 16) & 1) != 0 )
              g_uiExtrasAllowed |= 1u;
            else
              g_uiExtrasAllowed &= ~1u;
            v29 = CEvn_Event::CEvn_Event(&v53, 0x4Bu, (unsigned __int8)g_uiExtrasAllowed, 0, 0);
            v65 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v29);
            v65 = -1;
            CEvn_Event::~CEvn_Event(&v53);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369210E);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_369210F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 && g_iMapListTopOffset + 7 < dword_4031918 )
        {
          ++g_iMapListTopOffset;
          PlayGuiSound(2);
          GuiDlgMapSettingsFillList();
        }
      }
      else if ( g_iMapListTopOffset > 0 )
      {
        --g_iMapListTopOffset;
        PlayGuiSound(2);
        GuiDlgMapSettingsFillList();
      }
      break;
    case 11:
      v20 = CEvn_Event::CEvn_Event(&v54, 0x47u, dword_3EDDCF0, 0, 0);
      v65 = 0;
      IEventEngine::SendAMessage(g_pEvnEngine, v20);
      v65 = -1;
      CEvn_Event::~CEvn_Event(&v54);
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13a8550]
// Decompiled from void InitGuiDlgMainMessageBox()
void __cdecl InitGuiDlgMainMessageBox(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2317);
    IGuiEngine::SetText((void *)g_pGUIEngine, 20, 2510, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2382);
    IGuiEngine::SetText((void *)g_pGUIEngine, 20, 2511, v1);
    v2 = (char *)std::string::c_str(&g_iMessageBoxStringID);
    IGuiEngine::SetText((void *)g_pGUIEngine, 20, 2519, v2);
  }
}


// address=[0x13a85e0]
// Decompiled from char __cdecl GuiDlgMainMessageBoxProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgMainMessageBoxProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-38h]
  CEvn_Event v7; // [esp+14h] [ebp-28h] BYREF
  int v8; // [esp+38h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainMessageBox();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( S4LoWord(a2) == 2510 )
      {
        v6 = CEvn_Event::CEvn_Event(&v7, 0x72u, 0, 0, 0);
        v8 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v6);
        v8 = -1;
        CEvn_Event::~CEvn_Event(&v7);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36941F2);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_36941F3);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13a8810]
// Decompiled from char __cdecl GuiDlgMainscreenProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainscreenProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  int v5; // [esp+4h] [ebp-198h]
  int v6; // [esp+Ch] [ebp-190h]
  int v7; // [esp+14h] [ebp-188h]
  int v8; // [esp+1Ch] [ebp-180h]
  int v9; // [esp+24h] [ebp-178h]
  int v10; // [esp+2Ch] [ebp-170h]
  int v11; // [esp+34h] [ebp-168h]
  int v12; // [esp+3Ch] [ebp-160h]
  int v13; // [esp+44h] [ebp-158h]
  int v14; // [esp+4Ch] [ebp-150h]
  int v15; // [esp+54h] [ebp-148h]
  int v16; // [esp+5Ch] [ebp-140h]
  _BYTE v17[24]; // [esp+6Ch] [ebp-130h] BYREF
  _BYTE v18[24]; // [esp+84h] [ebp-118h] BYREF
  _BYTE v19[24]; // [esp+9Ch] [ebp-100h] BYREF
  _BYTE v20[24]; // [esp+B4h] [ebp-E8h] BYREF
  _BYTE v21[24]; // [esp+CCh] [ebp-D0h] BYREF
  _BYTE v22[24]; // [esp+E4h] [ebp-B8h] BYREF
  _BYTE v23[24]; // [esp+FCh] [ebp-A0h] BYREF
  _BYTE v24[24]; // [esp+114h] [ebp-88h] BYREF
  _BYTE v25[24]; // [esp+12Ch] [ebp-70h] BYREF
  _BYTE v26[24]; // [esp+144h] [ebp-58h] BYREF
  _BYTE v27[24]; // [esp+15Ch] [ebp-40h] BYREF
  _BYTE v28[24]; // [esp+174h] [ebp-28h] BYREF
  int v29; // [esp+198h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainscreen();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      PlayGuiSound(2);
      switch ( (__int16)a2 )
      {
        case 2531:
          v15 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 96], 0, 0, 0);
          IEventEngine::SendAMessage(v15);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v22);
          break;
        case 2532:
          v16 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 144], 0, 0, 0);
          IEventEngine::SendAMessage(v16);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v21);
          break;
        case 2533:
          v10 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 384], 0, 0, 0);
          IEventEngine::SendAMessage(v10);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v17);
          break;
        case 2534:
          v6 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 192], 0, 0, 0);
          IEventEngine::SendAMessage(v6);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v24);
          break;
        case 2535:
          v14 = CEvn_Event::CEvn_Event(aControls[3 * iStatus], 0, 0, 0);
          IEventEngine::SendAMessage(v14);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v23);
          break;
        case 2536:
          v7 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 240], 0, 0, 0);
          IEventEngine::SendAMessage(v7);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v25);
          break;
        case 2537:
          v8 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 288], 0, 0, 0);
          IEventEngine::SendAMessage(v8);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v26);
          break;
        case 2538:
          v9 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 336], 0, 0, 0);
          IEventEngine::SendAMessage(v9);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v27);
          break;
        case 2548:
          v5 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 48], 0, 0, 0);
          IEventEngine::SendAMessage(v5);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v18);
          break;
        case 2549:
          v13 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 432], 0, 0, 0);
          IEventEngine::SendAMessage(v13);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v19);
          break;
        case 2550:
          v12 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 480], 0, 0, 0);
          IEventEngine::SendAMessage(v12);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v20);
          break;
        case 2551:
          v11 = CEvn_Event::CEvn_Event(aControls[3 * iStatus + 528], 0, 0, 0);
          IEventEngine::SendAMessage(v11);
          v29 = -1;
          CEvn_Event::~CEvn_Event(v28);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369421F);
      }
      else
      {
        v4 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13a8ea0]
// Decompiled from void InitGuiDlgMainscreen()
void __cdecl InitGuiDlgMainscreen(void) {
  
  int *v0; // eax
  int *v1; // ecx
  int *v2; // eax
  int *v3; // ecx
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax
  char *v14; // eax
  char *v15; // eax
  char *v16; // eax
  char *v17; // eax
  char v18[7]; // [esp+Ch] [ebp-13Ch] BYREF
  char v19; // [esp+13h] [ebp-135h]
  int i; // [esp+14h] [ebp-134h]
  int j; // [esp+18h] [ebp-130h]
  CHAR v22[28]; // [esp+1Ch] [ebp-12Ch] BYREF
  CHAR Str[256]; // [esp+38h] [ebp-110h] BYREF
  int v24; // [esp+144h] [ebp-4h]

  aControls[0] = 47;
  aControls[48] = 47;
  aControls[96] = 43;
  aControls[144] = 44;
  aControls[192] = 50;
  aControls[240] = 51;
  aControls[288] = 46;
  aControls[336] = 49;
  aControls[384] = 45;
  aControls[432] = 45;
  aControls[480] = 45;
  dword_3EDDD2C[0] = 2101;
  dword_3EDDD2C[48] = 2101;
  dword_3EDDD2C[96] = 2071;
  dword_3EDDD2C[144] = 2057;
  dword_3EDDD2C[192] = 2032;
  dword_3EDDD2C[240] = 2076;
  dword_3EDDD2C[288] = 2030;
  dword_3EDDD2C[336] = 2000;
  dword_3EDDD2C[384] = 2016;
  dword_3EDDD2C[432] = 2016;
  dword_3EDDD2C[480] = 2016;
  byte_3EDDD30[0] = 0;
  byte_3EDDD30[192] = 1;
  byte_3EDDD30[384] = 1;
  byte_3EDDD30[576] = 1;
  byte_3EDDD30[768] = 1;
  byte_3EDDD30[960] = 1;
  byte_3EDDD30[1152] = 1;
  byte_3EDDD30[1344] = 1;
  byte_3EDDD30[1536] = 1;
  byte_3EDDD30[1728] = 0;
  byte_3EDDD30[1920] = 0;
  aControls[3] = 47;
  aControls[51] = 7001;
  aControls[99] = 43;
  aControls[147] = 44;
  aControls[195] = 50;
  aControls[243] = 51;
  aControls[291] = 46;
  aControls[339] = 49;
  aControls[387] = 45;
  aControls[435] = 45;
  aControls[483] = 45;
  dword_3EDDD2C[3] = 2101;
  dword_3EDDD2C[51] = 2976;
  dword_3EDDD2C[99] = 2071;
  dword_3EDDD2C[147] = 2057;
  dword_3EDDD2C[195] = 2032;
  dword_3EDDD2C[243] = 2076;
  dword_3EDDD2C[291] = 2030;
  dword_3EDDD2C[339] = 2000;
  dword_3EDDD2C[387] = 2016;
  dword_3EDDD2C[435] = 2016;
  dword_3EDDD2C[483] = 2016;
  byte_3EDDD30[12] = 1;
  byte_3EDDD30[204] = 1;
  byte_3EDDD30[396] = 1;
  byte_3EDDD30[588] = 1;
  byte_3EDDD30[780] = 1;
  byte_3EDDD30[972] = 1;
  byte_3EDDD30[1164] = 1;
  byte_3EDDD30[1356] = 1;
  byte_3EDDD30[1548] = 1;
  byte_3EDDD30[1740] = 0;
  byte_3EDDD30[1932] = 0;
  aControls[6] = 47;
  aControls[54] = 8001;
  aControls[102] = 43;
  aControls[150] = 44;
  aControls[198] = 50;
  aControls[246] = 51;
  aControls[294] = 46;
  aControls[342] = 49;
  aControls[390] = 45;
  aControls[438] = 45;
  aControls[486] = 45;
  dword_3EDDD2C[6] = 2101;
  dword_3EDDD2C[54] = 47;
  dword_3EDDD2C[102] = 2071;
  dword_3EDDD2C[150] = 2057;
  dword_3EDDD2C[198] = 2032;
  dword_3EDDD2C[246] = 2076;
  dword_3EDDD2C[294] = 2030;
  dword_3EDDD2C[342] = 2000;
  dword_3EDDD2C[390] = 2016;
  dword_3EDDD2C[438] = 2016;
  dword_3EDDD2C[486] = 2016;
  byte_3EDDD30[24] = 1;
  byte_3EDDD30[216] = 1;
  byte_3EDDD30[408] = 1;
  byte_3EDDD30[600] = 1;
  byte_3EDDD30[792] = 1;
  byte_3EDDD30[984] = 1;
  byte_3EDDD30[1176] = 1;
  byte_3EDDD30[1368] = 1;
  byte_3EDDD30[1560] = 1;
  byte_3EDDD30[1752] = 0;
  byte_3EDDD30[1944] = 0;
  aControls[9] = 47;
  aControls[57] = 8001;
  aControls[105] = 7001;
  aControls[153] = 43;
  aControls[201] = 44;
  aControls[249] = 50;
  aControls[297] = 51;
  aControls[345] = 46;
  aControls[393] = 49;
  aControls[441] = 45;
  aControls[489] = 9001;
  dword_3EDDD2C[9] = 2101;
  dword_3EDDD2C[57] = 47;
  dword_3EDDD2C[105] = 3840;
  dword_3EDDD2C[153] = 2071;
  dword_3EDDD2C[201] = 2057;
  dword_3EDDD2C[249] = 2032;
  dword_3EDDD2C[297] = 2076;
  dword_3EDDD2C[345] = 2030;
  dword_3EDDD2C[393] = 2000;
  dword_3EDDD2C[441] = 2016;
  dword_3EDDD2C[489] = 47;
  byte_3EDDD30[36] = 1;
  byte_3EDDD30[228] = 1;
  byte_3EDDD30[420] = 1;
  byte_3EDDD30[612] = 1;
  byte_3EDDD30[804] = 1;
  byte_3EDDD30[996] = 1;
  byte_3EDDD30[1188] = 1;
  byte_3EDDD30[1380] = 1;
  byte_3EDDD30[1572] = 1;
  byte_3EDDD30[1764] = 0;
  byte_3EDDD30[1956] = 0;
  aControls[12] = 47;
  aControls[60] = 9001;
  aControls[108] = 43;
  aControls[156] = 44;
  aControls[204] = 50;
  aControls[252] = 51;
  aControls[300] = 46;
  aControls[348] = 49;
  aControls[396] = 45;
  aControls[444] = 45;
  aControls[492] = 45;
  dword_3EDDD2C[12] = 2101;
  dword_3EDDD2C[60] = 3840;
  dword_3EDDD2C[108] = 2071;
  dword_3EDDD2C[156] = 2057;
  dword_3EDDD2C[204] = 2032;
  dword_3EDDD2C[252] = 2076;
  dword_3EDDD2C[300] = 2030;
  dword_3EDDD2C[348] = 2000;
  dword_3EDDD2C[396] = 2016;
  dword_3EDDD2C[444] = 2016;
  dword_3EDDD2C[492] = 2016;
  byte_3EDDD30[48] = 1;
  byte_3EDDD30[240] = 1;
  byte_3EDDD30[432] = 1;
  byte_3EDDD30[624] = 1;
  byte_3EDDD30[816] = 1;
  byte_3EDDD30[1008] = 1;
  byte_3EDDD30[1200] = 1;
  byte_3EDDD30[1392] = 1;
  byte_3EDDD30[1584] = 1;
  byte_3EDDD30[1776] = 0;
  byte_3EDDD30[1968] = 0;
  aControls[15] = 47;
  aControls[63] = 7001;
  aControls[111] = 9001;
  aControls[159] = 43;
  aControls[207] = 44;
  aControls[255] = 50;
  aControls[303] = 51;
  aControls[351] = 46;
  aControls[399] = 49;
  aControls[447] = 45;
  aControls[495] = 9001;
  dword_3EDDD2C[15] = 2101;
  dword_3EDDD2C[63] = 2976;
  dword_3EDDD2C[111] = 3840;
  dword_3EDDD2C[159] = 2071;
  dword_3EDDD2C[207] = 2057;
  dword_3EDDD2C[255] = 2032;
  dword_3EDDD2C[303] = 2076;
  dword_3EDDD2C[351] = 2030;
  dword_3EDDD2C[399] = 2000;
  dword_3EDDD2C[447] = 2016;
  dword_3EDDD2C[495] = 47;
  byte_3EDDD30[60] = 1;
  byte_3EDDD30[252] = 1;
  byte_3EDDD30[444] = 1;
  byte_3EDDD30[636] = 1;
  byte_3EDDD30[828] = 1;
  byte_3EDDD30[1020] = 1;
  byte_3EDDD30[1212] = 1;
  byte_3EDDD30[1404] = 1;
  byte_3EDDD30[1596] = 1;
  byte_3EDDD30[1788] = 1;
  byte_3EDDD30[1980] = 0;
  aControls[18] = 47;
  aControls[66] = 8001;
  aControls[114] = 9001;
  aControls[162] = 43;
  aControls[210] = 44;
  aControls[258] = 50;
  aControls[306] = 51;
  aControls[354] = 46;
  aControls[402] = 49;
  aControls[450] = 45;
  aControls[498] = 9001;
  dword_3EDDD2C[18] = 2101;
  dword_3EDDD2C[66] = 47;
  dword_3EDDD2C[114] = 3840;
  dword_3EDDD2C[162] = 2071;
  dword_3EDDD2C[210] = 2057;
  dword_3EDDD2C[258] = 2032;
  dword_3EDDD2C[306] = 2076;
  dword_3EDDD2C[354] = 2030;
  dword_3EDDD2C[402] = 2000;
  dword_3EDDD2C[450] = 2016;
  dword_3EDDD2C[498] = 3840;
  byte_3EDDD30[72] = 1;
  byte_3EDDD30[264] = 1;
  byte_3EDDD30[456] = 1;
  byte_3EDDD30[648] = 1;
  byte_3EDDD30[840] = 1;
  byte_3EDDD30[1032] = 1;
  byte_3EDDD30[1224] = 1;
  byte_3EDDD30[1416] = 1;
  byte_3EDDD30[1608] = 1;
  byte_3EDDD30[1800] = 1;
  byte_3EDDD30[1992] = 0;
  aControls[21] = 47;
  aControls[69] = 8001;
  aControls[117] = 7001;
  aControls[165] = 9001;
  aControls[213] = 43;
  aControls[261] = 44;
  aControls[309] = 50;
  aControls[357] = 51;
  aControls[405] = 46;
  aControls[453] = 49;
  aControls[501] = 45;
  dword_3EDDD2C[21] = 2101;
  dword_3EDDD2C[69] = 47;
  dword_3EDDD2C[117] = 2976;
  dword_3EDDD2C[165] = 3840;
  dword_3EDDD2C[213] = 2071;
  dword_3EDDD2C[261] = 2057;
  dword_3EDDD2C[309] = 2032;
  dword_3EDDD2C[357] = 2076;
  dword_3EDDD2C[405] = 2030;
  dword_3EDDD2C[453] = 2000;
  dword_3EDDD2C[501] = 2016;
  byte_3EDDD30[84] = 1;
  byte_3EDDD30[276] = 1;
  byte_3EDDD30[468] = 1;
  byte_3EDDD30[660] = 1;
  byte_3EDDD30[852] = 1;
  byte_3EDDD30[1044] = 1;
  byte_3EDDD30[1236] = 1;
  byte_3EDDD30[1428] = 0;
  byte_3EDDD30[1620] = 1;
  byte_3EDDD30[1812] = 1;
  byte_3EDDD30[2004] = 1;
  for ( i = 0; i < 16; ++i )
  {
    for ( j = 11; j < 12; ++j )
    {
      aControls[48 * j + 3 * i] = 45;
      dword_3EDDD2C[48 * j + 3 * i] = 2016;
      byte_3EDDD30[192 * j + 12 * i] = 0;
    }
  }
  for ( i = 8; i <= 15; ++i )
  {
    j = 11;
    v19 = 0;
    while ( !v19 )
    {
      if ( j <= 0 && BBSupportDbgReport(2, "gui\\GUI_Mainscreen.cpp", 438, "iControlCounter > 0") == 1 )
        __debugbreak();
      v0 = &aControls[48 * j - 72 + 3 * i];
      v1 = &aControls[48 * j + 3 * i];
      *v1 = *v0;
      v1[1] = v0[1];
      v1[2] = v0[2];
      --j;
      if ( aControls[48 * j - 24 + 3 * i] == 43 )
        v19 = 1;
    }
    byte_3EDDD30[192 * j + 12 * i] = 1;
    aControls[48 * j + 3 * i] = 9501;
    dword_3EDDD2C[48 * j + 3 * i] = 3841;
    while ( j > 0 )
    {
      --j;
      v2 = &aControls[48 * j - 24 + 3 * i];
      v3 = &aControls[48 * j + 3 * i];
      *v3 = *v2;
      v3[1] = v2[1];
      v3[2] = v2[2];
    }
  }
  if ( !g_pMissionCD && BBSupportDbgReport(2, "gui\\GUI_Mainscreen.cpp", 458, "g_pMissionCD") == 1 )
    __debugbreak();
  if ( !g_pAddOn && BBSupportDbgReport(2, "gui\\GUI_Mainscreen.cpp", 459, "g_pAddOn") == 1 )
    __debugbreak();
  if ( !g_pMissionCD2 && BBSupportDbgReport(2, "gui\\GUI_Mainscreen.cpp", 460, "g_pMissionCD2") == 1 )
    __debugbreak();
  if ( !g_pMissionCD3 && BBSupportDbgReport(2, "gui\\GUI_Mainscreen.cpp", 461, "g_pMissionCD3") == 1 )
    __debugbreak();
  if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD + 4))(g_pMissionCD)
    && (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
    && (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2)
    && ExtraCD::IsGermanOnlyContentEnabled() )
  {
    iStatus = 7;
  }
  else if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2)
         && ExtraCD::IsGermanOnlyContentEnabled() )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD + 4))(g_pMissionCD) )
    {
      iStatus = 5;
    }
    else if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn) )
    {
      iStatus = 6;
    }
    else
    {
      iStatus = 4;
    }
  }
  else if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn) )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD + 4))(g_pMissionCD) )
      iStatus = 3;
    else
      iStatus = 2;
  }
  else
  {
    iStatus = (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD + 4))(g_pMissionCD) != 0;
  }
  if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD3 + 4))(g_pMissionCD3)
    && ExtraCD::IsGermanOnlyContentEnabled() )
  {
    iStatus += 8;
  }
  if ( g_pStringEngine )
  {
    v4 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                   g_pStringEngine,
                   dword_3EDDD2C[3 * iStatus + 96]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2531, v4);
    v5 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                   g_pStringEngine,
                   dword_3EDDD2C[3 * iStatus + 144]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2532, v5);
    v6 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                   g_pStringEngine,
                   dword_3EDDD2C[3 * iStatus + 384]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2533, v6);
    v7 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                   g_pStringEngine,
                   dword_3EDDD2C[3 * iStatus + 192]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2534, v7);
    v8 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                   g_pStringEngine,
                   dword_3EDDD2C[3 * iStatus]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2535, v8);
    v9 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                   g_pStringEngine,
                   dword_3EDDD2C[3 * iStatus + 240]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2536, v9);
    v10 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                    g_pStringEngine,
                    dword_3EDDD2C[3 * iStatus + 288]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2537, v10);
    v11 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                    g_pStringEngine,
                    dword_3EDDD2C[3 * iStatus + 336]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2538, v11);
    v12 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                    g_pStringEngine,
                    dword_3EDDD2C[3 * iStatus + 48]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2548, v12);
    v13 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                    g_pStringEngine,
                    dword_3EDDD2C[3 * iStatus + 432]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2549, v13);
    v14 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                    g_pStringEngine,
                    dword_3EDDD2C[3 * iStatus + 480]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2550, v14);
    v15 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(
                    g_pStringEngine,
                    dword_3EDDD2C[3 * iStatus + 528]);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2551, v15);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2535, byte_3EDDD30[12 * iStatus]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2548, byte_3EDDD30[12 * iStatus + 192]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2531, byte_3EDDD30[12 * iStatus + 384]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2532, byte_3EDDD30[12 * iStatus + 576]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2534, byte_3EDDD30[12 * iStatus + 768]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2536, byte_3EDDD30[12 * iStatus + 960]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2537, byte_3EDDD30[12 * iStatus + 1152]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2538, byte_3EDDD30[12 * iStatus + 1344]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2533, byte_3EDDD30[12 * iStatus + 1536]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2549, byte_3EDDD30[12 * iStatus + 1728]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2550, byte_3EDDD30[12 * iStatus + 1920]);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 2955, byte_3EDDD30[12 * iStatus + 2112]);
    _wsprintfA(Str, " V%d.%02d.%d", g_iApplicationVersionMajor, g_iApplicationVersionMinor, g_iApplicationVersionBuild);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2539, Str);
    v18[0] = -87;
    v18[1] = 0;
    String::String(v18, -1);
    v24 = 0;
    String::operator+=(" ");
    v16 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 1126);
    String::operator+=(v16);
    v17 = (char *)String::c_str((String *)v22);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 2547, v17);
    switch ( CGameSettings::GetLanguage() )
    {
      case 1:
        IGuiEngine::SetImages((void *)g_pGUIEngine, 0, 2540, 130, 0);
        break;
      default:
        IGuiEngine::SetImages((void *)g_pGUIEngine, 0, 2540, 131, 0);
        break;
    }
    v24 = -1;
    String::~String((String *)v22);
  }
}


// address=[0x13abf50]
// Decompiled from char InitGuiDlgMainSplash()
void __cdecl InitGuiDlgMainSplash(void) {
  
  char result; // al

  if ( !g_pStringEngine )
    return result;
  result = g_iVictoryScreenCampaignType;
  switch ( g_iVictoryScreenCampaignType )
  {
    case 1:
      return IGuiEngine::SetImages((void *)g_pGUIEngine, 12, 2559, 254, 0);
    case 2:
      return IGuiEngine::SetImages((void *)g_pGUIEngine, 12, 2559, 256, 0);
    case 3:
      return IGuiEngine::SetImages((void *)g_pGUIEngine, 12, 2559, 255, 0);
  }
  return result;
}


// address=[0x13abfd0]
// Decompiled from char __cdecl GuiDlgMainSplashProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainSplashProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainSplash();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36942F9);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_36942FA);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13ac140]
// Decompiled from void InitGuiDlgMainStatisticDisplayMode()
void __cdecl InitGuiDlgMainStatisticDisplayMode(void) {
  
  int TotalProducedSettler; // esi
  int v1; // esi
  int v2; // esi
  int v3; // esi
  int v4; // esi
  int v5; // esi
  int v6; // esi
  int NumberOfPlayers; // esi
  int Soldiers; // eax
  char *v9; // eax
  int Kills; // eax
  char *v11; // eax
  int v12; // eax
  char *v13; // eax
  char *v14; // eax
  char *v15; // eax
  int v16; // eax
  char *v17; // eax
  char *v18; // eax
  int TotalTowers; // eax
  char *v20; // eax
  int v21; // esi
  int v22; // eax
  char *v23; // eax
  int TotalProducedBuildings; // eax
  char *v25; // eax
  int MaxLandSize; // eax
  char *v27; // eax
  char *v28; // eax
  int ProducedMana; // eax
  char *v30; // eax
  int TotalMineProduction; // eax
  char *v32; // eax
  int TotalFood; // eax
  char *v34; // eax
  int v35; // [esp+Ch] [ebp-38h]
  char *Buffer; // [esp+10h] [ebp-34h]
  int k; // [esp+14h] [ebp-30h]
  int i; // [esp+18h] [ebp-2Ch]
  int j; // [esp+18h] [ebp-2Ch]
  int Value[9]; // [esp+1Ch] [ebp-28h]

  Buffer = (char *)operator new[](0x10u);
  if ( byte_3EDE7F9 )
  {
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2663, 871, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2664, 866, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2665, 868, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2666, 867, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2667, 869, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2668, 3842, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2663, 246, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2664, 241, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2665, 243, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2666, 242, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2667, 244, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2668, 333, 0);
    v35 = 0;
    for ( i = 1; i <= 8; ++i )
    {
      TotalProducedSettler = CStatistic::GetTotalProducedSettler((CStatistic *)&g_cEndStatistic, i);
      v1 = CStatistic::GetTotalProducedBuildings((CStatistic *)&g_cEndStatistic, i) + 2 * TotalProducedSettler;
      v2 = CStatistic::GetTotalFood((CStatistic *)&g_cEndStatistic, i) + v1;
      v3 = CStatistic::GetTotalMineProduction((CStatistic *)&g_cEndStatistic, i) + v2;
      v4 = v3 + 2 * CStatistic::GetProducedGoods((CStatistic *)&g_cEndStatistic, i, 14);
      v5 = CStatistic::GetProducedMana((CStatistic *)&g_cEndStatistic, i) + v4;
      v6 = v5 + 2 * CStatistic::GetSoldiers((CStatistic *)&g_cEndStatistic, i);
      Value[i] = (5 * CStatistic::GetKills((CStatistic *)&g_cEndStatistic, i) + v6) / 10;
      if ( Value[i] > v35 )
        v35 = Value[i];
    }
    for ( j = 1; j <= 8; ++j )
    {
      NumberOfPlayers = CEndStatistic::GetNumberOfPlayers((CEndStatistic *)&g_cEndStatistic);
      if ( j <= NumberOfPlayers - CStatistic::GetDontShowLastNPlayers((CStatistic *)&g_cEndStatistic) )
      {
        Soldiers = CStatistic::GetSoldiers((CStatistic *)&g_cEndStatistic, j);
        v9 = j___itoa(Soldiers, Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_36943C8[j], v9);
        Kills = CStatistic::GetKills((CStatistic *)&g_cEndStatistic, j);
        v11 = j___itoa(Kills, Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_36943F0[j], v11);
        v12 = CStatistic::OffenceStrength100Max((CStatistic *)&g_cEndStatistic, j);
        v13 = j___itoa(v12, Buffer, 10);
        v14 = j__strcat(v13, "%");
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694418[j], v14);
        if ( Value[j] == v35 )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 13, dword_3694490[j], 0);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 13, dword_3694490[j], 1);
        v15 = j___itoa(Value[j], Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694490[j], v15);
        v16 = CStatistic::DefenceStrength100Max((CStatistic *)&g_cEndStatistic, j);
        v17 = j___itoa(v16, Buffer, 10);
        v18 = j__strcat(v17, "%");
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694440[j], v18);
        TotalTowers = CStatistic::GetTotalTowers((CStatistic *)&g_cEndStatistic, j);
        v20 = j___itoa(TotalTowers, Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694468[j], v20);
      }
    }
  }
  else
  {
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2663, 860, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2664, 855, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2665, 857, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2666, 859, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2667, 856, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2668, 858, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2663, 240, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2664, 235, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2665, 237, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2666, 239, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2667, 236, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 13, 2668, 238, 0);
    for ( k = 1; k <= 8; ++k )
    {
      v21 = CEndStatistic::GetNumberOfPlayers((CEndStatistic *)&g_cEndStatistic);
      if ( k <= v21 - CStatistic::GetDontShowLastNPlayers((CStatistic *)&g_cEndStatistic) )
      {
        v22 = CStatistic::GetTotalProducedSettler((CStatistic *)&g_cEndStatistic, k);
        v23 = j___itoa(v22, Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_36943C8[k], v23);
        TotalProducedBuildings = CStatistic::GetTotalProducedBuildings((CStatistic *)&g_cEndStatistic, k);
        v25 = j___itoa(TotalProducedBuildings, Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_36943F0[k], v25);
        MaxLandSize = CStatistic::GetMaxLandSize((CStatistic *)&g_cEndStatistic, k);
        v27 = j___itoa(MaxLandSize, Buffer, 10);
        v28 = j__strcat(v27, "%");
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694418[k], v28);
        IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 13, dword_3694490[k], 3);
        ProducedMana = CStatistic::GetProducedMana((CStatistic *)&g_cEndStatistic, k);
        v30 = j___itoa(ProducedMana, Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694490[k], v30);
        TotalMineProduction = CStatistic::GetTotalMineProduction((CStatistic *)&g_cEndStatistic, k);
        v32 = j___itoa(TotalMineProduction, Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694440[k], v32);
        TotalFood = CStatistic::GetTotalFood((CStatistic *)&g_cEndStatistic, k);
        v34 = j___itoa(TotalFood, Buffer, 10);
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694468[k], v34);
      }
    }
  }
  operator delete(Buffer);
}


// address=[0x13ac860]
// Decompiled from void InitGuiDlgMainStatistic()
void __cdecl InitGuiDlgMainStatistic(void) {
  
  float v0; // xmm0_4
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  const wchar_t *MapName; // eax
  char *v5; // eax
  int NumberOfPlayers; // esi
  int v7; // eax
  int v8; // eax
  const wchar_t *v9; // eax
  int PlayerColor; // eax
  int PlayerRace; // eax
  int PlayerAlliance; // eax
  int v13; // esi
  size_t v14; // [esp-4h] [ebp-910h]
  unsigned int v15; // [esp+1Ch] [ebp-8F0h]
  char *Dest; // [esp+28h] [ebp-8E4h]
  int v17; // [esp+2Ch] [ebp-8E0h]
  wchar_t *String; // [esp+30h] [ebp-8DCh]
  wchar_t *Stringa; // [esp+30h] [ebp-8DCh]
  int i; // [esp+34h] [ebp-8D8h]
  char v21[88]; // [esp+38h] [ebp-8D4h] BYREF
  _BYTE v22[28]; // [esp+90h] [ebp-87Ch] BYREF
  _BYTE v23[28]; // [esp+ACh] [ebp-860h] BYREF
  wchar_t Destination[1024]; // [esp+C8h] [ebp-844h] BYREF
  char Str[52]; // [esp+8C8h] [ebp-44h] BYREF
  int v26; // [esp+908h] [ebp-4h]

  if ( g_pStringEngine )
  {
    v0 = (float)(unsigned int)(71 * CEndStatistic::GetTickCounter((CEndStatistic *)&g_cEndStatistic));
    j___snprintf(
      Str,
      0x32u,
      "%02u:%02u:%02u",
      (unsigned int)(float)(v0 / 1000.0) / 0xE10,
      (unsigned int)(float)(v0 / 1000.0) / 0x3C % 0x3C,
      (unsigned int)(float)(v0 / 1000.0) % 0x3C);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2584, 854, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2585, 865, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2567, 851, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2662, 861, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2658, 875, 0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 13, 2662, Str);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 875);
    IGuiEngine::SetText((void *)g_pGUIEngine, 13, 2658, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 864);
    IGuiEngine::SetText((void *)g_pGUIEngine, 13, 2659, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 861);
    IGuiEngine::SetText((void *)g_pGUIEngine, 13, 2660, v3);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, 2661, 864, 0);
    if ( CEndStatistic::GetMapName((CEndStatistic *)&g_cEndStatistic) )
    {
      MapName = (const wchar_t *)CEndStatistic::GetMapName((CEndStatistic *)&g_cEndStatistic);
      j__wcscpy(Destination, MapName);
      String = (wchar_t *)wcschr(Destination, 92);
      if ( String )
      {
        Stringa = String + 1;
        v17 = wcschr(Stringa, 46);
        if ( !v17 )
          v17 = (int)&Stringa[j__wcslen(Stringa)];
        j__wcsncpy(Destination, Stringa, (v17 - (int)Stringa) >> 1);
        v15 = (v17 - (int)Stringa) >> 1;
        if ( v15 >= 1024 )
          j____report_rangecheckfailure();
        Destination[v15] = 0;
      }
    }
    else
    {
      Destination[0] = 0;
    }
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v21);
    v26 = 0;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
      v22,
      Destination);
    LOBYTE(v26) = 1;
    v5 = (char *)std::string::c_str(v22);
    IGuiEngine::SetText((void *)g_pGUIEngine, 13, 2661, v5);
    if ( !(*(unsigned __int8 (__thiscall **)(void *, wchar_t *, _DWORD))(*(_DWORD *)g_pRandomMaps + 36))(
            g_pRandomMaps,
            Destination,
            0) )
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 13, 2673, 0);
    for ( i = 1; i <= 8; ++i )
    {
      NumberOfPlayers = CEndStatistic::GetNumberOfPlayers((CEndStatistic *)&g_cEndStatistic);
      if ( i > NumberOfPlayers - CStatistic::GetDontShowLastNPlayers((CStatistic *)&g_cEndStatistic) )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 13, dword_3694520[i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 13, dword_3694548[i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 13, dword_3694598[i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 13, dword_3694570[i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 13, dword_36945C0[i], 0);
      }
      else
      {
        IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, dword_3694520[i], 872, 0);
        IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, dword_3694548[i], 853, 0);
        IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, dword_3694598[i], 873, 0);
        IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, dword_3694570[i], 874, 0);
        CEndStatistic::GetPlayerName(&g_cEndStatistic, (int)v23, i);
        LOBYTE(v26) = 2;
        v7 = std::wstring::length(v23);
        Dest = (char *)operator new[](v7 + 1);
        v8 = std::wstring::length(v23);
        v9 = (const wchar_t *)std::wstring::data(v8);
        j__wcstombs(Dest, v9, v14);
        Dest[std::wstring::length(v23)] = 0;
        IGuiEngine::SetText((void *)g_pGUIEngine, 13, dword_3694520[i], Dest);
        operator delete(Dest);
        PlayerColor = CEndStatistic::GetPlayerColor((CEndStatistic *)&g_cEndStatistic, i);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 13, dword_3694548[i], dword_36944BC[PlayerColor], 0);
        PlayerRace = CEndStatistic::GetPlayerRace((CEndStatistic *)&g_cEndStatistic, i);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 13, dword_3694598[i], dword_369450C[PlayerRace], 0);
        PlayerAlliance = CEndStatistic::GetPlayerAlliance((CEndStatistic *)&g_cEndStatistic, i);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 13, dword_3694570[i], dword_36944E0[PlayerAlliance], 0);
        if ( CEndStatistic::IsGameWone((CEndStatistic *)&g_cEndStatistic) )
        {
          v13 = CEndStatistic::GetPlayerAlliance((CEndStatistic *)&g_cEndStatistic, i);
          if ( v13 == CEndStatistic::GetWonAlliance((CEndStatistic *)&g_cEndStatistic) )
          {
            IGuiEngine::SetImages((void *)g_pGUIEngine, 13, dword_36945C0[i], 253, 0);
            IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, dword_36945C0[i], 876, 0);
          }
          else
          {
            IGuiEngine::SetImages((void *)g_pGUIEngine, 13, dword_36945C0[i], 252, 0);
            IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, dword_36945C0[i], 863, 0);
          }
        }
        else
        {
          IGuiEngine::SetImages((void *)g_pGUIEngine, 13, dword_36945C0[i], 251, 0);
          IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 13, dword_36945C0[i], 862, 0);
        }
        LOBYTE(v26) = 1;
        std::wstring::~wstring(v23);
      }
    }
    InitGuiDlgMainStatisticDisplayMode();
    LOBYTE(v26) = 0;
    std::string::~string(v22);
    v26 = -1;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v21);
  }
}


// address=[0x13ad050]
// Decompiled from char __cdecl GuiDlgMainStatisticProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgMainStatisticProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-1CCh]
  CEvn_Event *v7; // [esp+Ch] [ebp-1C4h]
  CEvn_Event *v8; // [esp+14h] [ebp-1BCh]
  CEvn_Event *v9; // [esp+1Ch] [ebp-1B4h]
  CEvn_Event *v10; // [esp+24h] [ebp-1ACh]
  CEvn_Event *v11; // [esp+2Ch] [ebp-1A4h]
  CEvn_Event *v12; // [esp+34h] [ebp-19Ch]
  CEvn_Event *v13; // [esp+3Ch] [ebp-194h]
  CEvn_Event *v14; // [esp+44h] [ebp-18Ch]
  char *Str; // [esp+4Ch] [ebp-184h]
  char v16[88]; // [esp+58h] [ebp-178h] BYREF
  CEvn_Event v17; // [esp+B0h] [ebp-120h] BYREF
  CEvn_Event v18; // [esp+C8h] [ebp-108h] BYREF
  CEvn_Event v19; // [esp+E0h] [ebp-F0h] BYREF
  CEvn_Event v20; // [esp+F8h] [ebp-D8h] BYREF
  CEvn_Event v21; // [esp+110h] [ebp-C0h] BYREF
  CEvn_Event v22; // [esp+128h] [ebp-A8h] BYREF
  CEvn_Event v23; // [esp+140h] [ebp-90h] BYREF
  CEvn_Event v24; // [esp+158h] [ebp-78h] BYREF
  CEvn_Event v25; // [esp+170h] [ebp-60h] BYREF
  _BYTE v26[28]; // [esp+188h] [ebp-48h] BYREF
  int v27[7]; // [esp+1A4h] [ebp-2Ch] BYREF
  int v28; // [esp+1CCh] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EDE7F9 = 1;
      InitGuiDlgMainStatistic();
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 13, 2585, 1);
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0xA07u:
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v22, 0x74u, 0, 0, 0);
          v28 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v22);
          break;
        case 0xA08u:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v23, 0x73u, 1u, 0, 0);
          v28 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v23);
          break;
        case 0xA09u:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v24, 0x73u, 2u, 0, 0);
          v28 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v24);
          break;
        case 0xA0Au:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v25, 0x73u, 3u, 0, 0);
          v28 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v25);
          break;
        case 0xA0Bu:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v17, 0x73u, 4u, 0, 0);
          v28 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          break;
        case 0xA0Cu:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v18, 0x73u, 5u, 0, 0);
          v28 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v18);
          break;
        case 0xA0Du:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v19, 0x73u, 6u, 0, 0);
          v28 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v19);
          break;
        case 0xA0Eu:
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v20, 0x73u, 7u, 0, 0);
          v28 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v20);
          break;
        case 0xA0Fu:
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v21, 0x73u, 8u, 0, 0);
          v28 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v28 = -1;
          CEvn_Event::~CEvn_Event(&v21);
          break;
        case 0xA18u:
          byte_3EDE7F9 = 0;
          InitGuiDlgMainStatisticDisplayMode();
          break;
        case 0xA19u:
          byte_3EDE7F9 = 1;
          InitGuiDlgMainStatisticDisplayMode();
          break;
        case 0xA71u:
          PlayGuiSound(2);
          Str = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, 13, 2661);
          std::wstring::wstring(v26);
          v28 = 9;
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v16);
          LOBYTE(v28) = 10;
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::from_bytes(
            (int)v27,
            Str);
          LOBYTE(v28) = 11;
          if ( !(*(unsigned __int8 (__thiscall **)(void *, int *, _DWORD))(*(_DWORD *)g_pRandomMaps + 32))(
                  g_pRandomMaps,
                  v27,
                  0)
            && BBSupportDbgReport(
                 2,
                 "gui\\GUI_MainStatistic.cpp",
                 768,
                 "g_pRandomMaps->IsRandomMapFileName(testName,NULL)") == 1 )
          {
            __debugbreak();
          }
          (*(void (__thiscall **)(void *, int *, _BYTE *))(*(_DWORD *)g_pRandomMaps + 32))(g_pRandomMaps, v27, v26);
          (*(void (__thiscall **)(void *, char *))(*(_DWORD *)g_pClipboard + 4))(g_pClipboard, Str);
          LOBYTE(v28) = 10;
          std::wstring::~wstring(v27);
          LOBYTE(v28) = 9;
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v16);
          v28 = -1;
          std::wstring::~wstring(v26);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36942FE);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_36942FF);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13ade30]
// Decompiled from wchar_t *__cdecl wcschr(wchar_t *Str, wchar_t a2)
wchar_t * __cdecl wcschr(wchar_t * Str, wchar_t a2) {
  
  return j__wcschr(Str, a2);
}


// address=[0x13ade50]
// Decompiled from int __cdecl GetGuiGoodImage(int a1)
unsigned int __cdecl GetGuiGoodImage(enum PILE_TYPES a1) {
  
  int result; // eax

  switch ( a1 )
  {
    case 1:
      result = 281;
      break;
    case 2:
      result = 280;
      break;
    case 3:
      result = 279;
      break;
    case 4:
      result = 305;
      break;
    case 5:
      result = 304;
      break;
    case 6:
      result = 302;
      break;
    case 7:
      result = 314;
      break;
    case 8:
      result = 301;
      break;
    case 9:
      result = 299;
      break;
    case 10:
      result = 290;
      break;
    case 11:
      result = 298;
      break;
    case 12:
      result = 297;
      break;
    case 13:
      result = 296;
      break;
    case 14:
      result = 313;
      break;
    case 15:
      result = 295;
      break;
    case 16:
      result = 294;
      break;
    case 17:
      result = 293;
      break;
    case 18:
      result = 312;
      break;
    case 19:
      result = 292;
      break;
    case 20:
      result = 303;
      break;
    case 21:
      result = 278;
      break;
    case 22:
      result = 311;
      break;
    case 23:
      result = 283;
      break;
    case 24:
      result = 291;
      break;
    case 25:
      result = 310;
      break;
    case 26:
      result = 289;
      break;
    case 27:
      result = 309;
      break;
    case 28:
      result = 308;
      break;
    case 29:
      result = 307;
      break;
    case 30:
      result = 288;
      break;
    case 31:
      result = 306;
      break;
    case 32:
      result = 300;
      break;
    case 33:
      result = 287;
      break;
    case 34:
      result = 284;
      break;
    case 35:
      result = 286;
      break;
    case 36:
      result = 285;
      break;
    case 37:
      result = 282;
      break;
    case 38:
      result = 330;
      break;
    case 39:
      result = 328;
      break;
    case 40:
      result = 329;
      break;
    case 41:
      result = 327;
      break;
    case 42:
      result = 331;
      break;
    default:
      result = 314;
      break;
  }
  return result;
}


// address=[0x13ae150]
// Decompiled from void InitGuiDlgMainStatisticEcoDisplayMode()
void __cdecl InitGuiDlgMainStatisticEcoDisplayMode(void) {
  
  float v0; // xmm0_4
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  const wchar_t *MapName; // eax
  char *v5; // eax
  int GuiGoodImage; // eax
  int v7; // eax
  int v8; // eax
  const wchar_t *v9; // eax
  int PlayerColor; // eax
  int PlayerRace; // eax
  int PlayerAlliance; // eax
  int v13; // esi
  int v14; // eax
  int v15; // eax
  int v16; // esi
  size_t v17; // [esp-4h] [ebp-A28h]
  void *v18; // [esp+14h] [ebp-A10h]
  unsigned int v19; // [esp+24h] [ebp-A00h]
  int Good; // [esp+2Ch] [ebp-9F8h]
  int v21; // [esp+30h] [ebp-9F4h]
  int v22; // [esp+34h] [ebp-9F0h]
  int v23; // [esp+40h] [ebp-9E4h]
  int n; // [esp+44h] [ebp-9E0h]
  int v25; // [esp+48h] [ebp-9DCh]
  int v26; // [esp+4Ch] [ebp-9D8h]
  int nn; // [esp+50h] [ebp-9D4h]
  char *Dest; // [esp+54h] [ebp-9D0h]
  int v29; // [esp+58h] [ebp-9CCh]
  int v30; // [esp+5Ch] [ebp-9C8h]
  int m; // [esp+60h] [ebp-9C4h]
  int ii; // [esp+64h] [ebp-9C0h]
  int k; // [esp+68h] [ebp-9BCh]
  int i; // [esp+6Ch] [ebp-9B8h]
  int kk; // [esp+70h] [ebp-9B4h]
  wchar_t *String; // [esp+74h] [ebp-9B0h]
  wchar_t *Stringa; // [esp+74h] [ebp-9B0h]
  int mm; // [esp+78h] [ebp-9ACh]
  int jj; // [esp+7Ch] [ebp-9A8h]
  int j; // [esp+80h] [ebp-9A4h]
  char v41[88]; // [esp+84h] [ebp-9A0h] BYREF
  _BYTE v42[28]; // [esp+DCh] [ebp-948h] BYREF
  _BYTE v43[28]; // [esp+F8h] [ebp-92Ch] BYREF
  wchar_t Destination[1024]; // [esp+114h] [ebp-910h] BYREF
  char Buffer[100]; // [esp+914h] [ebp-110h] BYREF
  CHAR v46[52]; // [esp+978h] [ebp-ACh] BYREF
  char Str[52]; // [esp+9ACh] [ebp-78h] BYREF
  CHAR v48[52]; // [esp+9E0h] [ebp-44h] BYREF
  int v49; // [esp+A20h] [ebp-4h]

  if ( g_pStringEngine )
  {
    v0 = (float)(unsigned int)(71 * CEndStatistic::GetTickCounter((CEndStatistic *)&g_cEndStatistic));
    j___snprintf(
      Str,
      0x32u,
      "%02u:%02u:%02u",
      (unsigned int)(float)(v0 / 1000.0) / 0xE10,
      (unsigned int)(float)(v0 / 1000.0) / 0x3C % 0x3C,
      (unsigned int)(float)(v0 / 1000.0) % 0x3C);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 22, 2690, 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, 2690, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, 2680, 851, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, 2767, 861, 0);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, 2763, 875, 0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 22, 2767, Str);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 875);
    IGuiEngine::SetText((void *)g_pGUIEngine, 22, 2763, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 864);
    IGuiEngine::SetText((void *)g_pGUIEngine, 22, 2764, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 861);
    IGuiEngine::SetText((void *)g_pGUIEngine, 22, 2765, v3);
    IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, 2766, 864, 0);
    if ( CEndStatistic::GetMapName((CEndStatistic *)&g_cEndStatistic) )
    {
      MapName = (const wchar_t *)CEndStatistic::GetMapName((CEndStatistic *)&g_cEndStatistic);
      j__wcscpy(Destination, MapName);
      String = (wchar_t *)wcsrchr(Destination, 92);
      if ( String )
      {
        Stringa = String + 1;
        v29 = wcschr(Stringa, 46);
        if ( !v29 )
          v29 = (int)&Stringa[j__wcslen(Stringa)];
        j__wcsncpy(Destination, Stringa, (v29 - (int)Stringa) >> 1);
        v19 = (v29 - (int)Stringa) >> 1;
        if ( v19 >= 1024 )
          j____report_rangecheckfailure();
        Destination[v19] = 0;
      }
    }
    else
    {
      Destination[0] = 0;
    }
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v41);
    v49 = 0;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
      v42,
      Destination);
    LOBYTE(v49) = 1;
    v5 = (char *)std::string::c_str(v42);
    IGuiEngine::SetText((void *)g_pGUIEngine, 22, 2766, v5);
    if ( !(*(unsigned __int8 (__thiscall **)(void *, wchar_t *, _DWORD))(*(_DWORD *)g_pRandomMaps + 36))(
            g_pRandomMaps,
            Destination,
            0) )
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, 2795, 0);
    for ( i = 0; i <= 7; ++i )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694CBC[i], 1);
      GuiGoodImage = GetGuiGoodImage(dword_3F1EE88[3 * i]);
      IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694CBC[i], GuiGoodImage, 0);
      IGuiEngine::SetTooltipID(
        (IGuiEngine *)g_pGUIEngine,
        22,
        dword_3694CBC[i],
        dword_36945F0[5 * dword_3F1EE88[3 * i] + 3],
        dword_36945F0[5 * dword_3F1EE88[3 * i] + 4]);
    }
    v18 = operator new[](0x10u);
    if ( byte_3EDE7FA )
    {
      for ( j = 1; j <= 8; ++j )
      {
        if ( byte_3EDE7FA && j <= CEndStatistic::GetNumberOfPlayers((CEndStatistic *)&g_cEndStatistic) )
        {
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694BF0[j], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C18[j], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C68[j], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C40[j], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C90[j], 1);
          IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694BF0[j], 872, 0);
          IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C18[j], 853, 0);
          IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C68[j], 873, 0);
          IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C40[j], 874, 0);
          CEndStatistic::GetPlayerName(&g_cEndStatistic, (int)v43, j);
          LOBYTE(v49) = 2;
          v7 = std::wstring::length(v43);
          Dest = (char *)operator new[](v7 + 1);
          v8 = std::wstring::length(v43);
          v9 = (const wchar_t *)std::wstring::data(v8);
          j__wcstombs(Dest, v9, v17);
          Dest[std::wstring::length(v43)] = 0;
          IGuiEngine::SetText((void *)g_pGUIEngine, 22, dword_3694BF0[j], Dest);
          operator delete(Dest);
          PlayerColor = CEndStatistic::GetPlayerColor((CEndStatistic *)&g_cEndStatistic, j);
          IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C18[j], dword_3694B8C[PlayerColor], 0);
          PlayerRace = CEndStatistic::GetPlayerRace((CEndStatistic *)&g_cEndStatistic, j);
          IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C68[j], dword_3694BDC[PlayerRace], 0);
          PlayerAlliance = CEndStatistic::GetPlayerAlliance((CEndStatistic *)&g_cEndStatistic, j);
          IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C40[j], dword_3694BB0[PlayerAlliance], 0);
          if ( CEndStatistic::IsGameWone((CEndStatistic *)&g_cEndStatistic) )
          {
            v13 = CEndStatistic::GetPlayerAlliance((CEndStatistic *)&g_cEndStatistic, j);
            if ( v13 == CEndStatistic::GetWonAlliance((CEndStatistic *)&g_cEndStatistic) )
            {
              IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C90[j], 253, 0);
              IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C90[j], 876, 0);
            }
            else
            {
              IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C90[j], 252, 0);
              IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C90[j], 863, 0);
            }
          }
          else
          {
            IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C90[j], 251, 0);
            IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C90[j], 862, 0);
          }
          for ( k = 0; k < 7; ++k )
          {
            v21 = 2;
            Good = CStatistic::GetGood((CStatistic *)&g_cEndStatistic, j, dword_3F1EE88[3 * k]);
            v23 = -1;
            for ( m = 1; m <= CEndStatistic::GetNumberOfPlayers((CEndStatistic *)&g_cEndStatistic); ++m )
            {
              if ( m != j )
              {
                v22 = CStatistic::GetGood((CStatistic *)&g_cEndStatistic, m, dword_3F1EE88[3 * k]);
                if ( v22 > v23 )
                  v23 = v22;
              }
            }
            if ( v23 == Good )
              v21 = 1;
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694A80[7 * j - 7 + k], 1);
            IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 22, dword_3694A80[7 * j - 7 + k], v21);
            _wsprintfA(v48, "%u", Good);
            IGuiEngine::SetText((void *)g_pGUIEngine, 22, dword_3694A80[7 * j - 7 + k], v48);
          }
          LOBYTE(v49) = 1;
          std::wstring::~wstring(v43);
        }
        else
        {
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694BF0[j], 0);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C18[j], 0);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C68[j], 0);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C40[j], 0);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C90[j], 0);
          for ( n = 0; n < 7; ++n )
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694A80[7 * j - 7 + n], 0);
        }
      }
    }
    else
    {
      for ( ii = 1; ii <= 2; ++ii )
      {
        for ( jj = 1; jj <= 8 && CEndStatistic::GetPlayerAlliance((CEndStatistic *)&g_cEndStatistic, jj) != ii; ++jj )
          ;
        if ( jj <= 8 )
        {
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694BF0[jj], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C18[jj], 0);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C68[jj], 0);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C40[jj], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C90[jj], 1);
          j__sprintf(Buffer, "Team %d", ii);
          IGuiEngine::SetText((void *)g_pGUIEngine, 22, dword_3694BF0[jj], Buffer);
          v14 = CEndStatistic::GetPlayerColor((CEndStatistic *)&g_cEndStatistic, jj);
          IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C18[jj], dword_3694B8C[v14], 0);
          v15 = CEndStatistic::GetPlayerAlliance((CEndStatistic *)&g_cEndStatistic, jj);
          IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C40[jj], dword_3694BB0[v15], 0);
          if ( CEndStatistic::IsGameWone((CEndStatistic *)&g_cEndStatistic) )
          {
            v16 = CEndStatistic::GetPlayerAlliance((CEndStatistic *)&g_cEndStatistic, jj);
            if ( v16 == CEndStatistic::GetWonAlliance((CEndStatistic *)&g_cEndStatistic) )
            {
              IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C90[jj], 253, 0);
              IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C90[jj], 876, 0);
            }
            else
            {
              IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C90[jj], 252, 0);
              IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C90[jj], 863, 0);
            }
          }
          else
          {
            IGuiEngine::SetImages((void *)g_pGUIEngine, 22, dword_3694C90[jj], 251, 0);
            IGuiEngine::SetTooltipID((IGuiEngine *)g_pGUIEngine, 22, dword_3694C90[jj], 862, 0);
          }
          for ( kk = 0; kk < 7; ++kk )
          {
            if ( ii == 1 )
            {
              v30 = dword_3F1EE8C[3 * kk];
              v25 = dword_3F1EE90[3 * kk];
            }
            else
            {
              v25 = dword_3F1EE8C[3 * kk];
              v30 = dword_3F1EE90[3 * kk];
            }
            if ( v30 >= v25 )
              v26 = 1;
            else
              v26 = 2;
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694A80[7 * jj - 7 + kk], 1);
            IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 22, dword_3694A80[7 * jj - 7 + kk], v26);
            _wsprintfA(v46, "%u", v30);
            IGuiEngine::SetText((void *)g_pGUIEngine, 22, dword_3694A80[7 * jj - 7 + kk], v46);
          }
        }
      }
      for ( mm = ii; mm <= 8; ++mm )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694BF0[mm], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C18[mm], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C68[mm], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C40[mm], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694C90[mm], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694A80[7 * mm - 7 + mm], 0);
        for ( nn = 0; nn < 7; ++nn )
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 22, dword_3694A80[7 * mm - 7 + nn], 0);
      }
    }
    operator delete(v18);
    LOBYTE(v49) = 0;
    std::string::~string(v42);
    v49 = -1;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v41);
  }
}


// address=[0x13af240]
// Decompiled from void InitGuiDlgMainStatisticEco()
void __cdecl InitGuiDlgMainStatisticEco(void) {
  
  byte_3EDE7FA = 0;
  if ( g_pStringEngine )
    InitGuiDlgMainStatisticEcoDisplayMode();
}


// address=[0x13af260]
// Decompiled from char __cdecl GuiDlgMainStatisticEcoProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainStatisticEcoProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *Text; // eax
  int v7; // [esp+4h] [ebp-108h]
  CEvn_Event *v8; // [esp+Ch] [ebp-100h]
  char v9[88]; // [esp+1Ch] [ebp-F0h] BYREF
  _BYTE v10[28]; // [esp+74h] [ebp-98h] BYREF
  CEvn_Event v11; // [esp+90h] [ebp-7Ch] BYREF
  _BYTE v12[28]; // [esp+A8h] [ebp-64h] BYREF
  _BYTE v13[28]; // [esp+C4h] [ebp-48h] BYREF
  _BYTE v14[28]; // [esp+E0h] [ebp-2Ch] BYREF
  int v15; // [esp+108h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainStatisticEco();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 2680:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v11, 0x77u, 0, 0, 0);
          v15 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v15 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        case 2689:
          byte_3EDE7FA = 0;
          InitGuiDlgMainStatisticEcoDisplayMode();
          break;
        case 2690:
          byte_3EDE7FA = 1;
          InitGuiDlgMainStatisticEcoDisplayMode();
          break;
        case 2795:
          PlayGuiSound(2);
          Text = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, 22, 2766);
          std::string::string(v12, Text);
          v15 = 1;
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v9);
          LOBYTE(v15) = 2;
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::from_bytes(
            v13,
            v12);
          LOBYTE(v15) = 3;
          std::wstring::wstring(v14);
          LOBYTE(v15) = 4;
          if ( !(*(unsigned __int8 (__thiscall **)(void *, _BYTE *, _DWORD))(*(_DWORD *)g_pRandomMaps + 32))(
                  g_pRandomMaps,
                  v13,
                  0)
            && BBSupportDbgReport(
                 2,
                 "gui\\GUI_MainStatisticEco.cpp",
                 831,
                 "g_pRandomMaps->IsRandomMapFileName(temp,NULL)") == 1 )
          {
            __debugbreak();
          }
          (*(void (__thiscall **)(void *, _BYTE *, _BYTE *))(*(_DWORD *)g_pRandomMaps + 32))(g_pRandomMaps, v13, v14);
          v7 = std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
                 v10,
                 v14);
          LOBYTE(v15) = 5;
          (**(void (__thiscall ***)(void *, int))g_pClipboard)(g_pClipboard, v7);
          LOBYTE(v15) = 4;
          std::string::~string(v10);
          LOBYTE(v15) = 3;
          std::wstring::~wstring(v14);
          LOBYTE(v15) = 2;
          std::wstring::~wstring(v13);
          LOBYTE(v15) = 1;
          std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v9);
          v15 = -1;
          std::string::~string(v12);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369495B);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_369495F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13afcf0]
// Decompiled from wchar_t *__cdecl wcsrchr(wchar_t *Str, wchar_t a2)
wchar_t * __cdecl wcsrchr(wchar_t * Str, wchar_t a2) {
  
  return j__wcsrchr(Str, a2);
}


// address=[0x13afd10]
// Decompiled from void InitGuiDlgMainTutorial()
void __cdecl InitGuiDlgMainTutorial(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2101);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2796, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2091);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2798, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2092);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2799, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2093);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2800, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2094);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2801, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2095);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2802, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 2096);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2803, v6);
    v7 = g_pStringEngine->GetString(g_pStringEngine, 2097);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2804, v7);
    v8 = g_pStringEngine->GetString(g_pStringEngine, 2098);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2805, v8);
    v9 = g_pStringEngine->GetString(g_pStringEngine, 2099);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2806, v9);
    v10 = g_pStringEngine->GetString(g_pStringEngine, 2089);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2807, v10);
    v11 = g_pStringEngine->GetString(g_pStringEngine, 2090);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2808, v11);
    v12 = g_pStringEngine->GetString(g_pStringEngine, 2100);
    IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2809, v12);
  }
}


// address=[0x13aff60]
// Decompiled from char __cdecl GuiDlgMainTutorialProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMainTutorialProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  CEvn_Event *v7; // [esp+8h] [ebp-1C0h]
  CEvn_Event *v8; // [esp+10h] [ebp-1B8h]
  CEvn_Event *v9; // [esp+18h] [ebp-1B0h]
  CEvn_Event *v10; // [esp+1Ch] [ebp-1ACh]
  CEvn_Event *v11; // [esp+24h] [ebp-1A4h]
  CEvn_Event *v12; // [esp+2Ch] [ebp-19Ch]
  CEvn_Event *v13; // [esp+34h] [ebp-194h]
  CEvn_Event *v14; // [esp+38h] [ebp-190h]
  CEvn_Event *v15; // [esp+40h] [ebp-188h]
  CEvn_Event *v16; // [esp+48h] [ebp-180h]
  CEvn_Event *v17; // [esp+50h] [ebp-178h]
  CEvn_Event *v18; // [esp+60h] [ebp-168h]
  CEvn_Event *v19; // [esp+68h] [ebp-160h]
  CEvn_Event v20; // [esp+80h] [ebp-148h] BYREF
  CEvn_Event v21; // [esp+98h] [ebp-130h] BYREF
  CEvn_Event v22; // [esp+B0h] [ebp-118h] BYREF
  CEvn_Event v23; // [esp+C8h] [ebp-100h] BYREF
  CEvn_Event v24; // [esp+E0h] [ebp-E8h] BYREF
  CEvn_Event v25; // [esp+F8h] [ebp-D0h] BYREF
  CEvn_Event v26; // [esp+110h] [ebp-B8h] BYREF
  CEvn_Event v27; // [esp+128h] [ebp-A0h] BYREF
  CEvn_Event v28; // [esp+140h] [ebp-88h] BYREF
  CEvn_Event v29; // [esp+158h] [ebp-70h] BYREF
  CEvn_Event v30; // [esp+170h] [ebp-58h] BYREF
  CEvn_Event v31; // [esp+188h] [ebp-40h] BYREF
  CEvn_Event v32; // [esp+1A0h] [ebp-28h] BYREF
  int v33; // [esp+1C4h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMainTutorial();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 2797:
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v31, 0x69u, 0, 0, 0);
          v33 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v31);
          break;
        case 2798:
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v30, 0x68u, 0, 0, 0);
          v33 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v30);
          break;
        case 2799:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v29, 0x68u, 1u, 0, 0);
          v33 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v29);
          break;
        case 2800:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v28, 0x68u, 2u, 0, 0);
          v33 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v28);
          break;
        case 2801:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v27, 0x68u, 3u, 0, 0);
          v33 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v27);
          break;
        case 2802:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v26, 0x68u, 4u, 0, 0);
          v33 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v26);
          break;
        case 2803:
          PlayGuiSound(2);
          v19 = CEvn_Event::CEvn_Event(&v25, 0x68u, 5u, 0, 0);
          v33 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v19);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v25);
          break;
        case 2804:
          PlayGuiSound(2);
          v18 = CEvn_Event::CEvn_Event(&v32, 0x68u, 6u, 0, 0);
          v33 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v32);
          break;
        case 2805:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v24, 0x68u, 7u, 0, 0);
          v33 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v24);
          break;
        case 2806:
          PlayGuiSound(2);
          v17 = CEvn_Event::CEvn_Event(&v23, 0x68u, 8u, 0, 0);
          v33 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v23);
          break;
        case 2807:
          PlayGuiSound(2);
          v16 = CEvn_Event::CEvn_Event(&v22, 0x68u, 9u, 0, 0);
          v33 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v22);
          break;
        case 2808:
          PlayGuiSound(2);
          v15 = CEvn_Event::CEvn_Event(&v21, 0x68u, 0xAu, 0, 0);
          v33 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v21);
          break;
        case 2809:
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v20, 0x68u, 0xBu, 0, 0);
          v33 = 12;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v33 = -1;
          CEvn_Event::~CEvn_Event(&v20);
          break;
        default:
          return 1;
      }
      break;
    case 5:
      switch ( (__int16)a2 )
      {
        case 2798:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2080);
          goto LABEL_28;
        case 2799:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2081);
          goto LABEL_28;
        case 2800:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2082);
          goto LABEL_28;
        case 2801:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2083);
          goto LABEL_28;
        case 2802:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2084);
          goto LABEL_28;
        case 2803:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2085);
          goto LABEL_28;
        case 2804:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2086);
          goto LABEL_28;
        case 2805:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2087);
          goto LABEL_28;
        case 2806:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2088);
          goto LABEL_28;
        case 2807:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2077);
          goto LABEL_28;
        case 2808:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2078);
          goto LABEL_28;
        case 2809:
          v6 = g_pStringEngine->GetString(g_pStringEngine, 2079);
LABEL_28:
          IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2819, v6);
          return 1;
        default:
          return 1;
      }
    case 6:
      if ( (unsigned __int16)a2 >= 0xAEEu && (unsigned __int16)a2 <= 0xAF9u )
        IGuiEngine::SetText((void *)g_pGUIEngine, 11, 2819, (char *)&byte_3694CDF);
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694CDD);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3694CDE);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b0a00]
// Decompiled from char InitGuiDlgMD2Briefing()
void __cdecl InitGuiDlgMD2Briefing(void) {
  
  int v0; // eax
  char result; // al
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax

  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 1811, 0);
  v0 = std::string::c_str(&unk_402C998);
  result = CScrollMultiline::SetText(s_cMD2Scrolltext, v0);
  if ( !g_pStringEngine )
    return result;
  v2 = g_pStringEngine->GetString(g_pStringEngine, 880);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1802, v2);
  v3 = (char *)std::string::c_str(&unk_402C97C);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1807, v3);
  v4 = (char *)std::string::c_str(&unk_402C9B4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1808, v4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 1813, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 1814, 0);
  IGuiEngine::SetImages((void *)g_pGUIEngine, 1, 1813, dword_3694CE0[5 * dword_402C9EC - 85 + dword_402C9F0], 0);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1806, (char *)&byte_3694D30);
}


// address=[0x13b0b10]
// Decompiled from char __cdecl GuiDlgMD2BriefingProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMD2BriefingProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  CEvn_Event *v7; // [esp+4h] [ebp-5Ch]
  CEvn_Event *v8; // [esp+Ch] [ebp-54h]
  CEvn_Event v9; // [esp+20h] [ebp-40h] BYREF
  CEvn_Event v10; // [esp+38h] [ebp-28h] BYREF
  int v11; // [esp+5Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMD2Briefing();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1803:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v10, 0x2330u, 0, 0, 0);
          v11 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v11 = -1;
          CEvn_Event::~CEvn_Event(&v10);
          break;
        case 1804:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v9, 0x2331u, 0, 0, 0);
          v11 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v11 = -1;
          CEvn_Event::~CEvn_Event(&v9);
          break;
        case 1809:
          goto LABEL_15;
        case 1810:
          CScrollMultiline::ScrollDown(s_cMD2Scrolltext);
          break;
        case 1812:
          if ( (a2 & 0x10000) != 0 )
          {
            v6 = (char *)std::string::c_str(&unk_402C9D0);
            IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1806, v6);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 1813, 1);
          }
          else
          {
            IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1806, (char *)byte_3694D33);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 1813, 0);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694D31);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3694D32);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 )
          CScrollMultiline::ScrollDown(s_cMD2Scrolltext);
      }
      else
      {
LABEL_15:
        CScrollMultiline::ScrollUp(s_cMD2Scrolltext);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b0f30]
// Decompiled from char InitGuiDlgMD2Campaigns()
void __cdecl InitGuiDlgMD2Campaigns(void) {
  
  char result; // al
  int v1; // [esp+0h] [ebp-38h]
  int v2; // [esp+4h] [ebp-34h]
  int v3; // [esp+8h] [ebp-30h]
  int v4; // [esp+Ch] [ebp-2Ch]

  if ( !g_pStringEngine )
    return result;
  v1 = dword_402CBBC[17];
  v4 = dword_402CBBC[18];
  v3 = dword_402CBBC[19];
  v2 = dword_402CBBC[20];
  if ( v4 >= 1 || v3 >= 1 )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1827, 1);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1827, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1851, v1 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1828, v1 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1852, v1 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1829, v1 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1853, v1 >= 3);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1830, v1 >= 3);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1854, v1 >= 4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1831, v1 >= 4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1832, 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1861, v4 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1862, v4 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1833, v4 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1863, v4 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1834, v4 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1864, v4 >= 3);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1835, v4 >= 3);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1865, v4 >= 4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1836, v4 >= 4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1842, 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1847, v3 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1843, v3 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1848, v3 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1844, v3 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1849, v3 >= 3);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1845, v3 >= 3);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1850, v3 >= 4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1846, v3 >= 4);
  if ( v4 >= 1 || v3 >= 1 )
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1837, 1);
  else
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1837, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1855, v2 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1838, v2 >= 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1856, v2 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1857, v2 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1858, v2 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1839, v2 >= 2);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1859, v2 >= 3);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1840, v2 >= 3);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1860, v2 >= 4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1841, v2 >= 4);
  IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 0, 1825);
  if ( dword_4031CFC )
    return IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 1825, 1);
  else
    return IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 1824, 1);
  return result;
}


// address=[0x13b15b0]
// Decompiled from char __cdecl GuiDlgMD2CampaignsProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMD2CampaignsProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+8h] [ebp-2B4h]
  CEvn_Event *v7; // [esp+10h] [ebp-2ACh]
  CEvn_Event *v8; // [esp+18h] [ebp-2A4h]
  CEvn_Event *v9; // [esp+20h] [ebp-29Ch]
  CEvn_Event *v10; // [esp+2Ch] [ebp-290h]
  CEvn_Event *v11; // [esp+34h] [ebp-288h]
  CEvn_Event *v12; // [esp+3Ch] [ebp-280h]
  CEvn_Event *v13; // [esp+40h] [ebp-27Ch]
  CEvn_Event *v14; // [esp+48h] [ebp-274h]
  CEvn_Event *v15; // [esp+50h] [ebp-26Ch]
  CEvn_Event *v16; // [esp+58h] [ebp-264h]
  CEvn_Event *v17; // [esp+60h] [ebp-25Ch]
  CEvn_Event *v18; // [esp+68h] [ebp-254h]
  CEvn_Event *v19; // [esp+70h] [ebp-24Ch]
  CEvn_Event *v20; // [esp+78h] [ebp-244h]
  CEvn_Event *v21; // [esp+80h] [ebp-23Ch]
  CEvn_Event *v22; // [esp+88h] [ebp-234h]
  CEvn_Event *v23; // [esp+90h] [ebp-22Ch]
  CEvn_Event *v24; // [esp+98h] [ebp-224h]
  CEvn_Event *v25; // [esp+A0h] [ebp-21Ch]
  CEvn_Event *v26; // [esp+A8h] [ebp-214h]
  CEvn_Event v27; // [esp+B4h] [ebp-208h] BYREF
  CEvn_Event v28; // [esp+CCh] [ebp-1F0h] BYREF
  CEvn_Event v29; // [esp+E4h] [ebp-1D8h] BYREF
  CEvn_Event v30; // [esp+FCh] [ebp-1C0h] BYREF
  CEvn_Event v31; // [esp+114h] [ebp-1A8h] BYREF
  CEvn_Event v32; // [esp+12Ch] [ebp-190h] BYREF
  CEvn_Event v33; // [esp+144h] [ebp-178h] BYREF
  CEvn_Event v34; // [esp+15Ch] [ebp-160h] BYREF
  CEvn_Event v35; // [esp+174h] [ebp-148h] BYREF
  CEvn_Event v36; // [esp+18Ch] [ebp-130h] BYREF
  CEvn_Event v37; // [esp+1A4h] [ebp-118h] BYREF
  CEvn_Event v38; // [esp+1BCh] [ebp-100h] BYREF
  CEvn_Event v39; // [esp+1D4h] [ebp-E8h] BYREF
  CEvn_Event v40; // [esp+1ECh] [ebp-D0h] BYREF
  CEvn_Event v41; // [esp+204h] [ebp-B8h] BYREF
  CEvn_Event v42; // [esp+21Ch] [ebp-A0h] BYREF
  CEvn_Event v43; // [esp+234h] [ebp-88h] BYREF
  CEvn_Event v44; // [esp+24Ch] [ebp-70h] BYREF
  CEvn_Event v45; // [esp+264h] [ebp-58h] BYREF
  CEvn_Event v46; // [esp+27Ch] [ebp-40h] BYREF
  CEvn_Event v47; // [esp+294h] [ebp-28h] BYREF
  int v48; // [esp+2B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMD2Campaigns();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1824:
          PlayGuiSound(2);
          dword_4031CFC = 0;
          break;
        case 1825:
          PlayGuiSound(2);
          dword_4031CFC = 1;
          break;
        case 1826:
          PlayGuiSound(2);
          v15 = CEvn_Event::CEvn_Event(&v46, 0x232Fu, 0, 0, 0);
          v48 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v46);
          break;
        case 1827:
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v45, 0x232Au, 0, 0, 0);
          v48 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v45);
          break;
        case 1828:
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v44, 0x232Au, 1u, 0, 0);
          v48 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v44);
          break;
        case 1829:
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v43, 0x232Au, 2u, 0, 0);
          v48 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v43);
          break;
        case 1830:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v42, 0x232Au, 3u, 0, 0);
          v48 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v42);
          break;
        case 1831:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v41, 0x232Au, 4u, 0, 0);
          v48 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v41);
          break;
        case 1832:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v40, 0x232Bu, 0, 0, 0);
          v48 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v40);
          break;
        case 1833:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v39, 0x232Bu, 1u, 0, 0);
          v48 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v39);
          break;
        case 1834:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v38, 0x232Bu, 2u, 0, 0);
          v48 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v38);
          break;
        case 1835:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v37, 0x232Bu, 3u, 0, 0);
          v48 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v37);
          break;
        case 1836:
          PlayGuiSound(2);
          v26 = CEvn_Event::CEvn_Event(&v36, 0x232Bu, 4u, 0, 0);
          v48 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v26);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v36);
          break;
        case 1837:
          PlayGuiSound(2);
          v20 = CEvn_Event::CEvn_Event(&v31, 0x232Du, 0, 0, 0);
          v48 = 16;
          IEventEngine::SendAMessage(g_pEvnEngine, v20);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v31);
          break;
        case 1838:
          PlayGuiSound(2);
          v19 = CEvn_Event::CEvn_Event(&v30, 0x232Du, 1u, 0, 0);
          v48 = 17;
          IEventEngine::SendAMessage(g_pEvnEngine, v19);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v30);
          break;
        case 1839:
          PlayGuiSound(2);
          v18 = CEvn_Event::CEvn_Event(&v29, 0x232Du, 2u, 0, 0);
          v48 = 18;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v29);
          break;
        case 1840:
          PlayGuiSound(2);
          v17 = CEvn_Event::CEvn_Event(&v28, 0x232Du, 3u, 0, 0);
          v48 = 19;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v28);
          break;
        case 1841:
          PlayGuiSound(2);
          v16 = CEvn_Event::CEvn_Event(&v27, 0x232Du, 4u, 0, 0);
          v48 = 20;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v27);
          break;
        case 1842:
          PlayGuiSound(2);
          v25 = CEvn_Event::CEvn_Event(&v35, 0x232Cu, 0, 0, 0);
          v48 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v25);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v35);
          break;
        case 1843:
          PlayGuiSound(2);
          v24 = CEvn_Event::CEvn_Event(&v47, 0x232Cu, 1u, 0, 0);
          v48 = 12;
          IEventEngine::SendAMessage(g_pEvnEngine, v24);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v47);
          break;
        case 1844:
          PlayGuiSound(2);
          v23 = CEvn_Event::CEvn_Event(&v34, 0x232Cu, 2u, 0, 0);
          v48 = 13;
          IEventEngine::SendAMessage(g_pEvnEngine, v23);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v34);
          break;
        case 1845:
          PlayGuiSound(2);
          v22 = CEvn_Event::CEvn_Event(&v33, 0x232Cu, 3u, 0, 0);
          v48 = 14;
          IEventEngine::SendAMessage(g_pEvnEngine, v22);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v33);
          break;
        case 1846:
          PlayGuiSound(2);
          v21 = CEvn_Event::CEvn_Event(&v32, 0x232Cu, 4u, 0, 0);
          v48 = 15;
          IEventEngine::SendAMessage(g_pEvnEngine, v21);
          v48 = -1;
          CEvn_Event::~CEvn_Event(&v32);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694D44);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3694D45);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b23e0]
// Decompiled from char InitGuiDlgMDBriefing()
void __cdecl InitGuiDlgMDBriefing(void) {
  
  int v0; // eax
  char result; // al
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax

  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 5, 1875, 0);
  v0 = std::string::c_str(&unk_402C998);
  result = CScrollMultiline::SetText(s_cMDScrolltext, v0);
  if ( !g_pStringEngine )
    return result;
  v2 = g_pStringEngine->GetString(g_pStringEngine, 880);
  IGuiEngine::SetText((void *)g_pGUIEngine, 5, 1866, v2);
  v3 = (char *)std::string::c_str(&unk_402C97C);
  IGuiEngine::SetText((void *)g_pGUIEngine, 5, 1871, v3);
  v4 = (char *)std::string::c_str(&unk_402C9B4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 5, 1872, v4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 5, 1877, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 5, 1878, 0);
  IGuiEngine::SetImages((void *)g_pGUIEngine, 5, 1877, dword_3694D48[5 * dword_402C9EC - 25 + dword_402C9F0], 0);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 5, 1870, (char *)&byte_3694DC0);
}


// address=[0x13b24f0]
// Decompiled from char __cdecl GuiDlgMDBriefingProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMDBriefingProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  CEvn_Event *v7; // [esp+4h] [ebp-5Ch]
  CEvn_Event *v8; // [esp+Ch] [ebp-54h]
  CEvn_Event v9; // [esp+20h] [ebp-40h] BYREF
  CEvn_Event v10; // [esp+38h] [ebp-28h] BYREF
  int v11; // [esp+5Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMDBriefing();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1867:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v10, 0x1B75u, 0, 0, 0);
          v11 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v11 = -1;
          CEvn_Event::~CEvn_Event(&v10);
          break;
        case 1868:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v9, 0x1B76u, 0, 0, 0);
          v11 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v11 = -1;
          CEvn_Event::~CEvn_Event(&v9);
          break;
        case 1873:
          goto LABEL_15;
        case 1874:
          CScrollMultiline::ScrollDown(s_cMDScrolltext);
          break;
        case 1876:
          if ( (a2 & 0x10000) != 0 )
          {
            v6 = (char *)std::string::c_str(&unk_402C9D0);
            IGuiEngine::SetText((void *)g_pGUIEngine, 5, 1870, v6);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 5, 1877, 1);
          }
          else
          {
            IGuiEngine::SetText((void *)g_pGUIEngine, 5, 1870, (char *)&byte_3694DC3);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 5, 1877, 0);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694DC1);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3694DC2);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 0 )
      {
        if ( a2 < 0 )
          CScrollMultiline::ScrollDown(s_cMDScrolltext);
      }
      else
      {
LABEL_15:
        CScrollMultiline::ScrollUp(s_cMDScrolltext);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b2910]
// Decompiled from void InitGuiDlgMDCampaignMayan()
void __cdecl InitGuiDlgMDCampaignMayan(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  int v6; // [esp+0h] [ebp-8h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2986);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 1888, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2955);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 1889, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2957);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 1890, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2959);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 1891, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2961);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 1892, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2963);
    IGuiEngine::SetText((void *)g_pGUIEngine, 2, 1893, v5);
    v6 = dword_402CBBC[7];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 1890, v6 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 1891, v6 >= 2);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 1892, v6 >= 3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 2, 1893, v6 >= 4);
  }
}


// address=[0x13b2ae0]
// Decompiled from char __cdecl GuiDlgMDCampaignMayanProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgMDCampaignMayanProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-D8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-D0h]
  CEvn_Event *v8; // [esp+14h] [ebp-C8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-C0h]
  CEvn_Event *v10; // [esp+24h] [ebp-B8h]
  CEvn_Event *v11; // [esp+2Ch] [ebp-B0h]
  CEvn_Event v12; // [esp+3Ch] [ebp-A0h] BYREF
  CEvn_Event v13; // [esp+54h] [ebp-88h] BYREF
  CEvn_Event v14; // [esp+6Ch] [ebp-70h] BYREF
  CEvn_Event v15; // [esp+84h] [ebp-58h] BYREF
  CEvn_Event v16; // [esp+9Ch] [ebp-40h] BYREF
  CEvn_Event v17; // [esp+B4h] [ebp-28h] BYREF
  int v18; // [esp+D8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMDCampaignMayan();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 1889:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v16, 0x1B62u, 0, 0, 0);
          v18 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v16);
          break;
        case 1890:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v15, 0x1B62u, 1u, 0, 0);
          v18 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case 1891:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v14, 0x1B62u, 2u, 0, 0);
          v18 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 1892:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v13, 0x1B62u, 3u, 0, 0);
          v18 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case 1893:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v12, 0x1B62u, 4u, 0, 0);
          v18 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case 1901:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v17, 0x1B63u, 0, 0, 0);
          v18 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694DDC);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3694DDD);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b3050]
// Decompiled from void InitGuiDlgMDCampaignRoman()
void __cdecl InitGuiDlgMDCampaignRoman(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  int v6; // [esp+0h] [ebp-8h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2982);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1902, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2939);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1903, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2941);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1904, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2943);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1905, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2945);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1906, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2947);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 1907, v5);
    v6 = dword_402CBBC[5];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 1, 1904, v6 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 1, 1905, v6 >= 2);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 1, 1906, v6 >= 3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 1, 1907, v6 >= 4);
  }
}


// address=[0x13b3220]
// Decompiled from char __cdecl GuiDlgMDCampaignRomanProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgMDCampaignRomanProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-D8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-D0h]
  CEvn_Event *v8; // [esp+14h] [ebp-C8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-C0h]
  CEvn_Event *v10; // [esp+24h] [ebp-B8h]
  CEvn_Event *v11; // [esp+2Ch] [ebp-B0h]
  CEvn_Event v12; // [esp+3Ch] [ebp-A0h] BYREF
  CEvn_Event v13; // [esp+54h] [ebp-88h] BYREF
  CEvn_Event v14; // [esp+6Ch] [ebp-70h] BYREF
  CEvn_Event v15; // [esp+84h] [ebp-58h] BYREF
  CEvn_Event v16; // [esp+9Ch] [ebp-40h] BYREF
  CEvn_Event v17; // [esp+B4h] [ebp-28h] BYREF
  int v18; // [esp+D8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMDCampaignRoman();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 1903:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v16, 0x1B60u, 0, 0, 0);
          v18 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v16);
          break;
        case 1904:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v15, 0x1B60u, 1u, 0, 0);
          v18 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case 1905:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v14, 0x1B60u, 2u, 0, 0);
          v18 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 1906:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v13, 0x1B60u, 3u, 0, 0);
          v18 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case 1907:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v12, 0x1B60u, 4u, 0, 0);
          v18 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case 1915:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v17, 0x1B61u, 0, 0, 0);
          v18 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694DDE);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3694DDF);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b3790]
// Decompiled from void InitGuiDlgMDCampaigns()
void __cdecl InitGuiDlgMDCampaigns(void) {
  
  char *v0; // eax
  char *v1; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 888);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 1922, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2988);
    IGuiEngine::SetText((void *)g_pGUIEngine, 0, 1921, v1);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 0, 1917, dword_402CBBC[10] != 0);
    IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 0, 1924);
    if ( dword_4031CFC )
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 1924, 1);
    else
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 1923, 1);
  }
}


// address=[0x13b3880]
// Decompiled from char __cdecl GuiDlgMDCampaignsProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMDCampaignsProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-D8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-D0h]
  CEvn_Event *v8; // [esp+14h] [ebp-C8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-C0h]
  CEvn_Event *v10; // [esp+24h] [ebp-B8h]
  CEvn_Event *v11; // [esp+2Ch] [ebp-B0h]
  CEvn_Event v12; // [esp+3Ch] [ebp-A0h] BYREF
  CEvn_Event v13; // [esp+54h] [ebp-88h] BYREF
  CEvn_Event v14; // [esp+6Ch] [ebp-70h] BYREF
  CEvn_Event v15; // [esp+84h] [ebp-58h] BYREF
  CEvn_Event v16; // [esp+9Ch] [ebp-40h] BYREF
  CEvn_Event v17; // [esp+B4h] [ebp-28h] BYREF
  int v18; // [esp+D8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMDCampaigns();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1916:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v14, 0x1B5Du, 0, 0, 0);
          v18 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 1917:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v12, 0x1B5Eu, 0, 0, 0);
          v18 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        case 1918:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v15, 0x1B5Bu, 0, 0, 0);
          v18 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case 1919:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v13, 0x1B5Fu, 0, 0, 0);
          v18 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case 1920:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v16, 0x1B5Cu, 0, 0, 0);
          v18 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v16);
          break;
        case 1923:
          PlayGuiSound(2);
          dword_4031CFC = 0;
          break;
        case 1924:
          PlayGuiSound(2);
          dword_4031CFC = 1;
          break;
        case 1925:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v17, 0x1B5Au, 0, 0, 0);
          v18 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694DE0);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3694DE1);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b3de0]
// Decompiled from void InitGuiDlgMDCampaignsEcoConflict()
void __cdecl InitGuiDlgMDCampaignsEcoConflict(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  int v7; // [esp+0h] [ebp-Ch]
  int v8; // [esp+4h] [ebp-8h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2984);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 1947, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2949);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 1941, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2951);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 1942, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2953);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 1943, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2923);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 1944, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2925);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 1945, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 2927);
    IGuiEngine::SetText((void *)g_pGUIEngine, 4, 1946, v6);
    v8 = dword_402CBBC[8];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 4, 1942, v8 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 4, 1943, v8 >= 2);
    v7 = dword_402CBBC[9];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 4, 1945, v7 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 4, 1946, v7 >= 2);
  }
}


// address=[0x13b3ff0]
// Decompiled from char __cdecl GuiDlgMDCampaignsEcoConflictProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgMDCampaignsEcoConflictProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-F8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-F0h]
  CEvn_Event *v8; // [esp+14h] [ebp-E8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-E0h]
  CEvn_Event *v10; // [esp+24h] [ebp-D8h]
  CEvn_Event *v11; // [esp+2Ch] [ebp-D0h]
  CEvn_Event *v12; // [esp+34h] [ebp-C8h]
  CEvn_Event v13; // [esp+44h] [ebp-B8h] BYREF
  CEvn_Event v14; // [esp+5Ch] [ebp-A0h] BYREF
  CEvn_Event v15; // [esp+74h] [ebp-88h] BYREF
  CEvn_Event v16; // [esp+8Ch] [ebp-70h] BYREF
  CEvn_Event v17; // [esp+A4h] [ebp-58h] BYREF
  CEvn_Event v18; // [esp+BCh] [ebp-40h] BYREF
  CEvn_Event v19; // [esp+D4h] [ebp-28h] BYREF
  int v20; // [esp+F8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMDCampaignsEcoConflict();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 1940:
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v19, 0x1B68u, 0, 0, 0);
          v20 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v19);
          break;
        case 1941:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v18, 0x1B66u, 0, 0, 0);
          v20 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v18);
          break;
        case 1942:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v17, 0x1B66u, 1u, 0, 0);
          v20 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          break;
        case 1943:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v16, 0x1B66u, 2u, 0, 0);
          v20 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v16);
          break;
        case 1944:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v15, 0x1B67u, 0, 0, 0);
          v20 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case 1945:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v14, 0x1B67u, 1u, 0, 0);
          v20 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 1946:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v13, 0x1B67u, 2u, 0, 0);
          v20 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v20 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694DE2);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3694DE3);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b45d0]
// Decompiled from void InitGuiDlgMDCampaignViking()
void __cdecl InitGuiDlgMDCampaignViking(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  int v6; // [esp+0h] [ebp-8h]

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2980);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 1948, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2929);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 1950, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2931);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 1951, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2933);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 1952, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2935);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 1953, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2937);
    IGuiEngine::SetText((void *)g_pGUIEngine, 3, 1954, v5);
    v6 = dword_402CBBC[6];
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 3, 1951, v6 >= 1);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 3, 1952, v6 >= 2);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 3, 1953, v6 >= 3);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 3, 1954, v6 >= 4);
  }
}


// address=[0x13b47a0]
// Decompiled from char __cdecl GuiDlgMDCampaignVikingProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgMDCampaignVikingProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-D8h]
  CEvn_Event *v7; // [esp+Ch] [ebp-D0h]
  CEvn_Event *v8; // [esp+14h] [ebp-C8h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-C0h]
  CEvn_Event *v10; // [esp+24h] [ebp-B8h]
  CEvn_Event *v11; // [esp+2Ch] [ebp-B0h]
  CEvn_Event v12; // [esp+3Ch] [ebp-A0h] BYREF
  CEvn_Event v13; // [esp+54h] [ebp-88h] BYREF
  CEvn_Event v14; // [esp+6Ch] [ebp-70h] BYREF
  CEvn_Event v15; // [esp+84h] [ebp-58h] BYREF
  CEvn_Event v16; // [esp+9Ch] [ebp-40h] BYREF
  CEvn_Event v17; // [esp+B4h] [ebp-28h] BYREF
  int v18; // [esp+D8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMDCampaignViking();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 1949:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v17, 0x1B65u, 0, 0, 0);
          v18 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v17);
          break;
        case 1950:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v16, 0x1B64u, 0, 0, 0);
          v18 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v16);
          break;
        case 1951:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v15, 0x1B64u, 1u, 0, 0);
          v18 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v15);
          break;
        case 1952:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v14, 0x1B64u, 2u, 0, 0);
          v18 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 1953:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v13, 0x1B64u, 3u, 0, 0);
          v18 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case 1954:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v12, 0x1B64u, 4u, 0, 0);
          v18 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v18 = -1;
          CEvn_Event::~CEvn_Event(&v12);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694DE4);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3694DE5);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b4cf0]
// Decompiled from bool GuiDlgMDRandomMapParametersFillPlayerTeams()
void __cdecl GuiDlgMDRandomMapParametersFillPlayerTeams(void) {
  
  CHAR Str[256]; // [esp+8h] [ebp-104h] BYREF

  if ( dword_4031928 > dword_4031924 )
    dword_4031928 = dword_4031924;
  _wsprintfA(Str, "%d", dword_4031924);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1991, Str);
  _wsprintfA(Str, "%d", dword_4031928);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1997, Str);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 1992, byte_403195A);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 1993, byte_403195A);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 1998, byte_403195B);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 1999, byte_403195B);
  return IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2017, dword_4031998 == 7);
}


// address=[0x13b4e60]
// Decompiled from void GuiDlgMDRandomMapParametersUpdate()
void __cdecl GuiDlgMDRandomMapParametersUpdate(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  const wchar_t *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax
  char *v14; // eax
  char *v15; // eax
  char *v16; // eax
  char *v17; // eax
  char *v18; // eax
  char *v19; // eax
  char *v20; // eax
  char *v21; // eax
  char *v22; // eax
  char *v23; // eax
  char *v24; // eax
  char *v25; // eax
  char *v26; // eax
  char *v27; // eax
  char *v28; // eax
  char *v29; // eax
  char *v30; // eax
  char *v31; // eax
  char *v32; // eax
  char *v33; // eax
  char *v34; // eax
  char *v35; // eax
  char *v36; // eax
  char *v37; // eax
  char *v38; // eax
  char *v39; // eax
  char *v40; // eax
  char *v41; // eax
  CEvn_Event *v42; // [esp+4h] [ebp-240h]
  CEvn_Event *v43; // [esp+Ch] [ebp-238h]
  CEvn_Event *v44; // [esp+14h] [ebp-230h]
  CEvn_Event *v45; // [esp+1Ch] [ebp-228h]
  char v46[88]; // [esp+44h] [ebp-200h] BYREF
  CEvn_Event v47; // [esp+9Ch] [ebp-1A8h] BYREF
  CEvn_Event v48; // [esp+B4h] [ebp-190h] BYREF
  CEvn_Event v49; // [esp+CCh] [ebp-178h] BYREF
  CEvn_Event v50; // [esp+E4h] [ebp-160h] BYREF
  _BYTE v51[28]; // [esp+FCh] [ebp-148h] BYREF
  char v52[28]; // [esp+118h] [ebp-12Ch] BYREF
  char Dest[256]; // [esp+134h] [ebp-110h] BYREF
  int v54; // [esp+240h] [ebp-4h]

  IGuiEngine::SetImages((void *)g_pGUIEngine, dword_4031998, 2006, 31, 31);
  byte_3EDFB45 = 0;
  GuiDlgMDRandomMapParametersFillPlayerTeams();
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2005, byte_3EDFB44);
  if ( !g_pAddOn && BBSupportDbgReport(2, "gui\\GUI_MD_RandomMapParameters.cpp", 433, "g_pAddOn") == 1 )
    __debugbreak();
  if ( !g_pMissionCD2 && BBSupportDbgReport(2, "gui\\GUI_MD_RandomMapParameters.cpp", 434, "g_pMissionCD2") == 1 )
    __debugbreak();
  if ( g_pEvnEngine )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
      || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
    {
      v45 = CEvn_Event::CEvn_Event(&v50, 0x4Bu, (unsigned __int8)g_uiExtrasAllowed, 0, 0);
      v54 = 0;
      IEventEngine::SendAMessage(g_pEvnEngine, v45);
      v54 = -1;
      CEvn_Event::~CEvn_Event(&v50);
    }
    else
    {
      v44 = CEvn_Event::CEvn_Event(&v49, 0x4Bu, 0, 0, 0);
      v54 = 1;
      IEventEngine::SendAMessage(g_pEvnEngine, v44);
      v54 = -1;
      CEvn_Event::~CEvn_Event(&v49);
    }
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
    {
      v43 = CEvn_Event::CEvn_Event(&v48, 0x4Cu, (unsigned __int8)g_bNewTextures, 0, 0);
      v54 = 2;
      IEventEngine::SendAMessage(g_pEvnEngine, v43);
      v54 = -1;
      CEvn_Event::~CEvn_Event(&v48);
    }
    else
    {
      v42 = CEvn_Event::CEvn_Event(&v47, 0x4Cu, 0, 0, 0);
      v54 = 3;
      IEventEngine::SendAMessage(g_pEvnEngine, v42);
      v54 = -1;
      CEvn_Event::~CEvn_Event(&v47);
    }
  }
  switch ( dword_4031930 )
  {
    case 1:
      v0 = g_pStringEngine->GetString(g_pStringEngine, 2056);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2000, v0);
      break;
    case 2:
      v1 = g_pStringEngine->GetString(g_pStringEngine, 2049);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2000, v1);
      break;
    case 3:
      v2 = g_pStringEngine->GetString(g_pStringEngine, 2046);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2000, v2);
      break;
  }
  switch ( dword_4031934 )
  {
    case 1:
      v3 = g_pStringEngine->GetString(g_pStringEngine, 2040);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1987, v3);
      break;
    case 2:
      v5 = g_pStringEngine->GetString(g_pStringEngine, 2041);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1987, v5);
      break;
    case 3:
      v4 = g_pStringEngine->GetString(g_pStringEngine, 2042);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1987, v4);
      break;
    case 4:
      v6 = g_pStringEngine->GetString(g_pStringEngine, 2309);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1987, v6);
      break;
    case 5:
      v7 = g_pStringEngine->GetString(g_pStringEngine, 2043);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1987, v7);
      break;
    default:
      break;
  }
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2006, byte_3EDFB45);
  v8 = (char *)std::string::c_str(&unk_403197C);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2003, v8);
  v9 = (const wchar_t *)std::wstring::c_str((_Cnd_internal_imp_t *)&unk_4031960);
  j__wcstombs(Dest, v9, 0x100u);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1985, Dest);
  if ( dword_4031F88 > 640 )
  {
    if ( dword_4031F88 > 896 )
    {
      if ( dword_4031F88 == 960 )
      {
        v21 = g_pStringEngine->GetString(g_pStringEngine, 3290);
        IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v21);
        goto LABEL_62;
      }
      if ( dword_4031F88 == 1024 )
      {
        v22 = g_pStringEngine->GetString(g_pStringEngine, 3278);
        IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v22);
        goto LABEL_62;
      }
    }
    else
    {
      switch ( dword_4031F88 )
      {
        case 896:
          v20 = g_pStringEngine->GetString(g_pStringEngine, 3289);
          IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v20);
          goto LABEL_62;
        case 704:
          v17 = g_pStringEngine->GetString(g_pStringEngine, 3286);
          IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v17);
          goto LABEL_62;
        case 768:
          v18 = g_pStringEngine->GetString(g_pStringEngine, 3287);
          IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v18);
          goto LABEL_62;
        case 832:
          v19 = g_pStringEngine->GetString(g_pStringEngine, 3288);
          IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v19);
          goto LABEL_62;
      }
    }
  }
  else
  {
    if ( dword_4031F88 == 640 )
    {
      v16 = g_pStringEngine->GetString(g_pStringEngine, 3285);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v16);
      goto LABEL_62;
    }
    if ( dword_4031F88 > 448 )
    {
      if ( dword_4031F88 == 512 )
      {
        v14 = g_pStringEngine->GetString(g_pStringEngine, 3283);
        IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v14);
        goto LABEL_62;
      }
      if ( dword_4031F88 == 576 )
      {
        v15 = g_pStringEngine->GetString(g_pStringEngine, 3284);
        IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v15);
        goto LABEL_62;
      }
    }
    else
    {
      switch ( dword_4031F88 )
      {
        case 448:
          v13 = g_pStringEngine->GetString(g_pStringEngine, 3282);
          IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v13);
          goto LABEL_62;
        case 256:
          v10 = g_pStringEngine->GetString(g_pStringEngine, 3279);
          IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v10);
          goto LABEL_62;
        case 320:
          v11 = g_pStringEngine->GetString(g_pStringEngine, 3280);
          IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v11);
          goto LABEL_62;
        case 384:
          v12 = g_pStringEngine->GetString(g_pStringEngine, 3281);
          IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v12);
          goto LABEL_62;
      }
    }
  }
  dword_4031F88 = 512;
  v23 = g_pStringEngine->GetString(g_pStringEngine, 3283);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1964, v23);
LABEL_62:
  switch ( dword_4031F94 & 3 )
  {
    case 0:
      v24 = g_pStringEngine->GetString(g_pStringEngine, 3276);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1968, v24);
      break;
    case 1:
      v26 = g_pStringEngine->GetString(g_pStringEngine, 3277);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1968, v26);
      break;
    case 2:
      v25 = g_pStringEngine->GetString(g_pStringEngine, 3275);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1968, v25);
      break;
    case 3:
      v27 = g_pStringEngine->GetString(g_pStringEngine, 3274);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1968, v27);
      break;
    default:
      break;
  }
  switch ( dword_4031F8C )
  {
    case 10:
      v28 = g_pStringEngine->GetString(g_pStringEngine, 3265);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v28);
      break;
    case 20:
      v29 = g_pStringEngine->GetString(g_pStringEngine, 3266);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v29);
      break;
    case 30:
      v30 = g_pStringEngine->GetString(g_pStringEngine, 3267);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v30);
      break;
    case 40:
      v31 = g_pStringEngine->GetString(g_pStringEngine, 3268);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v31);
      break;
    case 50:
      v32 = g_pStringEngine->GetString(g_pStringEngine, 3269);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v32);
      break;
    case 60:
      v33 = g_pStringEngine->GetString(g_pStringEngine, 3270);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v33);
      break;
    case 70:
      v34 = g_pStringEngine->GetString(g_pStringEngine, 3271);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v34);
      break;
    case 80:
      v35 = g_pStringEngine->GetString(g_pStringEngine, 3272);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v35);
      break;
    case 90:
      v36 = g_pStringEngine->GetString(g_pStringEngine, 3273);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v36);
      break;
    default:
      dword_4031F8C = 70;
      v37 = g_pStringEngine->GetString(g_pStringEngine, 3269);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1975, v37);
      break;
  }
  dword_4031FA0 = dword_4031924;
  if ( byte_4031FA4 )
    Dest[0] = 0;
  else
    j__sprintf(Dest, "%i", dword_4031F84);
  IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1972, Dest);
  if ( dword_4031F90 == 5 )
  {
    v38 = g_pStringEngine->GetString(g_pStringEngine, 2056);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1979, v38);
  }
  else if ( dword_4031F90 == 10 )
  {
    v39 = g_pStringEngine->GetString(g_pStringEngine, 2049);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1979, v39);
  }
  else
  {
    if ( dword_4031F90 == 15 )
    {
      v40 = g_pStringEngine->GetString(g_pStringEngine, 2046);
    }
    else
    {
      dword_4031F90 = 10;
      v40 = g_pStringEngine->GetString(g_pStringEngine, 2049);
    }
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1979, v40);
  }
  if ( byte_3EDFB44 )
  {
    std::wstring::wstring(v52);
    v54 = 4;
    (*(void (__thiscall **)(void *, int *, char *))(*(_DWORD *)g_pRandomMaps + 24))(g_pRandomMaps, &g_sRMP, v52);
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v46);
    LOBYTE(v54) = 5;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::to_bytes(
      v51,
      v52);
    LOBYTE(v54) = 6;
    v41 = (char *)std::string::c_str(v51);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1983, v41);
    LOBYTE(v54) = 5;
    std::string::~string(v51);
    LOBYTE(v54) = 4;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v46);
    v54 = -1;
    std::wstring::~wstring(v52);
  }
}


// address=[0x13b5d80]
// Decompiled from void InitGuiDlgMDRandomMapParameters()
void __cdecl InitGuiDlgMDRandomMapParameters(void) {
  
  __int64 v0; // kr00_8
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  int Instance; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax
  char *v14; // eax
  char *v15; // eax
  char *v16; // eax
  char *v17; // eax
  char v18; // al
  char *v19; // eax
  char *Str; // [esp+8h] [ebp-10h]
  int i; // [esp+Ch] [ebp-Ch]
  char v22; // [esp+15h] [ebp-3h]
  char v23; // [esp+16h] [ebp-2h]
  bool v24; // [esp+17h] [ebp-1h]

  byte_403199C = g_uiExtrasAllowed;
  g_bNewTextures = 0;
  byte_403199D = 0;
  IGuiEngine::SetImages((void *)g_pGUIEngine, dword_4031998, 2006, 31, 31);
  byte_3EDFB45 = 0;
  if ( g_pStringEngine )
  {
    memset(&g_sRMP, 0, 0xB8u);
    g_sRMP = 184;
    dword_4031F98 = 0;
    dword_4031F9C = 0;
    byte_4031FA5 = 0;
    dword_4031F94 = 0;
    dword_4031F8C = 70;
    dword_4031FA0 = dword_4031924;
    v0 = 0x7FFF * j__rand();
    dword_4031F84 = (j__rand() + v0) % 0xF4240uLL;
    byte_4031FA4 = 0;
    dword_4031F90 = 10;
    dword_4031F88 = 512;
    byte_3EDFB44 = 1;
    byte_3EDFB45 = 0;
    for ( i = 0; i < 9; ++i )
    {
      dword_4031FA8[4 * i] = 16;
      dword_4031FB4[4 * i] = 0;
      dword_4031FB0[4 * i] = 0;
      dword_4031FAC[4 * i] = -1;
    }
    v1 = g_pStringEngine->GetString(g_pStringEngine, 2991);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1962, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 2017);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1984, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 2062);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1990, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 2073);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1994, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 2053);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1995, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 2050);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1986, v6);
    if ( byte_4031914 )
    {
      IGuiEngine::SetTypeAsRadio((IGuiEngine *)g_pGUIEngine, dword_4031998, 2003, 0x23u, 0x22u);
      IGuiEngine::SetPosition((IGuiEngine *)g_pGUIEngine, dword_4031998, 2003, 0x264u, 0x1E4u);
      IGuiEngine::SetRadioCheckPressedState((IGuiEngine *)g_pGUIEngine, dword_4031998, 2003, g_bIsPrivateSession);
      Instance = OnlineManager::GetInstance();
      if ( (unsigned __int8)OnlineManager::IsQuickMatchFlow(Instance) )
      {
        IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1996, byte_3694E4B);
      }
      else
      {
        Str = g_pStringEngine->GetString(g_pStringEngine, 3836);
        IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1996, Str);
      }
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2003, g_bIsPrivateSession);
      v8 = OnlineManager::GetInstance();
      v24 = (unsigned __int8)OnlineManager::IsQuickMatchFlow(v8) == 0;
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2003, v24);
      v9 = OnlineManager::GetInstance();
      v23 = (unsigned __int8)OnlineManager::IsQuickMatchFlow(v9) == 0;
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2003, v23);
      v10 = OnlineManager::GetInstance();
      v22 = (unsigned __int8)OnlineManager::IsQuickMatchFlow(v10) == 0;
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 1996, v22);
    }
    IGuiEngine::SetEditProperties((IGuiEngine *)g_pGUIEngine, dword_4031998, 1985, 0x20u, 4u);
    IGuiEngine::SetEditProperties((IGuiEngine *)g_pGUIEngine, dword_4031998, 1972, 6u, 1u);
    IGuiEngine::SetEditProperties((IGuiEngine *)g_pGUIEngine, dword_4031998, 1983, 8u, 3u);
    v11 = g_pStringEngine->GetString(g_pStringEngine, 2994);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1982, v11);
    v12 = g_pStringEngine->GetString(g_pStringEngine, 2996);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1971, v12);
    v13 = g_pStringEngine->GetString(g_pStringEngine, 2990);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1974, v13);
    v14 = g_pStringEngine->GetString(g_pStringEngine, 2997);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1967, v14);
    v15 = g_pStringEngine->GetString(g_pStringEngine, 2992);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1978, v15);
    v16 = g_pStringEngine->GetString(g_pStringEngine, 2993);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 1963, v16);
    v17 = g_pStringEngine->GetString(g_pStringEngine, 297);
    IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2024, v17);
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
      || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2024, 1);
    }
    else
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2024, 0);
    }
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
      || (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2023, 1);
    }
    else
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2023, 0);
    }
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2023, 1);
    if ( !g_pMissionCD2 && BBSupportDbgReport(2, "gui\\GUI_MD_RandomMapParameters.cpp", 319, "g_pMissionCD2") == 1 )
      __debugbreak();
    v18 = (*(int (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2025, v18);
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
    {
      v19 = g_pStringEngine->GetString(g_pStringEngine, 3840);
      IGuiEngine::SetText((void *)g_pGUIEngine, dword_4031998, 2026, v19);
    }
    GuiDlgMDRandomMapParametersUpdate();
  }
}


// address=[0x13b6490]
// Decompiled from char __cdecl GuiDlgMDRandomMapParametersProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMDRandomMapParametersProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  int Instance; // eax
  OnlineManager *v7; // eax
  const char *v8; // eax
  CEvn_Event *v9; // [esp+4h] [ebp-6A4h]
  CEvn_Event *v10; // [esp+Ch] [ebp-69Ch]
  int v11; // [esp+10h] [ebp-698h]
  CEvn_Event *v12; // [esp+18h] [ebp-690h]
  CEvn_Event *v13; // [esp+20h] [ebp-688h]
  CEvn_Event *v14; // [esp+28h] [ebp-680h]
  CEvn_Event *v15; // [esp+30h] [ebp-678h]
  CEvn_Event *v16; // [esp+34h] [ebp-674h]
  CEvn_Event *v17; // [esp+3Ch] [ebp-66Ch]
  CEvn_Event *v18; // [esp+44h] [ebp-664h]
  CEvn_Event *v19; // [esp+4Ch] [ebp-65Ch]
  CEvn_Event *v20; // [esp+54h] [ebp-654h]
  CEvn_Event *v21; // [esp+5Ch] [ebp-64Ch]
  CEvn_Event *v22; // [esp+64h] [ebp-644h]
  CEvn_Event *v23; // [esp+6Ch] [ebp-63Ch]
  CEvn_Event *v24; // [esp+74h] [ebp-634h]
  CEvn_Event *v25; // [esp+7Ch] [ebp-62Ch]
  CEvn_Event *v26; // [esp+84h] [ebp-624h]
  CEvn_Event *v27; // [esp+94h] [ebp-614h]
  CEvn_Event *v28; // [esp+9Ch] [ebp-60Ch]
  CEvn_Event *v29; // [esp+A4h] [ebp-604h]
  CEvn_Event *v30; // [esp+ACh] [ebp-5FCh]
  CEvn_Event *v31; // [esp+B4h] [ebp-5F4h]
  CEvn_Event *v32; // [esp+BCh] [ebp-5ECh]
  CEvn_Event *v33; // [esp+C4h] [ebp-5E4h]
  CEvn_Event *v34; // [esp+D0h] [ebp-5D8h]
  char *Text; // [esp+D8h] [ebp-5D0h]
  char *Source; // [esp+F4h] [ebp-5B4h]
  char *String; // [esp+F8h] [ebp-5B0h]
  char *Str; // [esp+FCh] [ebp-5ACh]
  char v39; // [esp+107h] [ebp-5A1h]
  char v40[88]; // [esp+108h] [ebp-5A0h] BYREF
  char v41[88]; // [esp+160h] [ebp-548h] BYREF
  int v42[7]; // [esp+1B8h] [ebp-4F0h] BYREF
  CEvn_Event v43; // [esp+1D4h] [ebp-4D4h] BYREF
  CEvn_Event v44; // [esp+1ECh] [ebp-4BCh] BYREF
  CEvn_Event v45; // [esp+204h] [ebp-4A4h] BYREF
  CEvn_Event v46; // [esp+21Ch] [ebp-48Ch] BYREF
  CEvn_Event v47; // [esp+234h] [ebp-474h] BYREF
  CEvn_Event v48; // [esp+24Ch] [ebp-45Ch] BYREF
  CEvn_Event v49; // [esp+264h] [ebp-444h] BYREF
  CEvn_Event v50; // [esp+27Ch] [ebp-42Ch] BYREF
  CEvn_Event v51; // [esp+294h] [ebp-414h] BYREF
  CEvn_Event v52; // [esp+2ACh] [ebp-3FCh] BYREF
  CEvn_Event v53; // [esp+2C4h] [ebp-3E4h] BYREF
  CEvn_Event v54; // [esp+2DCh] [ebp-3CCh] BYREF
  CEvn_Event v55; // [esp+2F4h] [ebp-3B4h] BYREF
  CEvn_Event v56; // [esp+30Ch] [ebp-39Ch] BYREF
  CEvn_Event v57; // [esp+324h] [ebp-384h] BYREF
  CEvn_Event v58; // [esp+33Ch] [ebp-36Ch] BYREF
  CEvn_Event v59; // [esp+354h] [ebp-354h] BYREF
  CEvn_Event v60; // [esp+36Ch] [ebp-33Ch] BYREF
  CEvn_Event v61; // [esp+384h] [ebp-324h] BYREF
  CEvn_Event v62; // [esp+39Ch] [ebp-30Ch] BYREF
  CEvn_Event v63; // [esp+3B4h] [ebp-2F4h] BYREF
  CEvn_Event v64; // [esp+3CCh] [ebp-2DCh] BYREF
  CEvn_Event v65; // [esp+3E4h] [ebp-2C4h] BYREF
  CEvn_Event v66; // [esp+3FCh] [ebp-2ACh] BYREF
  CEvn_Event v67; // [esp+414h] [ebp-294h] BYREF
  int v68[7]; // [esp+42Ch] [ebp-27Ch] BYREF
  int v69[7]; // [esp+448h] [ebp-260h] BYREF
  _BYTE v70[28]; // [esp+464h] [ebp-244h] BYREF
  wchar_t Dest[256]; // [esp+480h] [ebp-228h] BYREF
  char v72[12]; // [esp+680h] [ebp-28h] BYREF
  char Destination[12]; // [esp+68Ch] [ebp-1Ch] BYREF
  int v74; // [esp+6A4h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMDRandomMapParameters();
      break;
    case 1:
      if ( (unsigned __int16)a2 == 2003 )
        g_bIsPrivateSession = BYTE2(a2) & 1;
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 2:
      switch ( (unsigned __int16)a2 )
      {
        case 0x7B4u:
          PlayGuiSound(2);
          String = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, dword_4031998, 1972);
          if ( String )
          {
            byte_4031FA4 = j__strlen(String) == 0;
            dword_4031F84 = j__atoi(String);
          }
          else
          {
            dword_4031F84 = 0;
          }
          byte_3EDFB44 = 1;
          GuiDlgMDRandomMapParametersUpdate();
          PlayGuiSound(2);
          break;
        case 0x7BFu:
          PlayGuiSound(2);
          Source = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, dword_4031998, 1983);
          if ( Source )
          {
            if ( j__strlen(Source) >= 8 )
            {
              j__strcpy_0(v72, Source);
              std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v40);
              v74 = 28;
              std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::from_bytes(
                (int)v68,
                v72);
              LOBYTE(v74) = 29;
              if ( (*(unsigned __int8 (__thiscall **)(void *, int *, int *))(*(_DWORD *)g_pRandomMaps + 16))(
                     g_pRandomMaps,
                     &g_sRMP,
                     v68) )
              {
                byte_3EDFB44 = 1;
                dword_4031924 = dword_4031FA0;
                GuiDlgMDRandomMapParametersUpdate();
                PlayGuiSound(2);
              }
              else
              {
                byte_3EDFB44 = 0;
                IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2005, 0);
              }
              LOBYTE(v74) = 28;
              std::wstring::~wstring(v68);
              v74 = -1;
              std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v40);
            }
            else
            {
              byte_3EDFB44 = 0;
              IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, dword_4031998, 2005, 0);
            }
          }
          break;
        case 0x7C1u:
          PlayGuiSound(2);
          Text = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, dword_4031998, 1985);
          if ( Text )
          {
            j__mbstowcs(Dest, Text, 0x100u);
            std::wstring::operator=(&unk_4031960, Dest);
            PlayGuiSound(2);
          }
          break;
      }
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1965:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v26 = CEvn_Event::CEvn_Event(&v44, 0x1B6Du, 0, 0, 0);
          v74 = 16;
          IEventEngine::SendAMessage(g_pEvnEngine, v26);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v44);
          return 1;
        case 1966:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v25 = CEvn_Event::CEvn_Event(&v43, 0x1B6Du, 1u, 0, 0);
          v74 = 15;
          IEventEngine::SendAMessage(g_pEvnEngine, v25);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v43);
          return 1;
        case 1969:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v31 = CEvn_Event::CEvn_Event(&v47, 0x1B6Eu, 0, 0, 0);
          v74 = 20;
          IEventEngine::SendAMessage(g_pEvnEngine, v31);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v47);
          return 1;
        case 1970:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v32 = CEvn_Event::CEvn_Event(&v53, 0x1B6Eu, 1u, 0, 0);
          v74 = 19;
          IEventEngine::SendAMessage(g_pEvnEngine, v32);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v53);
          return 1;
        case 1973:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v28 = CEvn_Event::CEvn_Event(&v50, 0x1B71u, 0, 0, 0);
          v74 = 23;
          IEventEngine::SendAMessage(g_pEvnEngine, v28);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v50);
          return 1;
        case 1976:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v16 = CEvn_Event::CEvn_Event(&v45, 0x1B6Fu, 1u, 0, 0);
          v74 = 17;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v45);
          return 1;
        case 1977:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v33 = CEvn_Event::CEvn_Event(&v46, 0x1B6Fu, 0, 0, 0);
          v74 = 18;
          IEventEngine::SendAMessage(g_pEvnEngine, v33);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v46);
          return 1;
        case 1980:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v29 = CEvn_Event::CEvn_Event(&v49, 0x1B70u, 0, 0, 0);
          v74 = 22;
          IEventEngine::SendAMessage(g_pEvnEngine, v29);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v49);
          return 1;
        case 1981:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v30 = CEvn_Event::CEvn_Event(&v48, 0x1B70u, 1u, 0, 0);
          v74 = 21;
          IEventEngine::SendAMessage(g_pEvnEngine, v30);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v48);
          return 1;
        case 1988:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v19 = CEvn_Event::CEvn_Event(&v62, 0x45u, 0, 0, 0);
          v74 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v19);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v62);
          return 1;
        case 1989:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v18 = CEvn_Event::CEvn_Event(&v61, 0x45u, 1u, 0, 0);
          v74 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v61);
          return 1;
        case 1992:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v60, 0x44u, 0, 0, 0);
          v74 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v60);
          return 1;
        case 1993:
          byte_3EDFB44 = 1;
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v59, 0x44u, 1u, 0, 0);
          v74 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v59);
          return 1;
        case 1998:
          PlayGuiSound(2);
          v17 = CEvn_Event::CEvn_Event(&v56, 0x43u, 0, 0, 0);
          v74 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v56);
          return 1;
        case 1999:
          PlayGuiSound(2);
          v15 = CEvn_Event::CEvn_Event(&v58, 0x43u, 1u, 0, 0);
          v74 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v58);
          return 1;
        case 2001:
          PlayGuiSound(2);
          v21 = CEvn_Event::CEvn_Event(&v52, 0x46u, 0, 0, 0);
          v74 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v21);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v52);
          return 1;
        case 2002:
          PlayGuiSound(2);
          v20 = CEvn_Event::CEvn_Event(&v63, 0x46u, 1u, 0, 0);
          v74 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v20);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v63);
          return 1;
        case 2004:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v57, 0x1B6Au, 0, 0, 0);
          v74 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v57);
          return 1;
        case 2005:
          Instance = OnlineManager::GetInstance();
          if ( (unsigned __int8)OnlineManager::IsQuickMatchFlow(Instance) )
            v39 = 0;
          else
            v39 = g_bIsPrivateSession;
          v7 = (OnlineManager *)OnlineManager::GetInstance();
          OnlineManager::SetPrivate(v7, v39);
          byte_403199C = g_uiExtrasAllowed;
          if ( g_uiExtrasAllowed && byte_4031914 )
          {
            v11 = std::operator+<wchar_t>((int)v42, (wchar_t *)L"(Troja) ", (int)&unk_4031960);
            std::wstring::operator=(v11);
            std::wstring::~wstring(v42);
          }
          if ( (unsigned int)std::wstring::length(&unk_4031960) >= 0x1F )
            std::wstring::resize(32, 0);
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v67, 0x1B6Bu, 0, 0, 0);
          v74 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v67);
          return 1;
        case 2006:
          PlayGuiSound(2);
          byte_3EDFB45 = 1;
          if ( byte_3EDFB44 )
          {
            (**(void (__thiscall ***)(void *, int *))g_pRandomMaps)(g_pRandomMaps, &g_sRMP);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2022, 1);
            v27 = CEvn_Event::CEvn_Event(&v51, 0x1B74u, 0, 0, 0);
            v74 = 27;
            IEventEngine::SendAMessage(g_pEvnEngine, v27);
            v74 = -1;
            CEvn_Event::~CEvn_Event(&v51);
          }
          else
          {
            byte_3EDFB45 = 0;
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, dword_4031998, 2022, 0);
            IGuiEngine::SetImages((void *)g_pGUIEngine, dword_4031998, 2006, 31, 30);
          }
          return 1;
        case 2017:
          PlayGuiSound(2);
          v22 = CEvn_Event::CEvn_Event(&v64, 0x1B6Cu, 0, 0, 0);
          v74 = 12;
          IEventEngine::SendAMessage(g_pEvnEngine, v22);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v64);
          return 1;
        case 2018:
          PlayGuiSound(2);
          v23 = CEvn_Event::CEvn_Event(&v65, 0x1B6Cu, 1u, 0, 0);
          v74 = 13;
          IEventEngine::SendAMessage(g_pEvnEngine, v23);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v65);
          return 1;
        case 2019:
          PlayGuiSound(2);
          v24 = CEvn_Event::CEvn_Event(&v66, 0x1B6Cu, 2u, 0, 0);
          v74 = 14;
          IEventEngine::SendAMessage(g_pEvnEngine, v24);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v66);
          return 1;
        case 2020:
          PlayGuiSound(2);
          v8 = IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, dword_4031998, 1983);
          (*(void (__thiscall **)(void *, const char *))(*(_DWORD *)g_pClipboard + 4))(g_pClipboard, v8);
          return 1;
        case 2021:
          PlayGuiSound(2);
          std::string::string();
          v74 = 24;
          (*(void (__thiscall **)(void *, _BYTE *, int))(*(_DWORD *)g_pClipboard + 8))(g_pClipboard, v70, 8);
          Str = (char *)std::string::c_str(v70);
          if ( !Str )
            goto LABEL_76;
          if ( j__strlen(Str) >= 8 )
          {
            j__strcpy_0(Destination, Str);
            std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v41);
            LOBYTE(v74) = 25;
            std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::from_bytes(
              (int)v69,
              Destination);
            LOBYTE(v74) = 26;
            if ( (*(unsigned __int8 (__thiscall **)(void *, int *, int *))(*(_DWORD *)g_pRandomMaps + 16))(
                   g_pRandomMaps,
                   &g_sRMP,
                   v69) )
            {
              byte_3EDFB44 = 1;
              dword_4031924 = dword_4031FA0;
              GuiDlgMDRandomMapParametersUpdate();
              PlayGuiSound(2);
              LOBYTE(v74) = 25;
              std::wstring::~wstring(v69);
              LOBYTE(v74) = 24;
              std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v41);
LABEL_76:
              v74 = -1;
              std::string::~string(v70);
            }
            else
            {
              byte_3EDFB44 = 0;
              LOBYTE(v74) = 25;
              std::wstring::~wstring(v69);
              LOBYTE(v74) = 24;
              std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v41);
              v74 = -1;
              std::string::~string(v70);
            }
          }
          else
          {
            byte_3EDFB44 = 0;
            v74 = -1;
            std::string::~string(v70);
          }
          break;
        case 2023:
          if ( !g_pAddOn && BBSupportDbgReport(2, "gui\\GUI_MD_RandomMapParameters.cpp", 1024, "g_pAddOn") == 1 )
            __debugbreak();
          if ( !g_pMissionCD2
            && BBSupportDbgReport(2, "gui\\GUI_MD_RandomMapParameters.cpp", 1025, "g_pMissionCD2") == 1 )
          {
            __debugbreak();
          }
          if ( !g_pAddOn && !g_pMissionCD2
            || !(*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pAddOn + 4))(g_pAddOn)
            && !(*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
          {
            return 1;
          }
          if ( (a2 & 0x10000) != 0 )
            g_uiExtrasAllowed |= 1u;
          else
            g_uiExtrasAllowed &= ~1u;
          v34 = CEvn_Event::CEvn_Event(&v54, 0x4Bu, (unsigned __int8)g_uiExtrasAllowed, 0, 0);
          v74 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v34);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v54);
          return 1;
        case 2025:
          if ( !g_pMissionCD2
            && BBSupportDbgReport(2, "gui\\GUI_MD_RandomMapParameters.cpp", 1044, "g_pMissionCD2") == 1 )
          {
            __debugbreak();
          }
          if ( !g_pMissionCD2 || !(*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pMissionCD2 + 4))(g_pMissionCD2) )
            return 1;
          g_bNewTextures = (a2 & 0x10000) != 0;
          v9 = CEvn_Event::CEvn_Event(&v55, 0x4Cu, (unsigned __int8)g_bNewTextures, 0, 0);
          v74 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v74 = -1;
          CEvn_Event::~CEvn_Event(&v55);
          return 1;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3694E76);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3694E77);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b8be0]
// Decompiled from void __cdecl UpdateGuiDlgMessages(struct CEvn_Event *a1)
void __cdecl UpdateGuiDlgMessages(class CEvn_Event *) {
  
  int v1; // eax
  int v2; // eax
  int lparam; // [esp+0h] [ebp-18h]
  int wparam; // [esp+8h] [ebp-10h]
  int i; // [esp+10h] [ebp-8h]

  if ( a1 )
  {
    lparam = (unsigned __int16)a1->lparam;
    switch ( a1->event )
    {
      case 0x264:
      case 0x265:
        CGuiMsgList::AddListItem(a1->lparam, (char *)a1->wparam);
        v1 = CGuiMsgList::Listcount((CGuiMsgList *)&s_cMsgLst_0);
        CGuiMsgList::SetTopindex((CGuiMsgList *)&s_cMsgLst_0, v1 - 1);
        break;
      case 0x266:
        CGuiMsgList::RemoveListItem((CGuiMsgList *)&s_cMsgLst_0, a1->wparam);
        break;
      case 0x267:
      case 0x268:
      case 0x279:
      case 0x27A:
        CGuiMsgList::Clear((CGuiMsgList *)&s_cMsgLst_0);
        wparam = a1->wparam;
        if ( wparam )
        {
          for ( i = 0; i < lparam; ++i )
            CGuiMsgList::AddListItem(*(_DWORD *)(wparam + 8 * i + 4), *(char **)(wparam + 8 * i));
          v2 = CGuiMsgList::Listcount((CGuiMsgList *)&s_cMsgLst_0);
          CGuiMsgList::SetTopindex((CGuiMsgList *)&s_cMsgLst_0, v2 - 1);
        }
        break;
      default:
        return;
    }
  }
}


// address=[0x13b8d40]
// Decompiled from char InitGuiDlgMessages()
void __cdecl InitGuiDlgMessages(void) {
  
  char result; // al
  _DWORD v1[16]; // [esp+0h] [ebp-44h] BYREF

  if ( !g_pStringEngine )
    return result;
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 969, 0);
  v1[0] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v1[1] = 958;
  v1[2] = 962;
  v1[4] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v1[5] = 959;
  v1[6] = 963;
  v1[8] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v1[9] = 960;
  v1[10] = 964;
  v1[12] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v1[13] = 961;
  v1[14] = 965;
  CGuiMsgList::SetOutputControls((CGuiMsgList *)&s_cMsgLst_0, 4, (struct CGuiMsgList::SControl *)v1);
  CGuiMsgList::SetTopindex((CGuiMsgList *)&s_cMsgLst_0, 0);
  return IGuiEngine::SetEditProperties(
           (IGuiEngine *)g_pGUIEngine,
           *(_DWORD *)(g_pGuiMainEvents + 40),
           969,
           0x60u,
           0x7Fu);
}


// address=[0x13b8ea0]
// Decompiled from char OpenChatentry()
bool __cdecl OpenChatentry(void) {
  
  int Topindex; // eax
  _DWORD v2[12]; // [esp+0h] [ebp-34h] BYREF

  v2[0] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v2[1] = 958;
  v2[2] = 962;
  v2[4] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v2[5] = 959;
  v2[6] = 963;
  v2[8] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v2[9] = 960;
  v2[10] = 964;
  CGuiMsgList::SetOutputControls((CGuiMsgList *)&s_cMsgLst_0, 3, (struct CGuiMsgList::SControl *)v2);
  Topindex = CGuiMsgList::GetTopindex((CGuiMsgList *)&s_cMsgLst_0);
  CGuiMsgList::SetTopindex((CGuiMsgList *)&s_cMsgLst_0, Topindex);
  IGuiEngine::RenderGui((IGuiEngine *)g_pGUIEngine);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 969, 1);
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 969, 1);
  return 1;
}


// address=[0x13b8fd0]
// Decompiled from char CloseChatentry()
bool __cdecl CloseChatentry(void) {
  
  int Topindex; // eax
  _DWORD v2[16]; // [esp+0h] [ebp-44h] BYREF

  IGuiEngine::SetText((void *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 969, (char *)&byte_3696DE6);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 969, 0);
  IGuiEngine::RenderGui((IGuiEngine *)g_pGUIEngine);
  v2[0] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v2[1] = 958;
  v2[2] = 962;
  v2[4] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v2[5] = 959;
  v2[6] = 963;
  v2[8] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v2[9] = 960;
  v2[10] = 964;
  v2[12] = *(_DWORD *)(g_pGuiMainEvents + 40);
  v2[13] = 961;
  v2[14] = 965;
  CGuiMsgList::SetOutputControls((CGuiMsgList *)&s_cMsgLst_0, 4, (struct CGuiMsgList::SControl *)v2);
  Topindex = CGuiMsgList::GetTopindex((CGuiMsgList *)&s_cMsgLst_0);
  CGuiMsgList::SetTopindex((CGuiMsgList *)&s_cMsgLst_0, Topindex);
  return 1;
}


// address=[0x13b9130]
// Decompiled from char __cdecl HighlightEntryDlgMessages(int a1, bool a2)
void __cdecl HighlightEntryDlgMessages(int a1, bool a2) {
  
  int v2; // eax
  int v4; // [esp+4h] [ebp-8h]
  int ListindexFromControlindex; // [esp+8h] [ebp-4h]

  ListindexFromControlindex = 0;
  if ( a2 )
    v4 = 10;
  else
    v4 = 9;
  switch ( a1 )
  {
    case 958:
      ListindexFromControlindex = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 0);
      break;
    case 959:
      ListindexFromControlindex = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 1);
      break;
    case 960:
      ListindexFromControlindex = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 2);
      break;
    case 961:
      ListindexFromControlindex = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 3);
      break;
    default:
      break;
  }
  if ( CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 0) == ListindexFromControlindex )
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 958, v4);
  if ( CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 1) == ListindexFromControlindex )
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 959, v4);
  if ( CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 2) == ListindexFromControlindex )
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 960, v4);
  v2 = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 3);
  if ( v2 == ListindexFromControlindex )
    LOBYTE(v2) = IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 961, v4);
  return v2;
}


// address=[0x13b9290]
// Decompiled from char __cdecl GuiDlgMessagesProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgMessagesProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int Topindex; // eax
  char *Text; // eax
  CEvn_Event *v12; // [esp+4h] [ebp-110h]
  CEvn_Event *v13; // [esp+Ch] [ebp-108h]
  CEvn_Event *v14; // [esp+14h] [ebp-100h]
  unsigned int v15; // [esp+1Ch] [ebp-F8h]
  CEvn_Event *v16; // [esp+20h] [ebp-F4h]
  unsigned int v17; // [esp+28h] [ebp-ECh]
  CEvn_Event *v18; // [esp+2Ch] [ebp-E8h]
  unsigned int v19; // [esp+34h] [ebp-E0h]
  CEvn_Event *v20; // [esp+38h] [ebp-DCh]
  unsigned int ListindexFromControlindex; // [esp+40h] [ebp-D4h]
  unsigned int v22; // [esp+44h] [ebp-D0h]
  unsigned int v23; // [esp+48h] [ebp-CCh]
  __int16 v24; // [esp+54h] [ebp-C0h]
  CEvn_Event v25; // [esp+58h] [ebp-BCh] BYREF
  CEvn_Event v26; // [esp+70h] [ebp-A4h] BYREF
  CEvn_Event v27; // [esp+88h] [ebp-8Ch] BYREF
  CEvn_Event v28; // [esp+A0h] [ebp-74h] BYREF
  CEvn_Event v29; // [esp+B8h] [ebp-5Ch] BYREF
  CEvn_Event v30; // [esp+D0h] [ebp-44h] BYREF
  _BYTE v31[28]; // [esp+E8h] [ebp-2Ch] BYREF
  int v32; // [esp+110h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMessages();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      break;
    case 2:
      if ( S4LoWord(a2) == 969 )
        PlayGuiSound(1);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0x3BEu:
          ListindexFromControlindex = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 0);
          v20 = CEvn_Event::CEvn_Event(&v30, 0x1771u, ListindexFromControlindex, 0, 0);
          v32 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v20);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v30);
          PlayGuiSound(0);
          break;
        case 0x3BFu:
          v19 = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 1);
          v18 = CEvn_Event::CEvn_Event(&v29, 0x1771u, v19, 0, 0);
          v32 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v29);
          PlayGuiSound(0);
          break;
        case 0x3C0u:
          v17 = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 2);
          v16 = CEvn_Event::CEvn_Event(&v28, 0x1771u, v17, 0, 0);
          v32 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v28);
          PlayGuiSound(0);
          break;
        case 0x3C1u:
          v15 = CGuiMsgList::GetListindexFromControlindex((CGuiMsgList *)&s_cMsgLst_0, 3);
          v14 = CEvn_Event::CEvn_Event(&v27, 0x1771u, v15, 0, 0);
          v32 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v27);
          PlayGuiSound(0);
          break;
        case 0x3C6u:
          goto LABEL_15;
        case 0x3C7u:
          Topindex = CGuiMsgList::GetTopindex((CGuiMsgList *)&s_cMsgLst_0);
          CGuiMsgList::SetTopindex((CGuiMsgList *)&s_cMsgLst_0, Topindex + 1);
          PlayGuiSound(2);
          break;
        case 0x3C8u:
          v13 = CEvn_Event::CEvn_Event(&v26, 0x26Au, 0, 0, 0);
          v32 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v32 = -1;
          CEvn_Event::~CEvn_Event(&v26);
          PlayGuiSound(2);
          break;
        case 0x3C9u:
          Text = (char *)IGuiEngine::GetText((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 969);
          String::String(Text, -1);
          v32 = 5;
          if ( (unsigned __int8)operator!=(v31, &unk_3696DEB) )
          {
            v12 = CEvn_Event::CEvn_Event(&v25, 0x26u, (unsigned int)v31, 0, 0);
            LOBYTE(v32) = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            LOBYTE(v32) = 5;
            CEvn_Event::~CEvn_Event(&v25);
          }
          v32 = -1;
          String::~String((String *)v31);
          CloseChatentry();
          PlayGuiSound(1);
          break;
        default:
          return 1;
      }
      break;
    case 4:
      if ( S4LoWord(a2) == 969 )
      {
        CloseChatentry();
        PlayGuiSound(0);
      }
      break;
    case 5:
      v23 = S4LoWord(a2);
      if ( v23 >= 0x3BE && v23 <= 0x3C1 )
      {
        v8 = S4LoWord(a2);
        HighlightEntryDlgMessages(v8, 1);
      }
      break;
    case 6:
      v22 = S4LoWord(a2);
      if ( v22 >= 0x3BE && v22 <= 0x3C1 )
      {
        v9 = S4LoWord(a2);
        HighlightEntryDlgMessages(v9, 0);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3696DE7);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3696DEA);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      v24 = S4HiWord(a2);
      HighlightEntryDlgMessages(958, 0);
      HighlightEntryDlgMessages(959, 0);
      HighlightEntryDlgMessages(960, 0);
      HighlightEntryDlgMessages(961, 0);
      if ( v24 <= 0 )
      {
        if ( v24 < 0 )
        {
          v7 = CGuiMsgList::GetTopindex((CGuiMsgList *)&s_cMsgLst_0);
          CGuiMsgList::SetTopindex((CGuiMsgList *)&s_cMsgLst_0, v7 + 1);
          PlayGuiSound(2);
        }
      }
      else
      {
LABEL_15:
        v6 = CGuiMsgList::GetTopindex((CGuiMsgList *)&s_cMsgLst_0);
        CGuiMsgList::SetTopindex((CGuiMsgList *)&s_cMsgLst_0, v6 - 1);
        PlayGuiSound(2);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13b9e90]
// Decompiled from int __cdecl operator!=(int a1, char *a2)
bool __cdecl operator!=(class String const & a1, char const * a2) {
  
  if ( a2 )
    return std::operator!=<char>(a1, a2);
  else
    return std::operator!=<char>(a1, (char *)&off_366DCF4);
}


// address=[0x13b9f30]
// Decompiled from void UpdateGuiDlgMilitaryBuildingContext()
void __cdecl UpdateGuiDlgMilitaryBuildingContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int i; // [esp+Ch] [ebp-3Ch]
  CHAR Str[52]; // [esp+10h] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3EFD430 = 1;
    GuiHouseImageID = GetGuiHouseImageID(dword_3EFD434, byte_3F1E538, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 16, 976, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(dword_3EFD434, byte_3F1E538);
    IGuiEngine::SetText((void *)g_pGUIEngine, 16, 973, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E540);
    IGuiEngine::SetText((void *)g_pGUIEngine, 16, 974, Str);
    if ( byte_3F1E53F <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, 975, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E53F);
      IGuiEngine::SetText((void *)g_pGUIEngine, 16, 975, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, 975, 1);
    }
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 16, 972, byte_3F1E53C == 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, 972, byte_3F1E53B);
    for ( i = 0; i < 10; ++i )
    {
      if ( byte_3F1E544[2 * i] == -2 )
      {
        IGuiEngine::SetImages((void *)g_pGUIEngine, 16, dword_36971D8[2 * i], 158, 0);
        IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 16, dword_36971D8[2 * i + 1], byte_3F1E545[2 * i]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_36971D8[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_36971D8[2 * i + 1], 0);
      }
      else if ( byte_3F1E544[2 * i] == -1 )
      {
        IGuiEngine::SetImages((void *)g_pGUIEngine, 16, dword_36971D8[2 * i], 159, 0);
        IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 16, dword_36971D8[2 * i + 1], byte_3F1E545[2 * i]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_36971D8[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_36971D8[2 * i + 1], 0);
      }
      else if ( byte_3F1E544[2 * i] <= 0 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_36971D8[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_36971D8[2 * i + 1], 0);
      }
      else
      {
        switch ( byte_3F1E544[2 * i] )
        {
          case 29:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 1],
              dword_3696DF0[50 * dword_3EFD434 + 2]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 3],
              dword_3696DF0[50 * dword_3EFD434 + 4]);
            break;
          case 30:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 6],
              dword_3696DF0[50 * dword_3EFD434 + 7]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 8],
              dword_3696DF0[50 * dword_3EFD434 + 9]);
            break;
          case 31:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 11],
              dword_3696DF0[50 * dword_3EFD434 + 12]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 13],
              dword_3696DF0[50 * dword_3EFD434 + 14]);
            break;
          case 32:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 16],
              dword_3696DF0[50 * dword_3EFD434 + 17]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 18],
              dword_3696DF0[50 * dword_3EFD434 + 19]);
            break;
          case 33:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 21],
              dword_3696DF0[50 * dword_3EFD434 + 22]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 23],
              dword_3696DF0[50 * dword_3EFD434 + 24]);
            break;
          case 34:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 26],
              dword_3696DF0[50 * dword_3EFD434 + 27]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 28],
              dword_3696DF0[50 * dword_3EFD434 + 29]);
            break;
          case 38:
          case 41:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 31],
              dword_3696DF0[50 * dword_3EFD434 + 32]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 33],
              dword_3696DF0[50 * dword_3EFD434 + 34]);
            break;
          case 39:
          case 42:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 36],
              dword_3696DF0[50 * dword_3EFD434 + 37]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 38],
              dword_3696DF0[50 * dword_3EFD434 + 39]);
            break;
          case 40:
          case 43:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 41],
              dword_3696DF0[50 * dword_3EFD434 + 42]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 43],
              dword_3696DF0[50 * dword_3EFD434 + 44]);
            break;
          case 44:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 46],
              dword_3696DF0[50 * dword_3EFD434 + 47]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_36971D8[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 48],
              dword_3696DF0[50 * dword_3EFD434 + 49]);
            break;
          default:
            break;
        }
        IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 16, dword_36971D8[2 * i + 1], byte_3F1E545[2 * i]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_36971D8[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_36971D8[2 * i + 1], 1);
      }
      if ( byte_3F1E558[2 * i] == -2 )
      {
        IGuiEngine::SetImages((void *)g_pGUIEngine, 16, dword_3697228[2 * i], 158, 0);
        IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 16, dword_3697228[2 * i + 1], byte_3F1E559[2 * i]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_3697228[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_3697228[2 * i + 1], 0);
      }
      else if ( byte_3F1E558[2 * i] == -1 )
      {
        IGuiEngine::SetImages((void *)g_pGUIEngine, 16, dword_3697228[2 * i], 159, 0);
        IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 16, dword_3697228[2 * i + 1], byte_3F1E559[2 * i]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_3697228[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_3697228[2 * i + 1], 0);
      }
      else if ( byte_3F1E558[2 * i] <= 0 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_3697228[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_3697228[2 * i + 1], 0);
      }
      else
      {
        switch ( byte_3F1E558[2 * i] )
        {
          case 29:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 1],
              dword_3696DF0[50 * dword_3EFD434 + 2]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 3],
              dword_3696DF0[50 * dword_3EFD434 + 4]);
            break;
          case 30:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 6],
              dword_3696DF0[50 * dword_3EFD434 + 7]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 8],
              dword_3696DF0[50 * dword_3EFD434 + 9]);
            break;
          case 31:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 11],
              dword_3696DF0[50 * dword_3EFD434 + 12]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 13],
              dword_3696DF0[50 * dword_3EFD434 + 14]);
            break;
          case 32:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 16],
              dword_3696DF0[50 * dword_3EFD434 + 17]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 18],
              dword_3696DF0[50 * dword_3EFD434 + 19]);
            break;
          case 33:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 21],
              dword_3696DF0[50 * dword_3EFD434 + 22]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 23],
              dword_3696DF0[50 * dword_3EFD434 + 24]);
            break;
          case 34:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 26],
              dword_3696DF0[50 * dword_3EFD434 + 27]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 28],
              dword_3696DF0[50 * dword_3EFD434 + 29]);
            break;
          case 38:
          case 41:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 31],
              dword_3696DF0[50 * dword_3EFD434 + 32]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 33],
              dword_3696DF0[50 * dword_3EFD434 + 34]);
            break;
          case 39:
          case 42:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 36],
              dword_3696DF0[50 * dword_3EFD434 + 37]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 38],
              dword_3696DF0[50 * dword_3EFD434 + 39]);
            break;
          case 40:
          case 43:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 41],
              dword_3696DF0[50 * dword_3EFD434 + 42]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 43],
              dword_3696DF0[50 * dword_3EFD434 + 44]);
            break;
          case 44:
            IGuiEngine::SetImages(
              (void *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 46],
              dword_3696DF0[50 * dword_3EFD434 + 47]);
            IGuiEngine::SetTooltipID(
              (IGuiEngine *)g_pGUIEngine,
              16,
              dword_3697228[2 * i],
              dword_3696DF0[50 * dword_3EFD434 + 48],
              dword_3696DF0[50 * dword_3EFD434 + 49]);
            break;
          default:
            break;
        }
        IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 16, dword_3697228[2 * i + 1], byte_3F1E559[2 * i]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_3697228[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 16, dword_3697228[2 * i + 1], 1);
      }
    }
    byte_3EFD430 = 0;
  }
}


// address=[0x13bb6c0]
// Decompiled from char __cdecl GuiDlgMilitaryBuildingContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgMilitaryBuildingContextProc(int a1, int a2, int a3) {
  
  int LocalPlayerId; // eax
  char *v5; // eax
  char *v6; // eax
  int v7; // [esp+0h] [ebp-42Ch]
  CEvn_Logic *v8; // [esp+4h] [ebp-428h]
  CEvn_Logic *v9; // [esp+Ch] [ebp-420h]
  CEvn_Logic *v10; // [esp+14h] [ebp-418h]
  CEvn_Logic *v11; // [esp+1Ch] [ebp-410h]
  CEvn_Logic *v12; // [esp+24h] [ebp-408h]
  CEvn_Logic *v13; // [esp+30h] [ebp-3FCh]
  CEvn_Logic *v14; // [esp+38h] [ebp-3F4h]
  CEvn_Logic *v15; // [esp+40h] [ebp-3ECh]
  CEvn_Logic *v16; // [esp+48h] [ebp-3E4h]
  CEvn_Logic *v17; // [esp+4Ch] [ebp-3E0h]
  CEvn_Logic *v18; // [esp+54h] [ebp-3D8h]
  CEvn_Logic *v19; // [esp+5Ch] [ebp-3D0h]
  CEvn_Logic *v20; // [esp+64h] [ebp-3C8h]
  CEvn_Logic *v21; // [esp+6Ch] [ebp-3C0h]
  CEvn_Logic *v22; // [esp+74h] [ebp-3B8h]
  CEvn_Logic *v23; // [esp+7Ch] [ebp-3B0h]
  CEvn_Logic *v24; // [esp+84h] [ebp-3A8h]
  CEvn_Logic *v25; // [esp+8Ch] [ebp-3A0h]
  CEvn_Logic *v26; // [esp+94h] [ebp-398h]
  CEvn_Logic *v27; // [esp+9Ch] [ebp-390h]
  CEvn_Logic *v28; // [esp+A4h] [ebp-388h]
  CEvn_Logic *v29; // [esp+ACh] [ebp-380h]
  CEvn_Logic *v30; // [esp+B4h] [ebp-378h]
  CEvn_Logic *v31; // [esp+BCh] [ebp-370h]
  CEvn_Logic *v32; // [esp+C4h] [ebp-368h]
  CEvn_Logic *v33; // [esp+CCh] [ebp-360h]
  _BYTE v34[32]; // [esp+DCh] [ebp-350h] BYREF
  _BYTE v35[32]; // [esp+FCh] [ebp-330h] BYREF
  _BYTE v36[32]; // [esp+11Ch] [ebp-310h] BYREF
  _BYTE v37[32]; // [esp+13Ch] [ebp-2F0h] BYREF
  _BYTE v38[32]; // [esp+15Ch] [ebp-2D0h] BYREF
  _BYTE v39[32]; // [esp+17Ch] [ebp-2B0h] BYREF
  _BYTE v40[32]; // [esp+19Ch] [ebp-290h] BYREF
  _BYTE v41[32]; // [esp+1BCh] [ebp-270h] BYREF
  _BYTE v42[32]; // [esp+1DCh] [ebp-250h] BYREF
  _BYTE v43[32]; // [esp+1FCh] [ebp-230h] BYREF
  _BYTE v44[32]; // [esp+21Ch] [ebp-210h] BYREF
  _BYTE v45[32]; // [esp+23Ch] [ebp-1F0h] BYREF
  _BYTE v46[32]; // [esp+25Ch] [ebp-1D0h] BYREF
  _BYTE v47[32]; // [esp+27Ch] [ebp-1B0h] BYREF
  _BYTE v48[32]; // [esp+29Ch] [ebp-190h] BYREF
  _BYTE v49[32]; // [esp+2BCh] [ebp-170h] BYREF
  _BYTE v50[32]; // [esp+2DCh] [ebp-150h] BYREF
  _BYTE v51[32]; // [esp+2FCh] [ebp-130h] BYREF
  _BYTE v52[32]; // [esp+31Ch] [ebp-110h] BYREF
  _BYTE v53[32]; // [esp+33Ch] [ebp-F0h] BYREF
  _BYTE v54[32]; // [esp+35Ch] [ebp-D0h] BYREF
  _BYTE v55[32]; // [esp+37Ch] [ebp-B0h] BYREF
  _BYTE v56[32]; // [esp+39Ch] [ebp-90h] BYREF
  _BYTE v57[32]; // [esp+3BCh] [ebp-70h] BYREF
  _BYTE v58[32]; // [esp+3DCh] [ebp-50h] BYREF
  _BYTE v59[32]; // [esp+3FCh] [ebp-30h] BYREF
  int v60; // [esp+428h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD430 = 0;
      LocalPlayerId = CPlayerManager::GetLocalPlayerId(v7);
      dword_3EFD434 = CPlayerManager::Race(LocalPlayerId);
      UpdateGuiDlgMilitaryBuildingContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 970:
          v20 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v58, 0x198u, 0, 0, 0, 0, 0);
          v60 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v20);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v58);
          PlayGuiSound(2);
          break;
        case 971:
          v19 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v57, 0x194u, 0, 0, 0, 0, 0);
          v60 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v19);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v57);
          PlayGuiSound(2);
          break;
        case 972:
          if ( (a2 & 0x10000) != 0 )
          {
            v18 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v56, 0x196u, 0, 0, 0, 0, 0);
            v60 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v18);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v56);
          }
          else
          {
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v55, 0x196u, 0, 1u, 0, 0, 0);
            v60 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v60 = -1;
            CEvn_Logic::~CEvn_Logic(v55);
          }
          PlayGuiSound(2);
          break;
        case 999:
          v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v54, 0x1BBu, 0, 0xFFFFFFFF, 0, 0, 0);
          v60 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v54);
          PlayGuiSound(2);
          break;
        case 1000:
          v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v53, 0x1BCu, 0, 0xFFFFFFFF, 0, 0, 0);
          v60 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v53);
          PlayGuiSound(2);
          break;
        case 1001:
          v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v52, 0x1BCu, 1u, 0, 0, 0, 0);
          v60 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v52);
          PlayGuiSound(2);
          break;
        case 1002:
          v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v51, 0x1BCu, 1u, 1u, 0, 0, 0);
          v60 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v51);
          PlayGuiSound(2);
          break;
        case 1003:
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v50, 0x1BCu, 1u, 2u, 0, 0, 0);
          v60 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v50);
          PlayGuiSound(2);
          break;
        case 1004:
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v49, 0x1BCu, 1u, 3u, 0, 0, 0);
          v60 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v49);
          PlayGuiSound(2);
          break;
        case 1005:
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v48, 0x1BCu, 1u, 4u, 0, 0, 0);
          v60 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v48);
          PlayGuiSound(2);
          break;
        case 1006:
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v47, 0x1BCu, 1u, 5u, 0, 0, 0);
          v60 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v47);
          PlayGuiSound(2);
          break;
        case 1007:
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v46, 0x1BCu, 1u, 6u, 0, 0, 0);
          v60 = 12;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v46);
          PlayGuiSound(2);
          break;
        case 1008:
          v33 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v45, 0x1BCu, 1u, 7u, 0, 0, 0);
          v60 = 13;
          IEventEngine::SendAMessage(g_pEvnEngine, v33);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v45);
          PlayGuiSound(2);
          break;
        case 1009:
          v32 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v44, 0x1BCu, 1u, 8u, 0, 0, 0);
          v60 = 14;
          IEventEngine::SendAMessage(g_pEvnEngine, v32);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v44);
          PlayGuiSound(2);
          break;
        case 1010:
          v31 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v59, 0x1BCu, 1u, 9u, 0, 0, 0);
          v60 = 15;
          IEventEngine::SendAMessage(g_pEvnEngine, v31);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v59);
          PlayGuiSound(2);
          break;
        case 1011:
          v30 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v43, 0x1BCu, 0, 0, 0, 0, 0);
          v60 = 16;
          IEventEngine::SendAMessage(g_pEvnEngine, v30);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v43);
          PlayGuiSound(2);
          break;
        case 1012:
          v29 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v42, 0x1BCu, 0, 1u, 0, 0, 0);
          v60 = 17;
          IEventEngine::SendAMessage(g_pEvnEngine, v29);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v42);
          PlayGuiSound(2);
          break;
        case 1013:
          v28 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v41, 0x1BCu, 0, 2u, 0, 0, 0);
          v60 = 18;
          IEventEngine::SendAMessage(g_pEvnEngine, v28);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v41);
          PlayGuiSound(2);
          break;
        case 1014:
          v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v40, 0x1BCu, 0, 3u, 0, 0, 0);
          v60 = 19;
          IEventEngine::SendAMessage(g_pEvnEngine, v27);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v40);
          PlayGuiSound(2);
          break;
        case 1015:
          v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v39, 0x1BCu, 0, 4u, 0, 0, 0);
          v60 = 20;
          IEventEngine::SendAMessage(g_pEvnEngine, v26);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v39);
          PlayGuiSound(2);
          break;
        case 1016:
          v25 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v38, 0x1BCu, 0, 5u, 0, 0, 0);
          v60 = 21;
          IEventEngine::SendAMessage(g_pEvnEngine, v25);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v38);
          PlayGuiSound(2);
          break;
        case 1017:
          v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v37, 0x1BCu, 0, 6u, 0, 0, 0);
          v60 = 22;
          IEventEngine::SendAMessage(g_pEvnEngine, v24);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v37);
          PlayGuiSound(2);
          break;
        case 1018:
          v23 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v36, 0x1BCu, 0, 7u, 0, 0, 0);
          v60 = 23;
          IEventEngine::SendAMessage(g_pEvnEngine, v23);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v36);
          PlayGuiSound(2);
          break;
        case 1019:
          v22 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v35, 0x1BCu, 0, 8u, 0, 0, 0);
          v60 = 24;
          IEventEngine::SendAMessage(g_pEvnEngine, v22);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v35);
          PlayGuiSound(2);
          break;
        case 1020:
          v21 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v34, 0x1BCu, 0, 9u, 0, 0, 0);
          v60 = 25;
          IEventEngine::SendAMessage(g_pEvnEngine, v21);
          v60 = -1;
          CEvn_Logic::~CEvn_Logic(v34);
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369727B);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v5);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3697280);
      }
      else
      {
        v6 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v6);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13bcc70]
// Decompiled from int MinimpapResetOpenDialogs()
void __cdecl MinimpapResetOpenDialogs(void) {
  
  int result; // eax

  result = g_pGuiMainEvents;
  if ( *(_DWORD *)(g_pGuiMainEvents + 24) == -1 )
    return result;
  IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 24));
  result = g_pGuiMainEvents;
  *(_DWORD *)(g_pGuiMainEvents + 24) = -1;
  return result;
}


// address=[0x13bccb0]
// Decompiled from int __cdecl UpdateGuiDlgMinimap(int a1)
void __cdecl UpdateGuiDlgMinimap(int a1) {
  
  int result; // eax

  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 614, (a1 & 1) != 0);
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 616, (a1 & 2) != 0);
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 615, (a1 & 4) != 0);
  LOBYTE(result) = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 617, (a1 & 8) != 0);
  dword_3EFD43C = a1;
  return result;
}


// address=[0x13bcd70]
// Decompiled from void InitGuiDlgMinimap()
void __cdecl InitGuiDlgMinimap(void) {
  
  ;
}


// address=[0x13bcd80]
// Decompiled from char __cdecl GuiDlgMinimapProc(int a1, unsigned int a2, unsigned int a3)
bool __cdecl GuiDlgMinimapProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+8h] [ebp-35Ch]
  CEvn_Logic *v7; // [esp+10h] [ebp-354h]
  CEvn_Event *v8; // [esp+18h] [ebp-34Ch]
  CEvn_Logic *v9; // [esp+20h] [ebp-344h]
  CEvn_Logic *v10; // [esp+24h] [ebp-340h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-338h]
  CEvn_Event *v12; // [esp+34h] [ebp-330h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-328h]
  CEvn_Logic *v14; // [esp+44h] [ebp-320h]
  CEvn_Logic *v15; // [esp+48h] [ebp-31Ch]
  CEvn_Logic *v16; // [esp+50h] [ebp-314h]
  CEvn_Logic *v17; // [esp+58h] [ebp-30Ch]
  CEvn_Event *v18; // [esp+60h] [ebp-304h]
  CEvn_Event *v19; // [esp+68h] [ebp-2FCh]
  CEvn_Event *v20; // [esp+70h] [ebp-2F4h]
  CEvn_Event *v21; // [esp+78h] [ebp-2ECh]
  CEvn_Event *v22; // [esp+80h] [ebp-2E4h]
  CEvn_Event *v23; // [esp+88h] [ebp-2DCh]
  CEvn_Logic *v24; // [esp+98h] [ebp-2CCh]
  CEvn_Event *v25; // [esp+A0h] [ebp-2C4h]
  CEvn_Logic *v26; // [esp+A8h] [ebp-2BCh]
  CEvn_Logic *v27; // [esp+B0h] [ebp-2B4h]
  CEvn_Event *v28; // [esp+B8h] [ebp-2ACh]
  _BYTE v29[32]; // [esp+C4h] [ebp-2A0h] BYREF
  _BYTE v30[32]; // [esp+E4h] [ebp-280h] BYREF
  _BYTE v31[32]; // [esp+104h] [ebp-260h] BYREF
  _BYTE v32[32]; // [esp+124h] [ebp-240h] BYREF
  _BYTE v33[32]; // [esp+144h] [ebp-220h] BYREF
  _BYTE v34[32]; // [esp+164h] [ebp-200h] BYREF
  _BYTE v35[32]; // [esp+184h] [ebp-1E0h] BYREF
  _BYTE v36[32]; // [esp+1A4h] [ebp-1C0h] BYREF
  _BYTE v37[32]; // [esp+1C4h] [ebp-1A0h] BYREF
  _BYTE v38[32]; // [esp+1E4h] [ebp-180h] BYREF
  _BYTE v39[32]; // [esp+204h] [ebp-160h] BYREF
  _BYTE v40[32]; // [esp+224h] [ebp-140h] BYREF
  _BYTE v41[32]; // [esp+244h] [ebp-120h] BYREF
  _DWORD v42[6]; // [esp+264h] [ebp-100h] BYREF
  _DWORD v43[6]; // [esp+27Ch] [ebp-E8h] BYREF
  _DWORD v44[6]; // [esp+294h] [ebp-D0h] BYREF
  _DWORD v45[6]; // [esp+2ACh] [ebp-B8h] BYREF
  _DWORD v46[6]; // [esp+2C4h] [ebp-A0h] BYREF
  _DWORD v47[6]; // [esp+2DCh] [ebp-88h] BYREF
  _DWORD v48[6]; // [esp+2F4h] [ebp-70h] BYREF
  _DWORD v49[6]; // [esp+30Ch] [ebp-58h] BYREF
  _DWORD v50[6]; // [esp+324h] [ebp-40h] BYREF
  _DWORD v51[6]; // [esp+33Ch] [ebp-28h] BYREF
  int v52; // [esp+360h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD440 = 0;
      dword_3EFD43C = 0;
      InitGuiDlgMinimap();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 2:
      goto GuiDlgMinimapProc___def_17BCEDB;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0x25Eu:
          if ( *(_DWORD *)(g_pGuiMainEvents + 24) != 3 )
          {
            PlayGuiSound(1);
            v17 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v40, 0x192u, 0, 0, 0, 0, 0);
            v52 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v40);
            v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v39, 0x1CCu, 0, 0, 0, 0, 0);
            v52 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v39);
            v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v38, 0x260u, 0, 0, 0, 0, 0);
            v52 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v38);
            MinimpapResetOpenDialogs();
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 3, GuiDlgBuildSubmenuProc);
            *(_DWORD *)(g_pGuiMainEvents + 24) = 3;
          }
          break;
        case 0x25Fu:
          if ( *(_DWORD *)(g_pGuiMainEvents + 24) != 4 )
          {
            PlayGuiSound(1);
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v37, 0x192u, 0, 0, 0, 0, 0);
            v52 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v37);
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v41, 0x1CCu, 0, 0, 0, 0, 0);
            v52 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v41);
            v12 = CEvn_Event::CEvn_Event((CEvn_Event *)v51, 0x260u, 0, 0, 0);
            v52 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v51);
            MinimpapResetOpenDialogs();
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 4, GuiDlgFiguresSubmenuProc);
            *(_DWORD *)(g_pGuiMainEvents + 24) = 4;
          }
          break;
        case 0x260u:
          if ( *(_DWORD *)(g_pGuiMainEvents + 24) != 5 )
          {
            PlayGuiSound(1);
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v36, 0x192u, 0, 0, 0, 0, 0);
            v52 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v36);
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v35, 0x1CCu, 0, 0, 0, 0, 0);
            v52 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v35);
            v8 = CEvn_Event::CEvn_Event((CEvn_Event *)v50, 0x260u, 0, 0, 0);
            v52 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v50);
            MinimpapResetOpenDialogs();
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 5, GuiDlgProductionSubmenuProc);
            *(_DWORD *)(g_pGuiMainEvents + 24) = 5;
          }
          break;
        case 0x261u:
          if ( *(_DWORD *)(g_pGuiMainEvents + 24) != 6 )
          {
            PlayGuiSound(1);
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v34, 0x192u, 0, 0, 0, 0, 0);
            v52 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v34);
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v33, 0x1CCu, 0, 0, 0, 0, 0);
            v52 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v33);
            v28 = CEvn_Event::CEvn_Event((CEvn_Event *)v49, 0x260u, 0, 0, 0);
            v52 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v28);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v49);
            MinimpapResetOpenDialogs();
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 6, GuiDlgStatisticSubmenuProc);
            *(_DWORD *)(g_pGuiMainEvents + 24) = 6;
          }
          break;
        case 0x262u:
          if ( *(_DWORD *)(g_pGuiMainEvents + 24) != 7 )
          {
            PlayGuiSound(1);
            v27 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v32, 0x192u, 0, 0, 0, 0, 0);
            v52 = 12;
            IEventEngine::SendAMessage(g_pEvnEngine, v27);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v32);
            v26 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v31, 0x1CCu, 0, 0, 0, 0, 0);
            v52 = 13;
            IEventEngine::SendAMessage(g_pEvnEngine, v26);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v31);
            v25 = CEvn_Event::CEvn_Event((CEvn_Event *)v48, 0x260u, 0, 0, 0);
            v52 = 14;
            IEventEngine::SendAMessage(g_pEvnEngine, v25);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v48);
            MinimpapResetOpenDialogs();
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 7, GuiDlgOptionsSubmenuProc);
            *(_DWORD *)(g_pGuiMainEvents + 24) = 7;
          }
          break;
        case 0x263u:
          if ( *(_DWORD *)(g_pGuiMainEvents + 24) != 8 )
          {
            PlayGuiSound(1);
            v24 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v30, 0x192u, 0, 0, 0, 0, 0);
            v52 = 15;
            IEventEngine::SendAMessage(g_pEvnEngine, v24);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v30);
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v29, 0x1CCu, 0, 0, 0, 0, 0);
            v52 = 16;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v52 = -1;
            CEvn_Logic::~CEvn_Logic(v29);
            v23 = CEvn_Event::CEvn_Event((CEvn_Event *)v47, 0x260u, 0, 0, 0);
            v52 = 17;
            IEventEngine::SendAMessage(g_pEvnEngine, v23);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v47);
            MinimpapResetOpenDialogs();
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 8, GuiDlgLoadSaveSubmenuProc);
            *(_DWORD *)(g_pGuiMainEvents + 24) = 8;
          }
          break;
        case 0x266u:
          if ( !byte_3EFD440 )
          {
            if ( (S4HiWord(a2) & 1) != 0 )
              dword_3EFD43C |= 1u;
            else
              dword_3EFD43C &= ~1u;
            PlayGuiSound(2);
            v22 = CEvn_Event::CEvn_Event((CEvn_Event *)v46, 0x6Au, dword_3EFD43C, 0, 0);
            v52 = 18;
            IEventEngine::SendAMessage(g_pEvnEngine, v22);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v46);
          }
          break;
        case 0x267u:
          if ( !byte_3EFD440 )
          {
            if ( (S4HiWord(a2) & 1) != 0 )
              dword_3EFD43C |= 4u;
            else
              dword_3EFD43C &= ~4u;
            PlayGuiSound(2);
            v20 = CEvn_Event::CEvn_Event((CEvn_Event *)v44, 0x6Au, dword_3EFD43C, 0, 0);
            v52 = 20;
            IEventEngine::SendAMessage(g_pEvnEngine, v20);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v44);
          }
          break;
        case 0x268u:
          if ( !byte_3EFD440 )
          {
            if ( (S4HiWord(a2) & 1) != 0 )
              dword_3EFD43C |= 2u;
            else
              dword_3EFD43C &= ~2u;
            PlayGuiSound(2);
            v21 = CEvn_Event::CEvn_Event((CEvn_Event *)v45, 0x6Au, dword_3EFD43C, 0, 0);
            v52 = 19;
            IEventEngine::SendAMessage(g_pEvnEngine, v21);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v45);
          }
          break;
        case 0x269u:
          if ( !byte_3EFD440 )
          {
            if ( (S4HiWord(a2) & 1) != 0 )
              dword_3EFD43C |= 8u;
            else
              dword_3EFD43C &= ~8u;
            PlayGuiSound(2);
            v19 = CEvn_Event::CEvn_Event((CEvn_Event *)v43, 0x6Au, dword_3EFD43C, 0, 0);
            v52 = 21;
            IEventEngine::SendAMessage(g_pEvnEngine, v19);
            v52 = -1;
            CEvn_Event::~CEvn_Event(v43);
          }
          break;
        default:
          break;
      }
GuiDlgMinimapProc___def_17BCEDB:
      if ( S4LoWord(a2) == 613 )
      {
        v18 = CEvn_Event::CEvn_Event((CEvn_Event *)v42, 0x12u, 0, a3, 0);
        v52 = 22;
        IEventEngine::SendAMessage(g_pEvnEngine, v18);
        v52 = -1;
        CEvn_Event::~CEvn_Event(v42);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369736A);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_369736B);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13bdd30]
// Decompiled from void InitGuiDlgMultiplayerType()
void __cdecl InitGuiDlgMultiplayerType(void) {
  
  char *v0; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 2057);
    IGuiEngine::SetText((void *)g_pGUIEngine, 1, 2522, v0);
  }
}


// address=[0x13bdd70]
// Decompiled from char __cdecl GuiDlgMultiplayerTypeMenuProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgMultiplayerTypeMenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  CEvn_Event *v5; // [esp+4h] [ebp-78h]
  CEvn_Event *v6; // [esp+Ch] [ebp-70h]
  CEvn_Event *v7; // [esp+14h] [ebp-68h]
  unsigned int v8; // [esp+20h] [ebp-5Ch]
  CEvn_Event v9; // [esp+24h] [ebp-58h] BYREF
  CEvn_Event v10; // [esp+3Ch] [ebp-40h] BYREF
  CEvn_Event v11; // [esp+54h] [ebp-28h] BYREF
  int v12; // [esp+78h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgMultiplayerType();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      PlayGuiSound(2);
      v8 = S4LoWord(a2);
      switch ( v8 )
      {
        case 0x9D8u:
          v7 = CEvn_Event::CEvn_Event(&v11, 0x34u, 0, 0, 0);
          v12 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v12 = -1;
          CEvn_Event::~CEvn_Event(&v11);
          break;
        case 0x9D9u:
          v6 = CEvn_Event::CEvn_Event(&v10, 0x35u, 0, 0, 0);
          v12 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v12 = -1;
          CEvn_Event::~CEvn_Event(&v10);
          break;
        case 0x9DBu:
          v5 = CEvn_Event::CEvn_Event(&v9, 0x36u, 0, 0, 0);
          v12 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v5);
          v12 = -1;
          CEvn_Event::~CEvn_Event(&v9);
          break;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)byte_369736C);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13be010]
// Decompiled from char __cdecl GuiDlgOptionsSubmenuProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgOptionsSubmenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-138h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-130h]
  CEvn_Event *v8; // [esp+14h] [ebp-128h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-120h]
  CEvn_Event *v10; // [esp+24h] [ebp-118h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-110h]
  CEvn_Event *v12; // [esp+34h] [ebp-108h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-100h]
  _BYTE v14[32]; // [esp+4Ch] [ebp-F0h] BYREF
  _BYTE v15[32]; // [esp+6Ch] [ebp-D0h] BYREF
  _BYTE v16[32]; // [esp+8Ch] [ebp-B0h] BYREF
  _BYTE v17[32]; // [esp+ACh] [ebp-90h] BYREF
  CEvn_Event v18; // [esp+CCh] [ebp-70h] BYREF
  CEvn_Event v19; // [esp+E4h] [ebp-58h] BYREF
  CEvn_Event v20; // [esp+FCh] [ebp-40h] BYREF
  CEvn_Event v21; // [esp+114h] [ebp-28h] BYREF
  int v22; // [esp+138h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 7, 1021, 1);
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0x3FDu:
          PlayGuiSound(2);
          if ( !g_pEvnEngine && BBSupportDbgReport(2, "gui\\GUI_OptionsSubmenu.cpp", 137, "g_pEvnEngine!= NULL") == 1 )
            __debugbreak();
          if ( g_pEvnEngine )
          {
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x192u, 0, 0, 0, 0, 0);
            v22 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
            v12 = CEvn_Event::CEvn_Event(&v21, 0x1Au, 0, 0, 0);
            v22 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v22 = -1;
            CEvn_Event::~CEvn_Event(&v21);
          }
          break;
        case 0x3FEu:
          PlayGuiSound(2);
          if ( !g_pEvnEngine && BBSupportDbgReport(2, "gui\\GUI_OptionsSubmenu.cpp", 150, "g_pEvnEngine!= NULL") == 1 )
            __debugbreak();
          if ( g_pEvnEngine )
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x192u, 0, 0, 0, 0, 0);
            v22 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v16);
            v10 = CEvn_Event::CEvn_Event(&v20, 0x1Bu, 0, 0, 0);
            v22 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v22 = -1;
            CEvn_Event::~CEvn_Event(&v20);
          }
          break;
        case 0x3FFu:
          PlayGuiSound(2);
          if ( !g_pEvnEngine && BBSupportDbgReport(2, "gui\\GUI_OptionsSubmenu.cpp", 162, "g_pEvnEngine!= NULL") == 1 )
            __debugbreak();
          if ( g_pEvnEngine )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x192u, 0, 0, 0, 0, 0);
            v22 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v15);
            v8 = CEvn_Event::CEvn_Event(&v19, 0x1Cu, 0, 0, 0);
            v22 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v22 = -1;
            CEvn_Event::~CEvn_Event(&v19);
          }
          break;
        case 0x400u:
          PlayGuiSound(2);
          if ( !g_pEvnEngine && BBSupportDbgReport(2, "gui\\GUI_OptionsSubmenu.cpp", 175, "g_pEvnEngine!= NULL") == 1 )
            __debugbreak();
          if ( g_pEvnEngine )
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x192u, 0, 0, 0, 0, 0);
            v22 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v14);
            v6 = CEvn_Event::CEvn_Event(&v18, 0x1Du, 0, 0, 0);
            v22 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v22 = -1;
            CEvn_Event::~CEvn_Event(&v18);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3697370);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3697371);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13be6b0]
// Decompiled from void UpdateGuiDlgPortContext()
void __cdecl UpdateGuiDlgPortContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int v2; // eax
  int GuiGoodImageID; // eax
  int v4; // [esp+4h] [ebp-44h]
  int i; // [esp+Ch] [ebp-3Ch]
  CHAR Str[52]; // [esp+10h] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3EFD442 = 1;
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E575, byte_3F1E574, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 17, 1033, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E575, byte_3F1E574);
    IGuiEngine::SetText((void *)g_pGUIEngine, 17, 1028, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E57C);
    IGuiEngine::SetText((void *)g_pGUIEngine, 17, 1029, Str);
    if ( byte_3F1E57B <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, 1030, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E57B);
      IGuiEngine::SetText((void *)g_pGUIEngine, 17, 1030, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, 1030, 1);
    }
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 17, 1027, byte_3F1E578 == 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, 1027, byte_3F1E577);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, 1034, byte_3F1E576);
    for ( i = 0; i < 15; ++i )
    {
      v4 = byte_3F1E580[2 * i];
      if ( v4 <= 0 || v4 >= 43 || byte_3F1E581[2 * i] <= 0 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, dword_36977D0[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, dword_36977D0[2 * i + 1], 0);
      }
      else
      {
        v2 = j__abs(byte_3F1E581[2 * i]);
        _wsprintfA(Str, "%u", v2);
        IGuiEngine::SetText((void *)g_pGUIEngine, 17, dword_36977D0[2 * i], Str);
        GuiGoodImageID = GetGuiGoodImageID(v4);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 17, dword_36977D0[2 * i + 1], GuiGoodImageID, 0);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          17,
          dword_36977D0[2 * i + 1],
          dword_3697470[5 * v4 + 3],
          dword_3697470[5 * v4 + 4]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, dword_36977D0[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, dword_36977D0[2 * i + 1], 1);
      }
    }
    if ( *(_DWORD *)(g_pGameType + 692) == 1 || *(_DWORD *)(g_pGameType + 692) == 3 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 17, 1057, 0);
    }
    else if ( byte_3F1E574 == 32 )
    {
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 17, 1060, byte_3F1E576);
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 17, 1057, byte_3F1E576);
    }
    else
    {
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 17, 1060, 1);
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 17, 1057, 1);
    }
    byte_3EFD442 = 0;
  }
}


// address=[0x13bea80]
// Decompiled from char __cdecl GuiDlgPortContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgPortContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-1C0h]
  CEvn_Logic *v7; // [esp+8h] [ebp-1BCh]
  CEvn_Logic *v8; // [esp+10h] [ebp-1B4h]
  CEvn_Logic *v9; // [esp+18h] [ebp-1ACh]
  CEvn_Logic *v10; // [esp+20h] [ebp-1A4h]
  CEvn_Event *v11; // [esp+28h] [ebp-19Ch]
  CEvn_Logic *v12; // [esp+30h] [ebp-194h]
  CEvn_Event *v13; // [esp+38h] [ebp-18Ch]
  CEvn_Logic *v14; // [esp+40h] [ebp-184h]
  CEvn_Logic *v15; // [esp+4Ch] [ebp-178h]
  CEvn_Logic *v16; // [esp+54h] [ebp-170h]
  _BYTE v17[32]; // [esp+64h] [ebp-160h] BYREF
  _BYTE v18[32]; // [esp+84h] [ebp-140h] BYREF
  _BYTE v19[32]; // [esp+A4h] [ebp-120h] BYREF
  _BYTE v20[32]; // [esp+C4h] [ebp-100h] BYREF
  _BYTE v21[32]; // [esp+E4h] [ebp-E0h] BYREF
  _BYTE v22[32]; // [esp+104h] [ebp-C0h] BYREF
  _BYTE v23[32]; // [esp+124h] [ebp-A0h] BYREF
  _BYTE v24[32]; // [esp+144h] [ebp-80h] BYREF
  _BYTE v25[32]; // [esp+164h] [ebp-60h] BYREF
  CEvn_Event v26; // [esp+184h] [ebp-40h] BYREF
  CEvn_Event v27; // [esp+19Ch] [ebp-28h] BYREF
  int v28; // [esp+1C0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD442 = 0;
      byte_3EFD443 = 0;
      byte_3EFD444 = 0;
      UpdateGuiDlgPortContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1025:
          v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v21, 0x198u, 0, 0, 0, 0, 0);
          v28 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v21);
          PlayGuiSound(2);
          break;
        case 1026:
          v15 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v22, 0x194u, 0, 0, 0, 0, 0);
          v28 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v22);
          PlayGuiSound(2);
          break;
        case 1027:
          if ( !byte_3EFD442 )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v23, 0x196u, 0, 0, 0, 0, 0);
              v28 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v7);
              v28 = -1;
              CEvn_Logic::~CEvn_Logic(v23);
            }
            else
            {
              v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v24, 0x196u, 0, 1u, 0, 0, 0);
              v28 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v8);
              v28 = -1;
              CEvn_Logic::~CEvn_Logic(v24);
            }
            PlayGuiSound(2);
          }
          break;
        case 1057:
          if ( (a2 & 0x10000) != 0 )
          {
            if ( byte_3EFD444 )
              IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 17, 1060, 0);
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1C8u, 0, 0, 0, 0, 0);
            v28 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v28 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
            byte_3EFD443 = 1;
          }
          else
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x1CCu, 0, 0, 0, 0, 0);
            v28 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v28 = -1;
            CEvn_Logic::~CEvn_Logic(v18);
            v11 = CEvn_Event::CEvn_Event(&v26, 0x260u, 0, 0, 0);
            v28 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v26);
            byte_3EFD443 = 0;
          }
          PlayGuiSound(2);
          break;
        case 1060:
          if ( (a2 & 0x10000) != 0 )
          {
            if ( byte_3EFD443 )
              IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 17, 1057, 0);
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x1C7u, 0, 0, 0, 0, 0);
            v28 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v28 = -1;
            CEvn_Logic::~CEvn_Logic(v19);
            byte_3EFD444 = 1;
          }
          else
          {
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x1CCu, 0, 0, 0, 0, 0);
            v28 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v28 = -1;
            CEvn_Logic::~CEvn_Logic(v20);
            v13 = CEvn_Event::CEvn_Event(&v27, 0x260u, 0, 0, 0);
            v28 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v28 = -1;
            CEvn_Event::~CEvn_Event(&v27);
            byte_3EFD444 = 0;
          }
          PlayGuiSound(2);
          break;
        case 1061:
          PlayGuiSound(2);
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v25, 0x199u, 0, 0, 0, 0, 0);
          v28 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v28 = -1;
          CEvn_Logic::~CEvn_Logic(v25);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3697463);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_369746B);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13bf3c0]
// Decompiled from char __cdecl GuiDlgProductionSubmenuProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgProductionSubmenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-E0h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-D8h]
  CEvn_Logic *v8; // [esp+14h] [ebp-D0h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-C8h]
  CEvn_Logic *v10; // [esp+24h] [ebp-C0h]
  unsigned int v11; // [esp+30h] [ebp-B4h]
  _BYTE v12[32]; // [esp+34h] [ebp-B0h] BYREF
  _BYTE v13[32]; // [esp+54h] [ebp-90h] BYREF
  _BYTE v14[32]; // [esp+74h] [ebp-70h] BYREF
  _BYTE v15[32]; // [esp+94h] [ebp-50h] BYREF
  _BYTE v16[32]; // [esp+B4h] [ebp-30h] BYREF
  int v17; // [esp+E0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 5, 1069, 1);
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      v11 = S4LoWord(a2);
      switch ( v11 )
      {
        case 0x42Bu:
          PlayGuiSound(2);
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x192u, 0, 0, 0, 0, 0);
          v17 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v17 = -1;
          CEvn_Logic::~CEvn_Logic(v16);
          if ( g_pGuiMainEvents )
          {
            if ( *(_DWORD *)(g_pGuiMainEvents + 12) != -1 )
            {
              IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 12));
              *(_DWORD *)(g_pGuiMainEvents + 12) = -1;
            }
            IGuiEngine::OpenDialog(
              (IGuiEngine *)g_pGUIEngine,
              26,
              (bool (__cdecl *)(int, int, int))GuiDlgGoodDistributionProc);
            *(_DWORD *)(g_pGuiMainEvents + 12) = 26;
          }
          break;
        case 0x42Cu:
          PlayGuiSound(2);
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x192u, 0, 0, 0, 0, 0);
          v17 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v17 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1B1u, 0, 0, 0, 0, 0);
          v17 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v17 = -1;
          CEvn_Logic::~CEvn_Logic(v14);
          break;
        case 0x42Du:
          PlayGuiSound(2);
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x192u, 0, 0, 0, 0, 0);
          v17 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v17 = -1;
          CEvn_Logic::~CEvn_Logic(v13);
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x1B0u, 0, 0, 0, 0, 0);
          v17 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v17 = -1;
          CEvn_Logic::~CEvn_Logic(v12);
          break;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3697910);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3697911);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13bf880]
// Decompiled from void InitGuiDlgQuitGame()
void __cdecl InitGuiDlgQuitGame(void) {
  
  char *v0; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 1983);
    IGuiEngine::SetText((void *)g_pGUIEngine, 34, 1070, v0);
  }
}


// address=[0x13bf8c0]
// Decompiled from char __cdecl GuiDlgQuitGameProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgQuitGameProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-58h]
  CEvn_Event *v7; // [esp+Ch] [ebp-50h]
  unsigned int v8; // [esp+14h] [ebp-48h]
  CEvn_Event v9; // [esp+1Ch] [ebp-40h] BYREF
  CEvn_Event v10; // [esp+34h] [ebp-28h] BYREF
  int v11; // [esp+58h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgQuitGame();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      v8 = S4LoWord(a2);
      if ( v8 == 1071 )
      {
        PlayGuiSound(2);
        v7 = CEvn_Event::CEvn_Event(&v10, 0x17u, 0, 0, 0);
        v11 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v7);
        v11 = -1;
        CEvn_Event::~CEvn_Event(&v10);
      }
      else if ( v8 == 1072 )
      {
        PlayGuiSound(2);
        v6 = CEvn_Event::CEvn_Event(&v9, 0x25Bu, 0, 0, 0);
        v11 = 1;
        IEventEngine::SendAMessage(g_pEvnEngine, v6);
        v11 = -1;
        CEvn_Event::~CEvn_Event(&v9);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3697912);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3697913);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13bfb60]
// Decompiled from void UpdateGuiDlgResourceCollectorContext()
void __cdecl UpdateGuiDlgResourceCollectorContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int GuiGoodImageID; // eax
  CHAR Str[52]; // [esp+4h] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3EFD445 = 1;
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E4ED, byte_3F1E4EC, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 18, 1093, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E4ED, byte_3F1E4EC);
    IGuiEngine::SetText((void *)g_pGUIEngine, 18, 1087, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E4F4);
    IGuiEngine::SetText((void *)g_pGUIEngine, 18, 1088, Str);
    if ( byte_3F1E4BB <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1089, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E4F3);
      IGuiEngine::SetText((void *)g_pGUIEngine, 18, 1089, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1089, 1);
    }
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1094, byte_3F1E4EE);
    if ( byte_3F1E4F2 == -1 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1096, 0);
    }
    else
    {
      IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 18, 1096, byte_3F1E4F2);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1096, 1);
    }
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 18, 1084, byte_3F1E4F1);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 18, 1086, byte_3F1E4F0 == 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1086, byte_3F1E4EF);
    if ( byte_3F1E4F8 <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1091, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1090, 0);
    }
    else
    {
      _wsprintfA(Str, "%u", byte_3F1E4F9);
      IGuiEngine::SetText((void *)g_pGUIEngine, 18, 1091, Str);
      GuiGoodImageID = GetGuiGoodImageID(byte_3F1E4F8);
      IGuiEngine::SetImages((void *)g_pGUIEngine, 18, 1090, GuiGoodImageID, 0);
      IGuiEngine::SetTooltipID(
        (IGuiEngine *)g_pGUIEngine,
        18,
        1090,
        dword_3697918[5 * byte_3F1E4F8 + 3],
        dword_3697918[5 * byte_3F1E4F8 + 4]);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1091, 1);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 18, 1090, 1);
    }
    byte_3EFD445 = 0;
  }
}


// address=[0x13bfe50]
// Decompiled from char __cdecl GuiDlgResourceCollectorContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgResourceCollectorContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-E0h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-D8h]
  CEvn_Logic *v8; // [esp+14h] [ebp-D0h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-C8h]
  CEvn_Logic *v10; // [esp+24h] [ebp-C0h]
  _BYTE v11[32]; // [esp+34h] [ebp-B0h] BYREF
  _BYTE v12[32]; // [esp+54h] [ebp-90h] BYREF
  _BYTE v13[32]; // [esp+74h] [ebp-70h] BYREF
  _BYTE v14[32]; // [esp+94h] [ebp-50h] BYREF
  _BYTE v15[32]; // [esp+B4h] [ebp-30h] BYREF
  int v16; // [esp+E0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD445 = 0;
      UpdateGuiDlgResourceCollectorContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1083:
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x198u, 0, 0, 0, 0, 0);
          v16 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          PlayGuiSound(2);
          break;
        case 1084:
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x193u, 0, 0, 0, 0, 0);
          v16 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v14);
          PlayGuiSound(2);
          break;
        case 1085:
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x194u, 0, 0, 0, 0, 0);
          v16 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v13);
          PlayGuiSound(2);
          break;
        case 1086:
          if ( !byte_3EFD445 )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x196u, 0, 0, 0, 0, 0);
              v16 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v7);
              v16 = -1;
              CEvn_Logic::~CEvn_Logic(v12);
            }
            else
            {
              v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v11, 0x196u, 0, 1u, 0, 0, 0);
              v16 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v6);
              v16 = -1;
              CEvn_Logic::~CEvn_Logic(v11);
            }
            PlayGuiSound(2);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3697C77);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3697C7F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13c03b0]
// Decompiled from int __cdecl GetGuiHouseImageID(int a1, int a2, char a3)
unsigned int __cdecl GetGuiHouseImageID(int a1, enum BUILDING_TYPES a2, bool a3) {
  
  int result; // eax
  int v4; // [esp+0h] [ebp-3B0h]
  int v5; // [esp+4h] [ebp-3ACh]
  int v6; // [esp+8h] [ebp-3A8h]
  int v7; // [esp+Ch] [ebp-3A4h]
  int v8; // [esp+10h] [ebp-3A0h]
  int v9; // [esp+14h] [ebp-39Ch]
  int v10; // [esp+18h] [ebp-398h]
  int v11; // [esp+1Ch] [ebp-394h]
  int v12; // [esp+20h] [ebp-390h]
  int v13; // [esp+24h] [ebp-38Ch]
  int v14; // [esp+28h] [ebp-388h]
  int v15; // [esp+2Ch] [ebp-384h]
  int v16; // [esp+30h] [ebp-380h]
  int v17; // [esp+34h] [ebp-37Ch]
  int v18; // [esp+38h] [ebp-378h]
  int v19; // [esp+3Ch] [ebp-374h]
  int v20; // [esp+40h] [ebp-370h]
  int v21; // [esp+44h] [ebp-36Ch]
  int v22; // [esp+48h] [ebp-368h]
  int v23; // [esp+4Ch] [ebp-364h]
  int v24; // [esp+50h] [ebp-360h]
  int v25; // [esp+54h] [ebp-35Ch]
  int v26; // [esp+58h] [ebp-358h]
  int v27; // [esp+5Ch] [ebp-354h]
  int v28; // [esp+60h] [ebp-350h]
  int v29; // [esp+64h] [ebp-34Ch]
  int v30; // [esp+68h] [ebp-348h]
  int v31; // [esp+6Ch] [ebp-344h]
  int v32; // [esp+70h] [ebp-340h]
  int v33; // [esp+74h] [ebp-33Ch]
  int v34; // [esp+78h] [ebp-338h]
  int v35; // [esp+7Ch] [ebp-334h]
  int v36; // [esp+80h] [ebp-330h]
  int v37; // [esp+84h] [ebp-32Ch]
  int v38; // [esp+88h] [ebp-328h]
  int v39; // [esp+8Ch] [ebp-324h]
  int v40; // [esp+90h] [ebp-320h]
  int v41; // [esp+94h] [ebp-31Ch]
  int v42; // [esp+98h] [ebp-318h]
  int v43; // [esp+9Ch] [ebp-314h]
  int v44; // [esp+A0h] [ebp-310h]
  int v45; // [esp+A4h] [ebp-30Ch]
  int v46; // [esp+A8h] [ebp-308h]
  int v47; // [esp+ACh] [ebp-304h]
  int v48; // [esp+B0h] [ebp-300h]
  int v49; // [esp+B4h] [ebp-2FCh]
  int v50; // [esp+B8h] [ebp-2F8h]
  int v51; // [esp+BCh] [ebp-2F4h]
  int v52; // [esp+C0h] [ebp-2F0h]
  int v53; // [esp+C4h] [ebp-2ECh]
  int v54; // [esp+C8h] [ebp-2E8h]
  int v55; // [esp+CCh] [ebp-2E4h]
  int v56; // [esp+D0h] [ebp-2E0h]
  int v57; // [esp+D4h] [ebp-2DCh]
  int v58; // [esp+D8h] [ebp-2D8h]
  int v59; // [esp+DCh] [ebp-2D4h]
  int v60; // [esp+E0h] [ebp-2D0h]
  int v61; // [esp+E4h] [ebp-2CCh]
  int v62; // [esp+E8h] [ebp-2C8h]
  int v63; // [esp+ECh] [ebp-2C4h]
  int v64; // [esp+F0h] [ebp-2C0h]
  int v65; // [esp+F4h] [ebp-2BCh]
  int v66; // [esp+F8h] [ebp-2B8h]
  int v67; // [esp+FCh] [ebp-2B4h]
  int v68; // [esp+100h] [ebp-2B0h]
  int v69; // [esp+104h] [ebp-2ACh]
  int v70; // [esp+108h] [ebp-2A8h]
  int v71; // [esp+10Ch] [ebp-2A4h]
  int v72; // [esp+110h] [ebp-2A0h]
  int v73; // [esp+114h] [ebp-29Ch]
  int v74; // [esp+118h] [ebp-298h]
  int v75; // [esp+11Ch] [ebp-294h]
  int v76; // [esp+120h] [ebp-290h]
  int v77; // [esp+124h] [ebp-28Ch]
  int v78; // [esp+128h] [ebp-288h]
  int v79; // [esp+12Ch] [ebp-284h]
  int v80; // [esp+130h] [ebp-280h]
  int v81; // [esp+134h] [ebp-27Ch]
  int v82; // [esp+138h] [ebp-278h]
  int v83; // [esp+13Ch] [ebp-274h]
  int v84; // [esp+140h] [ebp-270h]
  int v85; // [esp+144h] [ebp-26Ch]
  int v86; // [esp+148h] [ebp-268h]
  int v87; // [esp+14Ch] [ebp-264h]
  int v88; // [esp+150h] [ebp-260h]
  int v89; // [esp+154h] [ebp-25Ch]
  int v90; // [esp+158h] [ebp-258h]
  int v91; // [esp+15Ch] [ebp-254h]
  int v92; // [esp+160h] [ebp-250h]
  int v93; // [esp+164h] [ebp-24Ch]
  int v94; // [esp+168h] [ebp-248h]
  int v95; // [esp+16Ch] [ebp-244h]
  int v96; // [esp+170h] [ebp-240h]
  int v97; // [esp+174h] [ebp-23Ch]
  int v98; // [esp+178h] [ebp-238h]
  int v99; // [esp+17Ch] [ebp-234h]
  int v100; // [esp+180h] [ebp-230h]
  int v101; // [esp+184h] [ebp-22Ch]
  int v102; // [esp+188h] [ebp-228h]
  int v103; // [esp+18Ch] [ebp-224h]
  int v104; // [esp+190h] [ebp-220h]
  int v105; // [esp+194h] [ebp-21Ch]
  int v106; // [esp+198h] [ebp-218h]
  int v107; // [esp+19Ch] [ebp-214h]
  int v108; // [esp+1A0h] [ebp-210h]
  int v109; // [esp+1A4h] [ebp-20Ch]
  int v110; // [esp+1A8h] [ebp-208h]
  int v111; // [esp+1ACh] [ebp-204h]
  int v112; // [esp+1B0h] [ebp-200h]
  int v113; // [esp+1B4h] [ebp-1FCh]
  int v114; // [esp+1B8h] [ebp-1F8h]
  int v115; // [esp+1BCh] [ebp-1F4h]
  int v116; // [esp+1C0h] [ebp-1F0h]
  int v117; // [esp+1C4h] [ebp-1ECh]
  int v118; // [esp+1C8h] [ebp-1E8h]
  int v119; // [esp+1CCh] [ebp-1E4h]
  int v120; // [esp+1D0h] [ebp-1E0h]
  int v121; // [esp+1D4h] [ebp-1DCh]
  int v122; // [esp+1D8h] [ebp-1D8h]
  int v123; // [esp+1DCh] [ebp-1D4h]
  int v124; // [esp+1E0h] [ebp-1D0h]
  int v125; // [esp+1E4h] [ebp-1CCh]
  int v126; // [esp+1E8h] [ebp-1C8h]
  int v127; // [esp+1ECh] [ebp-1C4h]
  int v128; // [esp+1F0h] [ebp-1C0h]
  int v129; // [esp+1F4h] [ebp-1BCh]
  int v130; // [esp+1F8h] [ebp-1B8h]
  int v131; // [esp+1FCh] [ebp-1B4h]
  int v132; // [esp+200h] [ebp-1B0h]
  int v133; // [esp+204h] [ebp-1ACh]
  int v134; // [esp+208h] [ebp-1A8h]
  int v135; // [esp+20Ch] [ebp-1A4h]
  int v136; // [esp+210h] [ebp-1A0h]
  int v137; // [esp+214h] [ebp-19Ch]
  int v138; // [esp+218h] [ebp-198h]
  int v139; // [esp+21Ch] [ebp-194h]
  int v140; // [esp+220h] [ebp-190h]
  int v141; // [esp+224h] [ebp-18Ch]
  int v142; // [esp+228h] [ebp-188h]
  int v143; // [esp+22Ch] [ebp-184h]
  int v144; // [esp+230h] [ebp-180h]
  int v145; // [esp+234h] [ebp-17Ch]
  int v146; // [esp+238h] [ebp-178h]
  int v147; // [esp+23Ch] [ebp-174h]
  int v148; // [esp+240h] [ebp-170h]
  int v149; // [esp+244h] [ebp-16Ch]
  int v150; // [esp+248h] [ebp-168h]
  int v151; // [esp+24Ch] [ebp-164h]
  int v152; // [esp+250h] [ebp-160h]
  int v153; // [esp+254h] [ebp-15Ch]
  int v154; // [esp+258h] [ebp-158h]
  int v155; // [esp+25Ch] [ebp-154h]
  int v156; // [esp+260h] [ebp-150h]
  int v157; // [esp+264h] [ebp-14Ch]
  int v158; // [esp+268h] [ebp-148h]
  int v159; // [esp+26Ch] [ebp-144h]
  int v160; // [esp+270h] [ebp-140h]
  int v161; // [esp+274h] [ebp-13Ch]
  int v162; // [esp+278h] [ebp-138h]
  int v163; // [esp+27Ch] [ebp-134h]
  int v164; // [esp+280h] [ebp-130h]
  int v165; // [esp+284h] [ebp-12Ch]
  int v166; // [esp+288h] [ebp-128h]
  int v167; // [esp+28Ch] [ebp-124h]
  int v168; // [esp+290h] [ebp-120h]
  int v169; // [esp+294h] [ebp-11Ch]
  int v170; // [esp+298h] [ebp-118h]
  int v171; // [esp+29Ch] [ebp-114h]
  int v172; // [esp+2A0h] [ebp-110h]
  int v173; // [esp+2A4h] [ebp-10Ch]
  int v174; // [esp+2A8h] [ebp-108h]
  int v175; // [esp+2ACh] [ebp-104h]
  int v176; // [esp+2B0h] [ebp-100h]
  int v177; // [esp+2B4h] [ebp-FCh]
  int v178; // [esp+2B8h] [ebp-F8h]
  int v179; // [esp+2BCh] [ebp-F4h]
  int v180; // [esp+2C0h] [ebp-F0h]
  int v181; // [esp+2C4h] [ebp-ECh]
  int v182; // [esp+2C8h] [ebp-E8h]
  int v183; // [esp+2CCh] [ebp-E4h]

  switch ( a2 )
  {
    case 1:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v183 = 937;
          else
            v183 = 889;
          result = v183;
          break;
        case 2:
          if ( a3 )
            v181 = 950;
          else
            v181 = 901;
          result = v181;
          break;
        case 4:
          if ( a3 )
            v182 = 929;
          else
            v182 = 928;
          result = v182;
          break;
        default:
          if ( a3 )
            v180 = 939;
          else
            v180 = 898;
          result = v180;
          break;
      }
      break;
    case 2:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v179 = 945;
          else
            v179 = 887;
          result = v179;
          break;
        case 2:
          if ( a3 )
            v177 = 959;
          else
            v177 = 903;
          result = v177;
          break;
        case 4:
          if ( a3 )
            v178 = 975;
          else
            v178 = 974;
          result = v178;
          break;
        default:
          if ( a3 )
            v176 = 937;
          else
            v176 = 890;
          result = v176;
          break;
      }
      break;
    case 3:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v175 = 930;
          else
            v175 = 893;
          result = v175;
          break;
        case 2:
          if ( a3 )
            v173 = 943;
          else
            v173 = 898;
          result = v173;
          break;
        case 4:
          if ( a3 )
            v174 = 941;
          else
            v174 = 940;
          result = v174;
          break;
        default:
          if ( a3 )
            v172 = 956;
          else
            v172 = 895;
          result = v172;
          break;
      }
      break;
    case 4:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v171 = 925;
          else
            v171 = 876;
          result = v171;
          break;
        case 2:
          if ( a3 )
            v169 = 937;
          else
            v169 = 902;
          result = v169;
          break;
        case 4:
          if ( a3 )
            v170 = 951;
          else
            v170 = 950;
          result = v170;
          break;
        default:
          if ( a3 )
            v168 = 950;
          else
            v168 = 897;
          result = v168;
          break;
      }
      break;
    case 5:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v167 = 917;
          else
            v167 = 875;
          result = v167;
          break;
        case 2:
          if ( a3 )
            v165 = 930;
          else
            v165 = 920;
          result = v165;
          break;
        case 4:
          if ( a3 )
            v166 = 967;
          else
            v166 = 966;
          result = v166;
          break;
        default:
          if ( a3 )
            v164 = 962;
          else
            v164 = 901;
          result = v164;
          break;
      }
      break;
    case 6:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v163 = 946;
          else
            v163 = 881;
          result = v163;
          break;
        case 2:
          if ( a3 )
            v161 = 960;
          else
            v161 = 891;
          result = v161;
          break;
        case 4:
          if ( a3 )
            v162 = 908;
          else
            v162 = 907;
          result = v162;
          break;
        default:
          if ( a3 )
            v160 = 936;
          else
            v160 = 889;
          result = v160;
          break;
      }
      break;
    case 7:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v159 = 940;
          else
            v159 = 888;
          result = v159;
          break;
        case 2:
          if ( a3 )
            v157 = 954;
          else
            v157 = 923;
          result = v157;
          break;
        case 4:
          if ( a3 )
            v158 = 920;
          else
            v158 = 919;
          result = v158;
          break;
        default:
          if ( a3 )
            v156 = 942;
          else
            v156 = 899;
          result = v156;
          break;
      }
      break;
    case 8:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v91 = 929;
          else
            v91 = 900;
          result = v91;
          break;
        case 2:
          if ( a3 )
            v89 = 941;
          else
            v89 = 909;
          result = v89;
          break;
        case 4:
          if ( a3 )
            v90 = 945;
          else
            v90 = 944;
          result = v90;
          break;
        default:
          if ( a3 )
            v88 = 954;
          else
            v88 = 911;
          result = v88;
          break;
      }
      break;
    case 9:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v87 = 935;
          else
            v87 = 901;
          result = v87;
          break;
        case 2:
          if ( a3 )
            v85 = 948;
          else
            v85 = 910;
          result = v85;
          break;
        case 4:
          if ( a3 )
            v86 = 931;
          else
            v86 = 930;
          result = v86;
          break;
        default:
          if ( a3 )
            v84 = 961;
          else
            v84 = 912;
          result = v84;
          break;
      }
      break;
    case 10:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v155 = 953;
          else
            v155 = 886;
          result = v155;
          break;
        case 2:
          if ( a3 )
            v153 = 967;
          else
            v153 = 896;
          result = v153;
          break;
        case 4:
          if ( a3 )
            v154 = 894;
          else
            v154 = 893;
          result = v154;
          break;
        default:
          if ( a3 )
            v152 = 929;
          else
            v152 = 883;
          result = v152;
          break;
      }
      break;
    case 11:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v151 = 947;
          else
            v151 = 882;
          result = v151;
          break;
        case 2:
          if ( a3 )
            v149 = 961;
          else
            v149 = 892;
          result = v149;
          break;
        case 4:
          if ( a3 )
            v150 = 906;
          else
            v150 = 905;
          result = v150;
          break;
        default:
          if ( a3 )
            v148 = 935;
          else
            v148 = 888;
          result = v148;
          break;
      }
      break;
    case 12:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v147 = 954;
          else
            v147 = 913;
          result = v147;
          break;
        case 2:
          if ( a3 )
            v145 = 968;
          else
            v145 = 925;
          result = v145;
          break;
        case 4:
          if ( a3 )
            v146 = 892;
          else
            v146 = 891;
          result = v146;
          break;
        default:
          if ( a3 )
            v144 = 928;
          else
            v144 = 923;
          result = v144;
          break;
      }
      break;
    case 13:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v143 = 948;
          else
            v143 = 884;
          result = v143;
          break;
        case 2:
          if ( a3 )
            v141 = 962;
          else
            v141 = 894;
          result = v141;
          break;
        case 4:
          if ( a3 )
            v142 = 904;
          else
            v142 = 903;
          result = v142;
          break;
        default:
          if ( a3 )
            v140 = 934;
          else
            v140 = 882;
          result = v140;
          break;
      }
      break;
    case 14:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v83 = 924;
          else
            v83 = 896;
          result = v83;
          break;
        case 2:
          if ( a3 )
            v81 = 936;
          else
            v81 = 905;
          result = v81;
          break;
        case 4:
          if ( a3 )
            v82 = 953;
          else
            v82 = 952;
          result = v82;
          break;
        default:
          if ( a3 )
            v80 = 949;
          else
            v80 = 907;
          result = v80;
          break;
      }
      break;
    case 15:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v139 = 939;
          else
            v139 = 906;
          result = v139;
          break;
        case 2:
          if ( a3 )
            v137 = 953;
          else
            v137 = 917;
          result = v137;
          break;
        case 4:
          if ( a3 )
            v138 = 922;
          else
            v138 = 921;
          result = v138;
          break;
        default:
          if ( a3 )
            v136 = 941;
          else
            v136 = 917;
          result = v136;
          break;
      }
      break;
    case 16:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v135 = 944;
          else
            v135 = 880;
          result = v135;
          break;
        case 2:
          if ( a3 )
            v133 = 958;
          else
            v133 = 890;
          result = v133;
          break;
        case 4:
          if ( a3 )
            v134 = 910;
          else
            v134 = 909;
          result = v134;
          break;
        default:
          if ( a3 )
            v132 = 946;
          else
            v132 = 891;
          result = v132;
          break;
      }
      break;
    case 17:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v131 = 949;
          else
            v131 = 885;
          result = v131;
          break;
        case 2:
          if ( a3 )
            v129 = 963;
          else
            v129 = 895;
          result = v129;
          break;
        case 4:
          if ( a3 )
            v130 = 902;
          else
            v130 = 901;
          result = v130;
          break;
        default:
          if ( a3 )
            v128 = 933;
          else
            v128 = 896;
          result = v128;
          break;
      }
      break;
    case 18:
      if ( a1 )
      {
        if ( a1 == 1 )
        {
          if ( a3 )
            v79 = 958;
          else
            v79 = 957;
          result = v79;
        }
        else if ( a1 == 4 )
        {
          if ( a3 )
            v78 = 957;
          else
            v78 = 956;
          result = v78;
        }
        else
        {
          if ( a3 )
            v76 = 934;
          else
            v76 = 893;
          result = v76;
        }
      }
      else
      {
        if ( a3 )
          v77 = 983;
        else
          v77 = 982;
        result = v77;
      }
      break;
    case 19:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v75 = 927;
          else
            v75 = 898;
          result = v75;
          break;
        case 2:
          if ( a3 )
            v73 = 939;
          else
            v73 = 907;
          result = v73;
          break;
        case 4:
          if ( a3 )
            v74 = 978;
          else
            v74 = 948;
          result = v74;
          break;
        default:
          if ( a3 )
            v72 = 952;
          else
            v72 = 909;
          result = v72;
          break;
      }
      break;
    case 20:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v71 = 926;
          else
            v71 = 897;
          result = v71;
          break;
        case 2:
          if ( a3 )
            v69 = 938;
          else
            v69 = 906;
          result = v69;
          break;
        case 4:
          if ( a3 )
            v70 = 949;
          else
            v70 = 979;
          result = v70;
          break;
        default:
          if ( a3 )
            v68 = 951;
          else
            v68 = 908;
          result = v68;
          break;
      }
      break;
    case 21:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v127 = 921;
          else
            v127 = 894;
          result = v127;
          break;
        case 2:
          if ( a3 )
            v125 = 932;
          else
            v125 = 922;
          result = v125;
          break;
        case 4:
          if ( a3 )
            v126 = 961;
          else
            v126 = 960;
          result = v126;
          break;
        default:
          if ( a3 )
            v124 = 947;
          else
            v124 = 905;
          result = v124;
          break;
      }
      break;
    case 22:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v123 = 956;
          else
            v123 = 874;
          result = v123;
          break;
        case 2:
          if ( a3 )
            v121 = 929;
          else
            v121 = 918;
          result = v121;
          break;
        case 4:
          if ( a3 )
            v122 = 969;
          else
            v122 = 968;
          result = v122;
          break;
        default:
          if ( a3 )
            v120 = 918;
          else
            v120 = 900;
          result = v120;
          break;
      }
      break;
    case 23:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v119 = 918;
          else
            v119 = 879;
          result = v119;
          break;
        case 2:
          if ( a3 )
            v117 = 931;
          else
            v117 = 921;
          result = v117;
          break;
        case 4:
          if ( a3 )
            v118 = 965;
          else
            v118 = 964;
          result = v118;
          break;
        default:
          if ( a3 )
            v116 = 963;
          else
            v116 = 903;
          result = v116;
          break;
      }
      break;
    case 24:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v67 = 952;
          else
            v67 = 912;
          result = v67;
          break;
        case 2:
          if ( a3 )
            v65 = 966;
          else
            v65 = 916;
          result = v65;
          break;
        case 4:
          if ( a3 )
            v66 = 896;
          else
            v66 = 895;
          result = v66;
          break;
        default:
          if ( a3 )
            v64 = 930;
          else
            v64 = 922;
          result = v64;
          break;
      }
      break;
    case 25:
      if ( a3 )
        v63 = 871;
      else
        v63 = 914;
      result = v63;
      break;
    case 26:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v62 = 920;
          else
            v62 = 883;
          result = v62;
          break;
        case 2:
          if ( a3 )
            v60 = 928;
          else
            v60 = 886;
          result = v60;
          break;
        case 4:
          if ( a3 )
            v61 = 963;
          else
            v61 = 962;
          result = v61;
          break;
        default:
          if ( a3 )
            v59 = 964;
          else
            v59 = 904;
          result = v59;
          break;
      }
      break;
    case 27:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v58 = 941;
          else
            v58 = 907;
          result = v58;
          break;
        case 2:
          if ( a3 )
            v56 = 955;
          else
            v56 = 914;
          result = v56;
          break;
        case 4:
          if ( a3 )
            v57 = 918;
          else
            v57 = 917;
          result = v57;
          break;
        default:
          if ( a3 )
            v55 = 943;
          else
            v55 = 916;
          result = v55;
          break;
      }
      break;
    case 28:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v54 = 955;
          else
            v54 = 915;
          result = v54;
          break;
        case 2:
          if ( a3 )
            v52 = 969;
          else
            v52 = 926;
          result = v52;
          break;
        case 4:
          if ( a3 )
            v53 = 890;
          else
            v53 = 889;
          result = v53;
          break;
        default:
          if ( a3 )
            v51 = 927;
          else
            v51 = 924;
          result = v51;
          break;
      }
      break;
    case 30:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v50 = 916;
          else
            v50 = 905;
          result = v50;
          break;
        case 2:
          if ( a3 )
            v48 = 952;
          else
            v48 = 913;
          result = v48;
          break;
        case 4:
          if ( a3 )
            v49 = 925;
          else
            v49 = 924;
          result = v49;
          break;
        default:
          if ( a3 )
            v47 = 887;
          else
            v47 = 915;
          result = v47;
          break;
      }
      break;
    case 31:
    case 58:
    case 59:
    case 60:
    case 61:
    case 62:
    case 63:
    case 76:
    case 77:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v115 = 919;
          else
            v115 = 877;
          result = v115;
          break;
        case 2:
          if ( a3 )
            v113 = 942;
          else
            v113 = 887;
          result = v113;
          break;
        case 4:
          if ( a3 )
            v114 = 943;
          else
            v114 = 942;
          result = v114;
          break;
        default:
          if ( a3 )
            v112 = 955;
          else
            v112 = 893;
          result = v112;
          break;
      }
      break;
    case 32:
    case 52:
    case 53:
    case 54:
    case 55:
    case 56:
    case 57:
    case 78:
    case 79:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v111 = 934;
          else
            v111 = 878;
          result = v111;
          break;
        case 2:
          if ( a3 )
            v109 = 947;
          else
            v109 = 888;
          result = v109;
          break;
        case 4:
          if ( a3 )
            v110 = 933;
          else
            v110 = 932;
          result = v110;
          break;
        default:
          if ( a3 )
            v108 = 960;
          else
            v108 = 892;
          result = v108;
          break;
      }
      break;
    case 33:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v46 = 936;
          else
            v46 = 903;
          result = v46;
          break;
        case 2:
          if ( a3 )
            v44 = 949;
          else
            v44 = 911;
          result = v44;
          break;
        case 4:
          if ( a3 )
            v45 = 977;
          else
            v45 = 976;
          result = v45;
          break;
        default:
          if ( a3 )
            v43 = 938;
          else
            v43 = 913;
          result = v43;
          break;
      }
      break;
    case 34:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v42 = 923;
          else
            v42 = 895;
          result = v42;
          break;
        case 2:
          if ( a3 )
            v40 = 935;
          else
            v40 = 904;
          result = v40;
          break;
        case 4:
          if ( a3 )
            v41 = 955;
          else
            v41 = 954;
          result = v41;
          break;
        default:
          if ( a3 )
            v39 = 948;
          else
            v39 = 906;
          result = v39;
          break;
      }
      break;
    case 35:
      if ( a3 )
        v38 = 965;
      else
        v38 = 902;
      result = v38;
      break;
    case 36:
      if ( a3 )
        v37 = 970;
      else
        v37 = 927;
      result = v37;
      break;
    case 37:
      if ( a3 )
        v36 = 933;
      else
        v36 = 889;
      result = v36;
      break;
    case 38:
      if ( a3 )
        v33 = 873;
      else
        v33 = 911;
      result = v33;
      break;
    case 39:
      if ( a3 )
        v32 = 922;
      else
        v32 = 902;
      result = v32;
      break;
    case 40:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v103 = 933;
          else
            v103 = 892;
          result = v103;
          break;
        case 2:
          if ( a3 )
            v101 = 946;
          else
            v101 = 900;
          result = v101;
          break;
        case 4:
          if ( a3 )
            v102 = 935;
          else
            v102 = 934;
          result = v102;
          break;
        default:
          if ( a3 )
            v100 = 959;
          else
            v100 = 886;
          result = v100;
          break;
      }
      break;
    case 41:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v99 = 932;
          else
            v99 = 891;
          result = v99;
          break;
        case 2:
          if ( a3 )
            v97 = 945;
          else
            v97 = 899;
          result = v97;
          break;
        case 4:
          if ( a3 )
            v98 = 937;
          else
            v98 = 936;
          result = v98;
          break;
        default:
          if ( a3 )
            v96 = 958;
          else
            v96 = 885;
          result = v96;
          break;
      }
      break;
    case 42:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v95 = 931;
          else
            v95 = 890;
          result = v95;
          break;
        case 2:
          if ( a3 )
            v93 = 944;
          else
            v93 = 897;
          result = v93;
          break;
        case 4:
          if ( a3 )
            v94 = 939;
          else
            v94 = 938;
          result = v94;
          break;
        default:
          if ( a3 )
            v92 = 957;
          else
            v92 = 884;
          result = v92;
          break;
      }
      break;
    case 43:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v31 = 928;
          else
            v31 = 899;
          result = v31;
          break;
        case 2:
          if ( a3 )
            v29 = 940;
          else
            v29 = 908;
          result = v29;
          break;
        case 4:
          if ( a3 )
            v30 = 947;
          else
            v30 = 946;
          result = v30;
          break;
        default:
          if ( a3 )
            v28 = 953;
          else
            v28 = 910;
          result = v28;
          break;
      }
      break;
    case 44:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v107 = 951;
          else
            v107 = 910;
          result = v107;
          break;
        case 2:
          if ( a3 )
            v105 = 965;
          else
            v105 = 924;
          result = v105;
          break;
        case 4:
          if ( a3 )
            v106 = 898;
          else
            v106 = 897;
          result = v106;
          break;
        default:
          if ( a3 )
            v104 = 931;
          else
            v104 = 921;
          result = v104;
          break;
      }
      break;
    case 45:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v27 = 938;
          else
            v27 = 904;
          result = v27;
          break;
        case 2:
          if ( a3 )
            v25 = 951;
          else
            v25 = 912;
          result = v25;
          break;
        case 4:
          if ( a3 )
            v26 = 927;
          else
            v26 = 926;
          result = v26;
          break;
        default:
          if ( a3 )
            v24 = 940;
          else
            v24 = 914;
          result = v24;
          break;
      }
      break;
    case 46:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v23 = 942;
          else
            v23 = 872;
          result = v23;
          break;
        case 2:
          if ( a3 )
            v21 = 956;
          else
            v21 = 884;
          result = v21;
          break;
        case 4:
          if ( a3 )
            v22 = 914;
          else
            v22 = 913;
          result = v22;
          break;
        default:
          if ( a3 )
            v20 = 944;
          else
            v20 = 894;
          result = v20;
          break;
      }
      break;
    case 47:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v19 = 943;
          else
            v19 = 908;
          result = v19;
          break;
        case 2:
          if ( a3 )
            v17 = 957;
          else
            v17 = 915;
          result = v17;
          break;
        case 4:
          if ( a3 )
            v18 = 912;
          else
            v18 = 911;
          result = v18;
          break;
        default:
          if ( a3 )
            v16 = 945;
          else
            v16 = 919;
          result = v16;
          break;
      }
      break;
    case 48:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v15 = 950;
          else
            v15 = 909;
          result = v15;
          break;
        case 2:
          if ( a3 )
            v13 = 964;
          else
            v13 = 919;
          result = v13;
          break;
        case 4:
          if ( a3 )
            v14 = 900;
          else
            v14 = 899;
          result = v14;
          break;
        default:
          if ( a3 )
            v12 = 932;
          else
            v12 = 920;
          result = v12;
          break;
      }
      break;
    case 49:
    case 50:
    case 51:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v11 = 917;
          else
            v11 = 875;
          result = v11;
          break;
        case 2:
          if ( a3 )
            v9 = 930;
          else
            v9 = 920;
          result = v9;
          break;
        case 4:
          if ( a3 )
            v10 = 967;
          else
            v10 = 966;
          result = v10;
          break;
        default:
          if ( a3 )
            v8 = 962;
          else
            v8 = 901;
          result = v8;
          break;
      }
      break;
    case 64:
      switch ( a1 )
      {
        case 1:
          result = 572;
          break;
        case 2:
          result = 572;
          break;
        case 4:
          result = 619;
          break;
        default:
          result = 572;
          break;
      }
      break;
    case 65:
      switch ( a1 )
      {
        case 1:
          result = 574;
          break;
        case 2:
          result = 574;
          break;
        case 4:
          result = 620;
          break;
        default:
          result = 574;
          break;
      }
      break;
    case 66:
      switch ( a1 )
      {
        case 1:
          result = 573;
          break;
        case 2:
          result = 573;
          break;
        case 4:
          result = 621;
          break;
        default:
          result = 573;
          break;
      }
      break;
    case 67:
      switch ( a1 )
      {
        case 1:
          result = 576;
          break;
        case 2:
          result = 576;
          break;
        case 4:
          result = 622;
          break;
        default:
          result = 576;
          break;
      }
      break;
    case 68:
      switch ( a1 )
      {
        case 1:
          result = 575;
          break;
        case 2:
          result = 575;
          break;
        case 4:
          result = 623;
          break;
        default:
          result = 575;
          break;
      }
      break;
    case 69:
      switch ( a1 )
      {
        case 1:
          result = 578;
          break;
        case 2:
          result = 578;
          break;
        case 4:
          result = 624;
          break;
        default:
          result = 578;
          break;
      }
      break;
    case 70:
      switch ( a1 )
      {
        case 1:
          result = 577;
          break;
        case 2:
          result = 577;
          break;
        case 4:
          result = 625;
          break;
        default:
          result = 577;
          break;
      }
      break;
    case 71:
      switch ( a1 )
      {
        case 1:
          result = 579;
          break;
        case 2:
          result = 579;
          break;
        case 4:
          result = 626;
          break;
        default:
          result = 579;
          break;
      }
      break;
    case 72:
      switch ( a1 )
      {
        case 1:
          result = 580;
          break;
        case 2:
          result = 580;
          break;
        case 4:
          result = 627;
          break;
        default:
          result = 580;
          break;
      }
      break;
    case 73:
      switch ( a1 )
      {
        case 1:
          result = 581;
          break;
        case 2:
          result = 581;
          break;
        case 4:
          result = 628;
          break;
        default:
          result = 581;
          break;
      }
      break;
    case 74:
      switch ( a1 )
      {
        case 1:
          result = 582;
          break;
        case 2:
          result = 582;
          break;
        case 4:
          result = 629;
          break;
        default:
          result = 582;
          break;
      }
      break;
    case 75:
      switch ( a1 )
      {
        case 1:
          result = 583;
          break;
        case 2:
          result = 583;
          break;
        case 4:
          result = 630;
          break;
        default:
          result = 583;
          break;
      }
      break;
    case 81:
      if ( a3 )
        v34 = 971;
      else
        v34 = 970;
      result = v34;
      break;
    case 82:
      if ( a3 )
        v35 = 973;
      else
        v35 = 972;
      result = v35;
      break;
    default:
      switch ( a1 )
      {
        case 1:
          if ( a3 )
            v7 = 917;
          else
            v7 = 875;
          result = v7;
          break;
        case 2:
          if ( a3 )
            v5 = 930;
          else
            v5 = 920;
          result = v5;
          break;
        case 4:
          if ( a3 )
            v6 = 967;
          else
            v6 = 966;
          result = v6;
          break;
        default:
          if ( a3 )
            v4 = 962;
          else
            v4 = 901;
          result = v4;
          break;
      }
      break;
  }
  return result;
}


// address=[0x13c2c70]
// Decompiled from int __cdecl GetGuiHouseButtonID(int a1, int a2)
unsigned int __cdecl GetGuiHouseButtonID(int a1, enum BUILDING_TYPES a2) {
  
  int result; // eax

  switch ( a2 )
  {
    case 3:
      switch ( a1 )
      {
        case 1:
          result = 789;
          break;
        case 2:
          result = 0;
          break;
        case 4:
          result = 789;
          break;
        default:
          result = 0;
          break;
      }
      break;
    case 9:
      switch ( a1 )
      {
        case 1:
          result = 854;
          break;
        case 2:
          result = 859;
          break;
        case 4:
          result = 832;
          break;
        default:
          result = 838;
          break;
      }
      break;
    case 10:
      switch ( a1 )
      {
        case 1:
          result = 863;
          break;
        case 2:
          result = 861;
          break;
        case 4:
          result = 776;
          break;
        default:
          result = 836;
          break;
      }
      break;
    case 12:
      switch ( a1 )
      {
        case 1:
          result = 864;
          break;
        case 2:
          result = 862;
          break;
        case 4:
          result = 773;
          break;
        default:
          result = 835;
          break;
      }
      break;
    case 13:
      switch ( a1 )
      {
        case 1:
          result = 862;
          break;
        case 2:
          result = 860;
          break;
        case 4:
          result = 790;
          break;
        default:
          result = 837;
          break;
      }
      break;
    case 14:
      switch ( a1 )
      {
        case 1:
          result = 869;
          break;
        case 2:
          result = 881;
          break;
        case 4:
          result = 861;
          break;
        default:
          result = 849;
          break;
      }
      break;
    case 15:
      switch ( a1 )
      {
        case 1:
          result = 829;
          break;
        case 2:
          result = 875;
          break;
        case 4:
          result = 817;
          break;
        default:
          result = 807;
          break;
      }
      break;
    case 16:
      switch ( a1 )
      {
        case 1:
          result = 836;
          break;
        case 2:
          result = 872;
          break;
        case 4:
          result = 802;
          break;
        default:
          result = 812;
          break;
      }
      break;
    case 17:
      switch ( a1 )
      {
        case 1:
          result = 839;
          break;
        case 2:
          result = 868;
          break;
        case 4:
          result = 787;
          break;
        default:
          result = 815;
          break;
      }
      break;
    case 18:
      switch ( a1 )
      {
        case 1:
          result = 865;
          break;
        case 2:
          result = 863;
          break;
        case 4:
          result = 866;
          break;
        default:
          result = 847;
          break;
      }
      break;
    case 19:
      switch ( a1 )
      {
        case 1:
          result = 857;
          break;
        case 2:
          result = 856;
          break;
        case 4:
          result = 853;
          break;
        default:
          result = 841;
          break;
      }
      break;
    case 20:
      switch ( a1 )
      {
        case 1:
          result = 858;
          break;
        case 2:
          result = 855;
          break;
        case 4:
          result = 856;
          break;
        default:
          result = 842;
          break;
      }
      break;
    case 21:
      switch ( a1 )
      {
        case 1:
          result = 859;
          break;
        case 2:
          result = 853;
          break;
        case 4:
          result = 872;
          break;
        default:
          result = 843;
          break;
      }
      break;
    case 22:
      switch ( a1 )
      {
        case 1:
          result = 860;
          break;
        case 2:
          result = 807;
          break;
        case 4:
          result = 882;
          break;
        default:
          result = 845;
          break;
      }
      break;
    case 23:
      switch ( a1 )
      {
        case 1:
          result = 870;
          break;
        case 2:
          result = 882;
          break;
        case 4:
          result = 877;
          break;
        default:
          result = 850;
          break;
      }
      break;
    case 25:
      if ( a1 == 1 )
      {
        result = 868;
      }
      else if ( a1 == 2 || a1 == 4 )
      {
        result = 0;
      }
      else
      {
        result = 0;
      }
      break;
    case 28:
      switch ( a1 )
      {
        case 1:
          result = 850;
          break;
        case 2:
          result = 865;
          break;
        case 4:
          result = 770;
          break;
        default:
          result = 822;
          break;
      }
      break;
    case 31:
    case 58:
    case 59:
    case 60:
    case 61:
    case 62:
    case 63:
    case 76:
    case 77:
      switch ( a1 )
      {
        case 1:
          result = 856;
          break;
        case 2:
          result = 857;
          break;
        case 4:
          result = 846;
          break;
        default:
          result = 840;
          break;
      }
      break;
    case 32:
    case 52:
    case 53:
    case 54:
    case 55:
    case 56:
    case 57:
    case 78:
    case 79:
      switch ( a1 )
      {
        case 1:
          result = 855;
          break;
        case 2:
          result = 858;
          break;
        case 4:
          result = 835;
          break;
        default:
          result = 839;
          break;
      }
      break;
    case 35:
      if ( a1 == 1 )
      {
        result = 844;
      }
      else if ( a1 == 2 || a1 == 4 )
      {
        result = 844;
      }
      else
      {
        result = 844;
      }
      break;
    case 36:
      result = 864;
      break;
    case 37:
      result = 785;
      break;
    case 38:
      result = 845;
      break;
    case 39:
      result = 861;
      break;
    case 81:
      result = 1025;
      break;
    case 82:
      result = 1022;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}


// address=[0x13c3310]
// Decompiled from int __cdecl GetGuiGoodImageID(int a1)
unsigned int __cdecl GetGuiGoodImageID(enum PILE_TYPES a1) {
  
  int result; // eax

  switch ( a1 )
  {
    case 1:
      result = 411;
      break;
    case 2:
      result = 410;
      break;
    case 3:
      result = 409;
      break;
    case 4:
      result = 436;
      break;
    case 5:
      result = 435;
      break;
    case 6:
      result = 433;
      break;
    case 7:
      result = 445;
      break;
    case 8:
      result = 432;
      break;
    case 9:
      result = 430;
      break;
    case 10:
      result = 420;
      break;
    case 11:
      result = 428;
      break;
    case 12:
      result = 427;
      break;
    case 13:
      result = 426;
      break;
    case 14:
      result = 444;
      break;
    case 15:
      result = 425;
      break;
    case 16:
      result = 424;
      break;
    case 17:
      result = 423;
      break;
    case 18:
      result = 443;
      break;
    case 19:
      result = 422;
      break;
    case 20:
      result = 434;
      break;
    case 21:
      result = 408;
      break;
    case 22:
      result = 442;
      break;
    case 23:
      result = 413;
      break;
    case 24:
      result = 421;
      break;
    case 25:
      result = 441;
      break;
    case 26:
      result = 419;
      break;
    case 27:
      result = 440;
      break;
    case 28:
      result = 439;
      break;
    case 29:
      result = 438;
      break;
    case 30:
      result = 418;
      break;
    case 31:
      result = 437;
      break;
    case 32:
      result = 431;
      break;
    case 33:
      result = 417;
      break;
    case 34:
      result = 414;
      break;
    case 35:
      result = 416;
      break;
    case 36:
      result = 415;
      break;
    case 37:
      result = 412;
      break;
    case 38:
      result = 533;
      break;
    case 39:
      result = 539;
      break;
    case 40:
      result = 536;
      break;
    case 41:
      result = 542;
      break;
    case 42:
      result = 545;
      break;
    default:
      result = 429;
      break;
  }
  return result;
}


// address=[0x13c3610]
// Decompiled from char *__cdecl GetGuiHouseString(int a1, int a2)
char const * __cdecl GetGuiHouseString(int a1, enum BUILDING_TYPES a2) {
  
  int v3; // [esp+38h] [ebp-4h]

  if ( !g_pStringEngine )
    return (char *)&unk_3697D2E;
  switch ( a2 )
  {
    case 1:
      v3 = 1102;
      break;
    case 2:
      v3 = 1026;
      break;
    case 3:
      v3 = 1064;
      break;
    case 4:
      v3 = 1070;
      break;
    case 5:
      v3 = 1094;
      break;
    case 6:
      v3 = 1024;
      break;
    case 7:
      v3 = 1042;
      break;
    case 8:
      v3 = 940;
      break;
    case 9:
      v3 = 1098;
      break;
    case 10:
      v3 = 934;
      break;
    case 11:
      v3 = 1034;
      break;
    case 12:
      switch ( a1 )
      {
        case 1:
          v3 = 1056;
          break;
        case 2:
          v3 = 1028;
          break;
        case 4:
          v3 = 273;
          break;
        default:
          v3 = 1066;
          break;
      }
      break;
    case 13:
      v3 = 948;
      break;
    case 14:
      v3 = 1072;
      break;
    case 15:
      v3 = 1044;
      break;
    case 16:
      v3 = 1030;
      break;
    case 17:
      v3 = 946;
      break;
    case 18:
      v3 = 1076;
      break;
    case 19:
      v3 = 1032;
      break;
    case 20:
      v3 = 1046;
      break;
    case 21:
      v3 = 1084;
      break;
    case 22:
      v3 = 1096;
      break;
    case 23:
      v3 = 1092;
      break;
    case 24:
      v3 = 936;
      break;
    case 25:
      v3 = 944;
      break;
    case 26:
      v3 = 936;
      break;
    case 27:
      v3 = 1040;
      break;
    case 28:
      if ( a1 == 2 )
      {
        v3 = 1036;
      }
      else if ( a1 == 4 )
      {
        v3 = 211;
      }
      else
      {
        v3 = 932;
      }
      break;
    case 30:
      v3 = 1048;
      break;
    case 31:
    case 58:
    case 59:
    case 60:
    case 61:
    case 62:
    case 63:
    case 76:
    case 77:
      v3 = 1068;
      break;
    case 32:
    case 52:
    case 53:
    case 54:
    case 55:
    case 56:
    case 57:
    case 78:
    case 79:
      v3 = 1038;
      break;
    case 33:
      v3 = 1052;
      break;
    case 34:
      v3 = 1074;
      break;
    case 35:
      v3 = 1100;
      break;
    case 36:
      v3 = 930;
      break;
    case 37:
      v3 = 1082;
      break;
    case 38:
      v3 = 938;
      break;
    case 39:
      v3 = 1054;
      break;
    case 40:
      v3 = 1062;
      break;
    case 41:
      v3 = 1060;
      break;
    case 42:
      v3 = 1058;
      break;
    case 43:
      v3 = 1080;
      break;
    case 44:
      v3 = 1078;
      break;
    case 45:
      v3 = 1088;
      break;
    case 46:
      v3 = 1090;
      break;
    case 47:
      v3 = 1086;
      break;
    case 48:
      v3 = 942;
      break;
    case 49:
    case 50:
    case 51:
      v3 = 3837;
      break;
    case 64:
      switch ( a1 )
      {
        case 1:
          v3 = 1000;
          break;
        case 2:
          v3 = 952;
          break;
        case 4:
          v3 = 213;
          break;
        default:
          v3 = 976;
          break;
      }
      break;
    case 65:
      switch ( a1 )
      {
        case 1:
          v3 = 1002;
          break;
        case 2:
          v3 = 954;
          break;
        case 4:
          v3 = 215;
          break;
        default:
          v3 = 978;
          break;
      }
      break;
    case 66:
      switch ( a1 )
      {
        case 1:
          v3 = 1004;
          break;
        case 2:
          v3 = 956;
          break;
        case 4:
          v3 = 217;
          break;
        default:
          v3 = 980;
          break;
      }
      break;
    case 67:
      switch ( a1 )
      {
        case 1:
          v3 = 1006;
          break;
        case 2:
          v3 = 958;
          break;
        case 4:
          v3 = 219;
          break;
        default:
          v3 = 982;
          break;
      }
      break;
    case 68:
      switch ( a1 )
      {
        case 1:
          v3 = 1008;
          break;
        case 2:
          v3 = 960;
          break;
        case 4:
          v3 = 221;
          break;
        default:
          v3 = 984;
          break;
      }
      break;
    case 69:
      switch ( a1 )
      {
        case 1:
          v3 = 1010;
          break;
        case 2:
          v3 = 962;
          break;
        case 4:
          v3 = 223;
          break;
        default:
          v3 = 986;
          break;
      }
      break;
    case 70:
      switch ( a1 )
      {
        case 1:
          v3 = 1012;
          break;
        case 2:
          v3 = 964;
          break;
        case 4:
          v3 = 225;
          break;
        default:
          v3 = 988;
          break;
      }
      break;
    case 71:
      switch ( a1 )
      {
        case 1:
          v3 = 1014;
          break;
        case 2:
          v3 = 966;
          break;
        case 4:
          v3 = 227;
          break;
        default:
          v3 = 990;
          break;
      }
      break;
    case 72:
      switch ( a1 )
      {
        case 1:
          v3 = 1016;
          break;
        case 2:
          v3 = 968;
          break;
        case 4:
          v3 = 229;
          break;
        default:
          v3 = 992;
          break;
      }
      break;
    case 73:
      switch ( a1 )
      {
        case 1:
          v3 = 1018;
          break;
        case 2:
          v3 = 970;
          break;
        case 4:
          v3 = 231;
          break;
        default:
          v3 = 994;
          break;
      }
      break;
    case 74:
      switch ( a1 )
      {
        case 1:
          v3 = 1020;
          break;
        case 2:
          v3 = 972;
          break;
        case 4:
          v3 = 233;
          break;
        default:
          v3 = 996;
          break;
      }
      break;
    case 75:
      switch ( a1 )
      {
        case 1:
          v3 = 1022;
          break;
        case 2:
          v3 = 974;
          break;
        case 4:
          v3 = 235;
          break;
        default:
          v3 = 998;
          break;
      }
      break;
    case 81:
      v3 = 239;
      break;
    case 82:
      v3 = 241;
      break;
    default:
      v3 = 3837;
      break;
  }
  if ( v3 == 3837 )
    return (char *)&unk_3697D2F;
  else
    return g_pStringEngine->GetString(g_pStringEngine, v3);
}


// address=[0x13c4bf0]
// Decompiled from void UpdateGuiDlgResourceUpgradeContext()
void __cdecl UpdateGuiDlgResourceUpgradeContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int v2; // eax
  int GuiGoodImageID; // eax
  int v4; // eax
  int v5; // eax
  int Number; // [esp+0h] [ebp-44h]
  int Numbera; // [esp+0h] [ebp-44h]
  int i; // [esp+8h] [ebp-3Ch]
  int j; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3EFD447 = 1;
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E505, byte_3F1E504, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 19, 1106, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E505, byte_3F1E504);
    IGuiEngine::SetText((void *)g_pGUIEngine, 19, 1100, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E50C);
    IGuiEngine::SetText((void *)g_pGUIEngine, 19, 1101, Str);
    if ( byte_3F1E50B <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, 1102, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E50B);
      IGuiEngine::SetText((void *)g_pGUIEngine, 19, 1102, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, 1102, 1);
    }
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, 1107, byte_3F1E506);
    if ( byte_3F1E50A == -1 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, 1137, 0);
    }
    else
    {
      IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 19, 1137, byte_3F1E50A);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, 1137, 1);
    }
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 19, 1099, byte_3F1E508 == 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, 1099, byte_3F1E507);
    for ( i = 0; i < 5; ++i )
    {
      if ( byte_3F1E510[2 * i] <= 0 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, dword_369808C[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, dword_369808C[2 * i + 1], 0);
      }
      else
      {
        Number = byte_3F1E511[2 * i];
        v2 = j__abs(Number);
        _wsprintfA(Str, "%u", v2);
        IGuiEngine::SetText((void *)g_pGUIEngine, 19, dword_369808C[2 * i], Str);
        GuiGoodImageID = GetGuiGoodImageID(byte_3F1E510[2 * i]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 19, dword_369808C[2 * i + 1], GuiGoodImageID, 0);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          19,
          dword_369808C[2 * i + 1],
          dword_3697D30[5 * byte_3F1E510[2 * i] + 3],
          dword_3697D30[5 * byte_3F1E510[2 * i] + 4]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, dword_369808C[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, dword_369808C[2 * i + 1], 1);
        if ( Number < 0 )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 19, dword_369808C[2 * i], 2);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 19, dword_369808C[2 * i], 1);
      }
    }
    for ( j = 0; j < 10; ++j )
    {
      if ( byte_3F1E51A[2 * j] <= 0 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, dword_36980B8[2 * j], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, dword_36980B8[2 * j + 1], 0);
      }
      else
      {
        Numbera = byte_3F1E51B[2 * j];
        v4 = j__abs(Numbera);
        _wsprintfA(Str, "%u", v4);
        IGuiEngine::SetText((void *)g_pGUIEngine, 19, dword_36980B8[2 * j], Str);
        v5 = GetGuiGoodImageID(byte_3F1E51A[2 * j]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 19, dword_36980B8[2 * j + 1], v5, 0);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          19,
          dword_36980B8[2 * j + 1],
          dword_3697D30[5 * byte_3F1E51A[2 * j] + 3],
          dword_3697D30[5 * byte_3F1E51A[2 * j] + 4]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, dword_36980B8[2 * j], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, dword_36980B8[2 * j + 1], 1);
        if ( Numbera < 0 )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 19, dword_36980B8[2 * j], 2);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 19, dword_36980B8[2 * j], 1);
      }
    }
    if ( byte_3F1E504 == 21 || byte_3F1E504 == 22 )
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, 1138, 1);
    else
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 19, 1138, 0);
    byte_3EFD447 = 0;
    if ( g_bOpenSidebar )
    {
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 19, 1138, 1);
      g_bOpenSidebar = 0;
    }
  }
}


// address=[0x13c5220]
// Decompiled from char __cdecl GuiDlgResourceUpgradeContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgResourceUpgradeContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-150h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-148h]
  CEvn_Logic *v8; // [esp+14h] [ebp-140h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-138h]
  CEvn_Logic *v10; // [esp+24h] [ebp-130h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-128h]
  CEvn_Logic *v12; // [esp+34h] [ebp-120h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-118h]
  _BYTE v14[32]; // [esp+4Ch] [ebp-108h] BYREF
  _BYTE v15[32]; // [esp+6Ch] [ebp-E8h] BYREF
  _BYTE v16[32]; // [esp+8Ch] [ebp-C8h] BYREF
  _BYTE v17[32]; // [esp+ACh] [ebp-A8h] BYREF
  _BYTE v18[32]; // [esp+CCh] [ebp-88h] BYREF
  _BYTE v19[32]; // [esp+ECh] [ebp-68h] BYREF
  _BYTE v20[32]; // [esp+10Ch] [ebp-48h] BYREF
  CEvn_Event v21; // [esp+12Ch] [ebp-28h] BYREF
  int v22; // [esp+150h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD447 = 0;
      UpdateGuiDlgResourceUpgradeContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1097:
          v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x198u, 0, 0, 0, 0, 0);
          v22 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v22 = -1;
          CEvn_Logic::~CEvn_Logic(v20);
          PlayGuiSound(2);
          break;
        case 1098:
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x194u, 0, 0, 0, 0, 0);
          v22 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v22 = -1;
          CEvn_Logic::~CEvn_Logic(v19);
          PlayGuiSound(2);
          break;
        case 1099:
          if ( !byte_3EFD447 )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x196u, 0, 0, 0, 0, 0);
              v22 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v11);
              v22 = -1;
              CEvn_Logic::~CEvn_Logic(v18);
            }
            else
            {
              v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x196u, 0, 1u, 0, 0, 0);
              v22 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v10);
              v22 = -1;
              CEvn_Logic::~CEvn_Logic(v17);
            }
            PlayGuiSound(2);
          }
          break;
        case 1138:
          if ( !byte_3EFD447 )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              if ( byte_3F1E504 == 21 )
              {
                v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1C4u, 0, 0, 0, 0, 0);
                v22 = 4;
                IEventEngine::SendAMessage(g_pEvnEngine, v9);
                v22 = -1;
                CEvn_Logic::~CEvn_Logic(v16);
              }
              else if ( byte_3F1E504 == 22 )
              {
                v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1C5u, 0, 0, 0, 0, 0);
                v22 = 5;
                IEventEngine::SendAMessage(g_pEvnEngine, v8);
                v22 = -1;
                CEvn_Logic::~CEvn_Logic(v15);
              }
            }
            else
            {
              v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1CCu, 0, 0, 0, 0, 0);
              v22 = 6;
              IEventEngine::SendAMessage(g_pEvnEngine, v7);
              v22 = -1;
              CEvn_Logic::~CEvn_Logic(v14);
              v6 = CEvn_Event::CEvn_Event(&v21, 0x260u, 0, 0, 0);
              v22 = 7;
              IEventEngine::SendAMessage(g_pEvnEngine, v6);
              v22 = -1;
              CEvn_Event::~CEvn_Event(&v21);
            }
            PlayGuiSound(2);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36980B7);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_369810F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13c5a20]
// Decompiled from void UpdateGuiDlgSettingsGame()
void __cdecl UpdateGuiDlgSettingsGame(void) {
  
  char *v0; // eax

  if ( g_pGUIEngine )
  {
    byte_3EFD448 = 1;
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 38, 1139, *(_DWORD *)(g_pGame + 360) != 0);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 38, 1146, *(_BYTE *)(g_pGame + 364));
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 38, 1150, *(_BYTE *)(g_pGame + 372));
    IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 38, 1149, *(_DWORD *)(g_pGame + 368));
    if ( dword_4031CFC )
      v0 = g_pStringEngine->GetString(g_pStringEngine, 891);
    else
      v0 = g_pStringEngine->GetString(g_pStringEngine, 889);
    IGuiEngine::SetText((void *)g_pGUIEngine, 38, 1142, v0);
    byte_3EFD448 = 0;
  }
}


// address=[0x13c5b40]
// Decompiled from void InitGuiDlgSettingsGame()
void __cdecl InitGuiDlgSettingsGame(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 890);
    IGuiEngine::SetText((void *)g_pGUIEngine, 38, 1140, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 888);
    IGuiEngine::SetText((void *)g_pGUIEngine, 38, 1141, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 894);
    IGuiEngine::SetText((void *)g_pGUIEngine, 38, 1147, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 895);
    IGuiEngine::SetText((void *)g_pGUIEngine, 38, 1151, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 888);
    IGuiEngine::SetText((void *)g_pGUIEngine, 38, 1141, v4);
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 38, 1149, *(_BYTE *)(g_pGame + 364));
    IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 38, 1148, *(_BYTE *)(g_pGame + 364));
  }
}


// address=[0x13c5c70]
// Decompiled from char __cdecl GuiDlgSettingsGameProc(int a1, int a2, int a3)
bool __cdecl GuiDlgSettingsGameProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-98h]
  CEvn_Event *v7; // [esp+Ch] [ebp-90h]
  CEvn_Event *v8; // [esp+14h] [ebp-88h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-80h]
  CEvn_Event v10; // [esp+2Ch] [ebp-70h] BYREF
  CEvn_Event v11; // [esp+44h] [ebp-58h] BYREF
  CEvn_Event v12; // [esp+5Ch] [ebp-40h] BYREF
  CEvn_Event v13; // [esp+74h] [ebp-28h] BYREF
  int v14; // [esp+98h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD448 = 0;
      InitGuiDlgSettingsGame();
      UpdateGuiDlgSettingsGame();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 2:
      if ( (unsigned __int16)a2 == 1149 && !byte_3EFD448 )
        *(_DWORD *)(g_pGame + 368) = a3;
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1139:
          if ( !byte_3EFD448 )
          {
            *(_DWORD *)(g_pGame + 360) = (a2 & 0x10000) != 0;
            PlayGuiSound(1);
            v9 = CEvn_Event::CEvn_Event(&v13, 0x21u, 0, 0, 0);
            v14 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v14 = -1;
            CEvn_Event::~CEvn_Event(&v13);
          }
          break;
        case 1146:
          if ( !byte_3EFD448 )
          {
            *(_BYTE *)(g_pGame + 364) = (a2 & 0x10000) != 0;
            IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 38, 1149, *(_BYTE *)(g_pGame + 364));
            IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 38, 1148, *(_BYTE *)(g_pGame + 364));
            PlayGuiSound(1);
            v8 = CEvn_Event::CEvn_Event(&v12, 0x21u, 0, 0, 0);
            v14 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v14 = -1;
            CEvn_Event::~CEvn_Event(&v12);
          }
          break;
        case 1149:
          if ( !byte_3EFD448 )
          {
            PlayGuiSound(1);
            v6 = CEvn_Event::CEvn_Event(&v10, 0x21u, 0, 0, 0);
            v14 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v14 = -1;
            CEvn_Event::~CEvn_Event(&v10);
          }
          break;
        case 1150:
          if ( !byte_3EFD448 )
          {
            *(_BYTE *)(g_pGame + 372) = (a2 & 0x10000) != 0;
            PlayGuiSound(1);
            v7 = CEvn_Event::CEvn_Event(&v11, 0x21u, 0, 0, 0);
            v14 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v14 = -1;
            CEvn_Event::~CEvn_Event(&v11);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36981DA);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_36981DB);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13c6260]
// Decompiled from char UpdateGuiDlgSettingsGraphic()
void __cdecl UpdateGuiDlgSettingsGraphic(void) {
  
  char result; // al

  if ( !g_pGUIEngine )
    return result;
  byte_3EFD449 = 1;
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1177, 1);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1157, 1);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1156, 1);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1168, 1);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1169, 1);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1161, 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1163, 0);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1162, 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1172, 0);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1173, 1);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1158, 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1160, 0);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1159, 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1170, 0);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1171, 1);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1164, 1);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 36, 1174, 1);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1152, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1155, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1167, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1154, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1166, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1153, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 36, 1165, 0);
  IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 36, 1172);
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 36, 1173, 1);
  IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 36, 1170);
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 36, 1171, 1);
  IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 36, 1168);
  if ( *(_DWORD *)(g_pGame + 316) )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 36, 1169, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 36, 1168, 1);
  result = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 36, 1174, *(_DWORD *)(g_pGame + 324) != 0);
  byte_3EFD449 = 0;
  return result;
}


// address=[0x13c6530]
// Decompiled from void InitGuiDlgSettingsGraphic()
void __cdecl InitGuiDlgSettingsGraphic(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 1996);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1152, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 879);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1153, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 877);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1154, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 878);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1155, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 897);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1156, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 899);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1157, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 903);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1177, v6);
    v7 = g_pStringEngine->GetString(g_pStringEngine, 898);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1161, v7);
    v8 = g_pStringEngine->GetString(g_pStringEngine, 1724);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1162, v8);
    v9 = g_pStringEngine->GetString(g_pStringEngine, 2124);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1163, v9);
    v10 = g_pStringEngine->GetString(g_pStringEngine, 900);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1158, v10);
    v11 = g_pStringEngine->GetString(g_pStringEngine, 1724);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1159, v11);
    v12 = g_pStringEngine->GetString(g_pStringEngine, 2124);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1160, v12);
    v13 = g_pStringEngine->GetString(g_pStringEngine, 896);
    IGuiEngine::SetText((void *)g_pGUIEngine, 36, 1164, v13);
  }
}


// address=[0x13c67a0]
// Decompiled from char __cdecl GuiDlgSettingsGraphicProc(int a1, int a2, int a3)
bool __cdecl GuiDlgSettingsGraphicProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-98h]
  CEvn_Event *v7; // [esp+Ch] [ebp-90h]
  CEvn_Event *v8; // [esp+14h] [ebp-88h]
  CEvn_Event *v9; // [esp+1Ch] [ebp-80h]
  CEvn_Event v10; // [esp+2Ch] [ebp-70h] BYREF
  CEvn_Event v11; // [esp+44h] [ebp-58h] BYREF
  CEvn_Event v12; // [esp+5Ch] [ebp-40h] BYREF
  CEvn_Event v13; // [esp+74h] [ebp-28h] BYREF
  int v14; // [esp+98h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD449 = 0;
      InitGuiDlgSettingsGraphic();
      UpdateGuiDlgSettingsGraphic();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( (unsigned __int16)a2 == 1168 )
      {
        if ( !byte_3EFD449 && *(_DWORD *)(g_pGame + 316) )
        {
          PlayGuiSound(1);
          v9 = CEvn_Event::CEvn_Event(&v13, 0x1Fu, 0, 0, 0);
          v14 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v13);
        }
      }
      else if ( (unsigned __int16)a2 == 1169 )
      {
        if ( !byte_3EFD449 && *(_DWORD *)(g_pGame + 316) != 1 )
        {
          PlayGuiSound(1);
          v8 = CEvn_Event::CEvn_Event(&v12, 0x1Fu, 0, 1u, 0);
          v14 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v12);
        }
      }
      else if ( (unsigned __int16)a2 == 1174 && !byte_3EFD449 )
      {
        if ( (a2 & 0x10000) != 0 )
        {
          v7 = CEvn_Event::CEvn_Event(&v11, 0x1Fu, 1u, 1u, 0);
          v14 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v11);
        }
        else
        {
          v6 = CEvn_Event::CEvn_Event(&v10, 0x1Fu, 1u, 0, 0);
          v14 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v14 = -1;
          CEvn_Event::~CEvn_Event(&v10);
        }
        PlayGuiSound(1);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36981DC);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_36981DD);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13c6d00]
// Decompiled from char UpdateGuiDlgSettingsMessages()
void __cdecl UpdateGuiDlgSettingsMessages(void) {
  
  char result; // al

  byte_3EFD44A = 1;
  if ( (*(_DWORD *)(g_pGame + 380) & 3) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1206, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1206, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 5) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1205, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1205, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x300) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1204, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1204, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x500) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1203, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1203, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x900) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1202, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1202, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x1100) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1201, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1201, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x4100) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1199, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1199, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x30000) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1198, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1198, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x50000) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1197, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1197, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x90000) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1196, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1196, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x5000000) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1195, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1195, 0);
  if ( (*(_DWORD *)(g_pGame + 380) & 0x9000000) != 0 )
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1194, 1);
  else
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1194, 0);
  if ( ((unsigned int)&loc_3000000 & *(_DWORD *)(g_pGame + 380)) != 0 )
    result = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1200, 1);
  else
    result = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 39, 1200, 0);
  byte_3EFD44A = 0;
  return result;
}


// address=[0x13c7030]
// Decompiled from void InitGuiDlgSettingsMessages()
void __cdecl InitGuiDlgSettingsMessages(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 910);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1180, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 915);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1181, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 913);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1182, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 904);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1183, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 918);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1184, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 909);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1185, v5);
    v6 = g_pStringEngine->GetString(g_pStringEngine, 908);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1186, v6);
    v7 = g_pStringEngine->GetString(g_pStringEngine, 906);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1188, v7);
    v8 = g_pStringEngine->GetString(g_pStringEngine, 911);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1189, v8);
    v9 = g_pStringEngine->GetString(g_pStringEngine, 912);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1190, v9);
    v10 = g_pStringEngine->GetString(g_pStringEngine, 914);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1191, v10);
    v11 = g_pStringEngine->GetString(g_pStringEngine, 916);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1192, v11);
    v12 = g_pStringEngine->GetString(g_pStringEngine, 781);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1193, v12);
    v13 = g_pStringEngine->GetString(g_pStringEngine, 917);
    IGuiEngine::SetText((void *)g_pGUIEngine, 39, 1187, v13);
  }
}


// address=[0x13c72a0]
// Decompiled from char __cdecl GuiDlgSettingsMessagesProc(int a1, int a2, int a3)
bool __cdecl GuiDlgSettingsMessagesProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  unsigned int v6; // edx
  unsigned int v7; // ecx
  unsigned int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  unsigned int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // ecx
  unsigned int v14; // eax
  unsigned int v15; // edx
  unsigned int v16; // ecx
  unsigned int v17; // eax
  unsigned int v18; // edx
  CEvn_Event *v19; // [esp+Ch] [ebp-1B0h]
  CEvn_Event *v20; // [esp+14h] [ebp-1A8h]
  CEvn_Event *v21; // [esp+1Ch] [ebp-1A0h]
  CEvn_Event *v22; // [esp+24h] [ebp-198h]
  CEvn_Event *v23; // [esp+2Ch] [ebp-190h]
  CEvn_Event *v24; // [esp+34h] [ebp-188h]
  CEvn_Event *v25; // [esp+38h] [ebp-184h]
  CEvn_Event *v26; // [esp+40h] [ebp-17Ch]
  CEvn_Event *v27; // [esp+48h] [ebp-174h]
  CEvn_Event *v28; // [esp+50h] [ebp-16Ch]
  CEvn_Event *v29; // [esp+54h] [ebp-168h]
  CEvn_Event *v30; // [esp+5Ch] [ebp-160h]
  CEvn_Event *v31; // [esp+64h] [ebp-158h]
  CEvn_Event v32; // [esp+74h] [ebp-148h] BYREF
  CEvn_Event v33; // [esp+8Ch] [ebp-130h] BYREF
  CEvn_Event v34; // [esp+A4h] [ebp-118h] BYREF
  CEvn_Event v35; // [esp+BCh] [ebp-100h] BYREF
  CEvn_Event v36; // [esp+D4h] [ebp-E8h] BYREF
  CEvn_Event v37; // [esp+ECh] [ebp-D0h] BYREF
  CEvn_Event v38; // [esp+104h] [ebp-B8h] BYREF
  CEvn_Event v39; // [esp+11Ch] [ebp-A0h] BYREF
  CEvn_Event v40; // [esp+134h] [ebp-88h] BYREF
  CEvn_Event v41; // [esp+14Ch] [ebp-70h] BYREF
  CEvn_Event v42; // [esp+164h] [ebp-58h] BYREF
  CEvn_Event v43; // [esp+17Ch] [ebp-40h] BYREF
  CEvn_Event v44; // [esp+194h] [ebp-28h] BYREF
  int v45; // [esp+1B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD44A = 0;
      InitGuiDlgSettingsMessages();
      UpdateGuiDlgSettingsMessages();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( !byte_3EFD44A )
      {
        switch ( (__int16)a2 )
        {
          case 1194:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v17 = *(_DWORD *)(g_pGame + 380) | 0x9000000;
              else
                v17 = *(_DWORD *)(g_pGame + 380) & 0xF6FFFFFF;
              *(_DWORD *)(g_pGame + 380) = v17;
              v26 = CEvn_Event::CEvn_Event(&v36, 0x22u, 0, 0, 0);
              v45 = 11;
              IEventEngine::SendAMessage(g_pEvnEngine, v26);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v36);
            }
            break;
          case 1195:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v16 = *(_DWORD *)(g_pGame + 380) | 0x5000000;
              else
                v16 = *(_DWORD *)(g_pGame + 380) & 0xFAFFFFFF;
              *(_DWORD *)(g_pGame + 380) = v16;
              v27 = CEvn_Event::CEvn_Event(&v35, 0x22u, 0, 0, 0);
              v45 = 10;
              IEventEngine::SendAMessage(g_pEvnEngine, v27);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v35);
            }
            break;
          case 1196:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v15 = *(_DWORD *)(g_pGame + 380) | 0x90000;
              else
                v15 = *(_DWORD *)(g_pGame + 380) & 0xFFF6FFFF;
              *(_DWORD *)(g_pGame + 380) = v15;
              v28 = CEvn_Event::CEvn_Event(&v34, 0x22u, 0, 0, 0);
              v45 = 9;
              IEventEngine::SendAMessage(g_pEvnEngine, v28);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v34);
            }
            break;
          case 1197:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v14 = *(_DWORD *)(g_pGame + 380) | 0x50000;
              else
                v14 = *(_DWORD *)(g_pGame + 380) & 0xFFFAFFFF;
              *(_DWORD *)(g_pGame + 380) = v14;
              v24 = CEvn_Event::CEvn_Event(&v33, 0x22u, 0, 0, 0);
              v45 = 8;
              IEventEngine::SendAMessage(g_pEvnEngine, v24);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v33);
            }
            break;
          case 1198:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v13 = *(_DWORD *)(g_pGame + 380) | 0x30000;
              else
                v13 = *(_DWORD *)(g_pGame + 380) & 0xFFFCFFFF;
              *(_DWORD *)(g_pGame + 380) = v13;
              v23 = CEvn_Event::CEvn_Event(&v32, 0x22u, 0, 0, 0);
              v45 = 7;
              IEventEngine::SendAMessage(g_pEvnEngine, v23);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v32);
            }
            break;
          case 1199:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v12 = *(_DWORD *)(g_pGame + 380) | 0x4100;
              else
                v12 = *(_DWORD *)(g_pGame + 380) & 0xFFFFBEFF;
              *(_DWORD *)(g_pGame + 380) = v12;
              v22 = CEvn_Event::CEvn_Event(&v43, 0x22u, 0, 0, 0);
              v45 = 6;
              IEventEngine::SendAMessage(g_pEvnEngine, v22);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v43);
            }
            break;
          case 1200:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v18 = (unsigned int)&loc_3000000 | *(_DWORD *)(g_pGame + 380);
              else
                v18 = *(_DWORD *)(g_pGame + 380) & 0xFCFFFFFF;
              *(_DWORD *)(g_pGame + 380) = v18;
              v25 = CEvn_Event::CEvn_Event(&v44, 0x22u, 0, 0, 0);
              v45 = 12;
              IEventEngine::SendAMessage(g_pEvnEngine, v25);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v44);
            }
            break;
          case 1201:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
              {
                *(_DWORD *)(g_pGame + 380) |= 0x1100u;
                v11 = *(_DWORD *)(g_pGame + 380) | 0x2100;
              }
              else
              {
                *(_DWORD *)(g_pGame + 380) &= 0xFFFFEEFF;
                v11 = *(_DWORD *)(g_pGame + 380) & 0xFFFFDEFF;
              }
              *(_DWORD *)(g_pGame + 380) = v11;
              v21 = CEvn_Event::CEvn_Event(&v42, 0x22u, 0, 0, 0);
              v45 = 5;
              IEventEngine::SendAMessage(g_pEvnEngine, v21);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v42);
            }
            break;
          case 1202:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v10 = *(_DWORD *)(g_pGame + 380) | 0x900;
              else
                v10 = *(_DWORD *)(g_pGame + 380) & 0xFFFFF6FF;
              *(_DWORD *)(g_pGame + 380) = v10;
              v20 = CEvn_Event::CEvn_Event(&v41, 0x22u, 0, 0, 0);
              v45 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v20);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v41);
            }
            break;
          case 1203:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v9 = *(_DWORD *)(g_pGame + 380) | 0x500;
              else
                v9 = *(_DWORD *)(g_pGame + 380) & 0xFFFFFAFF;
              *(_DWORD *)(g_pGame + 380) = v9;
              v19 = CEvn_Event::CEvn_Event(&v40, 0x22u, 0, 0, 0);
              v45 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v19);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v40);
            }
            break;
          case 1204:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v8 = *(_DWORD *)(g_pGame + 380) | 0x300;
              else
                v8 = *(_DWORD *)(g_pGame + 380) & 0xFFFFFCFF;
              *(_DWORD *)(g_pGame + 380) = v8;
              v29 = CEvn_Event::CEvn_Event(&v39, 0x22u, 0, 0, 0);
              v45 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v29);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v39);
            }
            break;
          case 1205:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v7 = *(_DWORD *)(g_pGame + 380) | 5;
              else
                v7 = *(_DWORD *)(g_pGame + 380) & 0xFFFFFFFA;
              *(_DWORD *)(g_pGame + 380) = v7;
              v30 = CEvn_Event::CEvn_Event(&v38, 0x22u, 0, 0, 0);
              v45 = 1;
              IEventEngine::SendAMessage(g_pEvnEngine, v30);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v38);
            }
            break;
          case 1206:
            if ( !byte_3EFD44A )
            {
              PlayGuiSound(1);
              if ( (a2 & 0x10000) != 0 )
                v6 = *(_DWORD *)(g_pGame + 380) | 3;
              else
                v6 = *(_DWORD *)(g_pGame + 380) & 0xFFFFFFFC;
              *(_DWORD *)(g_pGame + 380) = v6;
              v31 = CEvn_Event::CEvn_Event(&v37, 0x22u, 0, 0, 0);
              v45 = 0;
              IEventEngine::SendAMessage(g_pEvnEngine, v31);
              v45 = -1;
              CEvn_Event::~CEvn_Event(&v37);
            }
            break;
          default:
            return 1;
        }
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36981DE);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_36981DF);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13c82a0]
// Decompiled from char UpdateGuiDlgSettingsSound()
void __cdecl UpdateGuiDlgSettingsSound(void) {
  
  char result; // al

  if ( !g_pGUIEngine )
    return result;
  byte_3EFD44B = 1;
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 37, 1218, *(_BYTE *)(g_pGame + 352));
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 37, 1219, *(_BYTE *)(g_pGame + 353));
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 37, 1225, *(_BYTE *)(g_pGame + 354));
  IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 37, 1216, *(_DWORD *)(g_pGame + 340));
  IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 37, 1217, *(_DWORD *)(g_pGame + 336));
  IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 37, 1224, *(_DWORD *)(g_pGame + 344));
  IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 37, 1229, *(_DWORD *)(g_pGame + 348));
  result = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 37, 1233, *(_BYTE *)(g_pGame + 355));
  byte_3EFD44B = 0;
  return result;
}


// address=[0x13c83c0]
// Decompiled from void InitGuiDlgSettingsSound()
void __cdecl InitGuiDlgSettingsSound(void) {
  
  char *v0; // eax
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 921);
    IGuiEngine::SetText((void *)g_pGUIEngine, 37, 1220, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 920);
    IGuiEngine::SetText((void *)g_pGUIEngine, 37, 1221, v1);
    v2 = g_pStringEngine->GetString(g_pStringEngine, 923);
    IGuiEngine::SetText((void *)g_pGUIEngine, 37, 1222, v2);
    v3 = g_pStringEngine->GetString(g_pStringEngine, 919);
    IGuiEngine::SetText((void *)g_pGUIEngine, 37, 1231, v3);
    v4 = g_pStringEngine->GetString(g_pStringEngine, 924);
    IGuiEngine::SetText((void *)g_pGUIEngine, 37, 1232, v4);
    v5 = g_pStringEngine->GetString(g_pStringEngine, 922);
    IGuiEngine::SetText((void *)g_pGUIEngine, 37, 1230, v5);
  }
}


// address=[0x13c84e0]
// Decompiled from char __cdecl GuiDlgSettingsSoundProc(int a1, int a2, int a3)
bool __cdecl GuiDlgSettingsSoundProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+8h] [ebp-198h]
  CEvn_Event *v7; // [esp+10h] [ebp-190h]
  CEvn_Event *v8; // [esp+18h] [ebp-188h]
  CEvn_Event *v9; // [esp+20h] [ebp-180h]
  CEvn_Event *v10; // [esp+28h] [ebp-178h]
  CEvn_Event *v11; // [esp+30h] [ebp-170h]
  CEvn_Event *v12; // [esp+34h] [ebp-16Ch]
  CEvn_Event *v13; // [esp+3Ch] [ebp-164h]
  CEvn_Event *v14; // [esp+44h] [ebp-15Ch]
  CEvn_Event *v15; // [esp+4Ch] [ebp-154h]
  CEvn_Event *v16; // [esp+54h] [ebp-14Ch]
  CEvn_Event *v17; // [esp+5Ch] [ebp-144h]
  CEvn_Event v18; // [esp+70h] [ebp-130h] BYREF
  CEvn_Event v19; // [esp+88h] [ebp-118h] BYREF
  CEvn_Event v20; // [esp+A0h] [ebp-100h] BYREF
  CEvn_Event v21; // [esp+B8h] [ebp-E8h] BYREF
  CEvn_Event v22; // [esp+D0h] [ebp-D0h] BYREF
  CEvn_Event v23; // [esp+E8h] [ebp-B8h] BYREF
  CEvn_Event v24; // [esp+100h] [ebp-A0h] BYREF
  CEvn_Event v25; // [esp+118h] [ebp-88h] BYREF
  CEvn_Event v26; // [esp+130h] [ebp-70h] BYREF
  CEvn_Event v27; // [esp+148h] [ebp-58h] BYREF
  CEvn_Event v28; // [esp+160h] [ebp-40h] BYREF
  CEvn_Event v29; // [esp+178h] [ebp-28h] BYREF
  int v30; // [esp+19Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD44B = 0;
      InitGuiDlgSettingsSound();
      UpdateGuiDlgSettingsSound();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 2:
      switch ( (__int16)a2 )
      {
        case 1216:
          if ( !byte_3EFD44B )
          {
            *(_DWORD *)(g_pGame + 340) = a3;
            v15 = CEvn_Event::CEvn_Event(&v19, 0x20u, 0, 0, 0);
            v30 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v19);
          }
          break;
        case 1217:
          if ( !byte_3EFD44B )
          {
            *(_DWORD *)(g_pGame + 336) = a3;
            v14 = CEvn_Event::CEvn_Event(&v20, 0x20u, 0, 0, 0);
            v30 = 9;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v20);
          }
          break;
        case 1224:
          if ( !byte_3EFD44B )
          {
            *(_DWORD *)(g_pGame + 344) = a3;
            v13 = CEvn_Event::CEvn_Event(&v21, 0x20u, 0, 0, 0);
            v30 = 10;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v21);
          }
          break;
        case 1229:
          if ( !byte_3EFD44B )
          {
            *(_DWORD *)(g_pGame + 348) = a3;
            v12 = CEvn_Event::CEvn_Event(&v29, 0x20u, 0, 0, 0);
            v30 = 11;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v29);
          }
          break;
        default:
          return 1;
      }
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1216:
          if ( !byte_3EFD44B )
          {
            v8 = CEvn_Event::CEvn_Event(&v26, 0x20u, 0, 0, 0);
            v30 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v26);
            PlayGuiSound(1);
          }
          break;
        case 1217:
          if ( !byte_3EFD44B )
          {
            v9 = CEvn_Event::CEvn_Event(&v27, 0x20u, 0, 0, 0);
            v30 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v27);
            PlayGuiSound(1);
          }
          break;
        case 1218:
          if ( !byte_3EFD44B )
          {
            PlayGuiSound(1);
            *(_BYTE *)(g_pGame + 352) = (a2 & 0x10000) != 0;
            v17 = CEvn_Event::CEvn_Event(&v22, 0x20u, 0, 0, 0);
            v30 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v17);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v22);
          }
          break;
        case 1219:
          if ( !byte_3EFD44B )
          {
            PlayGuiSound(1);
            *(_BYTE *)(g_pGame + 353) = (a2 & 0x10000) != 0;
            v16 = CEvn_Event::CEvn_Event(&v23, 0x20u, 0, 0, 0);
            v30 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v16);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v23);
          }
          break;
        case 1224:
          if ( !byte_3EFD44B )
          {
            v10 = CEvn_Event::CEvn_Event(&v28, 0x20u, 0, 0, 0);
            v30 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v28);
            PlayGuiSound(1);
          }
          break;
        case 1225:
          if ( !byte_3EFD44B )
          {
            PlayGuiSound(1);
            *(_BYTE *)(g_pGame + 354) = (a2 & 0x10000) != 0;
            v6 = CEvn_Event::CEvn_Event(&v24, 0x20u, 0, 0, 0);
            v30 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v24);
          }
          break;
        case 1229:
          if ( !byte_3EFD44B )
          {
            v11 = CEvn_Event::CEvn_Event(&v18, 0x20u, 0, 0, 0);
            v30 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v18);
            PlayGuiSound(1);
          }
          break;
        case 1233:
          if ( !byte_3EFD44B )
          {
            PlayGuiSound(1);
            *(_BYTE *)(g_pGame + 355) = (a2 & 0x10000) != 0;
            v7 = CEvn_Event::CEvn_Event(&v25, 0x20u, 0, 0, 0);
            v30 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v30 = -1;
            CEvn_Event::~CEvn_Event(&v25);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36981E0);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_36981E1);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13c8fa0]
// Decompiled from void InitGuiDlgSettlerFindMenu()
void __cdecl InitGuiDlgSettlerFindMenu(void) {
  
  dword_3EFD44C = 0;
  if ( g_pStringEngine )
  {
    if ( CGameData::IsCampaign(g_pGameData) )
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 29, 1242, 0);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 29, 1240, 1);
  }
}


// address=[0x13c9000]
// Decompiled from char __cdecl GuiDlgSettlerFindMenuProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgSettlerFindMenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  int LocalPlayerId; // eax
  CPlayerInfo *v7; // eax
  int v8; // [esp+0h] [ebp-A4h]
  CEvn_Logic *v9; // [esp+4h] [ebp-A0h]
  CEvn_Logic *v10; // [esp+10h] [ebp-94h]
  CEvn_Logic *v11; // [esp+1Ch] [ebp-88h]
  DWORD v12; // [esp+2Ch] [ebp-78h]
  _BYTE v13[32]; // [esp+34h] [ebp-70h] BYREF
  _BYTE v14[32]; // [esp+54h] [ebp-50h] BYREF
  _BYTE v15[32]; // [esp+74h] [ebp-30h] BYREF
  int v16; // [esp+A0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgSettlerFindMenu();
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( S4LoWord(a2) )
      {
        case 0x4D4u:
          dword_3EFD44C = 29;
          PlayGuiSound(2);
          break;
        case 0x4D5u:
          dword_3EFD44C = 32;
          PlayGuiSound(2);
          break;
        case 0x4D6u:
          LocalPlayerId = CPlayerManager::GetLocalPlayerId(v8);
          v7 = CPlayerManager::PlayerInfo(LocalPlayerId);
          v12 = CPlayerInfo::Race(v7);
          switch ( v12 )
          {
            case 1u:
              dword_3EFD44C = 38;
              break;
            case 2u:
              dword_3EFD44C = 41;
              break;
            case 4u:
              dword_3EFD44C = 61;
              break;
            default:
              dword_3EFD44C = 35;
              break;
          }
          PlayGuiSound(2);
          break;
        case 0x4D7u:
          dword_3EFD44C = 44;
          PlayGuiSound(2);
          break;
        case 0x4D8u:
          dword_3EFD44C = 50;
          PlayGuiSound(2);
          break;
        case 0x4D9u:
          dword_3EFD44C = 49;
          PlayGuiSound(2);
          break;
        case 0x4DAu:
          dword_3EFD44C = 46;
          PlayGuiSound(2);
          break;
        case 0x4DBu:
          dword_3EFD44C = 47;
          PlayGuiSound(2);
          break;
        case 0x4DCu:
          dword_3EFD44C = 48;
          PlayGuiSound(2);
          break;
        case 0x4DDu:
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1B9u, dword_3EFD44C, 0, 0, 0, 0);
          v16 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          PlayGuiSound(2);
          break;
        case 0x4DEu:
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1B9u, dword_3EFD44C, 1u, 0, 0, 0);
          v16 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v14);
          PlayGuiSound(2);
          break;
        case 0x4DFu:
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1B9u, dword_3EFD44C, 2u, 0, 0, 0);
          v16 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v13);
          PlayGuiSound(2);
          break;
        case 0x4E0u:
          dword_3EFD44C = 45;
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36981E2);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_36981E3);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13c9580]
// Decompiled from char __cdecl SetAmountGuiDlgSettlerProductionMenu(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8)
void __cdecl SetAmountGuiDlgSettlerProductionMenu(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8) {
  
  char result; // al
  CHAR Str[52]; // [esp+0h] [ebp-38h] BYREF

  _wsprintfA(Str, "%u", a2);
  result = IGuiEngine::SetText((void *)g_pGUIEngine, 30, a1, Str);
  if ( a3 > -1 )
  {
    if ( a4 >= 0 )
      _wsprintfA(Str, "+%d", a4);
    else
      _wsprintfA(Str, "%d", a4);
    result = IGuiEngine::SetText((void *)g_pGUIEngine, 30, a3, Str);
  }
  if ( a5 > -1 )
  {
    _wsprintfA(Str, "%d", a6);
    result = IGuiEngine::SetText((void *)g_pGUIEngine, 30, a5, Str);
  }
  if ( a7 <= -1 )
    return result;
  _wsprintfA(Str, "%d", a8);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 30, a7, Str);
}


// address=[0x13c9680]
// Decompiled from char UpdateGuiDlgSettlerProductionMenu()
void __cdecl UpdateGuiDlgSettlerProductionMenu(void) {
  
  char result; // al
  int i; // [esp+4h] [ebp-8h]

  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 30, 1268, byte_3F1EBC4);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 30, 1269, byte_3F1EBC4);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 30, 1270, byte_3F1EBC4);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 30, 1271, byte_3F1EBC4);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 30, 1272, byte_3F1EBC4);
  result = SetAmountGuiDlgSettlerProductionMenu(1262, dword_3F1EBC0, -1, 0, -1, 0, -1, 0);
  for ( i = 0; i < 6; ++i )
  {
    switch ( dword_3F1EB30[6 * i] )
    {
      case '.':
        SetAmountGuiDlgSettlerProductionMenu(
          1260,
          dword_3F1EB34[6 * i],
          1277,
          dword_3F1EB38[6 * i],
          1282,
          dword_3F1EB40[6 * i],
          -1,
          0);
        if ( byte_3F1EB3C[24 * i] )
          IGuiEngine::SetImages((void *)g_pGUIEngine, 30, 1266, 441, 0);
        else
          IGuiEngine::SetImages((void *)g_pGUIEngine, 30, 1266, 501, 0);
        break;
      case '/':
        SetAmountGuiDlgSettlerProductionMenu(
          1259,
          dword_3F1EB34[6 * i],
          1273,
          dword_3F1EB38[6 * i],
          1280,
          dword_3F1EB40[6 * i],
          -1,
          0);
        if ( byte_3F1EB3C[24 * i] )
          IGuiEngine::SetImages((void *)g_pGUIEngine, 30, 1265, 437, 0);
        else
          IGuiEngine::SetImages((void *)g_pGUIEngine, 30, 1265, 500, 0);
        break;
      case '0':
        SetAmountGuiDlgSettlerProductionMenu(1258, dword_3F1EB34[6 * i], 1276, dword_3F1EB38[6 * i], -1, 0, -1, 0);
        break;
      case '1':
        SetAmountGuiDlgSettlerProductionMenu(
          1257,
          dword_3F1EB34[6 * i],
          1274,
          dword_3F1EB38[6 * i],
          1279,
          dword_3F1EB40[6 * i],
          -1,
          0);
        if ( byte_3F1EB3C[24 * i] )
          IGuiEngine::SetImages((void *)g_pGUIEngine, 30, 1263, 443, 0);
        else
          IGuiEngine::SetImages((void *)g_pGUIEngine, 30, 1263, 502, 0);
        break;
      case '2':
        SetAmountGuiDlgSettlerProductionMenu(
          1256,
          dword_3F1EB34[6 * i],
          1275,
          dword_3F1EB38[6 * i],
          1278,
          dword_3F1EB40[6 * i],
          -1,
          0);
        if ( byte_3F1EB3C[24 * i] )
          IGuiEngine::SetImages((void *)g_pGUIEngine, 30, 1264, 437, 0);
        else
          IGuiEngine::SetImages((void *)g_pGUIEngine, 30, 1264, 500, 0);
        break;
      default:
        break;
    }
    result = i + 1;
  }
  return result;
}


// address=[0x13c99d0]
// Decompiled from void InitGuiDlgSettlerProductionMenu()
void __cdecl InitGuiDlgSettlerProductionMenu(void) {
  
  dword_3EFD450 = 0;
  if ( g_pStringEngine )
  {
    if ( CGameData::IsCampaign(g_pGameData) )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 30, 1253, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 30, 1266, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 30, 1260, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 30, 1277, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 30, 1282, 0);
    }
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 30, 1267, 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 30, 1281, 0);
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 30, 1251, 1);
    UpdateGuiDlgSettlerProductionMenu();
  }
}


// address=[0x13c9ab0]
// Decompiled from char __cdecl GuiDlgSettlerProductionMenuProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgSettlerProductionMenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-E0h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-D8h]
  CEvn_Logic *v8; // [esp+14h] [ebp-D0h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-C8h]
  CEvn_Logic *v10; // [esp+24h] [ebp-C0h]
  _BYTE v11[32]; // [esp+34h] [ebp-B0h] BYREF
  _BYTE v12[32]; // [esp+54h] [ebp-90h] BYREF
  _BYTE v13[32]; // [esp+74h] [ebp-70h] BYREF
  _BYTE v14[32]; // [esp+94h] [ebp-50h] BYREF
  _BYTE v15[32]; // [esp+B4h] [ebp-30h] BYREF
  int v16; // [esp+E0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgSettlerProductionMenu();
      UpdateGuiDlgSettlerProductionMenu();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 1251:
          dword_3EFD450 = 50;
          break;
        case 1252:
          dword_3EFD450 = 49;
          break;
        case 1253:
          dword_3EFD450 = 46;
          break;
        case 1254:
          dword_3EFD450 = 47;
          break;
        case 1255:
          dword_3EFD450 = 48;
          break;
        case 1268:
          if ( byte_3F1EBC4 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1E1u, dword_3EFD450, 0, 0, 0, 0);
            v16 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v16 = -1;
            CEvn_Logic::~CEvn_Logic(v15);
          }
          break;
        case 1269:
          if ( byte_3F1EBC4 )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1E1u, dword_3EFD450, 5u, 0, 0, 0);
            v16 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v16 = -1;
            CEvn_Logic::~CEvn_Logic(v14);
          }
          break;
        case 1270:
          if ( byte_3F1EBC4 )
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1E1u, dword_3EFD450, 0xFFFFFFFB, 0, 0, 0);
            v16 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v16 = -1;
            CEvn_Logic::~CEvn_Logic(v13);
          }
          break;
        case 1271:
          if ( byte_3F1EBC4 )
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x1E1u, dword_3EFD450, 1u, 0, 0, 0);
            v16 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v16 = -1;
            CEvn_Logic::~CEvn_Logic(v12);
          }
          break;
        case 1272:
          if ( byte_3F1EBC4 )
          {
            v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v11, 0x1E1u, dword_3EFD450, 0xFFFFFFFF, 0, 0, 0);
            v16 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v16 = -1;
            CEvn_Logic::~CEvn_Logic(v11);
          }
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36981E7);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_36981EB);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13ca140]
// Decompiled from char UpdateGuiDlgSettlerStatisticMenu()
void __cdecl UpdateGuiDlgSettlerStatisticMenu(void) {
  
  char result; // al
  int i; // [esp+0h] [ebp-40h]
  CHAR Str[52]; // [esp+8h] [ebp-38h] BYREF

  if ( !g_pGUIEngine )
    return result;
  byte_3EFD454 = 1;
  IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 31, 1350, byte_3F1E9E8 == 0);
  for ( i = 0; i < 36; ++i )
  {
    if ( dword_3F1EA08[2 * i] )
    {
      _wsprintfA(Str, "%u", dword_3F1EA0C[2 * i]);
      IGuiEngine::SetText((void *)g_pGUIEngine, 31, dword_3698200[i], Str);
    }
  }
  _wsprintfA(Str, "%u", dword_3F1EA00);
  IGuiEngine::SetText((void *)g_pGUIEngine, 31, 1283, Str);
  _wsprintfA(Str, "%u", dword_3F1E9F8);
  IGuiEngine::SetText((void *)g_pGUIEngine, 31, 1361, Str);
  _wsprintfA(Str, "%u", dword_3F1E9FC);
  IGuiEngine::SetText((void *)g_pGUIEngine, 31, 1362, Str);
  _wsprintfA(Str, "%u", dword_3F1EA04);
  IGuiEngine::SetText((void *)g_pGUIEngine, 31, 1357, Str);
  _wsprintfA(Str, "%u", dword_3F1E9EC);
  IGuiEngine::SetText((void *)g_pGUIEngine, 31, 1355, Str);
  _wsprintfA(Str, "(%u/%u)", dword_3F1E9F0, dword_3F1E9F4);
  result = IGuiEngine::SetText((void *)g_pGUIEngine, 31, 1356, Str);
  byte_3EFD454 = 0;
  return result;
}


// address=[0x13ca340]
// Decompiled from char __cdecl GuiDlgSettlerStatisticMenuProc(int a1, int a2, int a3)
bool __cdecl GuiDlgSettlerStatisticMenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-68h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-60h]
  _BYTE v8[32]; // [esp+1Ch] [ebp-50h] BYREF
  _BYTE v9[32]; // [esp+3Ch] [ebp-30h] BYREF
  int v10; // [esp+68h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD454 = 0;
      UpdateGuiDlgSettlerStatisticMenu();
      break;
    case 1:
      if ( !byte_3EFD454 )
      {
        if ( (a2 & 0x10000) != 0 )
          PlayGuiSound(1);
        else
          PlayGuiSound(0);
      }
      break;
    case 3:
      if ( !byte_3EFD454 && (unsigned __int16)a2 == 1350 )
      {
        if ( (a2 & 0x10000) != 0 )
        {
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v9, 0x1B8u, 0, 1u, 0, 0, 0);
          v10 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v10 = -1;
          CEvn_Logic::~CEvn_Logic(v9);
        }
        else
        {
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v8, 0x1B8u, 0, 0, 0, 0, 0);
          v10 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v10 = -1;
          CEvn_Logic::~CEvn_Logic(v8);
        }
        PlayGuiSound(2);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698293);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3698297);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13ca690]
// Decompiled from void UpdateGuiDlgShipVehicleContext()
void __cdecl UpdateGuiDlgShipVehicleContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int v2; // eax
  int GuiGoodImageID; // eax
  int Number; // [esp+0h] [ebp-44h]
  int i; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3EFD455 = 1;
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E60D, byte_3F1E60C, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 24, 1372, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E60D, byte_3F1E60C);
    IGuiEngine::SetText((void *)g_pGUIEngine, 24, 1366, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E614);
    IGuiEngine::SetText((void *)g_pGUIEngine, 24, 1367, Str);
    if ( byte_3F1E613 <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1368, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E613);
      IGuiEngine::SetText((void *)g_pGUIEngine, 24, 1368, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1368, 1);
    }
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 24, 1365, byte_3F1E610 == 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1365, byte_3F1E60F);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1386, byte_3F1E60E);
    for ( i = 0; i < 5; ++i )
    {
      if ( byte_3F1E618[2 * i] )
      {
        Number = byte_3F1E619[2 * i];
        v2 = j__abs(Number);
        _wsprintfA(Str, "%u", v2);
        IGuiEngine::SetText((void *)g_pGUIEngine, 24, dword_36988F4[2 * i], Str);
        GuiGoodImageID = GetGuiGoodImageID(byte_3F1E618[2 * i]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 24, dword_36988F4[2 * i + 1], GuiGoodImageID, 0);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          24,
          dword_36988F4[2 * i + 1],
          dword_3698598[5 * byte_3F1E618[2 * i] + 3],
          dword_3698598[5 * byte_3F1E618[2 * i] + 4]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, dword_36988F4[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, dword_36988F4[2 * i + 1], 1);
        if ( Number < 0 )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 24, dword_36988F4[2 * i + 1], 2);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 24, dword_36988F4[2 * i], 1);
      }
      else
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, dword_36988F4[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, dword_36988F4[2 * i + 1], 0);
      }
    }
    if ( dword_3F1E628 <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1385, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1383, 0);
    }
    else
    {
      IGuiEngine::SetImages((void *)g_pGUIEngine, 24, 1385, dword_36982D8[35 * byte_3F1E60D + 5 * dword_3F1E628], 0);
      IGuiEngine::SetTooltipID(
        (IGuiEngine *)g_pGUIEngine,
        24,
        1385,
        dword_36982D8[35 * byte_3F1E60D + 3 + 5 * dword_3F1E628],
        dword_36982D8[35 * byte_3F1E60D + 4 + 5 * dword_3F1E628]);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1385, 1);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1383, 1);
    }
    if ( dword_3F1E624 > 0 )
    {
      IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 24, 1384, dword_3F1E624);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1384, 1);
    }
    else
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 24, 1384, 0);
    }
    byte_3EFD455 = 0;
    if ( g_bOpenSidebar )
    {
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 24, 1381, 1);
      g_bOpenSidebar = 0;
    }
  }
}


// address=[0x13cab80]
// Decompiled from char __cdecl GuiDlgShipVehicleContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgShipVehicleContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-150h]
  CEvn_Event *v7; // [esp+Ch] [ebp-148h]
  CEvn_Logic *v8; // [esp+14h] [ebp-140h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-138h]
  CEvn_Logic *v10; // [esp+24h] [ebp-130h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-128h]
  CEvn_Logic *v12; // [esp+34h] [ebp-120h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-118h]
  _BYTE v14[32]; // [esp+4Ch] [ebp-108h] BYREF
  _BYTE v15[32]; // [esp+6Ch] [ebp-E8h] BYREF
  _BYTE v16[32]; // [esp+8Ch] [ebp-C8h] BYREF
  _BYTE v17[32]; // [esp+ACh] [ebp-A8h] BYREF
  _BYTE v18[32]; // [esp+CCh] [ebp-88h] BYREF
  _BYTE v19[32]; // [esp+ECh] [ebp-68h] BYREF
  _BYTE v20[32]; // [esp+10Ch] [ebp-48h] BYREF
  CEvn_Event v21; // [esp+12Ch] [ebp-28h] BYREF
  int v22; // [esp+150h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD455 = 0;
      UpdateGuiDlgShipVehicleContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1363:
          v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x198u, 0, 0, 0, 0, 0);
          v22 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v22 = -1;
          CEvn_Logic::~CEvn_Logic(v20);
          PlayGuiSound(2);
          break;
        case 1364:
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x194u, 0, 0, 0, 0, 0);
          v22 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v22 = -1;
          CEvn_Logic::~CEvn_Logic(v19);
          PlayGuiSound(2);
          break;
        case 1365:
          if ( !byte_3EFD455 )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x196u, 0, 0, 0, 0, 0);
              v22 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v11);
              v22 = -1;
              CEvn_Logic::~CEvn_Logic(v18);
            }
            else
            {
              v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x196u, 0, 1u, 0, 0, 0);
              v22 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v10);
              v22 = -1;
              CEvn_Logic::~CEvn_Logic(v17);
            }
            PlayGuiSound(2);
          }
          break;
        case 1381:
          if ( (a2 & 0x10000) != 0 )
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1CBu, 0, 0, 0, 0, 0);
            v22 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v16);
          }
          else
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1CCu, 0, 0, 0, 0, 0);
            v22 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v22 = -1;
            CEvn_Logic::~CEvn_Logic(v15);
            v7 = CEvn_Event::CEvn_Event(&v21, 0x260u, 0, 0, 0);
            v22 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v22 = -1;
            CEvn_Event::~CEvn_Event(&v21);
          }
          PlayGuiSound(2);
          break;
        case 1383:
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1BFu, 0, 0, 0, 0, 0);
          v22 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v22 = -1;
          CEvn_Logic::~CEvn_Logic(v14);
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698597);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3698923);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13cb2f0]
// Decompiled from void UpdateGuiDlgSmallTempleContext()
void __cdecl UpdateGuiDlgSmallTempleContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int v2; // eax
  int GuiGoodImageID; // eax
  int Number; // [esp+0h] [ebp-40h]
  CHAR Str[52]; // [esp+8h] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3EFD456 = 1;
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E5D1, byte_3F1E5D0, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 20, 1394, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E5D1, byte_3F1E5D0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 20, 1390, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E5D8);
    IGuiEngine::SetText((void *)g_pGUIEngine, 20, 1391, Str);
    if ( byte_3F1E5D7 <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 20, 1392, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E5D7);
      IGuiEngine::SetText((void *)g_pGUIEngine, 20, 1392, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 20, 1392, 1);
    }
    if ( byte_3F1E5DC )
    {
      Number = byte_3F1E5DD;
      v2 = j__abs(byte_3F1E5DD);
      _wsprintfA(Str, "%u", v2);
      IGuiEngine::SetText((void *)g_pGUIEngine, 20, 1397, Str);
      GuiGoodImageID = GetGuiGoodImageID(byte_3F1E5DC);
      IGuiEngine::SetImages((void *)g_pGUIEngine, 20, 1396, GuiGoodImageID, 0);
      IGuiEngine::SetTooltipID(
        (IGuiEngine *)g_pGUIEngine,
        20,
        1396,
        dword_3698A68[5 * byte_3F1E5DC + 3],
        dword_3698A68[5 * byte_3F1E5DC + 4]);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 20, 1397, 1);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 20, 1396, 1);
      if ( Number < 0 )
        IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 20, 1396, 2);
      else
        IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 20, 1397, 1);
    }
    else
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 20, 1397, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 20, 1396, 0);
    }
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 20, 1389, byte_3F1E5D4 == 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 20, 1389, byte_3F1E5D3);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 20, 1395, byte_3F1E5D2);
    _wsprintfA(Str, "%u", dword_3F1E5E0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 20, 1399, Str);
    byte_3EFD456 = 0;
  }
}


// address=[0x13cb5f0]
// Decompiled from char __cdecl GuiDlgSmallTempleContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgSmallTempleContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-B8h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-B0h]
  CEvn_Logic *v8; // [esp+14h] [ebp-A8h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-A0h]
  _BYTE v10[32]; // [esp+2Ch] [ebp-90h] BYREF
  _BYTE v11[32]; // [esp+4Ch] [ebp-70h] BYREF
  _BYTE v12[32]; // [esp+6Ch] [ebp-50h] BYREF
  _BYTE v13[32]; // [esp+8Ch] [ebp-30h] BYREF
  int v14; // [esp+B8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD456 = 0;
      UpdateGuiDlgSmallTempleContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( (unsigned __int16)a2 == 1387 )
      {
        v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x198u, 0, 0, 0, 0, 0);
        v14 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v9);
        v14 = -1;
        CEvn_Logic::~CEvn_Logic(v13);
        PlayGuiSound(2);
      }
      else if ( (unsigned __int16)a2 == 1388 )
      {
        v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x194u, 0, 0, 0, 0, 0);
        v14 = 1;
        IEventEngine::SendAMessage(g_pEvnEngine, v8);
        v14 = -1;
        CEvn_Logic::~CEvn_Logic(v12);
        PlayGuiSound(2);
      }
      else if ( (unsigned __int16)a2 == 1389 && !byte_3EFD456 )
      {
        if ( (a2 & 0x10000) != 0 )
        {
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v11, 0x196u, 0, 0, 0, 0, 0);
          v14 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v14 = -1;
          CEvn_Logic::~CEvn_Logic(v11);
        }
        else
        {
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v10, 0x196u, 0, 1u, 0, 0, 0);
          v14 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v14 = -1;
          CEvn_Logic::~CEvn_Logic(v10);
        }
        PlayGuiSound(2);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698DC7);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3698DCF);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13cbac0]
// Decompiled from char __cdecl SetSoldierProperties(struct SHealthState *a1, int a2, int a3)
void __cdecl SetSoldierProperties(struct SHealthState * a1, int a2, int a3) {
  
  char result; // al
  unsigned int v4; // [esp+4h] [ebp-3Ch]
  CHAR Str[52]; // [esp+8h] [ebp-38h] BYREF

  v4 = *(_DWORD *)a1 + *((_DWORD *)a1 + 1);
  if ( *((int *)a1 + 2) <= 0 )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 45, a2, 0);
    return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 45, a3, 0);
  }
  else
  {
    _wsprintfA(Str, "%u", *((_DWORD *)a1 + 2));
    IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 45, a3, 100 * *(_DWORD *)a1 / v4);
    IGuiEngine::SetText((void *)g_pGUIEngine, 45, a2, Str);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 45, a2, 1);
    result = IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 45, a3, 1);
    if ( a2 != 1442 )
      byte_3EFD459 = 0;
  }
  return result;
}


// address=[0x13cbbb0]
// Decompiled from void UpdateGuiDlgSoldierContext()
void __cdecl UpdateGuiDlgSoldierContext(void) {
  
  CEvn_Event *v0; // [esp+4h] [ebp-90h]
  CEvn_Logic *v1; // [esp+Ch] [ebp-88h]
  int i; // [esp+14h] [ebp-80h]
  _BYTE v3[32]; // [esp+18h] [ebp-7Ch] BYREF
  CEvn_Event v4; // [esp+38h] [ebp-5Ch] BYREF
  CHAR Str[52]; // [esp+50h] [ebp-44h] BYREF
  int v6; // [esp+90h] [ebp-4h]

  if ( g_pGUIEngine )
  {
    for ( i = 0; i < 3; ++i )
    {
      SetSoldierProperties(
        (struct SHealthState *)((char *)&unk_3F1E668 + 12 * i),
        dword_3698E9C[2 * i],
        dword_3698E9C[2 * i + 1]);
      SetSoldierProperties(
        (struct SHealthState *)((char *)&unk_3F1E68C + 12 * i),
        dword_3698E84[2 * i],
        dword_3698E84[2 * i + 1]);
      SetSoldierProperties(
        (struct SHealthState *)((char *)&unk_3F1E6B0 + 12 * i),
        dword_3698EB4[2 * i],
        dword_3698EB4[2 * i + 1]);
    }
    SetSoldierProperties((struct SHealthState *)&unk_3F1E6D4, 1421, 1436);
    SetSoldierProperties((struct SHealthState *)&dword_3F1E6E0, 1442, 1443);
    if ( dword_3F1E6E4 || dword_3F1E6E0 )
    {
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 45, 1444, 1);
    }
    else
    {
      if ( byte_3EFD457 )
      {
        v1 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v3, 0x1CCu, 0, 0, 0, 0, 0);
        v6 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v1);
        v6 = -1;
        CEvn_Logic::~CEvn_Logic(v3);
        v0 = CEvn_Event::CEvn_Event(&v4, 0x260u, 0, 0, 0);
        v6 = 1;
        IEventEngine::SendAMessage(g_pEvnEngine, v0);
        v6 = -1;
        CEvn_Event::~CEvn_Event(&v4);
        byte_3EFD457 = 0;
      }
      IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 45, 1444, 0);
      byte_3EFD459 = 0;
    }
    _wsprintfA(Str, "%u%%", dword_3F1E6EC);
    IGuiEngine::SetText((void *)g_pGUIEngine, 45, 1445, Str);
    _wsprintfA(Str, "%u%%", dword_3F1E6F0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 45, 1422, Str);
    _wsprintfA(Str, off_3698EE0, dword_3F1E6F4);
    IGuiEngine::SetText((void *)g_pGUIEngine, 45, 1448, Str);
    if ( byte_3EFD459 )
    {
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 45, 1444, 1);
      byte_3EFD459 = 0;
    }
  }
}


// address=[0x13cbeb0]
// Decompiled from char __cdecl GuiDlgSoldierContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgSoldierContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  int v7; // [esp+0h] [ebp-184h]
  CEvn_Logic *v8; // [esp+Ch] [ebp-178h]
  CEvn_Logic *v9; // [esp+14h] [ebp-170h]
  CEvn_Logic *v10; // [esp+1Ch] [ebp-168h]
  CEvn_Logic *v11; // [esp+24h] [ebp-160h]
  CEvn_Event *v12; // [esp+28h] [ebp-15Ch]
  CEvn_Logic *v13; // [esp+30h] [ebp-154h]
  CEvn_Logic *v14; // [esp+38h] [ebp-14Ch]
  CEvn_Event *v15; // [esp+40h] [ebp-144h]
  CEvn_Logic *v16; // [esp+44h] [ebp-140h]
  char LocalPlayerId; // [esp+58h] [ebp-12Ch]
  _BYTE v18[32]; // [esp+64h] [ebp-120h] BYREF
  _BYTE v19[32]; // [esp+84h] [ebp-100h] BYREF
  _BYTE v20[32]; // [esp+A4h] [ebp-E0h] BYREF
  _BYTE v21[32]; // [esp+C4h] [ebp-C0h] BYREF
  _BYTE v22[32]; // [esp+E4h] [ebp-A0h] BYREF
  _BYTE v23[32]; // [esp+104h] [ebp-80h] BYREF
  _BYTE v24[32]; // [esp+124h] [ebp-60h] BYREF
  CEvn_Event v25; // [esp+144h] [ebp-40h] BYREF
  CEvn_Event v26; // [esp+15Ch] [ebp-28h] BYREF
  int v27; // [esp+180h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      v4 = g_pStringEngine->GetString(g_pStringEngine, 885);
      IGuiEngine::SetText((void *)g_pGUIEngine, 45, 1401, v4);
      byte_3EFD457 = 0;
      byte_3EFD458 = 0;
      byte_3EFD459 = 1;
      UpdateGuiDlgSoldierContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      LocalPlayerId = CPlayerManager::GetLocalPlayerId(v7);
      switch ( (__int16)a2 )
      {
        case 1437:
          v16 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x19Fu, (a3 & 4) != 0, 0, LocalPlayerId, 0, 0);
          v27 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v27 = -1;
          CEvn_Logic::~CEvn_Logic(v18);
          PlayGuiSound(2);
          break;
        case 1438:
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x19Eu, 0, 0, LocalPlayerId, 0, 0);
          v27 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v27 = -1;
          CEvn_Logic::~CEvn_Logic(v19);
          PlayGuiSound(2);
          break;
        case 1439:
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x19Cu, 0, 0, LocalPlayerId, 0, 0);
          v27 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v27 = -1;
          CEvn_Logic::~CEvn_Logic(v20);
          PlayGuiSound(2);
          break;
        case 1440:
          if ( (a2 & 0x10000) != 0 )
          {
            if ( byte_3EFD457 )
              IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 45, 1444, 0);
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v21, 0x1C2u, 0, 0, 0, 0, 0);
            v27 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v27 = -1;
            CEvn_Logic::~CEvn_Logic(v21);
            byte_3EFD458 = 1;
          }
          else
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v22, 0x1CCu, 0, 0, 0, 0, 0);
            v27 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v27 = -1;
            CEvn_Logic::~CEvn_Logic(v22);
            v15 = CEvn_Event::CEvn_Event(&v25, 0x260u, 0, 0, 0);
            v27 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v15);
            v27 = -1;
            CEvn_Event::~CEvn_Event(&v25);
            byte_3EFD458 = 0;
          }
          PlayGuiSound(2);
          break;
        case 1444:
          if ( (a2 & 0x10000) != 0 )
          {
            if ( byte_3EFD458 )
              IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 45, 1440, 0);
            v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v23, 0x1C1u, 0, 0, 0, 0, 0);
            v27 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v14);
            v27 = -1;
            CEvn_Logic::~CEvn_Logic(v23);
            byte_3EFD457 = 1;
          }
          else
          {
            v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v24, 0x1CCu, 0, 0, 0, 0, 0);
            v27 = 7;
            IEventEngine::SendAMessage(g_pEvnEngine, v13);
            v27 = -1;
            CEvn_Logic::~CEvn_Logic(v24);
            v12 = CEvn_Event::CEvn_Event(&v26, 0x260u, 0, 0, 0);
            v27 = 8;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v27 = -1;
            CEvn_Event::~CEvn_Event(&v26);
            byte_3EFD457 = 0;
          }
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698ECF);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v5);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3698ED5);
      }
      else
      {
        v6 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v6);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13cc770]
// Decompiled from int __cdecl PlayGuiSound(unsigned int a1)
void __cdecl PlayGuiSound(int a1) {
  
  int result; // eax

  if ( a1 <= 5 )
    return CSoundManager::PlaySoundFX(g_pSoundManager, dword_3D891B8[a1]);
  return result;
}


// address=[0x13cc7a0]
// Decompiled from char __cdecl SetSpecialistProperties(struct SHealthState *a1, int a2, int a3)
void __cdecl SetSpecialistProperties(struct SHealthState * a1, int a2, int a3) {
  
  unsigned int v4; // [esp+4h] [ebp-3Ch]
  CHAR Str[52]; // [esp+8h] [ebp-38h] BYREF

  v4 = *(_DWORD *)a1 + *((_DWORD *)a1 + 1);
  if ( *((int *)a1 + 2) <= 0 )
  {
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 44, a2, 0);
    return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 44, a3, 0);
  }
  else
  {
    _wsprintfA(Str, "%u", *((_DWORD *)a1 + 2));
    IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 44, a3, 100 * *(_DWORD *)a1 / v4);
    IGuiEngine::SetText((void *)g_pGUIEngine, 44, a2, Str);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 44, a2, 1);
    return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 44, a3, 1);
  }
}


// address=[0x13cc880]
// Decompiled from char UpdateGuiDlgSpecialistsContext()
void __cdecl UpdateGuiDlgSpecialistsContext(void) {
  
  char result; // al

  if ( !g_pGUIEngine )
    return result;
  SetSpecialistProperties((struct SHealthState *)&unk_3F1E700, 1455, 1461);
  SetSpecialistProperties((struct SHealthState *)&unk_3F1E70C, 1456, 1462);
  SetSpecialistProperties((struct SHealthState *)&unk_3F1E718, 1457, 1463);
  SetSpecialistProperties((struct SHealthState *)&unk_3F1E724, 1458, 1464);
  return SetSpecialistProperties((struct SHealthState *)&unk_3F1E730, 1470, 1469);
}


// address=[0x13cc910]
// Decompiled from char __cdecl GuiDlgSpecialistsContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgSpecialistsContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  CEvn_Logic *v7; // [esp+4h] [ebp-D8h]
  CEvn_Event *v8; // [esp+Ch] [ebp-D0h]
  CEvn_Logic *v9; // [esp+14h] [ebp-C8h]
  CEvn_Logic *v10; // [esp+1Ch] [ebp-C0h]
  CEvn_Logic *v11; // [esp+24h] [ebp-B8h]
  _BYTE v12[32]; // [esp+34h] [ebp-A8h] BYREF
  _BYTE v13[32]; // [esp+54h] [ebp-88h] BYREF
  _BYTE v14[32]; // [esp+74h] [ebp-68h] BYREF
  _BYTE v15[32]; // [esp+94h] [ebp-48h] BYREF
  CEvn_Event v16; // [esp+B4h] [ebp-28h] BYREF
  int v17; // [esp+D8h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      v4 = g_pStringEngine->GetString(g_pStringEngine, 886);
      IGuiEngine::SetText((void *)g_pGUIEngine, 44, 1450, v4);
      UpdateGuiDlgSpecialistsContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (unsigned __int16)a2 )
      {
        case 0x5B9u:
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x19Fu, 0, 0, 0, 0, 0);
          v17 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v17 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          PlayGuiSound(2);
          break;
        case 0x5BAu:
          if ( (a2 & 0x10000) != 0 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1C2u, 0, 0, 0, 0, 0);
            v17 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v17 = -1;
            CEvn_Logic::~CEvn_Logic(v14);
          }
          else
          {
            v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1CCu, 0, 0, 0, 0, 0);
            v17 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v9);
            v17 = -1;
            CEvn_Logic::~CEvn_Logic(v13);
            v8 = CEvn_Event::CEvn_Event(&v16, 0x260u, 0, 0, 0);
            v17 = 3;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v17 = -1;
            CEvn_Event::~CEvn_Event(&v16);
          }
          PlayGuiSound(2);
          break;
        case 0x5BBu:
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x1A7u, 0, 0, 0, 0, 0);
          v17 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v17 = -1;
          CEvn_Logic::~CEvn_Logic(v12);
          PlayGuiSound(2);
          break;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698EFB);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v5);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3698EFC);
      }
      else
      {
        v6 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v6);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13cce00]
// Decompiled from int __stdcall LineCallbackGoods(int a1, int a2, __int16 a3)
void __stdcall LineCallbackGoods(int a1, int a2, long a3) {
  
  int result; // eax

  if ( a2 <= 0 )
    return result;
  result = dword_3EFD460 + 2 * dword_3EFD464 * a2;
  *(_WORD *)(result + 2 * a1) = a3;
  return result;
}


// address=[0x13cce40]
// Decompiled from void InitMaxvalueGoods()
void __cdecl InitMaxvalueGoods(void) {
  
  CHAR Str[64]; // [esp+0h] [ebp-44h] BYREF

  *(float *)&dword_3EFD474 = 178.0 / *(float *)&dword_3EFD478;
  _wsprintfA(Str, "%d", (int)*(float *)&dword_3EFD478);
  IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1476, Str);
  UpdateGuiDlgStatisticGoods();
}


// address=[0x13cceb0]
// Decompiled from int __usercall DrawGoodsGrid@<xmm0>()
void __cdecl DrawGoodsGrid(void) {
  
  int result; // xmm0_4
  LPARAM data; // [esp+0h] [ebp-Ch]
  int yStart; // [esp+4h] [ebp-8h]
  int xStart; // [esp+8h] [ebp-4h]

  data = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(50, 100, 50);
  for ( xStart = 20; (float)xStart < 300.0; xStart += 20 )
    LineDDA(xStart, 0, xStart, 179, LineCallbackGoods, data);
  for ( yStart = 20; ; yStart += 20 )
  {
    *(float *)&result = (float)yStart;
    if ( (float)yStart >= 179.0 )
      break;
    LineDDA(0, yStart, 299, yStart, LineCallbackGoods, data);
  }
  return result;
}


// address=[0x13ccf60]
// Decompiled from void DrawGoodsGraph()
void __cdecl DrawGoodsGraph(void) {
  
  unsigned int v0; // eax
  unsigned int v1; // eax
  unsigned int v2; // eax
  LPARAM v3; // [esp+4h] [ebp-8Ch]
  int v4; // [esp+8h] [ebp-88h]
  LPARAM data; // [esp+Ch] [ebp-84h]
  LPARAM dataa; // [esp+Ch] [ebp-84h]
  LPARAM datab; // [esp+Ch] [ebp-84h]
  int v8; // [esp+10h] [ebp-80h]
  int LocalPlayerId; // [esp+10h] [ebp-80h]
  int v10; // [esp+10h] [ebp-80h]
  int yStart; // [esp+14h] [ebp-7Ch]
  int yStarta; // [esp+14h] [ebp-7Ch]
  int yStartb; // [esp+14h] [ebp-7Ch]
  int xStart; // [esp+18h] [ebp-78h]
  int xStarta; // [esp+18h] [ebp-78h]
  int xStartb; // [esp+18h] [ebp-78h]
  int yEnd; // [esp+1Ch] [ebp-74h]
  int yEnda; // [esp+1Ch] [ebp-74h]
  int yEndb; // [esp+1Ch] [ebp-74h]
  int yEndc; // [esp+1Ch] [ebp-74h]
  int yEndd; // [esp+1Ch] [ebp-74h]
  int yEnde; // [esp+1Ch] [ebp-74h]
  int v23; // [esp+20h] [ebp-70h]
  int v24; // [esp+20h] [ebp-70h]
  int v25; // [esp+20h] [ebp-70h]
  int n; // [esp+24h] [ebp-6Ch]
  int ii; // [esp+24h] [ebp-6Ch]
  int i; // [esp+24h] [ebp-6Ch]
  int j; // [esp+24h] [ebp-6Ch]
  int k; // [esp+24h] [ebp-6Ch]
  int m; // [esp+24h] [ebp-6Ch]
  int xEnd; // [esp+28h] [ebp-68h]
  int xEnda; // [esp+28h] [ebp-68h]
  int xEndb; // [esp+28h] [ebp-68h]
  int xEndc; // [esp+28h] [ebp-68h]
  int xEndd; // [esp+28h] [ebp-68h]
  int xEnde; // [esp+28h] [ebp-68h]
  int v38; // [esp+2Ch] [ebp-64h]
  int v39; // [esp+2Ch] [ebp-64h]
  int v40; // [esp+2Ch] [ebp-64h]
  int v41; // [esp+2Ch] [ebp-64h]
  int v42; // [esp+2Ch] [ebp-64h]
  int v43; // [esp+2Ch] [ebp-64h]
  int v44; // [esp+2Ch] [ebp-64h]
  int v45; // [esp+2Ch] [ebp-64h]
  _BYTE v46[16]; // [esp+30h] [ebp-60h] BYREF
  int v47; // [esp+40h] [ebp-50h] BYREF
  int v48; // [esp+44h] [ebp-4Ch]
  int v49; // [esp+48h] [ebp-48h]
  CHAR Str[64]; // [esp+4Ch] [ebp-44h] BYREF

  IGuiEngine::EraseOwnerImage((IGuiEngine *)g_pGUIEngine, 76, 1471);
  IGuiEngine::LockOwnerImage(
    (IGuiEngine *)g_pGUIEngine,
    76,
    1471,
    (struct SGuiRect *)v46,
    (unsigned __int16 **)&dword_3EFD460,
    (unsigned int *)&dword_3EFD464);
  v4 = 0;
  if ( dword_3EFD460 )
  {
    dword_3EFD464 = (unsigned int)dword_3EFD464 >> 1;
    DrawGoodsGrid();
    v3 = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(255, 255, 255);
    if ( dword_3EFD46C )
    {
      if ( dword_3EFD46C == 1 )
      {
        if ( dword_3F2BCC0 >= 0 )
        {
          LocalPlayerId = CPlayerManager::GetLocalPlayerId(1);
          v1 = CPlayerManager::Color(LocalPlayerId);
          IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v1, (struct SGfxColor *)&v47);
          dataa = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v47, v48, v49);
          v24 = 15;
          v41 = dword_3F32B24[784 * LocalPlayerId + 16 * dword_3EFD468 + dword_3F2BCC0];
          _wsprintfA(Str, "%d", v41);
          IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1475, Str);
          yStarta = (int)(float)(178.0 - (float)((float)v41 * *(float *)&dword_3EFD474));
          xStarta = (int)(float)((float)15 * *(float *)&dword_3EFD470);
          for ( i = dword_3F2BCC0; i >= 0; --i )
          {
            v42 = dword_3F32B24[784 * LocalPlayerId + 16 * dword_3EFD468 + i];
            if ( v42 > v4 )
              v4 = dword_3F32B24[784 * LocalPlayerId + 16 * dword_3EFD468 + i];
            yEndb = (int)(float)(178.0 - (float)((float)v42 * *(float *)&dword_3EFD474));
            xEndb = (int)(float)((float)v24 * *(float *)&dword_3EFD470);
            LineDDA(xStarta, yStarta, xEndb, yEndb, LineCallbackGoods, dataa);
            LineDDA(xStarta, yStarta + 1, xEndb, yEndb + 1, LineCallbackGoods, dataa);
            xStarta = xEndb;
            yStarta = yEndb;
            if ( v24 == dword_3EFD47C )
            {
              _wsprintfA(Str, "%d", v42);
              IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1475, Str);
              LineDDA(xEndb, 0, xEndb, 179, LineCallbackGoods, v3);
            }
            --v24;
          }
          for ( j = dword_3F2BCC4 - 1; j > dword_3F2BCC0; --j )
          {
            v43 = dword_3F32B24[784 * LocalPlayerId + 16 * dword_3EFD468 + j];
            if ( v43 > v4 )
              v4 = dword_3F32B24[784 * LocalPlayerId + 16 * dword_3EFD468 + j];
            yEndc = (int)(float)(178.0 - (float)((float)v43 * *(float *)&dword_3EFD474));
            xEndc = (int)(float)((float)v24 * *(float *)&dword_3EFD470);
            LineDDA(xStarta, yStarta, xEndc, yEndc, LineCallbackGoods, dataa);
            LineDDA(xStarta, yStarta + 1, xEndc, yEndc + 1, LineCallbackGoods, dataa);
            xStarta = xEndc;
            yStarta = yEndc;
            if ( v24 == dword_3EFD47C )
            {
              _wsprintfA(Str, "%d", v43);
              IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1475, Str);
              LineDDA(xEndc, 0, xEndc, 179, LineCallbackGoods, v3);
            }
            --v24;
          }
        }
      }
      else if ( dword_3EFD46C == 2 && dword_3F2BCD4 >= 0 )
      {
        v10 = CPlayerManager::GetLocalPlayerId(2);
        v2 = CPlayerManager::Color(v10);
        IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v2, (struct SGfxColor *)&v47);
        datab = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v47, v48, v49);
        v25 = 15;
        yStartb = (int)(float)(178.0
                             - (float)((float)dword_3F39964[784 * v10 + 16 * dword_3EFD468 + dword_3F2BCD4]
                                     * *(float *)&dword_3EFD474));
        xStartb = (int)(float)((float)15 * *(float *)&dword_3EFD470);
        for ( k = dword_3F2BCD4; k >= 0; --k )
        {
          v44 = dword_3F39964[784 * v10 + 16 * dword_3EFD468 + k];
          if ( v44 > v4 )
            v4 = dword_3F39964[784 * v10 + 16 * dword_3EFD468 + k];
          yEndd = (int)(float)(178.0 - (float)((float)v44 * *(float *)&dword_3EFD474));
          xEndd = (int)(float)((float)v25 * *(float *)&dword_3EFD470);
          LineDDA(xStartb, yStartb, xEndd, yEndd, LineCallbackGoods, datab);
          LineDDA(xStartb, yStartb + 1, xEndd, yEndd + 1, LineCallbackGoods, datab);
          xStartb = xEndd;
          yStartb = yEndd;
          if ( v25 == dword_3EFD47C )
          {
            _wsprintfA(Str, "%d", v44);
            IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1475, Str);
            LineDDA(xEndd, 0, xEndd, 179, LineCallbackGoods, v3);
          }
          --v25;
        }
        for ( m = dword_3F2BCD8 - 1; m > dword_3F2BCD4; --m )
        {
          v45 = dword_3F39964[784 * v10 + 16 * dword_3EFD468 + m];
          if ( v45 > v4 )
            v4 = dword_3F39964[784 * v10 + 16 * dword_3EFD468 + m];
          yEnde = (int)(float)(178.0 - (float)((float)v45 * *(float *)&dword_3EFD474));
          xEnde = (int)(float)((float)v25 * *(float *)&dword_3EFD470);
          LineDDA(xStartb, yStartb, xEnde, yEnde, LineCallbackGoods, datab);
          LineDDA(xStartb, yStartb + 1, xEnde, yEnde + 1, LineCallbackGoods, datab);
          xStartb = xEnde;
          yStartb = yEnde;
          if ( v25 == dword_3EFD47C )
          {
            _wsprintfA(Str, "%d", v45);
            IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1475, Str);
            LineDDA(xEnde, 0, xEnde, 179, LineCallbackGoods, v3);
          }
          --v25;
        }
      }
    }
    else if ( dword_3F2BCAC >= 0 )
    {
      v8 = CPlayerManager::GetLocalPlayerId(0);
      v0 = CPlayerManager::Color(v8);
      IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v0, (struct SGfxColor *)&v47);
      data = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v47, v48, v49);
      v23 = 15;
      v38 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD468 + dword_3F2BCAC];
      *(float *)&dword_3EFD474 = 178.0 / *(float *)&dword_3EFD478;
      yStart = (int)(float)(178.0 - (float)((float)v38 * (float)(178.0 / *(float *)&dword_3EFD478)));
      xStart = (int)(float)((float)15 * *(float *)&dword_3EFD470);
      for ( n = dword_3F2BCAC; n >= 0; --n )
      {
        v39 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD468 + n];
        if ( v39 > v4 )
          v4 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD468 + n];
        yEnd = (int)(float)(178.0 - (float)((float)v39 * *(float *)&dword_3EFD474));
        xEnd = (int)(float)((float)v23 * *(float *)&dword_3EFD470);
        LineDDA(xStart, yStart, xEnd, yEnd, LineCallbackGoods, data);
        LineDDA(xStart, yStart + 1, xEnd, yEnd + 1, LineCallbackGoods, data);
        xStart = xEnd;
        yStart = yEnd;
        if ( v23 == dword_3EFD47C )
        {
          _wsprintfA(Str, "%d", v39);
          IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1475, Str);
          LineDDA(xEnd, 0, xEnd, 179, LineCallbackGoods, v3);
        }
        --v23;
      }
      for ( ii = dword_3F2BCB0 - 1; ii > dword_3F2BCAC; --ii )
      {
        v40 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD468 + ii];
        if ( v40 > v4 )
          v4 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD468 + ii];
        yEnda = (int)(float)(178.0 - (float)((float)v40 * *(float *)&dword_3EFD474));
        xEnda = (int)(float)((float)v23 * *(float *)&dword_3EFD470);
        LineDDA(xStart, yStart, xEnda, yEnda, LineCallbackGoods, data);
        LineDDA(xStart, yStart + 1, xEnda, yEnda + 1, LineCallbackGoods, data);
        xStart = xEnda;
        yStart = yEnda;
        if ( v23 == dword_3EFD47C )
        {
          _wsprintfA(Str, "%d", v40);
          IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1475, Str);
          LineDDA(xEnda, 0, xEnda, 179, LineCallbackGoods, v3);
        }
        --v23;
      }
    }
  }
  IGuiEngine::UnlockOwnerImage((IGuiEngine *)g_pGUIEngine, 76, 1471);
  if ( byte_3EFD45C )
  {
    byte_3EFD45C = 0;
    *(float *)&dword_3EFD478 = (float)v4;
    if ( (float)v4 < 10.0 )
      dword_3EFD478 = LODWORD(FLOAT_10_0);
    InitMaxvalueGoods();
  }
}


// address=[0x13cdac0]
// Decompiled from void UpdateGuiDlgStatisticGoods()
void __cdecl UpdateGuiDlgStatisticGoods(void) {
  
  DrawGoodsGraph();
}


// address=[0x13cdad0]
// Decompiled from char InitGuiDlgStatisticGoods()
void __cdecl InitGuiDlgStatisticGoods(void) {
  
  char result; // al

  if ( !g_pStringEngine )
    return result;
  IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1477, "0");
  return IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1481, " ");
}


// address=[0x13cdb30]
// Decompiled from char InitGoodsRange()
void __cdecl InitGoodsRange(void) {
  
  char result; // al
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax

  result = dword_3EFD46C;
  if ( dword_3EFD46C )
  {
    if ( dword_3EFD46C == 1 )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1478, "0");
      v2 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 928);
      IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1479, v2);
      v3 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 927);
      result = IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1480, v3);
      dword_3EFD47C = 15;
      *(float *)&dword_3EFD470 = 299.0 / 15.0;
    }
    else if ( dword_3EFD46C == 2 )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1478, "0");
      v4 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 929);
      IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1479, v4);
      v5 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 926);
      result = IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1480, v5);
      dword_3EFD47C = 15;
      *(float *)&dword_3EFD470 = 299.0 / 15.0;
    }
  }
  else
  {
    IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1478, "0");
    IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1479, " ");
    v1 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 925);
    result = IGuiEngine::SetText((void *)g_pGUIEngine, 76, 1480, v1);
    dword_3EFD47C = 15;
    *(float *)&dword_3EFD470 = 299.0 / 15.0;
  }
  return result;
}


// address=[0x13cdd10]
// Decompiled from char __cdecl GuiDlgStatisticGoodsProc(int a1, int a2, int a3)
bool __cdecl GuiDlgStatisticGoodsProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD45D = 1;
      dword_3EFD460 = 0;
      dword_3EFD478 = LODWORD(FLOAT_100_0);
      InitMaxvalueGoods();
      InitGuiDlgStatisticGoods();
      dword_3EFD46C = 0;
      dword_3EFD468 = 0;
      dword_3EFD470 = LODWORD(FLOAT_19_933332);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 76, 1472, 1);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 76, 1484, 1);
      byte_3EFD45D = 0;
      InitGoodsRange();
      UpdateGuiDlgStatisticGoods();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      PlayGuiSound(2);
      if ( (unsigned __int16)a2 > 0xB2Eu )
      {
        switch ( (__int16)a2 )
        {
          case 2863:
            byte_3EFD45C = 1;
            dword_3EFD468 = 36;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2864:
            byte_3EFD45C = 1;
            dword_3EFD468 = 43;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2883:
            byte_3EFD45C = 1;
            dword_3EFD468 = 46;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2884:
            byte_3EFD45C = 1;
            dword_3EFD468 = 44;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2885:
            byte_3EFD45C = 1;
            dword_3EFD468 = 45;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2886:
            byte_3EFD45C = 1;
            dword_3EFD468 = 48;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2887:
            byte_3EFD45C = 1;
            dword_3EFD468 = 47;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2908:
            byte_3EFD45C = 1;
            dword_3EFD468 = 11;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2909:
            byte_3EFD45C = 1;
            dword_3EFD468 = 32;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2910:
            byte_3EFD45C = 1;
            dword_3EFD468 = 29;
            UpdateGuiDlgStatisticGoods();
            break;
          case 2911:
            byte_3EFD45C = 1;
            dword_3EFD468 = 25;
            UpdateGuiDlgStatisticGoods();
            break;
          default:
            return 1;
        }
      }
      else if ( (unsigned __int16)a2 == 2862 )
      {
        byte_3EFD45C = 1;
        dword_3EFD468 = 8;
        UpdateGuiDlgStatisticGoods();
      }
      else
      {
        switch ( (__int16)a2 )
        {
          case 1472:
            dword_3EFD46C = 0;
            if ( !byte_3EFD45D )
              goto LABEL_32;
            return 1;
          case 1473:
            dword_3EFD46C = 1;
            if ( !byte_3EFD45D )
              goto LABEL_32;
            return 1;
          case 1474:
            dword_3EFD46C = 2;
            if ( !byte_3EFD45D )
            {
LABEL_32:
              InitGoodsRange();
              UpdateGuiDlgStatisticGoods();
            }
            break;
          case 1482:
            if ( ++dword_3EFD47C > 15 )
              dword_3EFD47C = 15;
            goto LABEL_34;
          case 1483:
            if ( --dword_3EFD47C < 0 )
              dword_3EFD47C = 0;
            goto LABEL_34;
          case 1484:
            dword_3EFD468 = 28;
            if ( !byte_3EFD45D )
              goto LABEL_34;
            break;
          case 1485:
            byte_3EFD45C = 1;
            dword_3EFD468 = 38;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1486:
            byte_3EFD45C = 1;
            dword_3EFD468 = 13;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1487:
            byte_3EFD45C = 1;
            dword_3EFD468 = 26;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1488:
            byte_3EFD45C = 1;
            dword_3EFD468 = 20;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1489:
            byte_3EFD45C = 1;
            dword_3EFD468 = 15;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1490:
            byte_3EFD45C = 1;
            dword_3EFD468 = 40;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1491:
            byte_3EFD45C = 1;
            dword_3EFD468 = 24;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1492:
            byte_3EFD45C = 1;
            dword_3EFD468 = 12;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1493:
            byte_3EFD45C = 1;
            dword_3EFD468 = 16;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1494:
            *(float *)&dword_3EFD478 = *(float *)&dword_3EFD478 - (float)(*(float *)&dword_3EFD478 / 10.0);
            if ( *(float *)&dword_3EFD478 < 10.0 )
              dword_3EFD478 = LODWORD(FLOAT_10_0);
            goto LABEL_87;
          case 1495:
            *(float *)&dword_3EFD478 = (float)(*(float *)&dword_3EFD478 / 10.0) + *(float *)&dword_3EFD478;
            if ( *(float *)&dword_3EFD478 > 9999.0 )
              dword_3EFD478 = LODWORD(FLOAT_9999_0);
            goto LABEL_87;
          case 1496:
            byte_3EFD45C = 1;
            dword_3EFD468 = 21;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1497:
            byte_3EFD45C = 1;
            dword_3EFD468 = 27;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1498:
            byte_3EFD45C = 1;
            dword_3EFD468 = 14;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1499:
            byte_3EFD45C = 1;
            dword_3EFD468 = 9;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1500:
            byte_3EFD45C = 1;
            dword_3EFD468 = 39;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1501:
            byte_3EFD45C = 1;
            dword_3EFD468 = 19;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1502:
            byte_3EFD45C = 1;
            dword_3EFD468 = 17;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1503:
            byte_3EFD45C = 1;
            dword_3EFD468 = 30;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1504:
            byte_3EFD45C = 1;
            dword_3EFD468 = 22;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1505:
            byte_3EFD45C = 1;
            dword_3EFD468 = 18;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1506:
            byte_3EFD45C = 1;
            dword_3EFD468 = 7;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1507:
            byte_3EFD45C = 1;
            dword_3EFD468 = 41;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1508:
            byte_3EFD45C = 1;
            dword_3EFD468 = 37;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1509:
            byte_3EFD45C = 1;
            dword_3EFD468 = 34;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1510:
            byte_3EFD45C = 1;
            dword_3EFD468 = 35;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1511:
            byte_3EFD45C = 1;
            dword_3EFD468 = 31;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1512:
            byte_3EFD45C = 1;
            dword_3EFD468 = 33;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1513:
            byte_3EFD45C = 1;
            dword_3EFD468 = 10;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1517:
            byte_3EFD45C = 1;
            dword_3EFD468 = 23;
            UpdateGuiDlgStatisticGoods();
            break;
          case 1518:
            byte_3EFD45C = 1;
            dword_3EFD468 = 42;
            UpdateGuiDlgStatisticGoods();
            break;
          default:
            return 1;
        }
      }
      break;
    case 8:
      DrawGoodsGraph();
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698F02);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3698F03);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 10 )
      {
        if ( SHIWORD(a2) < 10 )
        {
          *(float *)&dword_3EFD478 = (float)(*(float *)&dword_3EFD478 / 10.0) + *(float *)&dword_3EFD478;
          if ( *(float *)&dword_3EFD478 > 9999.0 )
            dword_3EFD478 = LODWORD(FLOAT_9999_0);
          InitMaxvalueGoods();
        }
      }
      else
      {
        *(float *)&dword_3EFD478 = *(float *)&dword_3EFD478 - (float)(*(float *)&dword_3EFD478 / 10.0);
        if ( *(float *)&dword_3EFD478 < 10.0 )
          dword_3EFD478 = LODWORD(FLOAT_10_0);
LABEL_87:
        InitMaxvalueGoods();
      }
      break;
    case 11:
LABEL_34:
      UpdateGuiDlgStatisticGoods();
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13ced20]
// Decompiled from int __stdcall LineCallbackLand(int a1, int a2, __int16 a3)
void __stdcall LineCallbackLand(int a1, int a2, long a3) {
  
  int result; // eax

  if ( a2 <= 0 )
    return result;
  result = dword_3EFD48C + 2 * dword_3EFD490 * a2;
  *(_WORD *)(result + 2 * a1) = a3;
  return result;
}


// address=[0x13ced60]
// Decompiled from void InitMaxvalue()
void __cdecl InitMaxvalue(void) {
  
  CHAR Str[64]; // [esp+0h] [ebp-44h] BYREF

  *(float *)&dword_3EFD4CC = 178.0 / *(float *)&dword_3EFD4D0;
  _wsprintfA(Str, "%d", (int)*(float *)&dword_3EFD4D0);
  IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1547, Str);
  UpdateGuiDlgStatisticLand();
}


// address=[0x13cedd0]
// Decompiled from int __usercall DrawLandGrid@<xmm0>()
void __cdecl DrawLandGrid(void) {
  
  int result; // xmm0_4
  LPARAM data; // [esp+0h] [ebp-Ch]
  int yStart; // [esp+4h] [ebp-8h]
  int xStart; // [esp+8h] [ebp-4h]

  data = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(50, 100, 50);
  for ( xStart = 20; (float)xStart < 300.0; xStart += 20 )
    LineDDA(xStart, 0, xStart, 179, LineCallbackLand, data);
  for ( yStart = 20; ; yStart += 20 )
  {
    *(float *)&result = (float)yStart;
    if ( (float)yStart >= 179.0 )
      break;
    LineDDA(0, yStart, 299, yStart, LineCallbackLand, data);
  }
  return result;
}


// address=[0x13cee80]
// Decompiled from void DrawLandGraph()
void __cdecl DrawLandGraph(void) {
  
  unsigned int v0; // eax
  unsigned int v1; // eax
  unsigned int v2; // eax
  LPARAM v3; // [esp+4h] [ebp-90h]
  int v4; // [esp+8h] [ebp-8Ch]
  LPARAM data; // [esp+Ch] [ebp-88h]
  LPARAM dataa; // [esp+Ch] [ebp-88h]
  LPARAM datab; // [esp+Ch] [ebp-88h]
  int v8; // [esp+10h] [ebp-84h]
  int v9; // [esp+10h] [ebp-84h]
  int v10; // [esp+10h] [ebp-84h]
  int yStart; // [esp+14h] [ebp-80h]
  int yStarta; // [esp+14h] [ebp-80h]
  int yStartb; // [esp+14h] [ebp-80h]
  int xStart; // [esp+18h] [ebp-7Ch]
  int xStarta; // [esp+18h] [ebp-7Ch]
  int xStartb; // [esp+18h] [ebp-7Ch]
  int yEnd; // [esp+1Ch] [ebp-78h]
  int yEnda; // [esp+1Ch] [ebp-78h]
  int yEndb; // [esp+1Ch] [ebp-78h]
  int yEndc; // [esp+1Ch] [ebp-78h]
  int yEndd; // [esp+1Ch] [ebp-78h]
  int yEnde; // [esp+1Ch] [ebp-78h]
  int jj; // [esp+20h] [ebp-74h]
  int i; // [esp+20h] [ebp-74h]
  int m; // [esp+20h] [ebp-74h]
  int v26; // [esp+24h] [ebp-70h]
  int v27; // [esp+24h] [ebp-70h]
  int v28; // [esp+24h] [ebp-70h]
  int kk; // [esp+28h] [ebp-6Ch]
  int mm; // [esp+28h] [ebp-6Ch]
  int j; // [esp+28h] [ebp-6Ch]
  int k; // [esp+28h] [ebp-6Ch]
  int n; // [esp+28h] [ebp-6Ch]
  int ii; // [esp+28h] [ebp-6Ch]
  int xEnd; // [esp+2Ch] [ebp-68h]
  int xEnda; // [esp+2Ch] [ebp-68h]
  int xEndb; // [esp+2Ch] [ebp-68h]
  int xEndc; // [esp+2Ch] [ebp-68h]
  int xEndd; // [esp+2Ch] [ebp-68h]
  int xEnde; // [esp+2Ch] [ebp-68h]
  int v41; // [esp+30h] [ebp-64h]
  int v42; // [esp+30h] [ebp-64h]
  int v43; // [esp+30h] [ebp-64h]
  int v44; // [esp+30h] [ebp-64h]
  int v45; // [esp+30h] [ebp-64h]
  int v46; // [esp+30h] [ebp-64h]
  int v47; // [esp+30h] [ebp-64h]
  int v48; // [esp+30h] [ebp-64h]
  _BYTE v49[16]; // [esp+34h] [ebp-60h] BYREF
  int v50; // [esp+44h] [ebp-50h] BYREF
  int v51; // [esp+48h] [ebp-4Ch]
  int v52; // [esp+4Ch] [ebp-48h]
  CHAR Str[64]; // [esp+50h] [ebp-44h] BYREF

  v4 = 0;
  IGuiEngine::EraseOwnerImage((IGuiEngine *)g_pGUIEngine, 75, 1519);
  IGuiEngine::LockOwnerImage(
    (IGuiEngine *)g_pGUIEngine,
    75,
    1519,
    (struct SGuiRect *)v49,
    (unsigned __int16 **)&dword_3EFD48C,
    (unsigned int *)&dword_3EFD490);
  if ( dword_3EFD48C )
  {
    dword_3EFD490 = (unsigned int)dword_3EFD490 >> 1;
    DrawLandGrid();
    v3 = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(255, 255, 255);
    if ( dword_3EFD4C4 )
    {
      if ( dword_3EFD4C4 == 1 )
      {
        if ( dword_3F2BCC0 >= 0 )
        {
          for ( i = 0; i < dword_3EFD4BC; ++i )
          {
            v9 = dword_3EFD49C[i];
            if ( byte_3EFD494[i] )
            {
              v1 = CPlayerManager::Color(v9);
              IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v1, (struct SGfxColor *)&v50);
              dataa = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v50, v51, v52);
              v27 = 15;
              v44 = dword_3F32B24[784 * v9 + 16 * dword_3EFD4C0 + dword_3F2BCC0];
              _wsprintfA(Str, "%d", v44);
              IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * i + 2], Str);
              yStarta = (int)(float)(178.0 - (float)((float)v44 * *(float *)&dword_3EFD4CC));
              xStarta = (int)(float)((float)15 * *(float *)&dword_3EFD4C8);
              for ( j = dword_3F2BCC0; j >= 0; --j )
              {
                v45 = dword_3F32B24[784 * v9 + 16 * dword_3EFD4C0 + j];
                if ( v45 > v4 )
                  v4 = dword_3F32B24[784 * v9 + 16 * dword_3EFD4C0 + j];
                yEndb = (int)(float)(178.0 - (float)((float)v45 * *(float *)&dword_3EFD4CC));
                xEndb = (int)(float)((float)v27 * *(float *)&dword_3EFD4C8);
                LineDDA(xStarta, yStarta, xEndb, yEndb, LineCallbackLand, dataa);
                LineDDA(xStarta, yStarta + 1, xEndb, yEndb + 1, LineCallbackLand, dataa);
                xStarta = xEndb;
                yStarta = yEndb;
                if ( v27 == dword_3EFD4D4 )
                {
                  _wsprintfA(Str, "%d", v45);
                  IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * i + 2], Str);
                  LineDDA(xEndb, 0, xEndb, 179, LineCallbackLand, v3);
                }
                --v27;
              }
              for ( k = dword_3F2BCC4 - 1; k > dword_3F2BCC0; --k )
              {
                v46 = dword_3F32B24[784 * v9 + 16 * dword_3EFD4C0 + k];
                if ( v46 > v4 )
                  v4 = dword_3F32B24[784 * v9 + 16 * dword_3EFD4C0 + k];
                yEndc = (int)(float)(178.0 - (float)((float)v46 * *(float *)&dword_3EFD4CC));
                xEndc = (int)(float)((float)v27 * *(float *)&dword_3EFD4C8);
                LineDDA(xStarta, yStarta, xEndc, yEndc, LineCallbackLand, dataa);
                LineDDA(xStarta, yStarta + 1, xEndc, yEndc + 1, LineCallbackLand, dataa);
                xStarta = xEndc;
                yStarta = yEndc;
                if ( v27 == dword_3EFD4D4 )
                {
                  _wsprintfA(Str, "%d", v46);
                  IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * i + 2], Str);
                  LineDDA(xEndc, 0, xEndc, 179, LineCallbackLand, v3);
                }
                --v27;
              }
            }
          }
        }
      }
      else if ( dword_3EFD4C4 == 2 && dword_3F2BCD4 >= 0 )
      {
        for ( m = 0; m < dword_3EFD4BC; ++m )
        {
          v10 = dword_3EFD49C[m];
          if ( byte_3EFD494[m] )
          {
            v2 = CPlayerManager::Color(v10);
            IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v2, (struct SGfxColor *)&v50);
            datab = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v50, v51, v52);
            v28 = 15;
            yStartb = (int)(float)(178.0
                                 - (float)((float)dword_3F39964[784 * v10 + 16 * dword_3EFD4C0 + dword_3F2BCD4]
                                         * *(float *)&dword_3EFD4CC));
            xStartb = (int)(float)((float)15 * *(float *)&dword_3EFD4C8);
            for ( n = dword_3F2BCD4; n >= 0; --n )
            {
              v47 = dword_3F39964[784 * v10 + 16 * dword_3EFD4C0 + n];
              if ( v47 > v4 )
                v4 = dword_3F39964[784 * v10 + 16 * dword_3EFD4C0 + n];
              yEndd = (int)(float)(178.0 - (float)((float)v47 * *(float *)&dword_3EFD4CC));
              xEndd = (int)(float)((float)v28 * *(float *)&dword_3EFD4C8);
              LineDDA(xStartb, yStartb, xEndd, yEndd, LineCallbackLand, datab);
              LineDDA(xStartb, yStartb + 1, xEndd, yEndd + 1, LineCallbackLand, datab);
              xStartb = xEndd;
              yStartb = yEndd;
              if ( v28 == dword_3EFD4D4 )
              {
                _wsprintfA(Str, "%d", v47);
                IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * m + 2], Str);
                LineDDA(xEndd, 0, xEndd, 179, LineCallbackLand, v3);
              }
              --v28;
            }
            for ( ii = dword_3F2BCD8 - 1; ii > dword_3F2BCD4; --ii )
            {
              v48 = dword_3F39964[784 * v10 + 16 * dword_3EFD4C0 + ii];
              if ( v48 > v4 )
                v4 = dword_3F39964[784 * v10 + 16 * dword_3EFD4C0 + ii];
              yEnde = (int)(float)(178.0 - (float)((float)v48 * *(float *)&dword_3EFD4CC));
              xEnde = (int)(float)((float)v28 * *(float *)&dword_3EFD4C8);
              LineDDA(xStartb, yStartb, xEnde, yEnde, LineCallbackLand, datab);
              LineDDA(xStartb, yStartb + 1, xEnde, yEnde + 1, LineCallbackLand, datab);
              xStartb = xEnde;
              yStartb = yEnde;
              if ( v28 == dword_3EFD4D4 )
              {
                _wsprintfA(Str, "%d", v48);
                IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * m + 2], Str);
                LineDDA(xEnde, 0, xEnde, 179, LineCallbackLand, v3);
              }
              --v28;
            }
          }
        }
      }
    }
    else if ( dword_3F2BCAC >= 0 )
    {
      for ( jj = 0; jj < dword_3EFD4BC; ++jj )
      {
        v8 = dword_3EFD49C[jj];
        if ( byte_3EFD494[jj] )
        {
          v0 = CPlayerManager::Color(v8);
          IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v0, (struct SGfxColor *)&v50);
          data = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v50, v51, v52);
          v26 = 15;
          v41 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD4C0 + dword_3F2BCAC];
          *(float *)&dword_3EFD4CC = 178.0 / *(float *)&dword_3EFD4D0;
          yStart = (int)(float)(178.0 - (float)((float)v41 * (float)(178.0 / *(float *)&dword_3EFD4D0)));
          xStart = (int)(float)((float)15 * *(float *)&dword_3EFD4C8);
          for ( kk = dword_3F2BCAC; kk >= 0; --kk )
          {
            v42 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD4C0 + kk];
            if ( v42 > v4 )
              v4 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD4C0 + kk];
            yEnd = (int)(float)(178.0 - (float)((float)v42 * *(float *)&dword_3EFD4CC));
            xEnd = (int)(float)((float)v26 * *(float *)&dword_3EFD4C8);
            LineDDA(xStart, yStart, xEnd, yEnd, LineCallbackLand, data);
            LineDDA(xStart, yStart + 1, xEnd, yEnd + 1, LineCallbackLand, data);
            xStart = xEnd;
            yStart = yEnd;
            if ( v26 == dword_3EFD4D4 )
            {
              _wsprintfA(Str, "%d", v42);
              IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * jj + 2], Str);
              LineDDA(xEnd, 0, xEnd, 179, LineCallbackLand, v3);
            }
            --v26;
          }
          for ( mm = dword_3F2BCB0 - 1; mm > dword_3F2BCAC; --mm )
          {
            v43 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD4C0 + mm];
            if ( v43 > v4 )
              v4 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD4C0 + mm];
            yEnda = (int)(float)(178.0 - (float)((float)v43 * *(float *)&dword_3EFD4CC));
            xEnda = (int)(float)((float)v26 * *(float *)&dword_3EFD4C8);
            LineDDA(xStart, yStart, xEnda, yEnda, LineCallbackLand, data);
            LineDDA(xStart, yStart + 1, xEnda, yEnda + 1, LineCallbackLand, data);
            xStart = xEnda;
            yStart = yEnda;
            if ( v26 == dword_3EFD4D4 )
            {
              _wsprintfA(Str, "%d", v43);
              IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * jj + 2], Str);
              LineDDA(xEnda, 0, xEnda, 179, LineCallbackLand, v3);
            }
            --v26;
          }
        }
      }
    }
  }
  IGuiEngine::UnlockOwnerImage((IGuiEngine *)g_pGUIEngine, 75, 1519);
  if ( byte_3EFD488 )
  {
    byte_3EFD488 = 0;
    *(float *)&dword_3EFD4D0 = (float)v4;
    if ( (float)v4 < 10.0 )
      dword_3EFD4D0 = LODWORD(FLOAT_10_0);
    InitMaxvalue();
  }
}


// address=[0x13cfb30]
// Decompiled from void UpdateGuiDlgStatisticLand()
void __cdecl UpdateGuiDlgStatisticLand(void) {
  
  DrawLandGraph();
}


// address=[0x13cfb40]
// Decompiled from void InitGuiDlgStatisticLand()
void __cdecl InitGuiDlgStatisticLand(void) {
  
  CPlayerInfo *v0; // eax
  const wchar_t *v1; // eax
  int v2; // edi
  CPlayerInfo *v3; // eax
  const wchar_t *v4; // eax
  int v5; // [esp+0h] [ebp-164h]
  _Cnd_internal_imp_t *v6; // [esp+8h] [ebp-15Ch]
  _Cnd_internal_imp_t *v7; // [esp+Ch] [ebp-158h]
  int v8; // [esp+10h] [ebp-154h]
  int LocalPlayerId; // [esp+14h] [ebp-150h]
  int v10; // [esp+20h] [ebp-144h]
  int v11; // [esp+20h] [ebp-144h]
  int i; // [esp+24h] [ebp-140h]
  int j; // [esp+24h] [ebp-140h]
  int k; // [esp+24h] [ebp-140h]
  _BYTE v15[28]; // [esp+28h] [ebp-13Ch] BYREF
  _BYTE v16[28]; // [esp+44h] [ebp-120h] BYREF
  char Dest[256]; // [esp+60h] [ebp-104h] BYREF

  if ( g_pStringEngine )
  {
    IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1548, "0");
    dword_3EFD4BC = 0;
    for ( i = 0; i < 8; ++i )
    {
      if ( (unsigned int)i >= 8 )
        j____report_rangecheckfailure();
      byte_3EFD494[i] = 0;
      dword_3EFD49C[i] = -1;
    }
    LocalPlayerId = CPlayerManager::GetLocalPlayerId(v5);
    v8 = CAlliances::AllianceId(LocalPlayerId);
    for ( j = 1; j <= CPlayerManager::LastPlayerId(); ++j )
    {
      if ( CGameData::IsNetworkGame(g_pGameData) )
      {
        if ( CAlliances::AllianceId(j) == v8 )
        {
          v10 = CPlayerManager::Color(j);
          v0 = CPlayerManager::PlayerInfo(j);
          v7 = (_Cnd_internal_imp_t *)CPlayerInfo::Name(v0);
          v1 = (const wchar_t *)std::wstring::c_str(v7);
          j__wcstombs(Dest, v1, 0x100u);
          std::wstring::~wstring(v16);
          dword_3EFD49C[dword_3EFD4BC] = j;
          IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * dword_3EFD4BC], Dest);
          IGuiEngine::SetImages(
            (void *)g_pGUIEngine,
            75,
            dword_3D891D8[3 * dword_3EFD4BC + 1],
            dword_3D89238[2 * v10 + 1],
            dword_3D89238[2 * v10]);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * dword_3EFD4BC], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * dword_3EFD4BC + 1], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * dword_3EFD4BC + 2], 1);
          ++dword_3EFD4BC;
        }
      }
      else
      {
        v2 = CPlayerManager::NumberOfPlayers();
        if ( j - 1 < v2 - CStatistic::GetDontShowLastNPlayers((CStatistic *)&g_cStatistic) )
        {
          dword_3EFD49C[dword_3EFD4BC++] = j;
          v11 = CPlayerManager::Color(j);
          v3 = CPlayerManager::PlayerInfo(j);
          v6 = (_Cnd_internal_imp_t *)CPlayerInfo::Name(v3);
          v4 = (const wchar_t *)std::wstring::c_str(v6);
          j__wcstombs(Dest, v4, 0x100u);
          std::wstring::~wstring(v15);
          IGuiEngine::SetText((void *)g_pGUIEngine, 75, dword_3D891D8[3 * j - 3], Dest);
          IGuiEngine::SetImages(
            (void *)g_pGUIEngine,
            75,
            dword_3D891D8[3 * j - 2],
            dword_3D89238[2 * v11 + 1],
            dword_3D89238[2 * v11]);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * j - 3], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * j - 2], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * j - 1], 1);
        }
      }
    }
    for ( k = 0; k < 8; ++k )
    {
      if ( k >= dword_3EFD4BC )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * k], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * k + 1], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 75, dword_3D891D8[3 * k + 2], 0);
      }
      else
      {
        IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 75, dword_3D891D8[3 * k + 1], 1);
      }
    }
  }
}


// address=[0x13d00a0]
// Decompiled from char InitLandRange()
void __cdecl InitLandRange(void) {
  
  char result; // al
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax

  result = dword_3EFD4C4;
  if ( dword_3EFD4C4 )
  {
    if ( dword_3EFD4C4 == 1 )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1549, "0");
      v2 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 928);
      IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1550, v2);
      v3 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 927);
      result = IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1551, v3);
      dword_3EFD4D4 = 15;
      *(float *)&dword_3EFD4C8 = 299.0 / 15.0;
    }
    else if ( dword_3EFD4C4 == 2 )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1549, "0");
      v4 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 929);
      IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1550, v4);
      v5 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 926);
      result = IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1551, v5);
      dword_3EFD4D4 = 15;
      *(float *)&dword_3EFD4C8 = 299.0 / 15.0;
    }
  }
  else
  {
    IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1549, "0");
    IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1550, " ");
    v1 = (char *)(*(int (__thiscall **)(int, int))(*(_DWORD *)g_pStringEngine + 4))(g_pStringEngine, 925);
    result = IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1551, v1);
    dword_3EFD4D4 = 15;
    *(float *)&dword_3EFD4C8 = 299.0 / 15.0;
  }
  return result;
}


// address=[0x13d0280]
// Decompiled from char __cdecl GuiDlgStatisticLandProc(int a1, int a2, int a3)
bool __cdecl GuiDlgStatisticLandProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      dword_3EFD48C = 0;
      dword_3EFD4D0 = LODWORD(FLOAT_100_0);
      dword_3EFD4BC = 0;
      byte_3EFD489 = 1;
      InitMaxvalue();
      InitGuiDlgStatisticLand();
      dword_3EFD4C4 = 0;
      dword_3EFD4C0 = 0;
      dword_3EFD4C8 = LODWORD(FLOAT_19_933332);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 75, 1520, 1);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 75, 1555, 1);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 75, 1523, 1);
      byte_3EFD489 = 0;
      InitLandRange();
      UpdateGuiDlgStatisticLand();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      PlayGuiSound(2);
      switch ( (__int16)a2 )
      {
        case 1520:
          dword_3EFD4C4 = 0;
          if ( !byte_3EFD489 )
            goto LABEL_29;
          return 1;
        case 1521:
          dword_3EFD4C4 = 1;
          if ( !byte_3EFD489 )
            goto LABEL_29;
          return 1;
        case 1522:
          dword_3EFD4C4 = 2;
          if ( !byte_3EFD489 )
          {
LABEL_29:
            InitLandRange();
            UpdateGuiDlgStatisticLand();
          }
          break;
        case 1523:
          byte_3EFD488 = 1;
          byte_3EFD494[0] = byte_3EFD494[0] == 0;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1524:
          byte_3EFD488 = 1;
          if ( byte_3EFD494[1] )
            byte_3EFD494[1] = 0;
          else
            byte_3EFD494[1] = 1;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1525:
          byte_3EFD488 = 1;
          if ( byte_3EFD494[2] )
            byte_3EFD494[2] = 0;
          else
            byte_3EFD494[2] = 1;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1526:
          byte_3EFD488 = 1;
          if ( byte_3EFD494[3] )
            byte_3EFD494[3] = 0;
          else
            byte_3EFD494[3] = 1;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1527:
          byte_3EFD488 = 1;
          if ( byte_3EFD494[4] )
            byte_3EFD494[4] = 0;
          else
            byte_3EFD494[4] = 1;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1528:
          byte_3EFD488 = 1;
          if ( byte_3EFD494[5] )
            byte_3EFD494[5] = 0;
          else
            byte_3EFD494[5] = 1;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1529:
          byte_3EFD488 = 1;
          if ( byte_3EFD494[6] )
            byte_3EFD494[6] = 0;
          else
            byte_3EFD494[6] = 1;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1530:
          byte_3EFD488 = 1;
          if ( byte_3EFD494[7] )
            byte_3EFD494[7] = 0;
          else
            byte_3EFD494[7] = 1;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1553:
          if ( ++dword_3EFD4D4 > 15 )
            dword_3EFD4D4 = 15;
          goto LABEL_72;
        case 1554:
          if ( --dword_3EFD4D4 < 0 )
            dword_3EFD4D4 = 0;
          goto LABEL_72;
        case 1555:
          byte_3EFD488 = 1;
          IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1552, "%");
          dword_3EFD4C0 = 0;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1556:
          byte_3EFD488 = 1;
          IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1552, (char *)&byte_3698F6F);
          dword_3EFD4C0 = 2;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1557:
          byte_3EFD488 = 1;
          IGuiEngine::SetText((void *)g_pGUIEngine, 75, 1552, (char *)&byte_3698F73);
          dword_3EFD4C0 = 1;
          if ( !byte_3EFD489 )
            goto LABEL_72;
          break;
        case 1558:
          *(float *)&dword_3EFD4D0 = (float)(*(float *)&dword_3EFD4D0 / 10.0) + *(float *)&dword_3EFD4D0;
          if ( *(float *)&dword_3EFD4D0 > 9999.0 )
            dword_3EFD4D0 = LODWORD(FLOAT_9999_0);
          goto LABEL_84;
        case 1559:
          *(float *)&dword_3EFD4D0 = *(float *)&dword_3EFD4D0 - (float)(*(float *)&dword_3EFD4D0 / 10.0);
          if ( *(float *)&dword_3EFD4D0 < 10.0 )
            dword_3EFD4D0 = LODWORD(FLOAT_10_0);
          goto LABEL_84;
        default:
          return 1;
      }
      break;
    case 8:
      DrawLandGraph();
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698F67);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3698F6B);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 10 )
      {
        if ( SHIWORD(a2) < 10 )
        {
          *(float *)&dword_3EFD4D0 = (float)(*(float *)&dword_3EFD4D0 / 10.0) + *(float *)&dword_3EFD4D0;
          if ( *(float *)&dword_3EFD4D0 > 9999.0 )
            dword_3EFD4D0 = LODWORD(FLOAT_9999_0);
          InitMaxvalue();
        }
      }
      else
      {
        *(float *)&dword_3EFD4D0 = *(float *)&dword_3EFD4D0 - (float)(*(float *)&dword_3EFD4D0 / 10.0);
        if ( *(float *)&dword_3EFD4D0 < 10.0 )
          dword_3EFD4D0 = LODWORD(FLOAT_10_0);
LABEL_84:
        InitMaxvalue();
      }
      break;
    case 11:
LABEL_72:
      UpdateGuiDlgStatisticLand();
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d12d0]
// Decompiled from char __cdecl GuiDlgStatisticSubmenuProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgStatisticSubmenuProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-90h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-88h]
  CEvn_Logic *v8; // [esp+14h] [ebp-80h]
  unsigned int v9; // [esp+20h] [ebp-74h]
  _BYTE v10[32]; // [esp+24h] [ebp-70h] BYREF
  _BYTE v11[32]; // [esp+44h] [ebp-50h] BYREF
  _BYTE v12[32]; // [esp+64h] [ebp-30h] BYREF
  int v13; // [esp+90h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 6, 1560, 1);
      break;
    case 1:
      if ( (S4HiWord(a2) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      v9 = S4LoWord(a2);
      switch ( v9 )
      {
        case 0x618u:
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x192u, 0, 0, 0, 0, 0);
          v13 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v13 = -1;
          CEvn_Logic::~CEvn_Logic(v12);
          if ( g_pGuiMainEvents )
          {
            if ( *(_DWORD *)(g_pGuiMainEvents + 12) != -1 )
            {
              IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 12));
              *(_DWORD *)(g_pGuiMainEvents + 12) = -1;
            }
            IGuiEngine::OpenDialog((IGuiEngine *)g_pGUIEngine, 28, GuiDlgStatisticWarriorProc);
            *(_DWORD *)(g_pGuiMainEvents + 12) = 28;
            UpdateGuiDlgStatisticWarrior();
          }
          break;
        case 0x619u:
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v11, 0x192u, 0, 0, 0, 0, 0);
          v13 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v13 = -1;
          CEvn_Logic::~CEvn_Logic(v11);
          if ( g_pGuiMainEvents )
          {
            if ( *(_DWORD *)(g_pGuiMainEvents + 12) != -1 )
            {
              IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 12));
              *(_DWORD *)(g_pGuiMainEvents + 12) = -1;
            }
            IGuiEngine::OpenDialog(
              (IGuiEngine *)g_pGUIEngine,
              75,
              (bool (__cdecl *)(int, int, int))GuiDlgStatisticLandProc);
            *(_DWORD *)(g_pGuiMainEvents + 12) = 75;
            UpdateGuiDlgStatisticLand();
          }
          break;
        case 0x61Au:
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v10, 0x192u, 0, 0, 0, 0, 0);
          v13 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v13 = -1;
          CEvn_Logic::~CEvn_Logic(v10);
          if ( g_pGuiMainEvents )
          {
            if ( *(_DWORD *)(g_pGuiMainEvents + 12) != -1 )
            {
              IGuiEngine::CloseDialog((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 12));
              *(_DWORD *)(g_pGuiMainEvents + 12) = -1;
            }
            IGuiEngine::OpenDialog(
              (IGuiEngine *)g_pGUIEngine,
              76,
              (bool (__cdecl *)(int, int, int))GuiDlgStatisticGoodsProc);
            *(_DWORD *)(g_pGuiMainEvents + 12) = 76;
            UpdateGuiDlgStatisticGoods();
          }
          break;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698FA4);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_3698FA5);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d1750]
// Decompiled from int __stdcall LineCallback(int a1, int a2, __int16 a3)
void __stdcall LineCallback(int a1, int a2, long a3) {
  
  int result; // eax

  if ( a2 <= 0 )
    return result;
  result = dword_3EFD4EC + 2 * dword_3EFD4F0 * a2;
  *(_WORD *)(result + 2 * a1) = a3;
  return result;
}


// address=[0x13d1790]
// Decompiled from void InitMaxvalueWarrior()
void __cdecl InitMaxvalueWarrior(void) {
  
  CHAR Str[64]; // [esp+0h] [ebp-44h] BYREF

  *(float *)&dword_3EFD52C = 178.0 / *(float *)&dword_3EFD530;
  _wsprintfA(Str, "%d", (int)*(float *)&dword_3EFD530);
  IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1591, Str);
  UpdateGuiDlgStatisticWarrior();
}


// address=[0x13d1800]
// Decompiled from int __usercall DrawGrid@<xmm0>()
void __cdecl DrawGrid(void) {
  
  int result; // xmm0_4
  LPARAM data; // [esp+0h] [ebp-Ch]
  int yStart; // [esp+4h] [ebp-8h]
  int xStart; // [esp+8h] [ebp-4h]

  data = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(50, 100, 50);
  for ( xStart = 20; (float)xStart < 300.0; xStart += 20 )
    LineDDA(xStart, 0, xStart, 179, LineCallback, data);
  for ( yStart = 20; ; yStart += 20 )
  {
    *(float *)&result = (float)yStart;
    if ( (float)yStart >= 179.0 )
      break;
    LineDDA(0, yStart, 299, yStart, LineCallback, data);
  }
  return result;
}


// address=[0x13d18b0]
// Decompiled from void DrawGraph()
void __cdecl DrawGraph(void) {
  
  unsigned int v0; // eax
  unsigned int v1; // eax
  unsigned int v2; // eax
  LPARAM v3; // [esp+4h] [ebp-90h]
  int v4; // [esp+8h] [ebp-8Ch]
  LPARAM data; // [esp+Ch] [ebp-88h]
  LPARAM dataa; // [esp+Ch] [ebp-88h]
  LPARAM datab; // [esp+Ch] [ebp-88h]
  int v8; // [esp+10h] [ebp-84h]
  int v9; // [esp+10h] [ebp-84h]
  int v10; // [esp+10h] [ebp-84h]
  int yStart; // [esp+14h] [ebp-80h]
  int yStarta; // [esp+14h] [ebp-80h]
  int yStartb; // [esp+14h] [ebp-80h]
  int xStart; // [esp+18h] [ebp-7Ch]
  int xStarta; // [esp+18h] [ebp-7Ch]
  int xStartb; // [esp+18h] [ebp-7Ch]
  int yEnd; // [esp+1Ch] [ebp-78h]
  int yEnda; // [esp+1Ch] [ebp-78h]
  int yEndb; // [esp+1Ch] [ebp-78h]
  int yEndc; // [esp+1Ch] [ebp-78h]
  int yEndd; // [esp+1Ch] [ebp-78h]
  int yEnde; // [esp+1Ch] [ebp-78h]
  int jj; // [esp+20h] [ebp-74h]
  int i; // [esp+20h] [ebp-74h]
  int m; // [esp+20h] [ebp-74h]
  int v26; // [esp+24h] [ebp-70h]
  int v27; // [esp+24h] [ebp-70h]
  int v28; // [esp+24h] [ebp-70h]
  int kk; // [esp+28h] [ebp-6Ch]
  int mm; // [esp+28h] [ebp-6Ch]
  int j; // [esp+28h] [ebp-6Ch]
  int k; // [esp+28h] [ebp-6Ch]
  int n; // [esp+28h] [ebp-6Ch]
  int ii; // [esp+28h] [ebp-6Ch]
  int xEnd; // [esp+2Ch] [ebp-68h]
  int xEnda; // [esp+2Ch] [ebp-68h]
  int xEndb; // [esp+2Ch] [ebp-68h]
  int xEndc; // [esp+2Ch] [ebp-68h]
  int xEndd; // [esp+2Ch] [ebp-68h]
  int xEnde; // [esp+2Ch] [ebp-68h]
  int v41; // [esp+30h] [ebp-64h]
  int v42; // [esp+30h] [ebp-64h]
  int v43; // [esp+30h] [ebp-64h]
  int v44; // [esp+30h] [ebp-64h]
  int v45; // [esp+30h] [ebp-64h]
  int v46; // [esp+30h] [ebp-64h]
  int v47; // [esp+30h] [ebp-64h]
  int v48; // [esp+30h] [ebp-64h]
  _BYTE v49[16]; // [esp+34h] [ebp-60h] BYREF
  int v50; // [esp+44h] [ebp-50h] BYREF
  int v51; // [esp+48h] [ebp-4Ch]
  int v52; // [esp+4Ch] [ebp-48h]
  CHAR Str[64]; // [esp+50h] [ebp-44h] BYREF

  IGuiEngine::EraseOwnerImage((IGuiEngine *)g_pGUIEngine, 28, 1563);
  IGuiEngine::LockOwnerImage(
    (IGuiEngine *)g_pGUIEngine,
    28,
    1563,
    (struct SGuiRect *)v49,
    (unsigned __int16 **)&dword_3EFD4EC,
    (unsigned int *)&dword_3EFD4F0);
  v4 = 0;
  if ( dword_3EFD4EC )
  {
    dword_3EFD4F0 = (unsigned int)dword_3EFD4F0 >> 1;
    DrawGrid();
    v3 = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(255, 255, 255);
    if ( dword_3EFD524 )
    {
      if ( dword_3EFD524 == 1 )
      {
        if ( dword_3F2BCC0 >= 0 )
        {
          for ( i = 0; i < dword_3EFD51C; ++i )
          {
            v9 = dword_3EFD4FC[i];
            if ( byte_3EFD4F4[i] )
            {
              v1 = CPlayerManager::Color(v9);
              IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v1, (struct SGfxColor *)&v50);
              dataa = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v50, v51, v52);
              v27 = 15;
              v44 = dword_3F32B24[784 * v9 + 16 * dword_3EFD520 + dword_3F2BCC0];
              _wsprintfA(Str, "%d", v44);
              IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * i + 2], Str);
              yStarta = (int)(float)(178.0 - (float)((float)v44 * *(float *)&dword_3EFD52C));
              xStarta = (int)(float)((float)15 * *(float *)&dword_3EFD528);
              for ( j = dword_3F2BCC0; j >= 0; --j )
              {
                v45 = dword_3F32B24[784 * v9 + 16 * dword_3EFD520 + j];
                if ( v45 > v4 )
                  v4 = dword_3F32B24[784 * v9 + 16 * dword_3EFD520 + j];
                yEndb = (int)(float)(178.0 - (float)((float)v45 * *(float *)&dword_3EFD52C));
                xEndb = (int)(float)((float)v27 * *(float *)&dword_3EFD528);
                LineDDA(xStarta, yStarta, xEndb, yEndb, LineCallback, dataa);
                LineDDA(xStarta, yStarta + 1, xEndb, yEndb + 1, LineCallback, dataa);
                xStarta = xEndb;
                yStarta = yEndb;
                if ( v27 == dword_3EFD534 )
                {
                  _wsprintfA(Str, "%d", v45);
                  IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * i + 2], Str);
                  LineDDA(xEndb, 0, xEndb, 179, LineCallback, v3);
                }
                --v27;
              }
              for ( k = dword_3F2BCC4 - 1; k > dword_3F2BCC0; --k )
              {
                v46 = dword_3F32B24[784 * v9 + 16 * dword_3EFD520 + k];
                if ( v46 > v4 )
                  v4 = dword_3F32B24[784 * v9 + 16 * dword_3EFD520 + k];
                yEndc = (int)(float)(178.0 - (float)((float)v46 * *(float *)&dword_3EFD52C));
                xEndc = (int)(float)((float)v27 * *(float *)&dword_3EFD528);
                LineDDA(xStarta, yStarta, xEndc, yEndc, LineCallback, dataa);
                LineDDA(xStarta, yStarta + 1, xEndc, yEndc + 1, LineCallback, dataa);
                xStarta = xEndc;
                yStarta = yEndc;
                if ( v27 == dword_3EFD534 )
                {
                  _wsprintfA(Str, "%d", v46);
                  IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * i + 2], Str);
                  LineDDA(xEndc, 0, xEndc, 179, LineCallback, v3);
                }
                --v27;
              }
            }
          }
        }
      }
      else if ( dword_3EFD524 == 2 && dword_3F2BCD4 >= 0 )
      {
        for ( m = 0; m < dword_3EFD51C; ++m )
        {
          v10 = dword_3EFD4FC[m];
          if ( byte_3EFD4F4[m] )
          {
            v2 = CPlayerManager::Color(v10);
            IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v2, (struct SGfxColor *)&v50);
            datab = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v50, v51, v52);
            v28 = 15;
            yStartb = (int)(float)(178.0
                                 - (float)((float)dword_3F39964[784 * v10 + 16 * dword_3EFD520 + dword_3F2BCD4]
                                         * *(float *)&dword_3EFD52C));
            xStartb = (int)(float)((float)15 * *(float *)&dword_3EFD528);
            for ( n = dword_3F2BCD4; n >= 0; --n )
            {
              v47 = dword_3F39964[784 * v10 + 16 * dword_3EFD520 + n];
              if ( v47 > v4 )
                v4 = dword_3F39964[784 * v10 + 16 * dword_3EFD520 + n];
              yEndd = (int)(float)(178.0 - (float)((float)v47 * *(float *)&dword_3EFD52C));
              xEndd = (int)(float)((float)v28 * *(float *)&dword_3EFD528);
              LineDDA(xStartb, yStartb, xEndd, yEndd, LineCallback, datab);
              LineDDA(xStartb, yStartb + 1, xEndd, yEndd + 1, LineCallback, datab);
              xStartb = xEndd;
              yStartb = yEndd;
              if ( v28 == dword_3EFD534 )
              {
                _wsprintfA(Str, "%d", v47);
                IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * m + 2], Str);
                LineDDA(xEndd, 0, xEndd, 179, LineCallback, v3);
              }
              --v28;
            }
            for ( ii = dword_3F2BCD8 - 1; ii > dword_3F2BCD4; --ii )
            {
              v48 = dword_3F39964[784 * v10 + 16 * dword_3EFD520 + ii];
              if ( v48 > v4 )
                v4 = dword_3F39964[784 * v10 + 16 * dword_3EFD520 + ii];
              yEnde = (int)(float)(178.0 - (float)((float)v48 * *(float *)&dword_3EFD52C));
              xEnde = (int)(float)((float)v28 * *(float *)&dword_3EFD528);
              LineDDA(xStartb, yStartb, xEnde, yEnde, LineCallback, datab);
              LineDDA(xStartb, yStartb + 1, xEnde, yEnde + 1, LineCallback, datab);
              xStartb = xEnde;
              yStartb = yEnde;
              if ( v28 == dword_3EFD534 )
              {
                _wsprintfA(Str, "%d", v48);
                IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * m + 2], Str);
                LineDDA(xEnde, 0, xEnde, 179, LineCallback, v3);
              }
              --v28;
            }
          }
        }
      }
    }
    else if ( dword_3F2BCAC >= 0 )
    {
      for ( jj = 0; jj < dword_3EFD51C; ++jj )
      {
        v8 = dword_3EFD4FC[jj];
        if ( byte_3EFD4F4[jj] )
        {
          v0 = CPlayerManager::Color(v8);
          IGfxEngine::GetPlayerColor((IGfxEngine *)g_pGfxEngine, v0, (struct SGfxColor *)&v50);
          data = (unsigned __int16)IGfxEngine::ConvertRgbToHicol(v50, v51, v52);
          v26 = 15;
          v41 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD520 + dword_3F2BCAC];
          *(float *)&dword_3EFD52C = 178.0 / *(float *)&dword_3EFD530;
          yStart = (int)(float)(178.0 - (float)((float)v41 * (float)(178.0 / *(float *)&dword_3EFD530)));
          xStart = (int)(float)((float)15 * *(float *)&dword_3EFD528);
          for ( kk = dword_3F2BCAC; kk >= 0; --kk )
          {
            v42 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD520 + kk];
            if ( v42 > v4 )
              v4 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD520 + kk];
            yEnd = (int)(float)(178.0 - (float)((float)v42 * *(float *)&dword_3EFD52C));
            xEnd = (int)(float)((float)v26 * *(float *)&dword_3EFD528);
            LineDDA(xStart, yStart, xEnd, yEnd, LineCallback, data);
            LineDDA(xStart, yStart + 1, xEnd, yEnd + 1, LineCallback, data);
            xStart = xEnd;
            yStart = yEnd;
            if ( v26 == dword_3EFD534 )
            {
              _wsprintfA(Str, "%d", v42);
              IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * jj + 2], Str);
              LineDDA(xEnd, 0, xEnd, 179, LineCallback, v3);
            }
            --v26;
          }
          for ( mm = dword_3F2BCB0 - 1; mm > dword_3F2BCAC; --mm )
          {
            v43 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD520 + mm];
            if ( v43 > v4 )
              v4 = dword_3F2BCE4[784 * v8 + 16 * dword_3EFD520 + mm];
            yEnda = (int)(float)(178.0 - (float)((float)v43 * *(float *)&dword_3EFD52C));
            xEnda = (int)(float)((float)v26 * *(float *)&dword_3EFD528);
            LineDDA(xStart, yStart, xEnda, yEnda, LineCallback, data);
            LineDDA(xStart, yStart + 1, xEnda, yEnda + 1, LineCallback, data);
            xStart = xEnda;
            yStart = yEnda;
            if ( v26 == dword_3EFD534 )
            {
              _wsprintfA(Str, "%d", v43);
              IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * jj + 2], Str);
              LineDDA(xEnda, 0, xEnda, 179, LineCallback, v3);
            }
            --v26;
          }
        }
      }
    }
  }
  IGuiEngine::UnlockOwnerImage((IGuiEngine *)g_pGUIEngine, 28, 1563);
  if ( byte_3EFD4E8 )
  {
    byte_3EFD4E8 = 0;
    *(float *)&dword_3EFD530 = (float)v4;
    if ( (float)v4 < 10.0 )
      dword_3EFD530 = LODWORD(FLOAT_10_0);
    InitMaxvalueWarrior();
  }
}


// address=[0x13d2560]
// Decompiled from void UpdateGuiDlgStatisticWarrior()
void __cdecl UpdateGuiDlgStatisticWarrior(void) {
  
  DrawGraph();
}


// address=[0x13d2570]
// Decompiled from void InitGuiDlgStatisticWarrior()
void __cdecl InitGuiDlgStatisticWarrior(void) {
  
  CPlayerInfo *v0; // eax
  const wchar_t *v1; // eax
  int v2; // edi
  CPlayerInfo *v3; // eax
  const wchar_t *v4; // eax
  int v5; // [esp+0h] [ebp-164h]
  _Cnd_internal_imp_t *v6; // [esp+8h] [ebp-15Ch]
  _Cnd_internal_imp_t *v7; // [esp+Ch] [ebp-158h]
  int v8; // [esp+10h] [ebp-154h]
  int LocalPlayerId; // [esp+14h] [ebp-150h]
  int v10; // [esp+20h] [ebp-144h]
  int v11; // [esp+20h] [ebp-144h]
  int i; // [esp+24h] [ebp-140h]
  int j; // [esp+24h] [ebp-140h]
  int k; // [esp+24h] [ebp-140h]
  _BYTE v15[28]; // [esp+28h] [ebp-13Ch] BYREF
  _BYTE v16[28]; // [esp+44h] [ebp-120h] BYREF
  char Dest[256]; // [esp+60h] [ebp-104h] BYREF

  if ( g_pStringEngine )
  {
    IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1592, "0");
    IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1596, "%");
    dword_3EFD51C = 0;
    for ( i = 0; i < 8; ++i )
    {
      if ( (unsigned int)i >= 8 )
        j____report_rangecheckfailure();
      byte_3EFD4F4[i] = 0;
      dword_3EFD4FC[i] = -1;
    }
    LocalPlayerId = CPlayerManager::GetLocalPlayerId(v5);
    v8 = CAlliances::AllianceId(LocalPlayerId);
    for ( j = 1; j <= CPlayerManager::LastPlayerId(); ++j )
    {
      if ( CGameData::IsNetworkGame(g_pGameData) )
      {
        if ( CAlliances::AllianceId(j) == v8 )
        {
          v10 = CPlayerManager::Color(j);
          v0 = CPlayerManager::PlayerInfo(j);
          v7 = (_Cnd_internal_imp_t *)CPlayerInfo::Name(v0);
          v1 = (const wchar_t *)std::wstring::c_str(v7);
          j__wcstombs(Dest, v1, 0x100u);
          std::wstring::~wstring(v16);
          dword_3EFD4FC[dword_3EFD51C] = j;
          IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * dword_3EFD51C], Dest);
          IGuiEngine::SetImages(
            (void *)g_pGUIEngine,
            28,
            dword_3D89298[3 * dword_3EFD51C + 1],
            dword_3D892F8[2 * v10 + 1],
            dword_3D892F8[2 * v10]);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * dword_3EFD51C], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * dword_3EFD51C + 1], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * dword_3EFD51C + 2], 1);
          ++dword_3EFD51C;
        }
      }
      else
      {
        v2 = CPlayerManager::NumberOfPlayers();
        if ( j - 1 < v2 - CStatistic::GetDontShowLastNPlayers((CStatistic *)&g_cStatistic) )
        {
          dword_3EFD4FC[dword_3EFD51C++] = j;
          v11 = CPlayerManager::Color(j);
          v3 = CPlayerManager::PlayerInfo(j);
          v6 = (_Cnd_internal_imp_t *)CPlayerInfo::Name(v3);
          v4 = (const wchar_t *)std::wstring::c_str(v6);
          j__wcstombs(Dest, v4, 0x100u);
          std::wstring::~wstring(v15);
          IGuiEngine::SetText((void *)g_pGUIEngine, 28, dword_3D89298[3 * j - 3], Dest);
          IGuiEngine::SetImages(
            (void *)g_pGUIEngine,
            28,
            dword_3D89298[3 * j - 2],
            dword_3D892F8[2 * v11 + 1],
            dword_3D892F8[2 * v11]);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * j - 3], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * j - 2], 1);
          IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * j - 1], 1);
        }
      }
    }
    for ( k = 0; k < 8; ++k )
    {
      if ( k >= dword_3EFD51C )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * k], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * k + 1], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 28, dword_3D89298[3 * k + 2], 0);
      }
      else
      {
        IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 28, dword_3D89298[3 * k + 1], 1);
      }
    }
  }
}


// address=[0x13d2ae0]
// Decompiled from char InitWarriorRange()
void __cdecl InitWarriorRange(void) {
  
  char result; // al
  char *v1; // eax
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax

  result = dword_3EFD524;
  if ( dword_3EFD524 )
  {
    if ( dword_3EFD524 == 1 )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1593, "0");
      v2 = g_pStringEngine->GetString(g_pStringEngine, 928);
      IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1594, v2);
      v3 = g_pStringEngine->GetString(g_pStringEngine, 927);
      result = IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1595, v3);
      dword_3EFD534 = 15;
      *(float *)&dword_3EFD528 = 299.0 / 15.0;
    }
    else if ( dword_3EFD524 == 2 )
    {
      IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1593, "0");
      v4 = g_pStringEngine->GetString(g_pStringEngine, 929);
      IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1594, v4);
      v5 = g_pStringEngine->GetString(g_pStringEngine, 926);
      result = IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1595, v5);
      dword_3EFD534 = 15;
      *(float *)&dword_3EFD528 = 299.0 / 15.0;
    }
  }
  else
  {
    IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1593, "0");
    IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1594, " ");
    v1 = g_pStringEngine->GetString(g_pStringEngine, 925);
    result = IGuiEngine::SetText((void *)g_pGUIEngine, 28, 1595, v1);
    dword_3EFD534 = 15;
    *(float *)&dword_3EFD528 = 299.0 / 15.0;
  }
  return result;
}


// address=[0x13d2cc0]
// Decompiled from char __cdecl GuiDlgStatisticWarriorProc(int a1, int a2, int a3)
bool __cdecl GuiDlgStatisticWarriorProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD4E9 = 1;
      dword_3EFD4EC = 0;
      dword_3EFD530 = LODWORD(FLOAT_100_0);
      dword_3EFD51C = 0;
      InitMaxvalueWarrior();
      InitGuiDlgStatisticWarrior();
      dword_3EFD524 = 0;
      dword_3EFD520 = 0;
      dword_3EFD528 = LODWORD(FLOAT_19_933332);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 28, 1564, 1);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 28, 1597, 1);
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 28, 1567, 1);
      byte_3EFD4E9 = 0;
      InitWarriorRange();
      UpdateGuiDlgStatisticWarrior();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      PlayGuiSound(2);
      switch ( (__int16)a2 )
      {
        case 1564:
          dword_3EFD524 = 0;
          if ( !byte_3EFD4E9 )
            goto LABEL_29;
          return 1;
        case 1565:
          dword_3EFD524 = 1;
          if ( !byte_3EFD4E9 )
            goto LABEL_29;
          return 1;
        case 1566:
          dword_3EFD524 = 2;
          if ( !byte_3EFD4E9 )
          {
LABEL_29:
            InitWarriorRange();
            UpdateGuiDlgStatisticWarrior();
          }
          break;
        case 1567:
          byte_3EFD4E8 = 1;
          byte_3EFD4F4[0] = byte_3EFD4F4[0] == 0;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1568:
          byte_3EFD4E8 = 1;
          if ( byte_3EFD4F4[1] )
            byte_3EFD4F4[1] = 0;
          else
            byte_3EFD4F4[1] = 1;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1569:
          byte_3EFD4E8 = 1;
          if ( byte_3EFD4F4[2] )
            byte_3EFD4F4[2] = 0;
          else
            byte_3EFD4F4[2] = 1;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1570:
          byte_3EFD4E8 = 1;
          if ( byte_3EFD4F4[3] )
            byte_3EFD4F4[3] = 0;
          else
            byte_3EFD4F4[3] = 1;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1571:
          byte_3EFD4E8 = 1;
          if ( byte_3EFD4F4[4] )
            byte_3EFD4F4[4] = 0;
          else
            byte_3EFD4F4[4] = 1;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1572:
          byte_3EFD4E8 = 1;
          if ( byte_3EFD4F4[5] )
            byte_3EFD4F4[5] = 0;
          else
            byte_3EFD4F4[5] = 1;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1573:
          byte_3EFD4E8 = 1;
          if ( byte_3EFD4F4[6] )
            byte_3EFD4F4[6] = 0;
          else
            byte_3EFD4F4[6] = 1;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1574:
          byte_3EFD4E8 = 1;
          if ( byte_3EFD4F4[7] )
            byte_3EFD4F4[7] = 0;
          else
            byte_3EFD4F4[7] = 1;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1597:
          byte_3EFD4E8 = 1;
          dword_3EFD520 = 3;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1598:
          byte_3EFD4E8 = 1;
          dword_3EFD520 = 4;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1599:
          byte_3EFD4E8 = 1;
          dword_3EFD520 = 5;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1600:
          byte_3EFD4E8 = 1;
          dword_3EFD520 = 6;
          if ( !byte_3EFD4E9 )
            goto LABEL_74;
          break;
        case 1601:
          if ( ++dword_3EFD534 > 15 )
            dword_3EFD534 = 15;
          goto LABEL_74;
        case 1602:
          if ( --dword_3EFD534 < 0 )
            dword_3EFD534 = 0;
          goto LABEL_74;
        case 1603:
          *(float *)&dword_3EFD530 = *(float *)&dword_3EFD530 - (float)(*(float *)&dword_3EFD530 / 10.0);
          if ( *(float *)&dword_3EFD530 < 10.0 )
            dword_3EFD530 = LODWORD(FLOAT_10_0);
          goto LABEL_86;
        case 1604:
          *(float *)&dword_3EFD530 = (float)(*(float *)&dword_3EFD530 / 10.0) + *(float *)&dword_3EFD530;
          if ( *(float *)&dword_3EFD530 > 9999.0 )
            dword_3EFD530 = LODWORD(FLOAT_9999_0);
          goto LABEL_86;
        default:
          return 1;
      }
      break;
    case 8:
      DrawGraph();
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3698FAB);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3698FAF);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      if ( SHIWORD(a2) <= 10 )
      {
        if ( SHIWORD(a2) < 10 )
        {
          *(float *)&dword_3EFD530 = (float)(*(float *)&dword_3EFD530 / 10.0) + *(float *)&dword_3EFD530;
          if ( *(float *)&dword_3EFD530 > 9999.0 )
            dword_3EFD530 = LODWORD(FLOAT_9999_0);
          InitMaxvalueWarrior();
        }
      }
      else
      {
        *(float *)&dword_3EFD530 = *(float *)&dword_3EFD530 - (float)(*(float *)&dword_3EFD530 / 10.0);
        if ( *(float *)&dword_3EFD530 < 10.0 )
          dword_3EFD530 = LODWORD(FLOAT_10_0);
LABEL_86:
        InitMaxvalueWarrior();
      }
      break;
    case 11:
LABEL_74:
      UpdateGuiDlgStatisticWarrior();
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d3cc0]
// Decompiled from void UpdateGuiDlgStorageContext()
void __cdecl UpdateGuiDlgStorageContext(void) {
  
  int GuiHouseImageID; // eax
  char *GuiHouseString; // eax
  int v2; // eax
  int GuiGoodImageID; // eax
  int Number; // [esp+0h] [ebp-44h]
  int i; // [esp+8h] [ebp-3Ch]
  CHAR Str[52]; // [esp+Ch] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    byte_3EFD548 = 1;
    GuiHouseImageID = GetGuiHouseImageID(byte_3F1E5A9, byte_3F1E5A8, 0);
    IGuiEngine::SetImages((void *)g_pGUIEngine, 23, 1614, GuiHouseImageID, 0);
    GuiHouseString = (char *)GetGuiHouseString(byte_3F1E5A9, byte_3F1E5A8);
    IGuiEngine::SetText((void *)g_pGUIEngine, 23, 1608, GuiHouseString);
    _wsprintfA(Str, "%u", byte_3F1E5B0);
    IGuiEngine::SetText((void *)g_pGUIEngine, 23, 1609, Str);
    if ( byte_3F1E5AF <= 0 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 23, 1610, 0);
    }
    else
    {
      _wsprintfA(Str, "+%u", byte_3F1E5AF);
      IGuiEngine::SetText((void *)g_pGUIEngine, 23, 1610, Str);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 23, 1610, 1);
    }
    IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 23, 1607, byte_3F1E5AC == 0);
    IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 23, 1607, byte_3F1E5AB);
    for ( i = 0; i < 10; ++i )
    {
      if ( byte_3F1E5B4[2 * i] )
      {
        Number = byte_3F1E5B5[2 * i];
        v2 = j__abs(Number);
        _wsprintfA(Str, "%u", v2);
        IGuiEngine::SetText((void *)g_pGUIEngine, 23, dword_3699348[2 * i], Str);
        GuiGoodImageID = GetGuiGoodImageID(byte_3F1E5B4[2 * i]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 23, dword_3699348[2 * i + 1], GuiGoodImageID, 0);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          23,
          dword_3699348[2 * i + 1],
          dword_3698FE8[5 * byte_3F1E5B4[2 * i] + 3],
          dword_3698FE8[5 * byte_3F1E5B4[2 * i] + 4]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 23, dword_3699348[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 23, dword_3699348[2 * i + 1], 1);
        if ( Number < 0 )
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 23, dword_3699348[2 * i + 1], 2);
        else
          IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, 23, dword_3699348[2 * i], 1);
        byte_3EFD549 = 0;
      }
      else
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 23, dword_3699348[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 23, dword_3699348[2 * i + 1], 0);
      }
    }
    byte_3EFD548 = 0;
    if ( byte_3EFD549 )
    {
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 23, 1623, 1);
      byte_3EFD549 = 0;
    }
  }
}


// address=[0x13d4060]
// Decompiled from char __cdecl GuiDlgStorageContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgStorageContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+4h] [ebp-128h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-120h]
  CEvn_Logic *v8; // [esp+14h] [ebp-118h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-110h]
  CEvn_Logic *v10; // [esp+24h] [ebp-108h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-100h]
  CEvn_Logic *v12; // [esp+34h] [ebp-F8h]
  _BYTE v13[32]; // [esp+44h] [ebp-E8h] BYREF
  _BYTE v14[32]; // [esp+64h] [ebp-C8h] BYREF
  _BYTE v15[32]; // [esp+84h] [ebp-A8h] BYREF
  _BYTE v16[32]; // [esp+A4h] [ebp-88h] BYREF
  _BYTE v17[32]; // [esp+C4h] [ebp-68h] BYREF
  _BYTE v18[32]; // [esp+E4h] [ebp-48h] BYREF
  CEvn_Event v19; // [esp+104h] [ebp-28h] BYREF
  int v20; // [esp+128h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD548 = 0;
      byte_3EFD549 = 1;
      UpdateGuiDlgStorageContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1605:
          v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x198u, 0, 0, 0, 0, 0);
          v20 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v18);
          PlayGuiSound(2);
          break;
        case 1606:
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x194u, 0, 0, 0, 0, 0);
          v20 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v17);
          PlayGuiSound(2);
          break;
        case 1607:
          if ( !byte_3EFD548 )
          {
            if ( (a2 & 0x10000) != 0 )
            {
              v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x196u, 0, 0, 0, 0, 0);
              v20 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v10);
              v20 = -1;
              CEvn_Logic::~CEvn_Logic(v16);
            }
            else
            {
              v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x196u, 0, 1u, 0, 0, 0);
              v20 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v9);
              v20 = -1;
              CEvn_Logic::~CEvn_Logic(v15);
            }
            PlayGuiSound(2);
          }
          break;
        case 1623:
          if ( (a2 & 0x10000) != 0 )
          {
            v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1C9u, 0, 0, 0, 0, 0);
            v20 = 4;
            IEventEngine::SendAMessage(g_pEvnEngine, v8);
            v20 = -1;
            CEvn_Logic::~CEvn_Logic(v14);
          }
          else
          {
            v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1CCu, 0, 0, 0, 0, 0);
            v20 = 5;
            IEventEngine::SendAMessage(g_pEvnEngine, v7);
            v20 = -1;
            CEvn_Logic::~CEvn_Logic(v13);
            v6 = CEvn_Event::CEvn_Event(&v19, 0x260u, 0, 0, 0);
            v20 = 6;
            IEventEngine::SendAMessage(g_pEvnEngine, v6);
            v20 = -1;
            CEvn_Event::~CEvn_Event(&v19);
          }
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3699347);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_369939F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d4700]
// Decompiled from char UpdateGuiDlgTransportpriority()
void __cdecl UpdateGuiDlgTransportpriority(void) {
  
  char result; // al
  int v1; // [esp+0h] [ebp-8h]
  int i; // [esp+4h] [ebp-4h]

  if ( !g_pGUIEngine )
    return result;
  v1 = 0;
  byte_3EFD5DC = 1;
  result = IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 25, dword_3D89358[0]);
  for ( i = 0; i < 42; ++i )
  {
    if ( dword_3F1EDB0[i] > 0 && v1 < dword_3F1EDAC )
    {
      IGuiEngine::SetImages(
        (void *)g_pGUIEngine,
        25,
        dword_3D89358[v1],
        dword_3699460[5 * dword_3F1EDB0[i] + 1],
        dword_3699460[5 * dword_3F1EDB0[i] + 2]);
      IGuiEngine::SetTooltipID(
        (IGuiEngine *)g_pGUIEngine,
        25,
        dword_3D89358[v1],
        dword_3699460[5 * dword_3F1EDB0[i] + 3],
        dword_3699460[5 * dword_3F1EDB0[i] + 4]);
      dword_3EFD550[v1] = dword_3F1EDB0[i];
      if ( dword_3F1EDB0[i] == dword_3EFD5D8 )
        IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 25, dword_3D89358[v1], 1);
    }
    result = ++v1;
  }
  byte_3EFD5DC = 0;
  return result;
}


// address=[0x13d4870]
// Decompiled from int InitGuiDlgTransportpriority()
void __cdecl InitGuiDlgTransportpriority(void) {
  
  int result; // eax
  int i; // [esp+0h] [ebp-4h]

  if ( !g_pStringEngine )
    return result;
  byte_3EFD5DC = 0;
  for ( i = 0; i < 34; ++i )
  {
    dword_3EFD550[i] = -1;
    result = i + 1;
  }
  return result;
}


// address=[0x13d48c0]
// Decompiled from char __cdecl GuiDlgTransportpriorityProc(int a1, unsigned int a2, int a3)
bool __cdecl GuiDlgTransportpriorityProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-10Ch]
  CEvn_Logic *v7; // [esp+Ch] [ebp-104h]
  CEvn_Logic *v8; // [esp+14h] [ebp-FCh]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-F4h]
  CEvn_Logic *v10; // [esp+24h] [ebp-ECh]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-E4h]
  __int16 v12; // [esp+3Ch] [ebp-D4h]
  _BYTE v13[32]; // [esp+40h] [ebp-D0h] BYREF
  _BYTE v14[32]; // [esp+60h] [ebp-B0h] BYREF
  _BYTE v15[32]; // [esp+80h] [ebp-90h] BYREF
  _BYTE v16[32]; // [esp+A0h] [ebp-70h] BYREF
  _BYTE v17[32]; // [esp+C0h] [ebp-50h] BYREF
  _BYTE v18[32]; // [esp+E0h] [ebp-30h] BYREF
  int v19; // [esp+10Ch] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      dword_3EFD5D8 = -1;
      InitGuiDlgTransportpriority();
      break;
    case 1:
      if ( !byte_3EFD5DC )
      {
        if ( (S4HiWord(a2) & 1) != 0 )
          PlayGuiSound(1);
        else
          PlayGuiSound(0);
      }
      break;
    case 3:
      if ( !byte_3EFD5DC )
      {
        switch ( S4LoWord(a2) )
        {
          case 0x687u:
            dword_3EFD5D8 = dword_3EFD550[0];
            PlayGuiSound(2);
            break;
          case 0x688u:
            dword_3EFD5D8 = dword_3EFD550[1];
            PlayGuiSound(2);
            break;
          case 0x689u:
            dword_3EFD5D8 = dword_3EFD550[2];
            PlayGuiSound(2);
            break;
          case 0x68Au:
            dword_3EFD5D8 = dword_3EFD550[3];
            PlayGuiSound(2);
            break;
          case 0x68Bu:
            dword_3EFD5D8 = dword_3EFD550[4];
            PlayGuiSound(2);
            break;
          case 0x68Cu:
            dword_3EFD5D8 = dword_3EFD550[5];
            PlayGuiSound(2);
            break;
          case 0x68Du:
            dword_3EFD5D8 = dword_3EFD550[6];
            PlayGuiSound(2);
            break;
          case 0x68Eu:
            dword_3EFD5D8 = dword_3EFD550[7];
            PlayGuiSound(2);
            break;
          case 0x68Fu:
            dword_3EFD5D8 = dword_3EFD550[8];
            PlayGuiSound(2);
            break;
          case 0x690u:
            dword_3EFD5D8 = dword_3EFD550[9];
            PlayGuiSound(2);
            break;
          case 0x691u:
            dword_3EFD5D8 = dword_3EFD550[13];
            PlayGuiSound(2);
            break;
          case 0x692u:
            dword_3EFD5D8 = dword_3EFD550[14];
            PlayGuiSound(2);
            break;
          case 0x693u:
            dword_3EFD5D8 = dword_3EFD550[15];
            PlayGuiSound(2);
            break;
          case 0x694u:
            dword_3EFD5D8 = dword_3EFD550[16];
            PlayGuiSound(2);
            break;
          case 0x695u:
            dword_3EFD5D8 = dword_3EFD550[17];
            PlayGuiSound(2);
            break;
          case 0x696u:
            dword_3EFD5D8 = dword_3EFD550[10];
            PlayGuiSound(2);
            break;
          case 0x697u:
            dword_3EFD5D8 = dword_3EFD550[21];
            PlayGuiSound(2);
            break;
          case 0x698u:
            dword_3EFD5D8 = dword_3EFD550[20];
            PlayGuiSound(2);
            break;
          case 0x699u:
            dword_3EFD5D8 = dword_3EFD550[19];
            PlayGuiSound(2);
            break;
          case 0x69Au:
            dword_3EFD5D8 = dword_3EFD550[18];
            PlayGuiSound(2);
            break;
          case 0x69Bu:
            dword_3EFD5D8 = dword_3EFD550[25];
            PlayGuiSound(2);
            break;
          case 0x69Cu:
            dword_3EFD5D8 = dword_3EFD550[26];
            PlayGuiSound(2);
            break;
          case 0x69Du:
            dword_3EFD5D8 = dword_3EFD550[27];
            PlayGuiSound(2);
            break;
          case 0x69Eu:
            dword_3EFD5D8 = dword_3EFD550[12];
            PlayGuiSound(2);
            break;
          case 0x69Fu:
            dword_3EFD5D8 = dword_3EFD550[11];
            PlayGuiSound(2);
            break;
          case 0x6A0u:
            dword_3EFD5D8 = dword_3EFD550[24];
            PlayGuiSound(2);
            break;
          case 0x6A1u:
            dword_3EFD5D8 = dword_3EFD550[23];
            PlayGuiSound(2);
            break;
          case 0x6A2u:
            dword_3EFD5D8 = dword_3EFD550[22];
            PlayGuiSound(2);
            break;
          case 0x6A3u:
            if ( dword_3EFD5D8 > 0 )
            {
              v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1BEu, dword_3EFD5D8, 0, 0, 0, 0);
              v19 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v9);
              v19 = -1;
              CEvn_Logic::~CEvn_Logic(v16);
              PlayGuiSound(2);
            }
            break;
          case 0x6A4u:
            if ( dword_3EFD5D8 > 0 )
            {
              v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1BEu, dword_3EFD5D8, 0xFFFFFFFF, 0, 0, 0);
              v19 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v8);
              v19 = -1;
              CEvn_Logic::~CEvn_Logic(v15);
              PlayGuiSound(2);
            }
            break;
          case 0x6A5u:
            if ( dword_3EFD5D8 > 0 )
            {
              v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1BEu, dword_3EFD5D8, 1u, 0, 0, 0);
              v19 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v7);
              v19 = -1;
              CEvn_Logic::~CEvn_Logic(v14);
              PlayGuiSound(2);
            }
            break;
          case 0x6A6u:
            if ( dword_3EFD5D8 > 0 )
            {
              v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1BEu, dword_3EFD5D8, 0x64u, 0, 0, 0);
              v19 = 5;
              IEventEngine::SendAMessage(g_pEvnEngine, v6);
              v19 = -1;
              CEvn_Logic::~CEvn_Logic(v13);
              PlayGuiSound(2);
            }
            break;
          case 0x6A8u:
            dword_3EFD5D8 = dword_3EFD550[28];
            PlayGuiSound(2);
            break;
          case 0x6A9u:
            dword_3EFD5D8 = dword_3EFD550[29];
            PlayGuiSound(2);
            break;
          case 0x6AAu:
            dword_3EFD5D8 = dword_3EFD550[30];
            PlayGuiSound(2);
            break;
          case 0x6ABu:
            dword_3EFD5D8 = dword_3EFD550[31];
            PlayGuiSound(2);
            break;
          case 0x6ACu:
            dword_3EFD5D8 = dword_3EFD550[32];
            PlayGuiSound(2);
            break;
          case 0x6ADu:
            dword_3EFD5D8 = dword_3EFD550[33];
            PlayGuiSound(2);
            break;
          default:
            return 1;
        }
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_36997BC);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_36997BD);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 10:
      v12 = S4HiWord(a2);
      if ( dword_3EFD5D8 > 0 )
      {
        if ( v12 <= 0 )
        {
          if ( v12 < 0 )
          {
            v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1BEu, dword_3EFD5D8, 1u, 0, 0, 0);
            v19 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v19 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
            PlayGuiSound(2);
          }
        }
        else
        {
          v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x1BEu, dword_3EFD5D8, 0xFFFFFFFF, 0, 0, 0);
          v19 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v19 = -1;
          CEvn_Logic::~CEvn_Logic(v18);
          PlayGuiSound(2);
        }
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d5550]
// Decompiled from void InitGuiDlgTutorial()
void __cdecl InitGuiDlgTutorial(void) {
  
  CEvn_Event *v0; // [esp+4h] [ebp-30h]
  CEvn_Event v1; // [esp+Ch] [ebp-28h] BYREF
  int v2; // [esp+30h] [ebp-4h]

  if ( g_pStringEngine )
  {
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 1711, 11);
    IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 1712, 14);
    v0 = CEvn_Event::CEvn_Event(&v1, 0x276u, 0, 0, 0);
    v2 = 0;
    IEventEngine::SendAMessage(g_pEvnEngine, v0);
    v2 = -1;
    CEvn_Event::~CEvn_Event(&v1);
  }
}


// address=[0x13d5620]
// Decompiled from char __cdecl HighlightEntryDlgTutorialMessages(int a1, bool a2)
void __cdecl HighlightEntryDlgTutorialMessages(int a1, bool a2) {
  
  if ( a2 )
    return IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), a1, 13);
  if ( a1 == 1711 )
    return IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), 1711, 11);
  return IGuiEngine::SetFontTemplate((IGuiEngine *)g_pGUIEngine, *(_DWORD *)(g_pGuiMainEvents + 40), a1, 14);
}


// address=[0x13d5670]
// Decompiled from char __cdecl GuiDlgTutorialProc(int a1, unsigned int a2, unsigned int a3)
bool __cdecl GuiDlgTutorialProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  CEvn_Event *v10; // [esp+4h] [ebp-60h]
  CEvn_Event *v11; // [esp+Ch] [ebp-58h]
  unsigned int v12; // [esp+14h] [ebp-50h]
  unsigned int v13; // [esp+18h] [ebp-4Ch]
  unsigned int v14; // [esp+1Ch] [ebp-48h]
  CEvn_Event v15; // [esp+24h] [ebp-40h] BYREF
  CEvn_Event v16; // [esp+3Ch] [ebp-28h] BYREF
  int v17; // [esp+60h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgTutorial();
      break;
    case 1:
      if ( (S4HiWord(a3) & 1) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      v12 = S4LoWord(a2);
      if ( v12 == 1711 )
      {
        v10 = CEvn_Event::CEvn_Event(&v15, 0x276u, 0, 0, 0);
        v17 = 1;
        IEventEngine::SendAMessage(g_pEvnEngine, v10);
        v17 = -1;
        CEvn_Event::~CEvn_Event(&v15);
        PlayGuiSound(0);
        v9 = S4LoWord(a2);
        HighlightEntryDlgTutorialMessages(v9, 0);
      }
      else if ( v12 == 1712 )
      {
        v11 = CEvn_Event::CEvn_Event(&v16, 0x275u, 0, 0, 0);
        v17 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v11);
        v17 = -1;
        CEvn_Event::~CEvn_Event(&v16);
        PlayGuiSound(0);
        v8 = S4LoWord(a2);
        HighlightEntryDlgTutorialMessages(v8, 0);
      }
      break;
    case 5:
      v14 = S4LoWord(a2);
      if ( v14 >= 0x6AF && v14 <= 0x6B0 )
      {
        v6 = S4LoWord(a2);
        HighlightEntryDlgTutorialMessages(v6, 1);
      }
      break;
    case 6:
      v13 = S4LoWord(a2);
      if ( v13 >= 0x6AF && v13 <= 0x6B0 )
      {
        v7 = S4LoWord(a2);
        HighlightEntryDlgTutorialMessages(v7, 0);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369986A);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_369986B);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d5a20]
// Decompiled from char UpdateGuiDlgTutorialCursor()
void __cdecl UpdateGuiDlgTutorialCursor(void) {
  
  char result; // al
  int v1; // [esp+0h] [ebp-14h] BYREF
  int v2; // [esp+4h] [ebp-10h]

  result = IGuiEngine::GetDialogRect((IGuiEngine *)g_pGUIEngine, 57, (struct SGuiRect *)&v1);
  if ( --dword_3D893FC > 0 )
    return result;
  if ( byte_3EFD5F9 )
  {
    result = IGuiEngine::MoveDialogTo((IGuiEngine *)g_pGUIEngine, 57, v1 + 10, v2 + 10);
    byte_3EFD5F9 = 0;
  }
  else
  {
    result = IGuiEngine::MoveDialogTo((IGuiEngine *)g_pGUIEngine, 57, v1 - 10, v2 - 10);
    byte_3EFD5F9 = 1;
  }
  dword_3D893FC = 3;
  return result;
}


// address=[0x13d5ad0]
// [Decompilation failed for void __cdecl InitGuiDlgTutorialCursor(void)]

// address=[0x13d5af0]
// Decompiled from char __cdecl GuiDlgTutorialCursorProc(int a1, int a2, int a3)
bool __cdecl GuiDlgTutorialCursorProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax

  if ( !g_pEvnEngine )
    return 0;
  if ( a1 )
  {
    if ( a1 == 8 )
    {
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369986C);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
    }
    else if ( a1 == 9 )
    {
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_369986D);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
    }
  }
  else
  {
    byte_3EFD5F9 = 0;
  }
  return 1;
}


// address=[0x13d5c10]
// Decompiled from void UpdateGuiDlgVehicleLoadContext()
void __cdecl UpdateGuiDlgVehicleLoadContext(void) {
  
  int LocalPlayerId; // eax
  int v1; // eax
  char *v2; // eax
  int v3; // eax
  int v4; // eax
  char *v5; // eax
  int v6; // eax
  int v7; // eax
  char *v8; // eax
  int GuiGoodImageID; // eax
  int v10; // [esp-4h] [ebp-40h]
  int v11; // [esp-4h] [ebp-40h]
  int v12; // [esp-4h] [ebp-40h]
  int i; // [esp+0h] [ebp-3Ch]
  CHAR Str[52]; // [esp+4h] [ebp-38h] BYREF

  if ( g_pGUIEngine )
  {
    if ( dword_3F1E78C == 22 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1751, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1750, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1717, 0);
      LocalPlayerId = CPlayerManager::GetLocalPlayerId(0);
      v1 = CPlayerManager::Race(LocalPlayerId);
      IGuiEngine::SetImages((void *)g_pGUIEngine, 41, 1716, dword_3699870[35 * v1 + 15], v10);
      v2 = g_pStringEngine->GetString(g_pStringEngine, 2246);
      IGuiEngine::SetText((void *)g_pGUIEngine, 41, 1714, v2);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1752, 0);
    }
    else if ( dword_3F1E78C == 24 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1751, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1750, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1713, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1717, 0);
      v3 = CPlayerManager::GetLocalPlayerId(0);
      v4 = CPlayerManager::Race(v3);
      IGuiEngine::SetImages((void *)g_pGUIEngine, 41, 1716, dword_3699870[35 * v4 + 30], v11);
      v5 = g_pStringEngine->GetString(g_pStringEngine, 882);
      IGuiEngine::SetText((void *)g_pGUIEngine, 41, 1714, v5);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1752, 0);
    }
    else
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1717, byte_3F1E883);
      if ( dword_3F1E78C == 21 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1750, 1);
        if ( byte_3F1E882 )
          IGuiEngine::SetImages((void *)g_pGUIEngine, 41, 1750, 272, 273);
        else
          IGuiEngine::SetImages((void *)g_pGUIEngine, 41, 1750, 274, 275);
      }
      else
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1750, byte_3F1E882);
      }
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1751, byte_3F1E880);
      v6 = CPlayerManager::GetLocalPlayerId(0);
      v7 = CPlayerManager::Race(v6);
      IGuiEngine::SetImages((void *)g_pGUIEngine, 41, 1716, dword_3699870[35 * v7 + 25], v12);
      if ( byte_3F1E881 )
        v8 = g_pStringEngine->GetString(g_pStringEngine, 883);
      else
        v8 = g_pStringEngine->GetString(g_pStringEngine, 2230);
      IGuiEngine::SetText((void *)g_pGUIEngine, 41, 1714, v8);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1752, 1);
    }
    for ( i = 0; i < 15; ++i )
    {
      if ( dword_3F1E790[3 * i] <= 0 )
      {
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, dword_3699E90[2 * i], 0);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, dword_3699E90[2 * i + 1], 0);
      }
      else
      {
        if ( byte_3F1E881 )
          _wsprintfA(Str, "%u/%u", dword_3F1E794[3 * i], dword_3F1E798[3 * i]);
        else
          _wsprintfA(Str, "%u", dword_3F1E794[3 * i]);
        IGuiEngine::SetText((void *)g_pGUIEngine, 41, dword_3699E90[2 * i], Str);
        GuiGoodImageID = GetGuiGoodImageID(dword_3F1E790[3 * i]);
        IGuiEngine::SetImages((void *)g_pGUIEngine, 41, dword_3699E90[2 * i + 1], GuiGoodImageID, 0);
        IGuiEngine::SetTooltipID(
          (IGuiEngine *)g_pGUIEngine,
          41,
          dword_3699E90[2 * i + 1],
          dword_3699B30[5 * dword_3F1E790[3 * i] + 3],
          dword_3699B30[5 * dword_3F1E790[3 * i] + 4]);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, dword_3699E90[2 * i], 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, dword_3699E90[2 * i + 1], 1);
      }
    }
    if ( byte_3F1E881 )
      _wsprintfA(Str, "%u/%u", dword_3F1E884, dword_3F1E888);
    else
      _wsprintfA(Str, "%u", dword_3F1E884);
    IGuiEngine::SetText((void *)g_pGUIEngine, 41, 1733, Str);
    if ( dword_3F1E78C == 24 || dword_3F1E78C == 22 )
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1733, 0);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1749, 0);
    }
    else
    {
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1733, 1);
      IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 41, 1749, 1);
    }
  }
}


// address=[0x13d61e0]
// Decompiled from char __cdecl GuiDlgVehicleLoadContextProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgVehicleLoadContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-E0h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-D8h]
  CEvn_Logic *v8; // [esp+14h] [ebp-D0h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-C8h]
  CEvn_Logic *v10; // [esp+24h] [ebp-C0h]
  _BYTE v11[32]; // [esp+34h] [ebp-B0h] BYREF
  _BYTE v12[32]; // [esp+54h] [ebp-90h] BYREF
  _BYTE v13[32]; // [esp+74h] [ebp-70h] BYREF
  _BYTE v14[32]; // [esp+94h] [ebp-50h] BYREF
  _BYTE v15[32]; // [esp+B4h] [ebp-30h] BYREF
  int v16; // [esp+E0h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      UpdateGuiDlgVehicleLoadContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( a2 )
      {
        case 1713:
          v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1ABu, 0, 0, 0, 0, 0);
          v16 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          PlayGuiSound(2);
          break;
        case 1717:
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1A1u, 0, 0, 0, 0, 0);
          v16 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v14);
          PlayGuiSound(2);
          break;
        case 1750:
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1A3u, 0, 0, 0, 0, 0);
          v16 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v13);
          PlayGuiSound(2);
          break;
        case 1751:
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v12, 0x1A5u, 0, 0, 0, 0, 0);
          v16 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v12);
          PlayGuiSound(2);
          break;
        case 1752:
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v11, 0x1C0u, 0, 0, 0, 0, 0);
          v16 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v16 = -1;
          CEvn_Logic::~CEvn_Logic(v11);
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_3699B2F);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_3699E8F);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d6810]
// Decompiled from char UpdateGuiDlgVehiclesContext()
void __cdecl UpdateGuiDlgVehiclesContext(void) {
  
  char result; // al
  int v1; // [esp+0h] [ebp-48h]
  int v2; // [esp+4h] [ebp-44h]
  int i; // [esp+8h] [ebp-40h]
  CHAR Str[52]; // [esp+10h] [ebp-38h] BYREF

  if ( !g_pGUIEngine )
    return result;
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 40, 1762, 0);
  IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 40, 1763, 0);
  result = IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 40, 1764, 0);
  for ( i = 0; i < 3; ++i )
  {
    v1 = dword_3F1E744[2 * i];
    switch ( v1 )
    {
      case 1:
        v2 = 1758;
        if ( dword_3F1E748[2 * i] > 0 )
          IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 40, 1762, 1);
        break;
      case 2:
        v2 = 1759;
        if ( dword_3F1E748[2 * i] > 0 )
          IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 40, 1763, 1);
        break;
      case 4:
        v2 = 1757;
        if ( dword_3F1E748[2 * i] > 0 )
          IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 40, 1764, 1);
        IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 40, 1765, dword_3F1E748[2 * i] == 1);
        break;
      default:
        v2 = -1;
        break;
    }
    if ( v2 >= 0 )
    {
      _wsprintfA(Str, "%u", dword_3F1E748[2 * i]);
      IGuiEngine::SetText((void *)g_pGUIEngine, 40, v2, Str);
    }
    result = i + 1;
  }
  if ( !g_bOpenSidebar )
    return result;
  result = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 40, 1761, 1);
  g_bOpenSidebar = 0;
  return result;
}


// address=[0x13d69e0]
// Decompiled from void InitGuiDlgVehiclesContext()
void __cdecl InitGuiDlgVehiclesContext(void) {
  
  char *v0; // eax

  if ( g_pStringEngine )
  {
    v0 = g_pStringEngine->GetString(g_pStringEngine, 887);
    IGuiEngine::SetText((void *)g_pGUIEngine, 40, 1753, v0);
  }
}


// address=[0x13d6a20]
// Decompiled from char __cdecl GuiDlgVehiclesContextProc(int a1, int a2, int a3)
bool __cdecl GuiDlgVehiclesContextProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-128h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-120h]
  CEvn_Logic *v8; // [esp+14h] [ebp-118h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-110h]
  CEvn_Event *v10; // [esp+24h] [ebp-108h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-100h]
  CEvn_Logic *v12; // [esp+34h] [ebp-F8h]
  _BYTE v13[32]; // [esp+44h] [ebp-E8h] BYREF
  _BYTE v14[32]; // [esp+64h] [ebp-C8h] BYREF
  _BYTE v15[32]; // [esp+84h] [ebp-A8h] BYREF
  _BYTE v16[32]; // [esp+A4h] [ebp-88h] BYREF
  _BYTE v17[32]; // [esp+C4h] [ebp-68h] BYREF
  _BYTE v18[32]; // [esp+E4h] [ebp-48h] BYREF
  CEvn_Event v19; // [esp+104h] [ebp-28h] BYREF
  int v20; // [esp+128h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgVehiclesContext();
      UpdateGuiDlgVehiclesContext();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 1761:
          if ( (a2 & 0x10000) != 0 )
          {
            v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v18, 0x1C2u, 0, 0, 0, 0, 0);
            v20 = 0;
            IEventEngine::SendAMessage(g_pEvnEngine, v12);
            v20 = -1;
            CEvn_Logic::~CEvn_Logic(v18);
          }
          else
          {
            v11 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1CCu, 0, 0, 0, 0, 0);
            v20 = 1;
            IEventEngine::SendAMessage(g_pEvnEngine, v11);
            v20 = -1;
            CEvn_Logic::~CEvn_Logic(v17);
            v10 = CEvn_Event::CEvn_Event(&v19, 0x260u, 0, 0, 0);
            v20 = 2;
            IEventEngine::SendAMessage(g_pEvnEngine, v10);
            v20 = -1;
            CEvn_Event::~CEvn_Event(&v19);
          }
          PlayGuiSound(2);
          break;
        case 1762:
          v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1A0u, 0, 0, 0, 0, 0);
          v20 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v16);
          PlayGuiSound(2);
          break;
        case 1763:
          v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v15, 0x1A1u, 0, 0, 0, 0, 0);
          v20 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v15);
          PlayGuiSound(2);
          break;
        case 1764:
          v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v14, 0x1A2u, 0, 0, 0, 0, 0);
          v20 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v14);
          PlayGuiSound(2);
          break;
        case 1765:
          v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v13, 0x1C0u, 0, 0, 0, 0, 0);
          v20 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v20 = -1;
          CEvn_Logic::~CEvn_Logic(v13);
          PlayGuiSound(2);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369A06F);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_369A070);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d7020]
// Decompiled from char GetSliderVals()
void __cdecl GetSliderVals(void) {
  
  int SliderPosition; // [esp+0h] [ebp-3Ch]
  int v2; // [esp+0h] [ebp-3Ch]
  int v3; // [esp+0h] [ebp-3Ch]
  int v4; // [esp+0h] [ebp-3Ch]
  CHAR Str[52]; // [esp+4h] [ebp-38h] BYREF

  SliderPosition = IGuiEngine::GetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1783);
  if ( SliderPosition < 0 )
    SliderPosition = 0;
  dword_3EFD604[0] = SliderPosition;
  _wsprintfA(Str, "%u%%", SliderPosition);
  IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1791, Str);
  v2 = IGuiEngine::GetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1784);
  if ( v2 < 0 )
    v2 = 0;
  dword_3EFD604[1] = v2;
  _wsprintfA(Str, "%u%%", v2);
  IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1792, Str);
  v3 = IGuiEngine::GetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1785);
  if ( v3 < 0 )
    v3 = 0;
  dword_3EFD604[2] = v3;
  _wsprintfA(Str, "%u%%", v3);
  IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1793, Str);
  v4 = IGuiEngine::GetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1787);
  if ( v4 < 0 )
    v4 = 0;
  dword_3EFD604[3] = v4;
  _wsprintfA(Str, "%u%%", v4);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1794, Str);
}


// address=[0x13d71c0]
// Decompiled from char __cdecl SetAmountWeaponsmithBar(int a1, int a2)
void __cdecl SetAmountWeaponsmithBar(int a1, int a2) {
  
  char v3; // [esp+Bh] [ebp-39h]
  CHAR Destination; // [esp+Ch] [ebp-38h] BYREF
  char v5; // [esp+Dh] [ebp-37h]

  if ( a2 <= 0 || a2 >= 100 )
  {
    if ( a2 <= 0 )
    {
      j__strcpy_0(&Destination, "0");
      v5 = 0;
      v3 = 0;
    }
    else
    {
      j__strcpy_0(&Destination, "E");
      v5 = 0;
      v3 = 1;
    }
  }
  else
  {
    _wsprintfA(&Destination, "%u", a2);
    v3 = 1;
  }
  IGuiEngine::SetText((void *)g_pGUIEngine, 46, a1, &Destination);
  return IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 46, a1, v3);
}


// address=[0x13d72a0]
// Decompiled from char UpdateGuiDlgWeaponsmithBar()
void __cdecl UpdateGuiDlgWeaponsmithBar(void) {
  
  char result; // al
  int i; // [esp+4h] [ebp-8h]

  if ( !g_pGUIEngine )
    return result;
  byte_3EFD5FC = 1;
  result = IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 46, 1778, byte_3F1E8CC == 0);
  for ( i = 0; i < 4; ++i )
  {
    result = byte_3F1E8D0[12 * i] - 3;
    switch ( byte_3F1E8D0[12 * i] )
    {
      case 3:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1785, byte_3F1E8CC);
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1782, byte_3F1E8CC);
        result = SetAmountWeaponsmithBar(1772, dword_3F1E8D4[3 * i]);
        break;
      case 5:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1787, byte_3F1E8CC);
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1786, byte_3F1E8CC);
        result = SetAmountWeaponsmithBar(2913, dword_3F1E8D4[3 * i]);
        break;
      case 6:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1787, byte_3F1E8CC);
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1786, byte_3F1E8CC);
        result = SetAmountWeaponsmithBar(1789, dword_3F1E8D4[3 * i]);
        break;
      case 8:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1784, byte_3F1E8CC);
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1781, byte_3F1E8CC);
        result = SetAmountWeaponsmithBar(1774, dword_3F1E8D4[3 * i]);
        break;
      case 34:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1783, byte_3F1E8CC);
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1780, byte_3F1E8CC);
        result = SetAmountWeaponsmithBar(1773, dword_3F1E8D4[3 * i]);
        break;
      case 38:
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1787, byte_3F1E8CC);
        IGuiEngine::EnableControl((IGuiEngine *)g_pGUIEngine, 46, 1786, byte_3F1E8CC);
        result = SetAmountWeaponsmithBar(2889, dword_3F1E8D4[3 * i]);
        break;
      default:
        continue;
    }
  }
  byte_3EFD5FC = 0;
  return result;
}


// address=[0x13d7570]
// Decompiled from char __cdecl GuiDlgWeaponsmithBarProc(int a1, int a2, int a3)
bool __cdecl GuiDlgWeaponsmithBarProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-1C4h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-1BCh]
  CEvn_Logic *v8; // [esp+14h] [ebp-1B4h]
  CEvn_Logic *v9; // [esp+1Ch] [ebp-1ACh]
  CEvn_Logic *v10; // [esp+24h] [ebp-1A4h]
  CEvn_Logic *v11; // [esp+2Ch] [ebp-19Ch]
  CEvn_Logic *v12; // [esp+34h] [ebp-194h]
  CEvn_Logic *v13; // [esp+3Ch] [ebp-18Ch]
  CEvn_Logic *v14; // [esp+44h] [ebp-184h]
  int i; // [esp+60h] [ebp-168h]
  _BYTE v16[32]; // [esp+64h] [ebp-164h] BYREF
  _BYTE v17[32]; // [esp+84h] [ebp-144h] BYREF
  _BYTE v18[32]; // [esp+A4h] [ebp-124h] BYREF
  _BYTE v19[32]; // [esp+C4h] [ebp-104h] BYREF
  _BYTE v20[32]; // [esp+E4h] [ebp-E4h] BYREF
  _BYTE v21[32]; // [esp+104h] [ebp-C4h] BYREF
  _BYTE v22[32]; // [esp+124h] [ebp-A4h] BYREF
  _BYTE v23[32]; // [esp+144h] [ebp-84h] BYREF
  CHAR v24[32]; // [esp+164h] [ebp-64h] BYREF
  CHAR Str[52]; // [esp+184h] [ebp-44h] BYREF
  int v26; // [esp+1C4h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      byte_3EFD5FC = 1;
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 46, 1778, byte_3F1E8CC == 0);
      for ( i = 0; i < 4; ++i )
      {
        switch ( byte_3F1E8D0[12 * i] )
        {
          case 3:
            dword_3EFD604[2] = dword_3F1E8D4[3 * i];
            SetAmountWeaponsmithBar(1772, dword_3F1E8D4[3 * i]);
            IGuiEngine::SetImages((void *)g_pGUIEngine, 46, 1785, 287, 337);
            IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1785, (unsigned __int8)byte_3F1E8D8[12 * i]);
            _wsprintfA(Str, "%u%%", (unsigned __int8)byte_3F1E8D8[12 * i]);
            IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1793, Str);
            break;
          case 5:
            dword_3EFD604[3] = dword_3F1E8D4[3 * i];
            SetAmountWeaponsmithBar(2913, dword_3F1E8D4[3 * i]);
            IGuiEngine::SetImages((void *)g_pGUIEngine, 46, 1787, 287, 337);
            IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1787, (unsigned __int8)byte_3F1E8D8[12 * i]);
            _wsprintfA(Str, "%u%%", (unsigned __int8)byte_3F1E8D8[12 * i]);
            IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1794, Str);
            break;
          case 6:
            dword_3EFD604[3] = dword_3F1E8D4[3 * i];
            SetAmountWeaponsmithBar(1789, dword_3F1E8D4[3 * i]);
            IGuiEngine::SetImages((void *)g_pGUIEngine, 46, 1787, 287, 337);
            IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1787, (unsigned __int8)byte_3F1E8D8[12 * i]);
            _wsprintfA(Str, "%u%%", (unsigned __int8)byte_3F1E8D8[12 * i]);
            IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1794, Str);
            break;
          case 8:
            dword_3EFD604[1] = dword_3F1E8D4[3 * i];
            SetAmountWeaponsmithBar(1774, dword_3F1E8D4[3 * i]);
            IGuiEngine::SetImages((void *)g_pGUIEngine, 46, 1784, 287, 337);
            IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1784, (unsigned __int8)byte_3F1E8D8[12 * i]);
            _wsprintfA(Str, "%u%%", (unsigned __int8)byte_3F1E8D8[12 * i]);
            IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1792, Str);
            break;
          case 34:
            dword_3EFD604[0] = dword_3F1E8D4[3 * i];
            SetAmountWeaponsmithBar(1773, dword_3F1E8D4[3 * i]);
            IGuiEngine::SetImages((void *)g_pGUIEngine, 46, 1783, 287, 337);
            IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1783, (unsigned __int8)byte_3F1E8D8[12 * i]);
            _wsprintfA(Str, "%u%%", (unsigned __int8)byte_3F1E8D8[12 * i]);
            IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1791, Str);
            break;
          case 38:
            dword_3EFD604[3] = dword_3F1E8D4[3 * i];
            SetAmountWeaponsmithBar(2889, dword_3F1E8D4[3 * i]);
            IGuiEngine::SetImages((void *)g_pGUIEngine, 46, 1787, 287, 337);
            IGuiEngine::SetSliderPosition((IGuiEngine *)g_pGUIEngine, 46, 1787, (unsigned __int8)byte_3F1E8D8[12 * i]);
            _wsprintfA(Str, "%u%%", (unsigned __int8)byte_3F1E8D8[12 * i]);
            IGuiEngine::SetText((void *)g_pGUIEngine, 46, 1794, Str);
            break;
          default:
            continue;
        }
      }
      byte_3EFD5FC = 0;
      dword_3EFD600 = 0;
      UpdateGuiDlgWeaponsmithBar();
      IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 46, 1775, 1);
      return 1;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      return 1;
    case 2:
      if ( !byte_3EFD5FC )
        GetSliderVals();
      return 1;
    case 3:
      if ( (unsigned __int16)a2 > 0xB48u )
      {
        if ( (unsigned __int16)a2 == 2912 && !byte_3EFD5FC )
        {
          if ( (a2 & 0x10000) != 0 )
            dword_3EFD600 = 5;
          else
            dword_3EFD600 = 0;
          goto LABEL_59;
        }
      }
      else
      {
        if ( (unsigned __int16)a2 != 2888 )
        {
          switch ( (__int16)a2 )
          {
            case 1766:
              v14 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v19, 0x1CEu, dword_3EFD600, 0x64u, 0, 0, 0);
              v26 = 0;
              IEventEngine::SendAMessage(g_pEvnEngine, v14);
              v26 = -1;
              CEvn_Logic::~CEvn_Logic(v19);
              PlayGuiSound(2);
              break;
            case 1767:
              v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v20, 0x1CEu, dword_3EFD600, 0, 0, 0, 0);
              v26 = 1;
              IEventEngine::SendAMessage(g_pEvnEngine, v7);
              v26 = -1;
              CEvn_Logic::~CEvn_Logic(v20);
              PlayGuiSound(2);
              break;
            case 1768:
              v8 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v21, 0x1CEu, dword_3EFD600, 5u, 0, 0, 0);
              v26 = 2;
              IEventEngine::SendAMessage(g_pEvnEngine, v8);
              v26 = -1;
              CEvn_Logic::~CEvn_Logic(v21);
              PlayGuiSound(2);
              break;
            case 1769:
              v9 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v22, 0x1CEu, dword_3EFD600, 0xFFFFFFFB, 0, 0, 0);
              v26 = 3;
              IEventEngine::SendAMessage(g_pEvnEngine, v9);
              v26 = -1;
              CEvn_Logic::~CEvn_Logic(v22);
              PlayGuiSound(2);
              break;
            case 1770:
              v10 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v23, 0x1CEu, dword_3EFD600, 1u, 0, 0, 0);
              v26 = 4;
              IEventEngine::SendAMessage(g_pEvnEngine, v10);
              v26 = -1;
              CEvn_Logic::~CEvn_Logic(v23);
              PlayGuiSound(2);
              break;
            case 1771:
              v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v24, 0x1CEu, dword_3EFD600, 0xFFFFFFFF, 0, 0, 0);
              v26 = 5;
              IEventEngine::SendAMessage(g_pEvnEngine, v6);
              v26 = -1;
              CEvn_Logic::~CEvn_Logic(v24);
              PlayGuiSound(2);
              break;
            case 1775:
              if ( !byte_3EFD5FC )
              {
                if ( (a2 & 0x10000) != 0 )
                  dword_3EFD600 = 34;
                else
                  dword_3EFD600 = 0;
                goto LABEL_59;
              }
              break;
            case 1776:
              if ( !byte_3EFD5FC )
              {
                if ( (a2 & 0x10000) != 0 )
                  dword_3EFD600 = 8;
                else
                  dword_3EFD600 = 0;
                goto LABEL_59;
              }
              break;
            case 1777:
              if ( !byte_3EFD5FC )
              {
                if ( (a2 & 0x10000) != 0 )
                  dword_3EFD600 = 3;
                else
                  dword_3EFD600 = 0;
                goto LABEL_59;
              }
              break;
            case 1778:
              if ( !byte_3EFD5FC )
              {
                if ( (a2 & 0x10000) != 0 )
                {
                  v13 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v16, 0x1D0u, 0, 1u, 0, 0, 0);
                  v26 = 6;
                  IEventEngine::SendAMessage(g_pEvnEngine, v13);
                  v26 = -1;
                  CEvn_Logic::~CEvn_Logic(v16);
                }
                else
                {
                  v12 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v17, 0x1D0u, 0, 0, 0, 0, 0);
                  v26 = 7;
                  IEventEngine::SendAMessage(g_pEvnEngine, v12);
                  v26 = -1;
                  CEvn_Logic::~CEvn_Logic(v17);
                }
                PlayGuiSound(2);
                UpdateGuiDlgWeaponsmithBar();
              }
              break;
            case 1783:
            case 1784:
            case 1785:
            case 1787:
              GetSliderVals();
              v11 = CEvn_Logic::CEvn_Logic(
                      (CEvn_Logic *)v18,
                      0x1CFu,
                      ((unsigned __int8)dword_3EFD604[3] << 24) | ((unsigned __int8)dword_3EFD604[2] << 16) | ((unsigned __int8)dword_3EFD604[1] << 8) | LOBYTE(dword_3EFD604[0]),
                      0,
                      0,
                      0,
                      0);
              v26 = 8;
              IEventEngine::SendAMessage(g_pEvnEngine, v11);
              v26 = -1;
              CEvn_Logic::~CEvn_Logic(v18);
              PlayGuiSound(1);
              break;
            case 1788:
              if ( !byte_3EFD5FC )
              {
                if ( (a2 & 0x10000) != 0 )
                  dword_3EFD600 = 6;
                else
                  dword_3EFD600 = 0;
                goto LABEL_59;
              }
              break;
            default:
              return 1;
          }
          return 1;
        }
        if ( !byte_3EFD5FC )
        {
          if ( (a2 & 0x10000) != 0 )
            dword_3EFD600 = 38;
          else
            dword_3EFD600 = 0;
LABEL_59:
          PlayGuiSound(2);
        }
      }
      return 1;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369A079);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      return 1;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_369A07A);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      return 1;
    default:
      return 1;
  }
}


// address=[0x13d8c30]
// Decompiled from char InitGuiDlgXMD3Briefing()
void __cdecl InitGuiDlgXMD3Briefing(void) {
  
  int v0; // eax
  char result; // al
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax

  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 2923, 0);
  v0 = std::string::c_str(&unk_402C998);
  result = CScrollMultiline::SetText(s_cXMD3Scrolltext, v0);
  if ( !g_pStringEngine )
    return result;
  v2 = g_pStringEngine->GetString(g_pStringEngine, 880);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 2914, v2);
  v3 = (char *)std::string::c_str(&unk_402C97C);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 2919, v3);
  v4 = (char *)std::string::c_str(&unk_402C9B4);
  IGuiEngine::SetText((void *)g_pGUIEngine, 1, 2920, v4);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 2925, 0);
  IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 2926, 0);
  return IGuiEngine::SetText((void *)g_pGUIEngine, 1, 2918, (char *)&byte_369A0DE);
}


// address=[0x13d8d10]
// Decompiled from char __cdecl GuiDlgXMD3BriefingProc(unsigned int a1, int a2, int a3)
bool __cdecl GuiDlgXMD3BriefingProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  CEvn_Event *v7; // [esp+4h] [ebp-74h]
  CEvn_Event *v8; // [esp+Ch] [ebp-6Ch]
  unsigned int v9[2]; // [esp+14h] [ebp-64h] BYREF
  unsigned __int16 *v10[2]; // [esp+1Ch] [ebp-5Ch] BYREF
  __int16 v11; // [esp+24h] [ebp-54h]
  _BYTE v12[16]; // [esp+28h] [ebp-50h] BYREF
  CEvn_Event v13; // [esp+38h] [ebp-40h] BYREF
  CEvn_Event v14; // [esp+50h] [ebp-28h] BYREF
  int v15; // [esp+74h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  v9[1] = a1;
  switch ( a1 )
  {
    case 0u:
      InitGuiDlgXMD3Briefing();
      break;
    case 1u:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3u:
      v10[1] = (unsigned __int16 *)((unsigned __int16)a2 - 2915);
      switch ( (__int16)a2 )
      {
        case 2915:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v14, 0x2523u, 0, 0, 0);
          v15 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v15 = -1;
          CEvn_Event::~CEvn_Event(&v14);
          break;
        case 2916:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v13, 0x2524u, 0, 0, 0);
          v15 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v15 = -1;
          CEvn_Event::~CEvn_Event(&v13);
          break;
        case 2921:
          goto LABEL_15;
        case 2922:
          CScrollMultiline::ScrollDown(s_cXMD3Scrolltext);
          break;
        case 2924:
          if ( (a2 & 0x10000) != 0 )
          {
            v6 = (char *)std::string::c_str(&unk_402C9D0);
            IGuiEngine::SetText((void *)g_pGUIEngine, 1, 2918, v6);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 2926, 1);
            if ( g_pGameType )
            {
              if ( *(_DWORD *)(g_pGameType + 1016) )
              {
                v10[0] = 0;
                v9[0] = 0;
                IGuiEngine::LockOwnerImage((IGuiEngine *)g_pGUIEngine, 1, 2926, (struct SGuiRect *)v12, v10, v9);
                if ( v10[0] )
                {
                  CStateLobbyGameSettings::DrawMap(
                    *(unsigned __int16 **)(g_pGameType + 1016),
                    v10[0],
                    v9[0],
                    *(_DWORD *)(g_pGameType + 1020),
                    *(_DWORD *)(g_pGameType + 1024));
                  IGuiEngine::UnlockOwnerImage((IGuiEngine *)g_pGUIEngine, 1, 2926);
                }
              }
            }
            byte_402C9F5 = 1;
          }
          else
          {
            IGuiEngine::SetText((void *)g_pGUIEngine, 1, 2918, (char *)&byte_369A0E1);
            IGuiEngine::EraseOwnerImage((IGuiEngine *)g_pGUIEngine, 1, 2926);
            IGuiEngine::SetControlVisibility((void *)g_pGUIEngine, 1, 2926, 0);
            byte_402C9F5 = 0;
          }
          break;
        default:
          return 1;
      }
      break;
    case 8u:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369A0DF);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9u:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_369A0E0);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    case 0xAu:
      v11 = HIWORD(a2);
      if ( SHIWORD(a2) <= 0 )
      {
        if ( v11 < 0 )
          CScrollMultiline::ScrollDown(s_cXMD3Scrolltext);
      }
      else
      {
LABEL_15:
        CScrollMultiline::ScrollUp(s_cXMD3Scrolltext);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d9210]
// Decompiled from char InitGuiDlgXMD3Campaigns()
void __cdecl InitGuiDlgXMD3Campaigns(void) {
  
  char result; // al

  if ( !g_pStringEngine )
    return result;
  IGuiEngine::ResetRadioGroup((IGuiEngine *)g_pGUIEngine, 0, 2937);
  if ( dword_4031CFC )
    return IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 2937, 1);
  else
    return IGuiEngine::SelectControl((IGuiEngine *)g_pGUIEngine, 0, 2936, 1);
  return result;
}


// address=[0x13d9270]
// Decompiled from char __cdecl GuiDlgXMD3CampaignsProc(int a1, int a2, int a3)
bool __cdecl GuiDlgXMD3CampaignsProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Event *v6; // [esp+8h] [ebp-234h]
  CEvn_Event *v7; // [esp+10h] [ebp-22Ch]
  CEvn_Event *v8; // [esp+18h] [ebp-224h]
  CEvn_Event *v9; // [esp+24h] [ebp-218h]
  CEvn_Event *v10; // [esp+2Ch] [ebp-210h]
  CEvn_Event *v11; // [esp+34h] [ebp-208h]
  CEvn_Event *v12; // [esp+38h] [ebp-204h]
  CEvn_Event *v13; // [esp+40h] [ebp-1FCh]
  CEvn_Event *v14; // [esp+48h] [ebp-1F4h]
  CEvn_Event *v15; // [esp+50h] [ebp-1ECh]
  CEvn_Event *v16; // [esp+58h] [ebp-1E4h]
  CEvn_Event *v17; // [esp+60h] [ebp-1DCh]
  CEvn_Event *v18; // [esp+68h] [ebp-1D4h]
  CEvn_Event *v19; // [esp+70h] [ebp-1CCh]
  CEvn_Event *v20; // [esp+78h] [ebp-1C4h]
  CEvn_Event *v21; // [esp+80h] [ebp-1BCh]
  CEvn_Event *v22; // [esp+88h] [ebp-1B4h]
  CEvn_Event v23; // [esp+94h] [ebp-1A8h] BYREF
  CEvn_Event v24; // [esp+ACh] [ebp-190h] BYREF
  CEvn_Event v25; // [esp+C4h] [ebp-178h] BYREF
  CEvn_Event v26; // [esp+DCh] [ebp-160h] BYREF
  CEvn_Event v27; // [esp+F4h] [ebp-148h] BYREF
  CEvn_Event v28; // [esp+10Ch] [ebp-130h] BYREF
  CEvn_Event v29; // [esp+124h] [ebp-118h] BYREF
  CEvn_Event v30; // [esp+13Ch] [ebp-100h] BYREF
  CEvn_Event v31; // [esp+154h] [ebp-E8h] BYREF
  CEvn_Event v32; // [esp+16Ch] [ebp-D0h] BYREF
  CEvn_Event v33; // [esp+184h] [ebp-B8h] BYREF
  CEvn_Event v34; // [esp+19Ch] [ebp-A0h] BYREF
  CEvn_Event v35; // [esp+1B4h] [ebp-88h] BYREF
  CEvn_Event v36; // [esp+1CCh] [ebp-70h] BYREF
  CEvn_Event v37; // [esp+1E4h] [ebp-58h] BYREF
  CEvn_Event v38; // [esp+1FCh] [ebp-40h] BYREF
  CEvn_Event v39; // [esp+214h] [ebp-28h] BYREF
  int v40; // [esp+238h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgXMD3Campaigns();
      break;
    case 1:
      if ( (a2 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      switch ( (__int16)a2 )
      {
        case 2936:
          PlayGuiSound(2);
          dword_4031CFC = 0;
          break;
        case 2937:
          PlayGuiSound(2);
          dword_4031CFC = 1;
          break;
        case 2938:
          PlayGuiSound(2);
          v13 = CEvn_Event::CEvn_Event(&v38, 0x2522u, 0, 0, 0);
          v40 = 0;
          IEventEngine::SendAMessage(g_pEvnEngine, v13);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v38);
          break;
        case 2939:
          PlayGuiSound(2);
          v12 = CEvn_Event::CEvn_Event(&v37, 0x251Eu, 0, 0, 0);
          v40 = 1;
          IEventEngine::SendAMessage(g_pEvnEngine, v12);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v37);
          break;
        case 2940:
          PlayGuiSound(2);
          v11 = CEvn_Event::CEvn_Event(&v36, 0x251Eu, 1u, 0, 0);
          v40 = 2;
          IEventEngine::SendAMessage(g_pEvnEngine, v11);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v36);
          break;
        case 2941:
          PlayGuiSound(2);
          v10 = CEvn_Event::CEvn_Event(&v35, 0x251Eu, 2u, 0, 0);
          v40 = 3;
          IEventEngine::SendAMessage(g_pEvnEngine, v10);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v35);
          break;
        case 2942:
          PlayGuiSound(2);
          v9 = CEvn_Event::CEvn_Event(&v34, 0x251Eu, 3u, 0, 0);
          v40 = 4;
          IEventEngine::SendAMessage(g_pEvnEngine, v9);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v34);
          break;
        case 2943:
          PlayGuiSound(2);
          v8 = CEvn_Event::CEvn_Event(&v33, 0x251Fu, 0, 0, 0);
          v40 = 5;
          IEventEngine::SendAMessage(g_pEvnEngine, v8);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v33);
          break;
        case 2944:
          PlayGuiSound(2);
          v7 = CEvn_Event::CEvn_Event(&v32, 0x251Fu, 1u, 0, 0);
          v40 = 6;
          IEventEngine::SendAMessage(g_pEvnEngine, v7);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v32);
          break;
        case 2945:
          PlayGuiSound(2);
          v6 = CEvn_Event::CEvn_Event(&v31, 0x251Fu, 2u, 0, 0);
          v40 = 7;
          IEventEngine::SendAMessage(g_pEvnEngine, v6);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v31);
          break;
        case 2946:
          PlayGuiSound(2);
          v22 = CEvn_Event::CEvn_Event(&v30, 0x251Fu, 3u, 0, 0);
          v40 = 8;
          IEventEngine::SendAMessage(g_pEvnEngine, v22);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v30);
          break;
        case 2947:
          PlayGuiSound(2);
          v17 = CEvn_Event::CEvn_Event(&v26, 0x2521u, 0, 0, 0);
          v40 = 13;
          IEventEngine::SendAMessage(g_pEvnEngine, v17);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v26);
          break;
        case 2948:
          PlayGuiSound(2);
          v16 = CEvn_Event::CEvn_Event(&v25, 0x2521u, 1u, 0, 0);
          v40 = 14;
          IEventEngine::SendAMessage(g_pEvnEngine, v16);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v25);
          break;
        case 2949:
          PlayGuiSound(2);
          v15 = CEvn_Event::CEvn_Event(&v24, 0x2521u, 2u, 0, 0);
          v40 = 15;
          IEventEngine::SendAMessage(g_pEvnEngine, v15);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v24);
          break;
        case 2950:
          PlayGuiSound(2);
          v14 = CEvn_Event::CEvn_Event(&v23, 0x2521u, 3u, 0, 0);
          v40 = 16;
          IEventEngine::SendAMessage(g_pEvnEngine, v14);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v23);
          break;
        case 2951:
          PlayGuiSound(2);
          v21 = CEvn_Event::CEvn_Event(&v29, 0x2520u, 0, 0, 0);
          v40 = 9;
          IEventEngine::SendAMessage(g_pEvnEngine, v21);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v29);
          break;
        case 2952:
          PlayGuiSound(2);
          v20 = CEvn_Event::CEvn_Event(&v39, 0x2520u, 1u, 0, 0);
          v40 = 10;
          IEventEngine::SendAMessage(g_pEvnEngine, v20);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v39);
          break;
        case 2953:
          PlayGuiSound(2);
          v19 = CEvn_Event::CEvn_Event(&v28, 0x2520u, 2u, 0, 0);
          v40 = 11;
          IEventEngine::SendAMessage(g_pEvnEngine, v19);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v28);
          break;
        case 2954:
          PlayGuiSound(2);
          v18 = CEvn_Event::CEvn_Event(&v27, 0x2520u, 3u, 0, 0);
          v40 = 12;
          IEventEngine::SendAMessage(g_pEvnEngine, v18);
          v40 = -1;
          CEvn_Event::~CEvn_Event(&v27);
          break;
        default:
          return 1;
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369A0E2);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)&byte_369A0E3);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13d9d20]
// Decompiled from void InitGuiDlgYesNo()
void __cdecl InitGuiDlgYesNo(void) {
  
  char *v0; // eax
  char *v1; // eax

  if ( g_pStringEngine )
  {
    if ( dword_3F1E4A8 == 1 )
      v0 = g_pStringEngine->GetString(g_pStringEngine, 2550);
    else
      v0 = g_pStringEngine->GetString(g_pStringEngine, 1971);
    IGuiEngine::SetText((void *)g_pGUIEngine, 43, 1798, v0);
    v1 = g_pStringEngine->GetString(g_pStringEngine, 1421);
    IGuiEngine::SetText((void *)g_pGUIEngine, 43, 1796, v1);
  }
}


// address=[0x13d9dc0]
// Decompiled from char __cdecl GuiDlgYesNoProc(int a1, __int16 a2, int a3)
bool __cdecl GuiDlgYesNoProc(int a1, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // eax
  CEvn_Logic *v6; // [esp+4h] [ebp-68h]
  CEvn_Logic *v7; // [esp+Ch] [ebp-60h]
  _BYTE v8[32]; // [esp+1Ch] [ebp-50h] BYREF
  _BYTE v9[32]; // [esp+3Ch] [ebp-30h] BYREF
  int v10; // [esp+68h] [ebp-4h]

  if ( !g_pEvnEngine )
    return 0;
  switch ( a1 )
  {
    case 0:
      InitGuiDlgYesNo();
      break;
    case 1:
      if ( (a3 & 0x10000) != 0 )
        PlayGuiSound(1);
      else
        PlayGuiSound(0);
      break;
    case 3:
      if ( a2 == 1799 )
      {
        v7 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v9, 0x195u, 1u, 0, 0, 0, 0);
        v10 = 0;
        IEventEngine::SendAMessage(g_pEvnEngine, v7);
        v10 = -1;
        CEvn_Logic::~CEvn_Logic(v9);
        PlayGuiSound(2);
      }
      else if ( a2 == 1800 )
      {
        v6 = CEvn_Logic::CEvn_Logic((CEvn_Logic *)v8, 0x195u, 0, 0, 0, 0, 0);
        v10 = 1;
        IEventEngine::SendAMessage(g_pEvnEngine, v6);
        v10 = -1;
        CEvn_Logic::~CEvn_Logic(v8);
        PlayGuiSound(2);
      }
      break;
    case 8:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltip((char *)&byte_369A0E4);
      }
      else
      {
        v4 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltip(v4);
      }
      break;
    case 9:
      if ( a3 == -1 )
      {
        IGuiEngine::SetTooltipExt((char *)byte_369A0E5);
      }
      else
      {
        v5 = g_pStringEngine->GetString(g_pStringEngine, a3);
        IGuiEngine::SetTooltipExt(v5);
      }
      break;
    default:
      return 1;
  }
  return 1;
}


// address=[0x13e42d0]
// Decompiled from _DWORD *__thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::CRCGenerator<16,32773,0,0,1,1>(_DWORD *this)
public: __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::CRCGenerator<16,32773,0,0,1,1>(void) {
  
  *this = 0;
  return this;
}


// address=[0x13e6450]
// Decompiled from int __cdecl cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Bitmask(char a1)
private: unsigned long __cdecl cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Bitmask(int a1) {
  
  return 1 << a1;
}


// address=[0x13e6560]
// Decompiled from int __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetCRC(_DWORD *this)
public: unsigned long __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetCRC(void)const {
  
  return *this & cdm_crc::CRCGenerator<16,32773,0,0,1,1>::WidthMask(16);
}


// address=[0x13e65b0]
// Decompiled from int __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetNormalCRC(_DWORD *this)
public: unsigned long __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetNormalCRC(void)const {
  
  unsigned int CRC; // [esp+4h] [ebp-Ch]
  int i; // [esp+8h] [ebp-8h]
  int v4; // [esp+Ch] [ebp-4h]

  v4 = 0;
  CRC = cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetCRC(this);
  for ( i = 8; i <= 32; i += 8 )
  {
    v4 |= (unsigned __int8)CRC << (32 - i);
    CRC >>= 8;
  }
  return v4;
}


// address=[0x13e6650]
// Decompiled from int cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetWidth()
public: int __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetWidth(void)const {
  
  return 16;
}


// address=[0x13e6670]
// Decompiled from int __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Process(int *this, char a2)
public: void __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Process(unsigned char a2) {
  
  int result; // eax

  result = ((unsigned int)*this >> 8) ^ cdm_crc::CRCGenerator<16,32773,0,0,1,1>::CRCTable::operator[](
                                          cdm_crc::CRCGenerator_16_32773_0_0_1_1_::Table,
                                          (unsigned __int8)(*(_BYTE *)this ^ a2));
  *this = result;
  return result;
}


// address=[0x13e67a0]
// Decompiled from int __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Process(int *this, char *a2, int a3)
public: void __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Process(unsigned char * a2, int a3) {
  
  int result; // eax
  int i; // [esp+4h] [ebp-8h]

  for ( i = 0; i < a3; ++i )
  {
    cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Process(this, *a2++);
    result = i + 1;
  }
  return result;
}


// address=[0x13e6800]
// Decompiled from unsigned int __cdecl cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Reflect(unsigned int a1, int a2)
private: unsigned long __cdecl cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Reflect(unsigned long a1, int a2) {
  
  unsigned int v3; // [esp+0h] [ebp-8h]
  int i; // [esp+4h] [ebp-4h]

  v3 = a1;
  for ( i = 0; i < a2; ++i )
  {
    if ( (v3 & 1) != 0 )
      a1 |= cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Bitmask(a2 - 1 - i);
    else
      a1 &= ~cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Bitmask(a2 - 1 - i);
    v3 >>= 1;
  }
  return a1;
}


// address=[0x13e68b0]
// Decompiled from int __cdecl cdm_crc::CRCGenerator<16,32773,0,0,1,1>::WidthMask(char a1)
private: unsigned long __cdecl cdm_crc::CRCGenerator<16,32773,0,0,1,1>::WidthMask(int a1) {
  
  return (2 * (1 << (a1 - 1)) - 2) | 1;
}


// address=[0x13ee6d0]
// Decompiled from int __cdecl operator^<signed char>(int a1, int a2)
std::istream & __cdecl operator^<signed char>(std::istream & a1, signed char & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee6f0]
// Decompiled from int __cdecl operator^<char>(int a1, int a2)
std::istream & __cdecl operator^<char>(std::istream & a1, char & a2) {
  
  Serial::Serialize(a1, a2, 1);
  return a1;
}


// address=[0x13ee710]
// Decompiled from int __cdecl operator^<unsigned char>(int a1, int a2)
std::istream & __cdecl operator^<unsigned char>(std::istream & a1, unsigned char & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee730]
// Decompiled from int __cdecl operator^<short>(int a1, int a2)
std::istream & __cdecl operator^<short>(std::istream & a1, short & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee750]
// Decompiled from int __cdecl operator^<unsigned short>(int a1, int a2)
std::istream & __cdecl operator^<unsigned short>(std::istream & a1, unsigned short & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee770]
// Decompiled from int __cdecl operator^<int>(struct std::istream *a1, int *a2)
std::istream & __cdecl operator^<int>(std::istream & a1, int & a2) {
  
  Serial::Serialize<int>(a1, a2);
  return (int)a1;
}


// address=[0x13ee790]
// Decompiled from int __cdecl operator^<unsigned int>(int a1, int a2)
std::istream & __cdecl operator^<unsigned int>(std::istream & a1, unsigned int & a2) {
  
  Serial::Serialize<unsigned int>(a1, a2);
  return a1;
}


// address=[0x13ee7b0]
// Decompiled from int __cdecl operator^<unsigned long>(int a1, int a2)
std::istream & __cdecl operator^<unsigned long>(std::istream & a1, unsigned long & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee7d0]
// Decompiled from struct std::ostream *__cdecl operator^<unsigned long>(struct std::ostream *a1, const unsigned int *a2)
std::ostream & __cdecl operator^<unsigned long>(std::ostream & a1, unsigned long const & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee7f0]
// Decompiled from int __cdecl operator^<float>(int a1, int a2)
std::istream & __cdecl operator^<float>(std::istream & a1, float & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee810]
// Decompiled from int __cdecl operator^<double>(int a1, int a2)
std::istream & __cdecl operator^<double>(std::istream & a1, double & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee830]
// Decompiled from int __cdecl operator^<std::string>(int a1, int a2)
std::istream & __cdecl operator^<std::string >(std::istream & a1, std::string & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee850]
// Decompiled from int __cdecl operator^<bool>(int a1, int a2)
std::istream & __cdecl operator^<bool>(std::istream & a1, bool & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x13ee870]
// Decompiled from int __cdecl Serial::Serialize<int>(int a1, int a2)
void __cdecl Serial::Serialize<int>(std::istream & a1, int & a2) {
  
  return std::istream::operator>>(a2);
}


// address=[0x13ee890]
// Decompiled from int __cdecl Serial::Serialize<unsigned int>(int a1, int a2)
void __cdecl Serial::Serialize<unsigned int>(std::istream & a1, unsigned int & a2) {
  
  return std::istream::operator>>(a2);
}


// address=[0x13f5350]
// Decompiled from int __cdecl Serial::Serialize(int a1, _BYTE *a2)
void __cdecl Serial::Serialize(std::istream & a1, signed char & a2) {
  
  int v2; // ecx
  int result; // eax
  int v4; // [esp+0h] [ebp-4h] BYREF

  v4 = v2;
  result = std::istream::operator>>(&v4);
  *a2 = v4;
  return result;
}


// address=[0x13f5380]
// Decompiled from int __cdecl Serial::Serialize(int a1, _BYTE *a2)
void __cdecl Serial::Serialize(std::istream & a1, unsigned char & a2) {
  
  int v2; // ecx
  int result; // eax
  int v4; // [esp+0h] [ebp-4h] BYREF

  v4 = v2;
  result = std::istream::operator>>(&v4);
  *a2 = v4;
  return result;
}


// address=[0x13f53b0]
// Decompiled from int __cdecl Serial::Serialize(int a1, int a2)
void __cdecl Serial::Serialize(std::istream & a1, short & a2) {
  
  return std::istream::operator>>(a2);
}


// address=[0x13f53d0]
// Decompiled from int __cdecl Serial::Serialize(int a1, int a2)
void __cdecl Serial::Serialize(std::istream & a1, unsigned short & a2) {
  
  return std::istream::operator>>(a2);
}


// address=[0x13f53f0]
// Decompiled from int __cdecl Serial::Serialize(int a1, int a2)
void __cdecl Serial::Serialize(std::istream & a1, unsigned long & a2) {
  
  return std::istream::operator>>(a2);
}


// address=[0x13f5410]
// Decompiled from int __cdecl Serial::Serialize(int a1, float *a2)
void __cdecl Serial::Serialize(std::istream & a1, float & a2) {
  
  int result; // eax
  int v3; // [esp+4h] [ebp-10Ch]
  bool v4; // [esp+Bh] [ebp-105h]
  char String[256]; // [esp+Ch] [ebp-104h] BYREF

  memset(String, 0, 0xFFu);
  v4 = 0;
  do
    std::istream::read(String, 1, 0);
  while ( String[0] == 32 );
  v3 = 1;
  while ( !v4 )
  {
    std::istream::read(&String[v3], 1, 0);
    v4 = String[v3++] == 32;
  }
  *a2 = j__atof(String);
  return result;
}


// address=[0x13f5560]
// Decompiled from int __cdecl Serial::Serialize(int a1, int a2)
void __cdecl Serial::Serialize(std::istream & a1, double & a2) {
  
  return std::istream::operator>>(a2);
}


// address=[0x13f5580]
// Decompiled from int __cdecl Serial::Serialize(int a1, int a2)
void __cdecl Serial::Serialize(std::istream & a1, bool & a2) {
  
  return std::istream::operator>>(a2);
}


// address=[0x13f55a0]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize(struct std::ostream *a1, const unsigned int *a2)
void __cdecl Serial::Serialize(std::ostream & a1, unsigned long const & a2) {
  
  struct std::ostream *v2; // eax
  struct std::ostream *v3; // eax
  unsigned int v5; // [esp-8h] [ebp-8h]

  v5 = *a2;
  v2 = std::operator<<<std::char_traits<char>>(a1, 32);
  v3 = std::ostream::operator<<(v2, v5);
  return std::operator<<<std::char_traits<char>>(v3, 32);
}


// address=[0x13ff240]
// Decompiled from int RegisterClasses()
void __cdecl RegisterClasses(void) {
  
  int result; // eax

  result = (unsigned __int8)byte_3EFE4A8;
  if ( byte_3EFE4A8 )
    return result;
  CPersistence::RegisterClassWhithId(&CBuilding::m_iClassID, CBuilding::New, 0);
  CPersistence::RegisterClassWhithId(&CSettler::m_iClassID, CSettler::New, 0);
  CPersistence::RegisterClassWhithId(&CPile::m_iClassID, CPile::New, 0);
  CPersistence::RegisterClassWhithId(&CLandAnimal::m_iClassID, CLandAnimal::New, 0);
  CPersistence::RegisterClassWhithId(&CPlant::m_iClassID, CPlant::New, 0);
  CPersistence::RegisterClassWhithId(&CStone::m_iClassID, CStone::New, 0);
  CPersistence::RegisterClassWhithId(&CTree::m_iClassID, CTree::New, 0);
  CPersistence::RegisterClassWhithId(&CShadowHerb::m_iClassID, CShadowHerb::New, 0);
  CPersistence::RegisterClassWhithId(&CDecoObject::m_iClassID, CDecoObject::New, 0);
  CPersistence::RegisterClassWhithId(&CAnyWherePileRole::m_iClassID, CAnyWherePileRole::New, 0);
  CPersistence::RegisterClassWhithId(&CBuildingSitePileRole::m_iClassID, CBuildingSitePileRole::New, 0);
  CPersistence::RegisterClassWhithId(&CDeliverPileRole::m_iClassID, CDeliverPileRole::New, 0);
  CPersistence::RegisterClassWhithId(&CProductionPileRole::m_iClassID, CProductionPileRole::New, 0);
  CPersistence::RegisterClassWhithId(&CStoragePileRole::m_iClassID, CStoragePileRole::New, 0);
  CPersistence::RegisterClassWhithId(&CTradePileRole::m_iClassID, CTradePileRole::New, 0);
  CPersistence::RegisterClassWhithId(&CAnimalRanchRole::m_iClassID, CAnimalRanchRole::New, 0);
  CPersistence::RegisterClassWhithId(&CBarrackRole::m_iClassID, CBarrackRole::New, 0);
  CPersistence::RegisterClassWhithId(&CBigTempleRole::m_iClassID, CBigTempleRole::New, 0);
  CPersistence::RegisterClassWhithId(&CBuildingSiteRole::m_iClassID, CBuildingSiteRole::New, 0);
  CPersistence::RegisterClassWhithId(&CCastleRole::m_iClassID, CCastleRole::New, 0);
  CPersistence::RegisterClassWhithId(&CDarkTempleRole::m_iClassID, CDarkTempleRole::New, 0);
  CPersistence::RegisterClassWhithId(&CEyeCatcherRole::m_iClassID, CEyeCatcherRole::New, 0);
  CPersistence::RegisterClassWhithId(&CFarmBuildingRole::m_iClassID, CFarmBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CGatherBuildingRole::m_iClassID, CGatherBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CLookoutTowerRole::m_iClassID, CLookoutTowerRole::New, 0);
  CPersistence::RegisterClassWhithId(&CMilitaryBuildingRole::m_iClassID, CMilitaryBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CMineRole::m_iClassID, CMineRole::New, 0);
  CPersistence::RegisterClassWhithId(&CProductionBuildingRole::m_iClassID, CProductionBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CResidenceBuildingRole::m_iClassID, CResidenceBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CSimpleBuildingRole::m_iClassID, CSimpleBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CSmallTempleRole::m_iClassID, CSmallTempleRole::New, 0);
  CPersistence::RegisterClassWhithId(&CStorageBuildingRole::m_iClassID, CStorageBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CTradingBuildingRole::m_iClassID, CTradingBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CWorkshopBuildingRole::m_iClassID, CWorkshopBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CWorkUpBuildingRole::m_iClassID, CWorkUpBuildingRole::New, 0);
  CPersistence::RegisterClassWhithId(&CBuilderRole::m_iClassID, CBuilderRole::New, 0);
  CPersistence::RegisterClassWhithId(&CCarrierRole::m_iClassID, CCarrierRole::New, 0);
  CPersistence::RegisterClassWhithId(&CDarkGardenerRole::m_iClassID, CDarkGardenerRole::New, 0);
  CPersistence::RegisterClassWhithId(&CDiggerRole::m_iClassID, CDiggerRole::New, 0);
  CPersistence::RegisterClassWhithId(&CHunterRole::m_iClassID, CHunterRole::New, 0);
  CPersistence::RegisterClassWhithId(&CDonkeyRole::m_iClassID, CDonkeyRole::New, 0);
  CPersistence::RegisterClassWhithId(&CDoorRole::m_iClassID, CDoorRole::New, 0);
  CPersistence::RegisterClassWhithId(&CFleeRole::m_iClassID, CFleeRole::New, 0);
  CPersistence::RegisterClassWhithId(&CFreeWorkerRole::m_iClassID, CFreeWorkerRole::New, 0);
  CPersistence::RegisterClassWhithId(&CGardenerRole::m_iClassID, CGardenerRole::New, 0);
  CPersistence::RegisterClassWhithId(&CGeologistRole::m_iClassID, CGeologistRole::New, 0);
  CPersistence::RegisterClassWhithId(&CHouseWorkerRole::m_iClassID, CHouseWorkerRole::New, 0);
  CPersistence::RegisterClassWhithId(&CMushroomFarmerRole::m_iClassID, CMushroomFarmerRole::New, 0);
  CPersistence::RegisterClassWhithId(&CPioneerRole::m_iClassID, CPioneerRole::New, 0);
  CPersistence::RegisterClassWhithId(&CPriestRole::m_iClassID, CPriestRole::New, 0);
  CPersistence::RegisterClassWhithId(&CSaboteurRole::m_iClassID, CSaboteurRole::New, 0);
  CPersistence::RegisterClassWhithId(&CShamanRole::m_iClassID, CShamanRole::New, 0);
  CPersistence::RegisterClassWhithId(&CSlaveRole::m_iClassID, CSlaveRole::New, 0);
  CPersistence::RegisterClassWhithId(&CSoldierRole::m_iClassID, CSoldierRole::New, 0);
  CPersistence::RegisterClassWhithId(&CThiefRole::m_iClassID, CThiefRole::New, 0);
  CPersistence::RegisterClassWhithId(&CTowerSoldier::m_iClassID, CTowerSoldier::New, 0);
  CPersistence::RegisterClassWhithId(&CCart::m_iClassID, CCart::New, 0);
  CPersistence::RegisterClassWhithId(&CRomanCatapult::m_iClassID, CRomanCatapult::New, 0);
  CPersistence::RegisterClassWhithId(&CMayaCatapult::m_iClassID, CMayaCatapult::New, 0);
  CPersistence::RegisterClassWhithId(&CVikingCatapult::m_iClassID, CVikingCatapult::New, 0);
  CPersistence::RegisterClassWhithId(&CTrojanCatapult::m_iClassID, CTrojanCatapult::New, 0);
  CPersistence::RegisterClassWhithId(&CFerryShip::m_iClassID, CFerryShip::New, 0);
  CPersistence::RegisterClassWhithId(&CTransportShip::m_iClassID, CTransportShip::New, 0);
  CPersistence::RegisterClassWhithId(&CWarShip::m_iClassID, CWarShip::New, 0);
  CPersistence::RegisterClassWhithId(&CEntityTask::m_iClassID, CEntityTask::New, 0);
  CPersistence::RegisterClassWhithId(&CEntityEvent::m_iClassID, CEntityEvent::New, 0);
  CPersistence::RegisterClassWhithId(&CEcoSector::m_iClassID, CEcoSector::New, 0);
  CPersistence::RegisterClassWhithId(&CGoodTransportPriority::m_iClassID, CGoodTransportPriority::New, 0);
  CPersistence::RegisterClassWhithId(&CBuildingSupplyPriority::m_iClassID, CBuildingSupplyPriority::New, 0);
  CPersistence::RegisterClassWhithId(&CDarkMushroomFarmRole::m_iClassID, CDarkMushroomFarmRole::New, 0);
  CPersistence::RegisterClassWhithId(&CRomanWarShip::m_iClassID, CRomanWarShip::New, 0);
  CPersistence::RegisterClassWhithId(&CMayaWarShip::m_iClassID, CMayaWarShip::New, 0);
  CPersistence::RegisterClassWhithId(&CVikingWarShip::m_iClassID, CVikingWarShip::New, 0);
  CPersistence::RegisterClassWhithId(&CTrojanWarShip::m_iClassID, CTrojanWarShip::New, 0);
  CPersistence::RegisterClassWhithId(&CSquadLeaderRole::m_iClassID, CSquadLeaderRole::New, 0);
  CPersistence::RegisterClassWhithId(&CManakopter::m_iClassID, CManakopter::New, 0);
  CPersistence::RegisterClassWhithId(&CManakopterHallRole::m_iClassID, CManakopterHallRole::New, 0);
  result = CPersistence::RegisterClassWhithId(&CHJBRole::m_iClassID, CHJBRole::New, 0);
  byte_3EFE4A8 = 1;
  return result;
}


// address=[0x1402ac0]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize(struct std::ostream *a1, char a2, char a3)
void __cdecl Serial::Serialize(std::ostream & a1, char a2, char a3) {
  
  struct std::ostream *v3; // eax
  int v5; // [esp+0h] [ebp-4h]

  if ( a2 == 92 )
  {
    v3 = std::operator<<<std::char_traits<char>>(a1, 92);
    return std::operator<<<std::char_traits<char>>(v3, 92);
  }
  else if ( !j__isprint(a2) || a2 == a3 )
  {
    v5 = std::ios_base::flags((char *)a1 + *(_DWORD *)(*(_DWORD *)a1 + 4));
    std::operator<<<std::char_traits<char>>(a1, 92);
    std::ostream::operator<<(std::hex);
    std::ostream::operator<<((a2 & 0xF0) >> 4);
    std::ostream::operator<<(a2 & 0xF);
    return (struct std::ostream *)std::ios_base::flags(
                                    (struct std::ostream *)((char *)a1 + *(_DWORD *)(*(_DWORD *)a1 + 4)),
                                    v5);
  }
  else
  {
    return std::operator<<<std::char_traits<char>>(a1, a2);
  }
}


// address=[0x1402b90]
// [Decompilation failed for void __cdecl Serial::Serialize(std::ostream &,char const * &)]

// address=[0x1402c00]
// [Decompilation failed for void __cdecl Serial::Serialize(std::ostream &,std::string const &)]

// address=[0x1402c80]
// Decompiled from char __cdecl Serial::Serialize(int a1, _BYTE *a2, char a3)
bool __cdecl Serial::Serialize(std::istream & a1, char & a2, bool a3) {
  
  int v3; // eax
  int v5; // [esp+0h] [ebp-10h]
  char v6; // [esp+4h] [ebp-Ch]
  char v7; // [esp+8h] [ebp-8h]
  char v8; // [esp+Ch] [ebp-4h]
  char v9; // [esp+Dh] [ebp-3h] BYREF
  char v10; // [esp+Eh] [ebp-2h] BYREF
  char v11; // [esp+Fh] [ebp-1h]

  v5 = std::ios_base::flags(*(_DWORD *)(*(_DWORD *)a1 + 4) + a1);
  if ( !a3 )
    std::ios_base::unsetf((std::ios_base *)(*(_DWORD *)(*(_DWORD *)a1 + 4) + a1), 1);
  v8 = 0;
  std::operator>><char,std::char_traits<char>>(a1, &v9);
  if ( v9 == 92 )
  {
    v8 = 1;
    std::operator>><char,std::char_traits<char>>(a1, &v9);
    if ( v9 == 92 )
    {
      *a2 = 92;
    }
    else
    {
      v11 = v9;
      std::operator>><char,std::char_traits<char>>(a1, &v10);
      if ( !j__isxdigit(v11) || !j__isxdigit(v10) )
      {
        std::ios_base::flags((std::ios_base *)(*(_DWORD *)(*(_DWORD *)a1 + 4) + a1), v5);
        v3 = std::ios_base::rdstate((pairNode *)(*(_DWORD *)(*(_DWORD *)a1 + 4) + a1));
        std::ios::clear(v3 | 2, 0);
        return 1;
      }
      v11 = j__toupper(v11);
      if ( v11 <= 57 )
        v7 = 48;
      else
        v7 = 55;
      v11 -= v7;
      v10 = j__toupper(v10);
      if ( v10 <= 57 )
        v6 = 48;
      else
        v6 = 55;
      v10 -= v6;
      *a2 = v10 | (16 * v11);
    }
  }
  else
  {
    *a2 = v9;
  }
  std::ios_base::flags((std::ios_base *)(*(_DWORD *)(*(_DWORD *)a1 + 4) + a1), v5);
  return v8;
}


// address=[0x1402e20]
// Decompiled from int __cdecl Serial::Serialize(int a1, void *a2)
void __cdecl Serial::Serialize(std::istream & a1, std::string & a2) {
  
  int v2; // ecx
  int v3; // eax
  int result; // eax
  char v5; // [esp+1h] [ebp-1h] BYREF

  v5 = HIBYTE(v2);
  std::operator>><char,std::char_traits<char>>(a1, &v5);
  if ( v5 == 34 )
  {
    std::string::operator=(a2, (char *)byte_369C8A1);
    while ( 1 )
    {
      result = (unsigned __int8)std::ios_base::operator bool(*(_DWORD *)(*(_DWORD *)a1 + 4) + a1);
      if ( !(_BYTE)result )
        break;
      result = (unsigned __int8)Serial::Serialize(a1, &v5, 0);
      if ( !(_BYTE)result && v5 == 34 )
        break;
      std::string::operator+=(v5);
    }
  }
  else
  {
    v3 = std::ios_base::rdstate((pairNode *)(*(_DWORD *)(*(_DWORD *)a1 + 4) + a1));
    return std::ios::clear(v3 | 2, 0);
  }
  return result;
}


// address=[0x140e460]
// Decompiled from int __cdecl operator^<int>(int a1, int *a2)
std::ostream & __cdecl operator^<int>(std::ostream & a1, int const & a2) {
  
  Serial::Serialize<int>(a1, a2);
  return a1;
}


// address=[0x140e480]
// Decompiled from int __cdecl operator^<unsigned int>(int a1, int *a2)
std::ostream & __cdecl operator^<unsigned int>(std::ostream & a1, unsigned int const & a2) {
  
  Serial::Serialize<unsigned int>(a1, a2);
  return a1;
}


// address=[0x140e4a0]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize<int>(struct std::ostream *a1, int *a2)
void __cdecl Serial::Serialize<int>(std::ostream & a1, int const & a2) {
  
  struct std::ostream *v2; // eax
  int v4; // [esp-8h] [ebp-8h]

  v4 = *a2;
  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = (struct std::ostream *)std::ostream::operator<<(v4);
  return std::operator<<<std::char_traits<char>>(v2, 32);
}


// address=[0x140e4e0]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize<unsigned int>(struct std::ostream *a1, int *a2)
void __cdecl Serial::Serialize<unsigned int>(std::ostream & a1, unsigned int const & a2) {
  
  struct std::ostream *v2; // eax
  int v4; // [esp-8h] [ebp-8h]

  v4 = *a2;
  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = (struct std::ostream *)std::ostream::operator<<(v4);
  return std::operator<<<std::char_traits<char>>(v2, 32);
}


// address=[0x14147e0]
// Decompiled from _DWORD *__thiscall TStaticConfigIntArray<6>::TStaticConfigIntArray<6>(  _DWORD *this,  int a2,  int a3,  int a4,  int a5,  int a6,  int a7,  int a8,  int a9)
public: __thiscall TStaticConfigIntArray<6>::TStaticConfigIntArray<6>(char const * a2, char const * a3, int a4, int a5, int a6, int a7, int a8, int a9) {
  
  TStaticConfigIntArrayBase<6>::TStaticConfigIntArrayBase<6>(a2, a3);
  *this = &TStaticConfigIntArray_6_::_vftable_;
  this[2] = a4;
  this[3] = a5;
  this[4] = a6;
  this[5] = a7;
  this[6] = a8;
  this[7] = a9;
  return this;
}


// address=[0x14148a0]
// Decompiled from _DWORD *__thiscall TStaticConfigIntArrayBase<6>::TStaticConfigIntArrayBase<6>(_DWORD *this, int a2, int a3)
private: __thiscall TStaticConfigIntArrayBase<6>::TStaticConfigIntArrayBase<6>(char const * a2, char const * a3) {
  
  CStaticConfigVar::CStaticConfigVar(this, a2, a3, 2, 6);
  *this = &TStaticConfigIntArrayBase_6_::_vftable_;
  return this;
}


// address=[0x1415250]
// Decompiled from int __thiscall TStaticConfigIntArray<6>::~TStaticConfigIntArray<6>(void *this)
public: __thiscall TStaticConfigIntArray<6>::~TStaticConfigIntArray<6>(void) {
  
  return TStaticConfigIntArrayBase<6>::~TStaticConfigIntArrayBase<6>(this, this);
}


// address=[0x1415270]
// Decompiled from CConfigVar *__thiscall TStaticConfigIntArrayBase<6>::~TStaticConfigIntArrayBase<6>(CStaticConfigVar *this)
public: __thiscall TStaticConfigIntArrayBase<6>::~TStaticConfigIntArrayBase<6>(void) {
  
  return CStaticConfigVar::~CStaticConfigVar(this);
}


// address=[0x1417130]
// Decompiled from char *__thiscall TStaticConfigIntArrayBase<6>::GetIntArray(char *this)
public: int * __thiscall TStaticConfigIntArrayBase<6>::GetIntArray(void) {
  
  return this + 8;
}


// address=[0x1417150]
// Decompiled from char *__thiscall TStaticConfigIntArrayBase<6>::GetIntArray(char *this)
public: int const * __thiscall TStaticConfigIntArrayBase<6>::GetIntArray(void)const {
  
  return this + 8;
}


// address=[0x141db20]
// Decompiled from int __cdecl Grid::TurnLeft(int pos)
int __cdecl Grid::TurnLeft(int pos) {
  
  int dir; // [esp+0h] [ebp-4h]

  if ( pos )
    dir = 0;
  else
    dir = 6;
  return pos + dir - 1;
}


// address=[0x141db60]
// Decompiled from int __cdecl Grid::TurnRight(int pos)
int __cdecl Grid::TurnRight(int pos) {
  
  return pos == 5 ? 0 : pos + 1;
}


// address=[0x14258b0]
// Decompiled from int __thiscall TDestructor<CDefineTranslator>::TDestructor<CDefineTranslator>(int this, int a2, int a3)
public: __thiscall TDestructor<class CDefineTranslator>::TDestructor<class CDefineTranslator>(class CDefineTranslator * a2, class CDestructionPhase a3) {
  
  CDestructor::CDestructor((CDestructor *)this, a3);
  *(_DWORD *)this = &TDestructor_CDefineTranslator_::_vftable_;
  *(_DWORD *)(this + 8) = a2;
  return this;
}


// address=[0x14269a0]
// Decompiled from CDefineTranslator *TDestructor<CDefineTranslator>::Destroy()
public: void __thiscall TDestructor<class CDefineTranslator>::Destroy(void) {
  
  return CDefineTranslator::DestroyInstance();
}


// address=[0x14326b0]
// Decompiled from int __cdecl operator^<signed char>(int a1, int a2)
std::ostream & __cdecl operator^<signed char>(std::ostream & a1, signed char const & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x14326d0]
// Decompiled from struct std::ostream *__cdecl operator^<unsigned char>(struct std::ostream *a1, BYTE *a2)
std::ostream & __cdecl operator^<unsigned char>(std::ostream & a1, unsigned char const & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x14326f0]
// Decompiled from int __cdecl operator^<short>(struct std::ostream *a1, __int16 *a2)
std::ostream & __cdecl operator^<short>(std::ostream & a1, short const & a2) {
  
  Serial::Serialize((int)a1, *a2);
  return (int)a1;
}


// address=[0x1432720]
// Decompiled from int __cdecl operator^<unsigned short>(int a1, __int16 *a2)
std::ostream & __cdecl operator^<unsigned short>(std::ostream & a1, unsigned short const & a2) {
  
  Serial::Serialize(a1, *a2);
  return a1;
}


// address=[0x1432750]
// Decompiled from int __cdecl LoadArray<signed char>(int a1, int a2, size_t a3)
std::istream & __cdecl LoadArray<signed char>(std::istream & a1, signed char * const a2, unsigned int a3) {
  
  int v4; // [esp+8h] [ebp-1Ch] BYREF
  int v5; // [esp+Ch] [ebp-18h]
  _BYTE *v6; // [esp+10h] [ebp-14h]
  size_t v7; // [esp+14h] [ebp-10h]
  size_t Size; // [esp+18h] [ebp-Ch] BYREF
  size_t i; // [esp+1Ch] [ebp-8h]
  size_t j; // [esp+20h] [ebp-4h]

  v5 = 1;
  v7 = a3;
  v4 = 0;
  Size = 0;
  Serial::Serialize<unsigned int>(a1, &v4);
  if ( v5 != v4
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         267,
         "iElementSize == iReadiElementSize") == 1 )
  {
    __debugbreak();
  }
  Serial::Serialize<unsigned int>(a1, &Size);
  if ( v7 != Size
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         270,
         "iNumberOfElements == iReadNumberOfElements") == 1 )
  {
    __debugbreak();
  }
  if ( Size <= v7 )
  {
    for ( i = 0; i < Size; ++i )
      operator^<signed char>(a1, i + a2);
    for ( i = Size; i < Size; ++i )
      memset((void *)(i + a2), 0, 1u);
    return a1;
  }
  else
  {
    v6 = operator new[](Size);
    for ( j = 0; j < Size; ++j )
      operator^<signed char>(a1, &v6[j]);
    for ( j = 0; j < v7; ++j )
      *(_BYTE *)(j + a2) = v6[j];
    operator delete[](v6);
    return a1;
  }
}


// address=[0x1432940]
// Decompiled from int __cdecl LoadArray<unsigned short>(int a1, int a2, unsigned int a3)
std::istream & __cdecl LoadArray<unsigned short>(std::istream & a1, unsigned short * const a2, unsigned int a3) {
  
  int v4; // [esp+Ch] [ebp-1Ch] BYREF
  int v5; // [esp+10h] [ebp-18h]
  _WORD *v6; // [esp+14h] [ebp-14h]
  unsigned int v7; // [esp+18h] [ebp-10h]
  unsigned int v8; // [esp+1Ch] [ebp-Ch] BYREF
  unsigned int i; // [esp+20h] [ebp-8h]
  unsigned int j; // [esp+24h] [ebp-4h]

  v5 = 2;
  v7 = a3 / 2;
  v4 = 0;
  v8 = 0;
  Serial::Serialize<unsigned int>(a1, &v4);
  if ( v5 != v4
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         267,
         "iElementSize == iReadiElementSize") == 1 )
  {
    __debugbreak();
  }
  Serial::Serialize<unsigned int>(a1, &v8);
  if ( v7 != v8
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         270,
         "iNumberOfElements == iReadNumberOfElements") == 1 )
  {
    __debugbreak();
  }
  if ( v8 <= v7 )
  {
    for ( i = 0; i < v8; ++i )
      operator^<unsigned short>(a1, a2 + 2 * i);
    for ( i = v8; i < v8; ++i )
      memset((void *)(a2 + 2 * i), 0, 2u);
    return a1;
  }
  else
  {
    v6 = operator new[](2 * v8);
    for ( j = 0; j < v8; ++j )
      operator^<unsigned short>(a1, &v6[j]);
    for ( j = 0; j < v7; ++j )
      *(_WORD *)(a2 + 2 * j) = v6[j];
    operator delete[](v6);
    return a1;
  }
}


// address=[0x1432b60]
// Decompiled from struct std::istream *__cdecl LoadVector<unsigned short>(struct std::istream *a1, int arg4)
std::istream & __cdecl LoadVector<unsigned short>(std::istream & a1, class std::vector<unsigned short,class std::allocator<unsigned short> > & arg4) {
  
  int a2; // [esp+0h] [ebp-Ch] BYREF
  int i; // [esp+4h] [ebp-8h]
  _BYTE v5[4]; // [esp+8h] [ebp-4h] BYREF

  if ( std::vector<unsigned short>::size(arg4)
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         304,
         "_rVector.size()==0") == 1 )
  {
    __debugbreak();
  }
  operator^<int>(a1, &a2);
  for ( i = 0; i < a2; ++i )
  {
    operator^<unsigned short>(a1, v5);
    std::vector<unsigned short>::push_back(v5);
  }
  return a1;
}


// address=[0x1432c10]
// Decompiled from int __cdecl StoreArray<signed char>(int a1, int a2, unsigned int a3)
std::ostream & __cdecl StoreArray<signed char>(std::ostream & a1, signed char const * const a2, unsigned int a3) {
  
  unsigned int v4; // [esp+0h] [ebp-Ch] BYREF
  int v5; // [esp+4h] [ebp-8h] BYREF
  unsigned int i; // [esp+8h] [ebp-4h]

  v5 = 1;
  v4 = a3;
  Serial::Serialize<unsigned int>(a1, &v5);
  Serial::Serialize<unsigned int>(a1, (int *)&v4);
  for ( i = 0; i < v4; ++i )
    operator^<signed char>(a1, i + a2);
  return a1;
}


// address=[0x1432ca0]
// Decompiled from struct std::ostream *__cdecl StoreArray<unsigned short>(struct std::ostream *a1, int a2, unsigned int a3)
std::ostream & __cdecl StoreArray<unsigned short>(std::ostream & a1, unsigned short const * const a2, unsigned int a3) {
  
  unsigned int v4; // [esp+0h] [ebp-Ch] BYREF
  int v5; // [esp+4h] [ebp-8h] BYREF
  unsigned int i; // [esp+8h] [ebp-4h]

  v5 = 2;
  v4 = a3 / 2;
  Serial::Serialize<unsigned int>((int)a1, &v5);
  Serial::Serialize<unsigned int>((int)a1, (int *)&v4);
  for ( i = 0; i < v4; ++i )
    operator^<unsigned short>(a1, (WORD *)(a2 + 2 * i));
  return a1;
}


// address=[0x1432d30]
// Decompiled from struct std::ostream *__cdecl StoreVector<unsigned short>(struct std::ostream *a1, int a2)
std::ostream & __cdecl StoreVector<unsigned short>(std::ostream & a1, class std::vector<unsigned short,class std::allocator<unsigned short> > & a2) {
  
  _BYTE v3[12]; // [esp+4h] [ebp-64h] BYREF
  _BYTE v4[12]; // [esp+10h] [ebp-58h] BYREF
  _BYTE v5[12]; // [esp+1Ch] [ebp-4Ch] BYREF
  _BYTE v6[12]; // [esp+28h] [ebp-40h] BYREF
  struct std::ostream *v7; // [esp+34h] [ebp-34h]
  WORD *v8; // [esp+38h] [ebp-30h]
  std::_Iterator_base12 *v9; // [esp+3Ch] [ebp-2Ch]
  std::_Iterator_base12 *v10; // [esp+40h] [ebp-28h]
  int v11; // [esp+44h] [ebp-24h]
  int v12; // [esp+48h] [ebp-20h]
  BOOL v13; // [esp+4Ch] [ebp-1Ch]
  int v14; // [esp+50h] [ebp-18h] BYREF
  int v15; // [esp+54h] [ebp-14h]
  bool v16; // [esp+5Bh] [ebp-Dh]
  int v17; // [esp+64h] [ebp-4h]

  v15 = 0;
  v14 = std::vector<unsigned short>::size(a2);
  operator^<int>(a1, &v14);
  std::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>(v6);
  v17 = 0;
  v12 = std::vector<unsigned short>::begin(v5);
  v11 = v12;
  LOBYTE(v17) = 1;
  std::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::operator=(v12);
  LOBYTE(v17) = 0;
  std::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::~_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>(v5);
  while ( 1 )
  {
    v10 = (std::_Iterator_base12 *)std::vector<unsigned short>::end(v3);
    v9 = v10;
    LOBYTE(v17) = 2;
    v15 |= 1u;
    v13 = (unsigned __int8)std::_Vector_const_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::operator!=(v10)
       && v14 > 0;
    v16 = v13;
    v17 = 0;
    if ( (v15 & 1) != 0 )
    {
      v15 &= ~1u;
      std::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::~_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>(v3);
    }
    if ( !v16 )
      break;
    v8 = (WORD *)std::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::operator*(v6);
    operator^<unsigned short>(a1, v8);
    std::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::operator++(v4, 0);
    std::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::~_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>(v4);
  }
  v7 = a1;
  v17 = -1;
  std::_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>::~_Vector_iterator<std::_Vector_val<std::_Simple_types<unsigned short>>>(v6);
  return v7;
}


// address=[0x1439c20]
// Decompiled from int __cdecl Serial::LoadVersion(int a1)
unsigned int __cdecl Serial::LoadVersion(std::istream & a1) {
  
  int v1; // ecx
  int v3; // [esp+0h] [ebp-4h] BYREF

  v3 = v1;
  Serial::Serialize<unsigned int>(a1, &v3);
  return v3;
}


// address=[0x1439d10]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize(struct std::ostream *a1, char *a2)
void __cdecl Serial::Serialize(std::ostream & a1, signed char const & a2) {
  
  struct std::ostream *v2; // eax
  int v4; // [esp-8h] [ebp-8h]

  v4 = *a2;
  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = (struct std::ostream *)std::ostream::operator<<(v4);
  return std::operator<<<std::char_traits<char>>(v2, 32);
}


// address=[0x1439d50]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize(struct std::ostream *a1, unsigned __int8 *a2)
void __cdecl Serial::Serialize(std::ostream & a1, unsigned char const & a2) {
  
  struct std::ostream *v2; // eax
  int v4; // [esp-8h] [ebp-8h]

  v4 = *a2;
  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = (struct std::ostream *)std::ostream::operator<<(v4);
  return std::operator<<<std::char_traits<char>>(v2, 32);
}


// address=[0x1439d90]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize(struct std::ostream *a1, __int16 a2)
void __cdecl Serial::Serialize(std::ostream & a1, short a2) {
  
  struct std::ostream *v2; // eax

  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = (struct std::ostream *)std::ostream::operator<<(a2);
  return std::operator<<<std::char_traits<char>>(v2, 32);
}


// address=[0x1439dd0]
// Decompiled from int __cdecl Serial::Serialize_16(int a1, __int16 a2)
void __cdecl Serial::Serialize(std::ostream & a1, unsigned short a2) {
  
  int v2; // eax

  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = std::ostream::operator<<(a2);
  return std::operator<<<std::char_traits<char>>(v2, 32);
}


// address=[0x1439f50]
// Decompiled from int __cdecl Serial::StoreVersion(int a1, int a2)
void __cdecl Serial::StoreVersion(std::ostream & a1, unsigned int a2) {
  
  int v3; // [esp+0h] [ebp-4h] BYREF

  v3 = a2;
  return Serial::Serialize<unsigned int>(a1, &v3);
}


// address=[0x1445fd0]
// Decompiled from struct std::istream *__cdecl LoadArray<int>(struct std::istream *a1, int a2, unsigned int a3)
std::istream & __cdecl LoadArray<int>(std::istream & a1, int * const a2, unsigned int a3) {
  
  int v4; // [esp+Ch] [ebp-1Ch] BYREF
  int v5; // [esp+10h] [ebp-18h]
  int *v6; // [esp+14h] [ebp-14h]
  unsigned int v7; // [esp+18h] [ebp-10h]
  unsigned int v8; // [esp+1Ch] [ebp-Ch] BYREF
  unsigned int i; // [esp+20h] [ebp-8h]
  unsigned int j; // [esp+24h] [ebp-4h]

  v5 = 4;
  v7 = a3 / 4;
  v4 = 0;
  v8 = 0;
  Serial::Serialize<unsigned int>(a1, &v4);
  if ( v5 != v4
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         267,
         "iElementSize == iReadiElementSize") == 1 )
  {
    __debugbreak();
  }
  Serial::Serialize<unsigned int>(a1, &v8);
  if ( v7 != v8
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         270,
         "iNumberOfElements == iReadNumberOfElements") == 1 )
  {
    __debugbreak();
  }
  if ( v8 <= v7 )
  {
    for ( i = 0; i < v8; ++i )
      operator^<int>(a1, (int *)(a2 + 4 * i));
    for ( i = v8; i < v8; ++i )
      memset((void *)(a2 + 4 * i), 0, 4u);
    return a1;
  }
  else
  {
    v6 = (int *)operator new[](4 * v8);
    for ( j = 0; j < v8; ++j )
      operator^<int>(a1, &v6[j]);
    for ( j = 0; j < v7; ++j )
      *(_DWORD *)(a2 + 4 * j) = v6[j];
    operator delete[](v6);
    return a1;
  }
}


// address=[0x14461f0]
// Decompiled from _DWORD *__cdecl BB::Max<int>(_DWORD *a1, _DWORD *a2)
int const & __cdecl BB::Max<int>(int const & a1, int const & a2) {
  
  if ( *a1 >= *a2 )
    return a1;
  else
    return a2;
}


// address=[0x1446230]
// Decompiled from struct std::ostream *__cdecl StoreArray<int>(struct std::ostream *a1, int a2, unsigned int a3)
std::ostream & __cdecl StoreArray<int>(std::ostream & a1, int const * const a2, unsigned int a3) {
  
  unsigned int v4; // [esp+0h] [ebp-Ch] BYREF
  int v5; // [esp+4h] [ebp-8h] BYREF
  unsigned int i; // [esp+8h] [ebp-4h]

  v5 = 4;
  v4 = a3 / 4;
  Serial::Serialize<unsigned int>((int)a1, &v5);
  Serial::Serialize<unsigned int>((int)a1, (int *)&v4);
  for ( i = 0; i < v4; ++i )
    operator^<int>(a1, (int *)(a2 + 4 * i));
  return a1;
}


// address=[0x144f800]
// Decompiled from double __cdecl sqrt(double x)
float __cdecl sqrt(float) {
  
  return j__sqrtf(*(float *)&x);
}


// address=[0x1454030]
// Decompiled from struct std::ostream *__cdecl operator^<bool>(struct std::ostream *a1, char *a2)
std::ostream & __cdecl operator^<bool>(std::ostream & a1, bool const & a2) {
  
  Serial::Serialize(a1, *a2);
  return a1;
}


// address=[0x1454280]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize(struct std::ostream *a1, char a2)
void __cdecl Serial::Serialize(std::ostream & a1, bool a2) {
  
  struct std::ostream *v2; // eax

  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = (struct std::ostream *)std::ostream::operator<<(a2 != 0);
  return std::operator<<<std::char_traits<char>>(v2, 32);
}


// address=[0x145daf0]
// Decompiled from int __cdecl sign(int a1)
int __cdecl sign(int a1) {
  
  if ( a1 < 0 )
    return -1;
  else
    return 1;
}


// address=[0x145fe50]
// Decompiled from _DWORD *__cdecl BB::Min<int>(_DWORD *a1, _DWORD *a2)
int const & __cdecl BB::Min<int>(int const & a1, int const & a2) {
  
  if ( *a1 >= *a2 )
    return a2;
  else
    return a1;
}


// address=[0x1460380]
// Decompiled from unsigned int __thiscall TSparseMap<unsigned char>::Clear(_DWORD *this)
public: void __thiscall TSparseMap<unsigned char>::Clear(void) {
  
  unsigned int result; // eax
  int *v2; // eax
  int v3; // [esp+4h] [ebp-10h]
  _DWORD *v5; // [esp+Ch] [ebp-8h]
  unsigned int i; // [esp+10h] [ebp-4h]

  for ( i = 0; i < this[6]; ++i )
  {
    if ( *(_DWORD *)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](i) )
    {
      v2 = (int *)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](i);
      v3 = *v2;
      v5 = *(_DWORD **)(*v2 + 4);
      if ( !v5
        && BBSupportDbgReport(
             2,
             "d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\world\\TSparseMap.h",
             289,
             "pTempNode!=NULL") == 1 )
      {
        __debugbreak();
      }
      while ( v5[1] )
      {
        *(_DWORD *)(v3 + 4) = v5[1];
        TSparseMap<unsigned char>::TNode::operator delete(v5);
        v5 = *(_DWORD **)(v3 + 4);
      }
    }
    result = i + 1;
  }
  this[7] = 0;
  return result;
}


// address=[0x1460510]
// Decompiled from char __thiscall TSparseMap<unsigned char>::Get(_BYTE *this, unsigned int a2, int a3)
public: unsigned char __thiscall TSparseMap<unsigned char>::Get(unsigned int a2, unsigned int a3) {
  
  int i; // [esp+4h] [ebp-4h]

  if ( !(unsigned __int8)TSparseMap<unsigned char>::IsValidCoordinate(a2, a3) )
    j___wassert(
      L"IsValidCoordinate(_uX, _uY)",
      L"d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\world\\TSparseMap.h",
      0x1B4u);
  if ( !(unsigned __int8)TSparseMap<unsigned char>::IsValidCoordinate(a2, a3) )
    return this[32];
  for ( i = *(_DWORD *)(*(_DWORD *)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](a3)
                      + 4); *(_DWORD *)i < a2; i = *(_DWORD *)(i + 4) )
    ;
  if ( *(_DWORD *)i == a2 )
    return *(_BYTE *)(i + 8);
  else
    return this[32];
}


// address=[0x1460700]
// Decompiled from bool __thiscall TSparseMap<unsigned char>::IsValidCoordinate(_DWORD *this, unsigned int a2, unsigned int a3)
private: bool __thiscall TSparseMap<unsigned char>::IsValidCoordinate(unsigned int a2, unsigned int a3)const {
  
  return a2 < this[5] && a3 < this[6];
}


// address=[0x1460800]
// Decompiled from int __thiscall TSparseMap<unsigned char>::Set(_DWORD *this, unsigned int a2, int a3, _BYTE *a4)
public: void __thiscall TSparseMap<unsigned char>::Set(unsigned int a2, unsigned int a3, unsigned char const & a4) {
  
  int result; // eax
  _DWORD *v5; // [esp+8h] [ebp-24h]
  _DWORD *v6; // [esp+Ch] [ebp-20h]
  unsigned int *v7; // [esp+10h] [ebp-1Ch]
  unsigned int *i; // [esp+14h] [ebp-18h]

  if ( !(unsigned __int8)TSparseMap<unsigned char>::IsValidCoordinate(a2, a3) )
    j___wassert(
      L"IsValidCoordinate(_uX, _uY)",
      L"d:\\projects\\tshe\\purplelamp\\s4\\source\\s4_main\\world\\TSparseMap.h",
      0x13Cu);
  result = (unsigned __int8)TSparseMap<unsigned char>::IsValidCoordinate(a2, a3);
  if ( !(_BYTE)result )
    return result;
  v7 = *(unsigned int **)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](a3);
  for ( i = *(unsigned int **)(*(_DWORD *)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](a3)
                             + 4); *i < a2; i = (unsigned int *)i[1] )
    v7 = i;
  v6 = (_DWORD *)TSparseMap<unsigned char>::TNode::operator new(12);
  if ( v6 )
    v5 = TSparseMap<unsigned char>::TNode::TNode(v6);
  else
    v5 = 0;
  result = (int)v5;
  if ( !v5 )
    return result;
  *((_BYTE *)v5 + 8) = *a4;
  *v5 = a2;
  v5[1] = v7[1];
  v7[1] = (unsigned int)v5;
  result = this[7] + 1;
  this[7] = result;
  return result;
}


// address=[0x1470380]
// Decompiled from _DWORD *__thiscall TStaticConfigIntArray<8>::TStaticConfigIntArray<8>(  _DWORD *this,  int a2,  int a3,  int a4,  int a5,  int a6,  int a7,  int a8,  int a9,  int a10,  int a11)
public: __thiscall TStaticConfigIntArray<8>::TStaticConfigIntArray<8>(char const * a2, char const * a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11) {
  
  TStaticConfigIntArrayBase<8>::TStaticConfigIntArrayBase<8>(a2, a3);
  *this = &TStaticConfigIntArray_8_::_vftable_;
  this[2] = a4;
  this[3] = a5;
  this[4] = a6;
  this[5] = a7;
  this[6] = a8;
  this[7] = a9;
  this[8] = a10;
  this[9] = a11;
  return this;
}


// address=[0x1470470]
// Decompiled from _DWORD *__thiscall TStaticConfigIntArrayBase<8>::TStaticConfigIntArrayBase<8>(_DWORD *this, int a2, int a3)
private: __thiscall TStaticConfigIntArrayBase<8>::TStaticConfigIntArrayBase<8>(char const * a2, char const * a3) {
  
  CStaticConfigVar::CStaticConfigVar(this, a2, a3, 2, 8);
  *this = &TStaticConfigIntArrayBase_8_::_vftable_;
  return this;
}


// address=[0x14705b0]
// Decompiled from int __thiscall TStaticConfigIntArray<8>::~TStaticConfigIntArray<8>(void *this)
public: __thiscall TStaticConfigIntArray<8>::~TStaticConfigIntArray<8>(void) {
  
  return TStaticConfigIntArrayBase<8>::~TStaticConfigIntArrayBase<8>(this, this);
}


// address=[0x14705d0]
// Decompiled from CConfigVar *__thiscall TStaticConfigIntArrayBase<8>::~TStaticConfigIntArrayBase<8>(CStaticConfigVar *this)
public: __thiscall TStaticConfigIntArrayBase<8>::~TStaticConfigIntArrayBase<8>(void) {
  
  return CStaticConfigVar::~CStaticConfigVar(this);
}


// address=[0x14705f0]
// Decompiled from int __thiscall TStaticConfigIntArrayBase<8>::operator[](void *this, int a2)
public: int & __thiscall TStaticConfigIntArrayBase<8>::operator[](int a2) {
  
  return (int)this + 4 * a2 + 8;
}


// address=[0x1470610]
// Decompiled from int __thiscall TStaticConfigIntArrayBase<8>::operator[](void *this, int a2)
public: int const & __thiscall TStaticConfigIntArrayBase<8>::operator[](int a2)const {
  
  return (int)this + 4 * a2 + 8;
}


// address=[0x14709a0]
// Decompiled from char *__thiscall TStaticConfigIntArrayBase<8>::GetIntArray(char *this)
public: int * __thiscall TStaticConfigIntArrayBase<8>::GetIntArray(void) {
  
  return this + 8;
}


// address=[0x14709c0]
// Decompiled from char *__thiscall TStaticConfigIntArrayBase<8>::GetIntArray(char *this)
public: int const * __thiscall TStaticConfigIntArrayBase<8>::GetIntArray(void)const {
  
  return this + 8;
}


// address=[0x147e550]
// Decompiled from bool __thiscall TBitArray<22>::operator[](_DWORD *this, unsigned int a2)
public: bool __thiscall TBitArray<22>::operator[](unsigned int a2) {
  
  return (this[a2 >> 5] & (1 << (a2 & 0x1F))) != 0;
}


// address=[0x147e5a0]
// Decompiled from bool __thiscall TBitArray<78>::operator[](_DWORD *this, unsigned int a2)
public: bool __thiscall TBitArray<78>::operator[](unsigned int a2) {
  
  return (this[a2 >> 5] & (1 << (a2 & 0x1F))) != 0;
}


// address=[0x147e5f0]
// Decompiled from bool __thiscall TBitArray<2956>::operator[](_DWORD *this, unsigned int a2)
public: bool __thiscall TBitArray<2956>::operator[](unsigned int a2) {
  
  return (this[a2 >> 5] & (1 << (a2 & 0x1F))) != 0;
}


// address=[0x147e640]
// Decompiled from unsigned int __thiscall TBitArray<2956>::Clear(_DWORD *this, unsigned int a2)
public: void __thiscall TBitArray<2956>::Clear(unsigned int a2) {
  
  unsigned int result; // eax

  result = a2 >> 5;
  this[a2 >> 5] &= ~(1 << (a2 & 0x1F));
  return result;
}


// address=[0x147e690]
// Decompiled from void *__thiscall TBitArray<22>::ClearArray(void *this)
public: void __thiscall TBitArray<22>::ClearArray(void) {
  
  return memset(this, 0, 4u);
}


// address=[0x147e6c0]
// Decompiled from void *__thiscall TBitArray<78>::ClearArray(void *this)
public: void __thiscall TBitArray<78>::ClearArray(void) {
  
  return memset(this, 0, 0xCu);
}


// address=[0x147e6f0]
// Decompiled from void *__thiscall TBitArray<2956>::ClearArray(void *this)
public: void __thiscall TBitArray<2956>::ClearArray(void) {
  
  return memset(this, 0, 0x174u);
}


// address=[0x147e8c0]
// Decompiled from unsigned int __thiscall TBitArray<22>::Set(_DWORD *this, unsigned int a2)
public: void __thiscall TBitArray<22>::Set(unsigned int a2) {
  
  unsigned int result; // eax

  result = a2 >> 5;
  this[a2 >> 5] |= 1 << (a2 & 0x1F);
  return result;
}


// address=[0x147e900]
// Decompiled from unsigned int __thiscall TBitArray<78>::Set(_DWORD *this, unsigned int a2)
public: void __thiscall TBitArray<78>::Set(unsigned int a2) {
  
  unsigned int result; // eax

  result = a2 >> 5;
  this[a2 >> 5] |= 1 << (a2 & 0x1F);
  return result;
}


// address=[0x147e940]
// Decompiled from unsigned int __thiscall TBitArray<2956>::Set(_DWORD *this, unsigned int a2)
public: void __thiscall TBitArray<2956>::Set(unsigned int a2) {
  
  unsigned int result; // eax

  result = a2 >> 5;
  this[a2 >> 5] |= 1 << (a2 & 0x1F);
  return result;
}


// address=[0x147e980]
// Decompiled from void *__thiscall TBitArray<2956>::SetArray(void *this)
public: void __thiscall TBitArray<2956>::SetArray(void) {
  
  return memset(this, 255, 0x174u);
}


// address=[0x147e9b0]
// Decompiled from unsigned int __thiscall TBitArray<2956>::SetValue(_DWORD *this, unsigned int a2, char a3)
public: void __thiscall TBitArray<2956>::SetValue(unsigned int a2, bool a3) {
  
  if ( a3 )
    return TBitArray<2956>::Set(this, a2);
  else
    return TBitArray<2956>::Clear(this, a2);
}


// address=[0x147f2f0]
// Decompiled from char S4CheckGfx()
bool __cdecl S4CheckGfx(int) {
  
  const char *SettlerJobName; // eax
  const char *RaceName; // [esp-8h] [ebp-198h]
  unsigned int SettlerJobFrameCount; // [esp+4h] [ebp-18Ch]
  int m; // [esp+8h] [ebp-188h]
  signed int j; // [esp+Ch] [ebp-184h]
  int i; // [esp+10h] [ebp-180h]
  int k; // [esp+14h] [ebp-17Ch]
  char v8; // [esp+1Bh] [ebp-175h]
  _BYTE v9[368]; // [esp+1Ch] [ebp-174h] BYREF

  memset(v9, 0, 0x16Fu);
  for ( i = 0; i < 434; ++i )
  {
    if ( (unsigned int)dword_36BB420[2 * i] <= 0x16E )
    {
      if ( strstr((&off_36BB424)[2 * i], "WALK") )
        v9[dword_36BB420[2 * i]] = 1;
    }
  }
  v8 = 1;
  if ( g_pGfxManager )
  {
    for ( j = 0; j < 5; ++j )
    {
      for ( k = 1; k < 367; ++k )
      {
        for ( m = 0; m < 6; ++m )
        {
          SettlerJobFrameCount = CGfxManager::GetSettlerJobFrameCount((CGfxManager *)g_pGfxManager, j, k, m);
          if ( SettlerJobFrameCount <= 0x1F )
          {
            if ( v9[k] && SettlerJobFrameCount > 1 && SettlerJobFrameCount != 13 )
            {
              v8 = 0;
              RaceName = CS4DefineNames::GetRaceName(j);
              SettlerJobName = CS4DefineNames::GetSettlerJobName(k);
              BBSupportTracePrintF(
                2,
                "Direction %i of settler walk job %i (%s) of race %i (%s) has %u frames instead of 13 frames!",
                m,
                k,
                SettlerJobName,
                j,
                RaceName,
                SettlerJobFrameCount);
            }
          }
          else
          {
            v8 = 0;
            BBSupportTracePrintF(2, "Direction %i of settler job %i of race %i has more the 31 frames!", m, k, j);
          }
        }
      }
    }
  }
  else
  {
    v8 = 0;
    BBSupportTracePrintF(2, "S4CheckGfx(): Gfx manager not initialized!");
  }
  return v8;
}


// address=[0x1481410]
// Decompiled from bool ExtraCD::IsGermanOnlyContentEnabled()
bool __cdecl ExtraCD::IsGermanOnlyContentEnabled(void) {
  
  CConfigManager *Instance; // [esp+8h] [ebp-14h]

  if ( dword_3F450B4 <= *(_DWORD *)(*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + _tls_index) + 20296) )
    return byte_3F450B3 || CGameSettings::GetLanguage() == 1;
  j___Init_thread_header(&dword_3F450B4);
  if ( dword_3F450B4 != -1 )
    return byte_3F450B3 || CGameSettings::GetLanguage() == 1;
  Instance = CConfigManagerPtr::GetInstance();
  byte_3F450B3 = ((int (__thiscall *)(CConfigManager *, const char *, const char *, int))Instance->GetIntValueNoAdd)(
                   Instance,
                   "GAMESETTINGS",
                   "EnableGermanOnlyContent",
                   1) != 0;
  j___Init_thread_footer(&dword_3F450B4);
  return byte_3F450B3 || CGameSettings::GetLanguage() == 1;
}


// address=[0x1485340]
// Decompiled from int SetCamWndViewPosition()
void __cdecl SetCamWndViewPosition(void) {
  
  int v0; // eax
  int v1; // eax
  int v2; // eax
  int v3; // eax
  int v5; // [esp-4h] [ebp-40h]
  int v6; // [esp-4h] [ebp-40h]
  double v7; // [esp+0h] [ebp-3Ch]
  int v8; // [esp+8h] [ebp-34h]
  int RenderHeight; // [esp+Ch] [ebp-30h]
  int v10; // [esp+10h] [ebp-2Ch]
  int v11; // [esp+14h] [ebp-28h]
  int v12; // [esp+18h] [ebp-24h]
  IMovingEntity *v13; // [esp+20h] [ebp-1Ch]
  int v14; // [esp+24h] [ebp-18h]
  int v15; // [esp+28h] [ebp-14h]
  int v16; // [esp+2Ch] [ebp-10h]
  int v17; // [esp+30h] [ebp-Ch]
  int v18; // [esp+30h] [ebp-Ch]
  int v19; // [esp+34h] [ebp-8h]
  int v20; // [esp+34h] [ebp-8h]
  IEntity *v21; // [esp+38h] [ebp-4h]

  if ( CMapObjectMgr::GetUniqueId((unsigned __int16)g_uCamWndEntityId) == g_iCamWndUniqueId )
  {
    v21 = CMapObjectMgr::EntityPtr((unsigned __int16)g_uCamWndEntityId);
    if ( !CMapObjectMgr::GetUniqueId((unsigned __int16)g_uCamWndEntityId) )
      v21 = 0;
  }
  else
  {
    v21 = 0;
  }
  if ( !v21 || IEntity::FlagBits(v21, EntityFlag_OnBoard) || !IEntity::X(v21) && !IEntity::Y(v21) )
    return IGfxEngine::SetCameraViewPosition(
             (IGfxEngine *)g_pGfxEngine,
             (int)(((double)g_iCamWndX - (double)g_iCamWndY / 2.0) * (double)g_iCamWndScale
                 - 87.0
                 - (double)g_iCamWndScale / 24.0 * 40.0),
             (int)((double)g_iCamWndY * ((double)g_iCamWndScale / 2.0) - (double)g_iCamWndScale / 24.0 * 10.0 - 95.0));
  v13 = (IMovingEntity *)j____RTDynamicCast(
                           (void **)&v21->__vftable,
                           0,
                           &IEntity__RTTI_Type_Descriptor_,
                           &IMovingEntity__RTTI_Type_Descriptor_,
                           0);
  v5 = IEntity::Y(v21);
  v0 = IEntity::X(v21);
  v1 = CWorldManager::GroundHeight(v0, v5);
  RenderHeight = IGfxEngine::GetRenderHeight((IGfxEngine *)g_pGfxEngine, v1);
  g_iCamWndX = IEntity::X(v21);
  g_iCamWndY = IEntity::Y(v21);
  v6 = IEntity::Y(v21);
  v2 = IEntity::X(v21);
  if ( (*(unsigned __int8 (__thiscall **)(void *, int, int))(*(_DWORD *)g_pFogging + 32))(g_pFogging, v2, v6) )
  {
    v15 = 0;
    v16 = 0;
    if ( !v13 )
      return IGfxEngine::SetCameraViewPosition((IGfxEngine *)g_pGfxEngine, v15, v16);
    v16 = (int)((double)IEntity::Y(v21) * ((double)g_iCamWndScale / 2.0)
              - (double)g_iCamWndScale / 24.0 * 10.0
              - (double)RenderHeight
              - 95.0);
    v7 = (double)IEntity::X(v21);
    v15 = (int)((v7 - (double)IEntity::Y(v21) / 2.0) * (double)g_iCamWndScale
              - (double)g_iCamWndScale / 24.0 * 40.0
              - 87.0);
    v17 = IEntity::X(v21);
    v19 = IEntity::Y(v21);
    v14 = IMovingEntity::Distance(v13);
    v8 = IMovingEntity::Direction(v13);
    if ( !v14 )
      return IGfxEngine::SetCameraViewPosition((IGfxEngine *)g_pGfxEngine, v15, v16);
    switch ( v8 )
    {
      case 0:
        --v17;
        break;
      case 1:
        --v17;
        --v19;
        break;
      case 2:
        --v19;
        break;
      case 3:
        ++v17;
        break;
      case 4:
        ++v17;
        ++v19;
        break;
      case 5:
        ++v19;
        break;
      default:
        break;
    }
    v3 = CWorldManager::GroundHeight(v17, v19);
    v12 = IGfxEngine::GetRenderHeight((IGfxEngine *)g_pGfxEngine, v3);
    v18 = (int)(((double)v17 - (double)v19 / 2.0) * (double)g_iCamWndScale - 87.0 - (double)g_iCamWndScale / 24.0 * 40.0);
    v20 = (int)((double)v19 * ((double)g_iCamWndScale / 2.0) - (double)g_iCamWndScale / 24.0 * 10.0 - 95.0 - (double)v12);
    v11 = j__abs(v15 - v18);
    v10 = j__abs(v16 - v20);
    if ( v15 <= v18 )
      v15 += (int)((double)v11 / 255.0 * (double)v14);
    else
      v15 -= (int)((double)v11 / 255.0 * (double)v14);
    if ( v16 <= v20 )
      v16 += (int)((double)v10 / 255.0 * (double)v14);
    else
      v16 -= (int)((double)v10 / 255.0 * (double)v14);
    return IGfxEngine::SetCameraViewPosition((IGfxEngine *)g_pGfxEngine, v15, v16);
  }
  else
  {
    g_iCamWndX = IEntity::X(v21);
    g_iCamWndY = IEntity::Y(v21);
    g_uCamWndEntityId = 0;
    g_iCamWndUniqueId = 0;
    return IGfxEngine::SetCameraViewPosition(
             (IGfxEngine *)g_pGfxEngine,
             (int)(((double)g_iCamWndX - (double)g_iCamWndY / 2.0) * (double)g_iCamWndScale
                 - 87.0
                 - (double)g_iCamWndScale / 24.0 * 40.0),
             (int)((double)g_iCamWndY * ((double)g_iCamWndScale / 2.0) - (double)g_iCamWndScale / 24.0 * 10.0 - 95.0));
  }
}


// address=[0x14859b0]
// Decompiled from int UpdateReefBlockingBits()
void __cdecl UpdateReefBlockingBits(void) {
  
  int result; // eax
  int v1; // eax
  int v2; // [esp+0h] [ebp-18h]
  int v3; // [esp+4h] [ebp-14h]
  int v4; // [esp+8h] [ebp-10h]
  IEntity *v5; // [esp+Ch] [ebp-Ch]
  int i; // [esp+10h] [ebp-8h]
  int j; // [esp+14h] [ebp-4h]

  for ( i = 0; ; ++i )
  {
    result = CWorldManager::Width();
    if ( i >= result )
      break;
    for ( j = 0; j < CWorldManager::Height(); ++j )
    {
      v4 = CWorldManager::Index(i, j);
      v2 = CWorldManager::FlagBits(v4, 2u);
      v3 = CWorldManager::ObjectId(i, j);
      v5 = CMapObjectMgr::EntityPtr(v3);
      if ( v5 && (IEntity::Type(v5) == 107 || IEntity::Type(v5) == 109) && !v2 )
      {
        v1 = IEntity::Type(v5);
        CDecoObjMgr::SetFlagsForObject((CDecoObjMgr *)&g_cDecoObjMgr, i, j, v1, 1);
      }
    }
  }
  return result;
}


// address=[0x14868c0]
// Decompiled from _DWORD *__thiscall CRingBuffer<CEvn_Logic>::CRingBuffer<CEvn_Logic>(_DWORD *this, unsigned int a2)
public: __thiscall CRingBuffer<class CEvn_Logic>::CRingBuffer<class CEvn_Logic>(int a2) {
  
  int v2; // ecx
  char *v4; // [esp+Ch] [ebp-1Ch]
  char *v5; // [esp+14h] [ebp-14h]

  *this = CRingBuffer_CEvn_Logic_::_vftable_;
  this[3] = 0;
  this[2] = 0;
  this[4] = 0;
  this[1] = a2;
  v2 = (unsigned __int64)a2 >> 27 != 0 ? -1 : 32 * a2;
  v5 = (char *)operator new[](__CFADD__(v2, 4) ? -1 : v2 + 4);
  if ( v5 )
  {
    *(_DWORD *)v5 = a2;
    _vec_ctor(v5 + 4, 0x20u, a2, CEvn_Logic::CEvn_Logic, CEvn_Logic::~CEvn_Logic);
    v4 = v5 + 4;
  }
  else
  {
    v4 = 0;
  }
  this[5] = v4;
  return this;
}


// address=[0x1486a80]
// Decompiled from int __thiscall CRingBuffer<CEvn_Logic>::~CRingBuffer<CEvn_Logic>(_DWORD *this)
public: __thiscall CRingBuffer<class CEvn_Logic>::~CRingBuffer<class CEvn_Logic>(void) {
  
  int result; // eax

  *this = CRingBuffer_CEvn_Logic_::_vftable_;
  result = this[5];
  if ( !result )
    return result;
  if ( *(_DWORD *)(result - 4) )
    return (*(int (__thiscall **)(_DWORD, int))(*(_DWORD *)this[5] + 8))(this[5], 3);
  else
    return operator delete[]((void *)(result - 4));
  return result;
}


// address=[0x1486d70]
// Decompiled from bool __thiscall CRingBuffer<CEvn_Logic>::Check(_DWORD *this)
public: bool __thiscall CRingBuffer<class CEvn_Logic>::Check(void)const {
  
  return this[2] != this[3];
}


// address=[0x1486db0]
// Decompiled from bool __thiscall CRingBuffer<CEvn_Logic>::CheckVirtual(_DWORD *this)
public: bool __thiscall CRingBuffer<class CEvn_Logic>::CheckVirtual(void)const {
  
  return this[4] != this[3];
}


// address=[0x1487220]
// Decompiled from int __thiscall CRingBuffer<CEvn_Logic>::Read(_DWORD *this)
public: class CEvn_Logic & __thiscall CRingBuffer<class CEvn_Logic>::Read(void) {
  
  int v2; // [esp+0h] [ebp-8h]

  v2 = this[5] + 32 * this[2]++;
  this[2] %= this[1];
  return v2;
}


// address=[0x1487280]
// Decompiled from int __thiscall CRingBuffer<CEvn_Logic>::ReadVirtual(_DWORD *this)
public: class CEvn_Logic & __thiscall CRingBuffer<class CEvn_Logic>::ReadVirtual(void) {
  
  int v2; // [esp+0h] [ebp-8h]

  v2 = this[5] + 32 * this[4]++;
  this[4] %= this[1];
  return v2;
}


// address=[0x14875c0]
// Decompiled from _DWORD *__thiscall CRingBuffer<CEvn_Logic>::StartVirtual(_DWORD *this)
public: void __thiscall CRingBuffer<class CEvn_Logic>::StartVirtual(void) {
  
  _DWORD *result; // eax

  result = this;
  this[4] = this[2];
  return result;
}


// address=[0x14875e0]
// Decompiled from char __thiscall CRingBuffer<CEvn_Logic>::Write(_DWORD *this, int a2)
public: bool __thiscall CRingBuffer<class CEvn_Logic>::Write(class CEvn_Logic & a2) {
  
  if ( (unsigned int)(this[3] + 1) % this[1] == this[2] )
    return 0;
  CEvn_Logic::operator=(this[5] + 32 * this[3]++, a2);
  this[3] %= this[1];
  return 1;
}


// address=[0x148a890]
// Decompiled from BOOL __cdecl ChangeScreenSize(int a1, int cy)
void __cdecl ChangeScreenSize(int a1, int cy) {
  
  unsigned int dwNewLong; // [esp+0h] [ebp-4h]

  dwNewLong = (unsigned int)&dword_C20408[212734] | GetWindowLongA(g_hWnd, -16);
  SetWindowLongA(g_hWnd, -16, dwNewLong);
  return SetWindowPos(g_hWnd, 0, 0, 0, a1, cy, 0x226u);
}


// address=[0x14944c0]
// Decompiled from unsigned __int8 *__cdecl _mbsstr(const unsigned __int8 *a1, unsigned __int8 *Substr)
unsigned char * __cdecl _mbsstr(unsigned char * const a1, unsigned char const * const Substr) {
  
  return j___mbsstr(a1, Substr);
}


// address=[0x1497120]
// [Decompilation failed for char * __cdecl MyStrNCopy(char *,char const *,unsigned int)]

// address=[0x14971c0]
// Decompiled from int __cdecl MyWStrNCopy(int a1, _WORD *a2, int a3)
wchar_t * __cdecl MyWStrNCopy(wchar_t * a1, wchar_t const * a2, unsigned int a3) {
  
  unsigned int v4; // [esp+Ch] [ebp-4h]
  unsigned int v5; // [esp+20h] [ebp+10h]

  if ( a3 == 0 || a1 == 0 )
    return a1;
  v5 = a3 - 1;
  v4 = 0;
  if ( *a2 )
  {
    while ( v4 < v5 && a2[v4] )
    {
      *(_WORD *)(a1 + 2 * v4) = a2[v4];
      ++v4;
    }
  }
  *(_WORD *)(a1 + 2 * v4) = 0;
  return a1;
}


// address=[0x149a3d0]
// Decompiled from int __cdecl DecodeMapKey(_DWORD *a1, wchar_t *String)
void __cdecl DecodeMapKey(struct SRandomMapParams * a1, wchar_t * String) {
  
  __int64 v2; // rax
  __int64 v3; // rax
  __int64 v5; // [esp+0h] [ebp-18h]
  wchar_t *v6; // [esp+8h] [ebp-10h]
  int v7; // [esp+Ch] [ebp-Ch]
  int i; // [esp+10h] [ebp-8h]
  int j; // [esp+10h] [ebp-8h]
  char v10; // [esp+17h] [ebp-1h]
  char v11; // [esp+17h] [ebp-1h]

  v6 = j__wcsupr(String);
  memset(a1, 0, 0xB8u);
  *a1 = 184;
  v5 = 0LL;
  v7 = 0;
  for ( i = 0; i < 8; ++i )
  {
    v10 = v6[i];
    if ( v10 < 65 )
      v11 = v10 - 48;
    else
      v11 = v10 - 55;
    v5 += (__int64)v11 << v7;
    v7 += 5;
  }
  a1[8] = (v5 & 7) + 1;
  a1[4] = 5 * (((v5 & 0x18) >> 3) + 1);
  a1[2] = (((v5 & 0x1E0) >> 5) + 4) << 6;
  a1[5] = (v5 & 0x600) >> 9;
  a1[3] = 10 * (((v5 & 0x7800) >> 11) + 1);
  LODWORD(v2) = v5 & 0xFFFF8000;
  HIDWORD(v2) = BYTE4(v5) & 7;
  v3 = v2 >> 15;
  a1[1] = v3;
  for ( j = 0; j < 9; ++j )
  {
    a1[4 * j + 10] = 16;
    LODWORD(v3) = j + 1;
  }
  return v3;
}


// address=[0x149a5e0]
// Decompiled from int __cdecl GenerateMapKey(struct SRandomMapParams *a1, wchar_t *a2)
void __cdecl GenerateMapKey(struct SRandomMapParams * a1, wchar_t * a2) {
  
  wchar_t v2; // dx
  int result; // eax
  __int64 v4; // [esp+0h] [ebp-1Ch]
  __int64 v5; // [esp+8h] [ebp-14h]
  char v6; // [esp+10h] [ebp-Ch]
  int i; // [esp+14h] [ebp-8h]
  char v8; // [esp+1Bh] [ebp-1h]

  v5 = *((_DWORD *)a1 + 8)
     - 1
     + (__int64)(8 * (*((_DWORD *)a1 + 4) / 5) - 8)
     + 32 * (*((_DWORD *)a1 + 2) / 64 - 4)
     + ((*((_DWORD *)a1 + 5) & 3u) << 9)
     + ((*((_DWORD *)a1 + 3) / 10 - 1) << 11)
     + ((__int64)*((int *)a1 + 1) << 15);
  v6 = 0;
  v4 = 31LL;
  for ( i = 0; i < 8; ++i )
  {
    v8 = (v4 & v5) >> v6;
    if ( v8 >= 10 )
      v2 = v8 + 55;
    else
      v2 = v8 + 48;
    a2[i] = v2;
    v4 *= 32LL;
    v6 += 5;
  }
  result = 16;
  a2[8] = 0;
  return result;
}


// address=[0x149a7c0]
// Decompiled from char __cdecl IsValidMapKey(wchar_t *String)
bool __cdecl IsValidMapKey(wchar_t * String) {
  
  char v2; // [esp+3h] [ebp-BDh]
  _BYTE v3[4]; // [esp+4h] [ebp-BCh] BYREF
  unsigned int v4; // [esp+8h] [ebp-B8h]
  int v5; // [esp+Ch] [ebp-B4h]
  int v6; // [esp+10h] [ebp-B0h]
  int v7; // [esp+14h] [ebp-ACh]
  unsigned int v8; // [esp+18h] [ebp-A8h]
  int v9; // [esp+24h] [ebp-9Ch]

  if ( !String )
    return 0;
  v2 = 1;
  DecodeMapKey(v3, String);
  if ( v9 < 1 || v9 > 8 )
    v2 = 0;
  if ( v7 < 1 || v7 > 15 )
    v2 = 0;
  if ( v5 % 64 || v5 > 1024 || v5 < 256 )
    v2 = 0;
  if ( v8 >= 4 )
    v2 = 0;
  if ( v6 % 10 || v6 > 90 || v6 < 10 )
    v2 = 0;
  if ( v4 >= 0xF4240 )
    v2 = 0;
  if ( String[7] != 48 )
    return 0;
  return v2;
}


// address=[0x14a8b70]
// Decompiled from int __stdcall DlgProc(HWND hDlg, int a2, int a3, int a4)
int __stdcall DlgProc(struct HWND__ * hDlg, unsigned int a2, unsigned int a3, long a4) {
  
  if ( a2 == 272 )
  {
    if ( ((int (__thiscall *)(CConfigManager *, const char *, const char *, _DWORD))g_pCfgMgr->GetIntValue)(
           g_pCfgMgr,
           "GAMESETTINGS",
           "Language",
           0) )
    {
      SetDlgItemTextA(hDlg, 1009, "Tragen Sie bitte hier Ihre Fehlerbeschreibung ein...");
    }
    else
    {
      SetDlgItemTextA(hDlg, 1009, "Please fill in your problem description here...");
    }
    return 1;
  }
  else if ( a2 == 273 )
  {
    if ( a3 == 1 )
    {
      GetDlgItemTextA(hDlg, 1009, g_szBugReportText, 0x2000);
      if ( IsDlgButtonChecked(hDlg, 1037) )
        EndDialog(hDlg, 2);
      else
        EndDialog(hDlg, 1);
    }
    else if ( a3 == 2 )
    {
      EndDialog(hDlg, 0);
    }
    return 1;
  }
  else
  {
    return 0;
  }
}


// address=[0x14b4db0]
// Decompiled from int __cdecl abs(int Number)
long __cdecl abs(long Number) {
  
  return j__labs(Number);
}


// address=[0x14d15c0]
// Decompiled from void __vcrt_va_start_verify_argument_type<bool>()
void __cdecl __vcrt_va_start_verify_argument_type<bool>(void) {
  
  ;
}


// address=[0x14d8770]
// Decompiled from int __cdecl Y16X16::NeighborModifier(Y16X16 *this)
int __cdecl Y16X16::NeighborModifier(int) {
  
  return Y16X16::g_iNeighborY16X16Modifiers[(_DWORD)this];
}


// address=[0x14e7ab0]
// Decompiled from int __cdecl SettlerTypePrioLevel(int a1)
int __cdecl SettlerTypePrioLevel(int a1) {
  
  int result; // eax

  switch ( a1 )
  {
    case 29:
    case 32:
    case 35:
    case 38:
    case 41:
    case 61:
      result = 1;
      break;
    case 30:
    case 33:
    case 36:
    case 39:
    case 42:
    case 62:
      result = 2;
      break;
    case 31:
    case 34:
    case 37:
    case 40:
    case 43:
    case 63:
      result = 3;
      break;
    case 44:
      result = 4;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}


// address=[0x14e7b40]
// Decompiled from int __cdecl SettlerTypePrioClass(int a1)
int __cdecl SettlerTypePrioClass(int a1) {
  
  int v2; // [esp+0h] [ebp-4h]

  v2 = CSettlerMgr::SettlerWarriorType(a1);
  switch ( v2 )
  {
    case 2:
      return 0;
    case 3:
      return 1;
    case 4:
      return 2;
  }
  return -1;
}


// address=[0x14f3930]
// Decompiled from int __thiscall AdvXMLParser::ConstIterator<AdvXMLParser::Element>::operator*(char *this)
public: class AdvXMLParser::Element const & __thiscall AdvXMLParser::ConstIterator<class AdvXMLParser::Element>::operator*(void)const {
  
  return *(_DWORD *)std::_Vector_const_iterator<std::_Vector_val<std::_Simple_types<AdvXMLParser::Node *>>>::operator*(this + 4);
}


// address=[0x14f3ab0]
// Decompiled from char *__thiscall AdvXMLParser::ConstIterator<AdvXMLParser::Element>::operator++(char *this)
public: struct AdvXMLParser::ConstIterator<class AdvXMLParser::Element> & __thiscall AdvXMLParser::ConstIterator<class AdvXMLParser::Element>::operator++(void) {
  
  std::_Vector_const_iterator<std::_Vector_val<std::_Simple_types<AdvXMLParser::Node *>>>::operator++(this + 4);
  AdvXMLParser::ConstIterator<AdvXMLParser::Element>::FirstValid();
  return this;
}


// address=[0x14f3da0]
// Decompiled from void __thiscall AdvXMLParser::ConstIterator<AdvXMLParser::Element>::FirstValid(_DWORD *this)
private: void __thiscall AdvXMLParser::ConstIterator<class AdvXMLParser::Element>::FirstValid(void) {
  
  _BYTE v1[12]; // [esp+4h] [ebp-2Ch] BYREF
  std::_Iterator_base12 *v2; // [esp+10h] [ebp-20h]
  std::_Iterator_base12 *v3; // [esp+14h] [ebp-1Ch]
  int v4; // [esp+18h] [ebp-18h]
  _DWORD *i; // [esp+1Ch] [ebp-14h]
  bool v6; // [esp+23h] [ebp-Dh]
  int v7; // [esp+2Ch] [ebp-4h]

  for ( i = this;
        ;
        std::_Vector_const_iterator<std::_Vector_val<std::_Simple_types<AdvXMLParser::Node *>>>::operator++(i + 1) )
  {
    v3 = (std::_Iterator_base12 *)std::vector<AdvXMLParser::Node *>::end(v1);
    v2 = v3;
    v7 = 0;
    v6 = std::_Vector_const_iterator<std::_Vector_val<std::_Simple_types<AdvXMLParser::Node *>>>::operator<(i + 1, v3);
    v7 = -1;
    std::_Vector_const_iterator<std::_Vector_val<std::_Simple_types<AdvXMLParser::Node *>>>::~_Vector_const_iterator<std::_Vector_val<std::_Simple_types<AdvXMLParser::Node *>>>(v1);
    if ( !v6 )
      break;
    v4 = *(_DWORD *)std::_Vector_const_iterator<std::_Vector_val<std::_Simple_types<AdvXMLParser::Node *>>>::operator*(i + 1);
    if ( (*(unsigned __int8 (__thiscall **)(int, int))(*(_DWORD *)v4 + 12))(v4, 1) )
      break;
  }
}


// address=[0x1506110]
// Decompiled from int __cdecl operator^<float>(int a1, _DWORD *a2)
std::ostream & __cdecl operator^<float>(std::ostream & a1, float const & a2) {
  
  Serial::Serialize(a1, *a2);
  return a1;
}


// address=[0x1506670]
// Decompiled from __int64 __cdecl Serial::Serialize(struct std::ostream *a1, float a2)
void __cdecl Serial::Serialize(std::ostream & a1, float a2) {
  
  struct std::ostream *v2; // eax
  __int64 v4; // [esp+8h] [ebp-10h]
  int v5; // [esp+14h] [ebp-4h]

  v5 = j___fpclass(a2);
  if ( v5 > 4 )
  {
    if ( v5 != 512 )
      goto LABEL_8;
LABEL_7:
    a2 = 0.0;
    goto LABEL_8;
  }
  if ( v5 == 4 || v5 > 0 && v5 <= 2 )
    goto LABEL_7;
LABEL_8:
  v4 = std::ios_base::precision((struct std::ostream *)((char *)a1 + *(_DWORD *)(*(_DWORD *)a1 + 4)));
  std::ios_base::precision((struct std::ostream *)((char *)a1 + *(_DWORD *)(*(_DWORD *)a1 + 4)), 18LL);
  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = (struct std::ostream *)std::ostream::operator<<(LODWORD(a2));
  std::operator<<<std::char_traits<char>>(v2, 32);
  return std::ios_base::precision((struct std::ostream *)((char *)a1 + *(_DWORD *)(*(_DWORD *)a1 + 4)), v4);
}


// address=[0x1516000]
// Decompiled from struct std::ostream *__cdecl operator^<char>(struct std::ostream *a1, char *a2)
std::ostream & __cdecl operator^<char>(std::ostream & a1, char const & a2) {
  
  Serial::Serialize(a1, *a2, 32);
  return a1;
}


// address=[0x151f680]
// Decompiled from int __cdecl LoadArray<unsigned char>(int a1, int a2, size_t a3)
std::istream & __cdecl LoadArray<unsigned char>(std::istream & a1, unsigned char * const a2, unsigned int a3) {
  
  int v4; // [esp+8h] [ebp-1Ch] BYREF
  int v5; // [esp+Ch] [ebp-18h]
  _BYTE *v6; // [esp+10h] [ebp-14h]
  size_t v7; // [esp+14h] [ebp-10h]
  size_t Size; // [esp+18h] [ebp-Ch] BYREF
  size_t i; // [esp+1Ch] [ebp-8h]
  size_t j; // [esp+20h] [ebp-4h]

  v5 = 1;
  v7 = a3;
  v4 = 0;
  Size = 0;
  Serial::Serialize<unsigned int>(a1, &v4);
  if ( v5 != v4
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         267,
         "iElementSize == iReadiElementSize") == 1 )
  {
    __debugbreak();
  }
  Serial::Serialize<unsigned int>(a1, &Size);
  if ( v7 != Size
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         270,
         "iNumberOfElements == iReadNumberOfElements") == 1 )
  {
    __debugbreak();
  }
  if ( Size <= v7 )
  {
    for ( i = 0; i < Size; ++i )
      operator^<unsigned char>(a1, i + a2);
    for ( i = Size; i < Size; ++i )
      memset((void *)(i + a2), 0, 1u);
    return a1;
  }
  else
  {
    v6 = operator new[](Size);
    for ( j = 0; j < Size; ++j )
      operator^<unsigned char>(a1, &v6[j]);
    for ( j = 0; j < v7; ++j )
      *(_BYTE *)(j + a2) = v6[j];
    operator delete[](v6);
    return a1;
  }
}


// address=[0x151f870]
// Decompiled from struct std::ostream *__cdecl StoreArray<unsigned char>(struct std::ostream *a1, int a2, unsigned int a3)
std::ostream & __cdecl StoreArray<unsigned char>(std::ostream & a1, unsigned char const * const a2, unsigned int a3) {
  
  unsigned int v4; // [esp+0h] [ebp-Ch] BYREF
  int v5; // [esp+4h] [ebp-8h] BYREF
  unsigned int i; // [esp+8h] [ebp-4h]

  v5 = 1;
  v4 = a3;
  Serial::Serialize<unsigned int>((int)a1, &v5);
  Serial::Serialize<unsigned int>((int)a1, (int *)&v4);
  for ( i = 0; i < v4; ++i )
    operator^<unsigned char>(a1, (BYTE *)(i + a2));
  return a1;
}


// address=[0x1536260]
// Decompiled from int __cdecl operator^<SLoadInfo>(int a1, int a2)
std::istream & __cdecl operator^<struct SLoadInfo>(std::istream & a1, struct SLoadInfo & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x1536280]
// Decompiled from int __cdecl operator^<SLoadInfo>(int a1, int a2)
std::ostream & __cdecl operator^<struct SLoadInfo>(std::ostream & a1, struct SLoadInfo const & a2) {
  
  Serial::Serialize(a1, a2);
  return a1;
}


// address=[0x15362a0]
// Decompiled from int __cdecl LoadArray<SLoadInfo>(int a1, int a2, unsigned int a3)
std::istream & __cdecl LoadArray<struct SLoadInfo>(std::istream & a1, struct SLoadInfo * const a2, unsigned int a3) {
  
  char *v3; // ecx
  _DWORD *v4; // edx
  int v6; // [esp+8h] [ebp-1Ch] BYREF
  int v7; // [esp+Ch] [ebp-18h]
  char *v8; // [esp+10h] [ebp-14h]
  unsigned int v9; // [esp+14h] [ebp-10h]
  unsigned int v10; // [esp+18h] [ebp-Ch] BYREF
  unsigned int i; // [esp+1Ch] [ebp-8h]
  unsigned int j; // [esp+20h] [ebp-4h]

  v7 = 12;
  v9 = a3 / 0xC;
  v6 = 0;
  v10 = 0;
  Serial::Serialize<unsigned int>(a1, &v6);
  if ( v7 != v6
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         267,
         "iElementSize == iReadiElementSize") == 1 )
  {
    __debugbreak();
  }
  Serial::Serialize<unsigned int>(a1, &v10);
  if ( v9 != v10
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\S4_Main\\LoadSave\\Serialize.h",
         270,
         "iNumberOfElements == iReadNumberOfElements") == 1 )
  {
    __debugbreak();
  }
  if ( v10 <= v9 )
  {
    for ( i = 0; i < v10; ++i )
      operator^<SLoadInfo>(a1, a2 + 12 * i);
    for ( i = v10; i < v10; ++i )
      memset((void *)(a2 + 12 * i), 0, 0xCu);
    return a1;
  }
  else
  {
    v8 = (char *)operator new[](12 * v10);
    for ( j = 0; j < v10; ++j )
      operator^<SLoadInfo>(a1, &v8[12 * j]);
    for ( j = 0; j < v9; ++j )
    {
      v3 = &v8[12 * j];
      v4 = (_DWORD *)(a2 + 12 * j);
      *v4 = *(_DWORD *)v3;
      v4[1] = *((_DWORD *)v3 + 1);
      v4[2] = *((_DWORD *)v3 + 2);
    }
    operator delete[](v8);
    return a1;
  }
}


// address=[0x15364c0]
// Decompiled from int __cdecl StoreArray<SLoadInfo>(int a1, int a2, unsigned int a3)
std::ostream & __cdecl StoreArray<struct SLoadInfo>(std::ostream & a1, struct SLoadInfo const * const a2, unsigned int a3) {
  
  _DWORD *v3; // eax
  unsigned int v5; // [esp+0h] [ebp-1Ch] BYREF
  int v6; // [esp+4h] [ebp-18h] BYREF
  unsigned int i; // [esp+8h] [ebp-14h]
  _DWORD v8[3]; // [esp+Ch] [ebp-10h] BYREF

  v6 = 12;
  v5 = a3 / 0xC;
  Serial::Serialize<unsigned int>(a1, &v6);
  Serial::Serialize<unsigned int>(a1, (int *)&v5);
  for ( i = 0; i < v5; ++i )
  {
    v3 = (_DWORD *)(a2 + 12 * i);
    v8[0] = *v3;
    v8[1] = v3[1];
    v8[2] = v3[2];
    operator^<SLoadInfo>(a1, v8);
  }
  return a1;
}


// address=[0x153a580]
// Decompiled from int __cdecl Serial::Serialize(int a1, int a2)
void __cdecl Serial::Serialize(std::istream & a1, struct SLoadInfo & a2) {
  
  Serial::Serialize<int>(a1, a2);
  Serial::Serialize<int>(a1, a2 + 4);
  return Serial::Serialize<int>(a1, a2 + 8);
}


// address=[0x153a5d0]
// Decompiled from int __cdecl Serial::Serialize(int a1, int *a2)
void __cdecl Serial::Serialize(std::ostream & a1, struct SLoadInfo const & a2) {
  
  Serial::Serialize<int>(a1, a2);
  Serial::Serialize<int>(a1, a2 + 1);
  return Serial::Serialize<int>(a1, a2 + 2);
}


// address=[0x1548110]
// Decompiled from void *__cdecl CreateArgv<unsigned int>(void *a1, int a2)
class TArgv<unsigned int,class std::vector<unsigned int,class std::allocator<unsigned int> > > __cdecl CreateArgv<unsigned int>(unsigned int const & a1) {
  
  TArgv<unsigned int,std::vector<unsigned int>>::TArgv<unsigned int,std::vector<unsigned int>>(a1, a2);
  return a1;
}


// address=[0x1548340]
// Decompiled from void *__thiscall TArgv<unsigned int,std::vector<unsigned int>>::operator()(void *this, int a2)
public: class TArgv<unsigned int,class std::vector<unsigned int,class std::allocator<unsigned int> > > & __thiscall TArgv<unsigned int,class std::vector<unsigned int,class std::allocator<unsigned int> > >::operator()(unsigned int const & a2) {
  
  std::vector<unsigned int>::push_back(a2);
  return this;
}


// address=[0x1552570]
// Decompiled from void *__thiscall TStaticArray<unsigned short,100>::TStaticArray<unsigned short,100>(void *this)
public: __thiscall TStaticArray<unsigned short,100>::TStaticArray<unsigned short,100>(void) {
  
  TStaticArray<unsigned short,100>::Init(this);
  return this;
}


// address=[0x1552610]
// Decompiled from unsigned __int16 *__thiscall TStaticArray<unsigned short,100>::operator[](  struct CGroupMgr::TStaticArray100short *this,  int a2)
public: unsigned short & __thiscall TStaticArray<unsigned short,100>::operator[](int a2) {
  
  return &this->entry[a2];
}


// address=[0x1552630]
// Decompiled from WORD *__thiscall TStaticArray<unsigned short,100>::operator[](struct CGroupMgr::TStaticArray100short *this, int a2)
public: unsigned short const & __thiscall TStaticArray<unsigned short,100>::operator[](int a2)const {
  
  return &this->entry[a2];
}


// address=[0x15526b0]
// Decompiled from int __thiscall TStaticArray<unsigned short,100>::FindEntry(  struct CGroupMgr::TStaticArray100short *this,  unsigned __int16 *a2)
public: int __thiscall TStaticArray<unsigned short,100>::FindEntry(unsigned short const & a2) {
  
  int i; // [esp+4h] [ebp-4h]

  for ( i = 0; i < (signed int)this->size; ++i )
  {
    if ( this->entry[i] == *a2 )
      return i;
  }
  return -1;
}


// address=[0x1552770]
// Decompiled from void __thiscall TStaticArray<unsigned short,100>::Init(void *this)
public: void __thiscall TStaticArray<unsigned short,100>::Init(void) {
  
  *(_DWORD *)this = 0;
}


// address=[0x1552790]
// Decompiled from int __thiscall TStaticArray<unsigned short,100>::PopBack(int *this)
public: void __thiscall TStaticArray<unsigned short,100>::PopBack(void) {
  
  int result; // eax

  if ( *this <= 0
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\BaseLib\\Include\\Misc\\Templates.h",
         161,
         "m_iSize > 0") == 1 )
  {
    __debugbreak();
  }
  result = *this - 1;
  *this = result;
  return result;
}


// address=[0x15527e0]
// Decompiled from int *__thiscall TStaticArray<unsigned short,100>::PushBack(struct CGroupMgr::TStaticArray100short *this, _WORD *a2)
public: void __thiscall TStaticArray<unsigned short,100>::PushBack(unsigned short const & a2) {
  
  int *result; // eax

  if ( (int)this->size >= 100
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\BaseLib\\Include\\Misc\\Templates.h",
         154,
         "m_iSize < MAX_SIZE") == 1 )
  {
    __debugbreak();
  }
  this->entry[this->size] = *a2;
  result = (int *)this;
  ++this->size;
  return result;
}


// address=[0x1552850]
// Decompiled from char __thiscall TStaticArray<unsigned short,100>::RemoveEntry(  struct CGroupMgr::TStaticArray100short *this,  unsigned __int16 *a1)
public: bool __thiscall TStaticArray<unsigned short,100>::RemoveEntry(unsigned short const & a2) {
  
  int Entry; // [esp+4h] [ebp-4h]

  Entry = TStaticArray<unsigned short,100>::FindEntry(this, a1);
  if ( Entry < 0 )
    return 0;
  TStaticArray<unsigned short,100>::RemoveIndex(Entry);
  return 1;
}


// address=[0x15528a0]
// Decompiled from _DWORD *__thiscall TStaticArray<unsigned short,100>::RemoveIndex(_DWORD *this, int a2)
public: void __thiscall TStaticArray<unsigned short,100>::RemoveIndex(int a2) {
  
  _DWORD *result; // eax

  if ( (a2 >= *this || a2 < 0)
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\BaseLib\\Include\\Misc\\Templates.h",
         209,
         "(_iIndex >= 0) & (_iIndex < m_iSize)") == 1 )
  {
    __debugbreak();
  }
  result = this;
  if ( a2 >= --*this )
    return result;
  result = this;
  *((_WORD *)this + a2 + 2) = *((_WORD *)this + *this + 2);
  return result;
}


// address=[0x1552960]
// Decompiled from int __thiscall TStaticArray<unsigned short,100>::Size(struct CGroupMgr::TStaticArray100short *this)
public: int __thiscall TStaticArray<unsigned short,100>::Size(void)const {
  
  return this->size;
}


// address=[0x1558300]
// Decompiled from int __cdecl MapObjectGetGfxInfo(unsigned int a1, int a2)
struct SGfxObjectInfo * __cdecl MapObjectGetGfxInfo(unsigned int a1, int a2) {
  
  return CMapObjectMgr::GetGfxInfo(g_pMapObjectMgr, a1, a2);
}


// address=[0x1568700]
// Decompiled from int __cdecl Y16X16::DeltaXFast(int x, int a2)
int __cdecl Y16X16::DeltaXFast(int x, int a2) {
  
  return (unsigned __int16)a2 - (unsigned __int16)x;
}


// address=[0x1568720]
// Decompiled from int __cdecl Y16X16::DeltaYFast(int this, int a2)
int __cdecl Y16X16::DeltaYFast(int a2, int a2) {
  
  return (a2 >> 16) - (this >> 16);
}


// address=[0x1568740]
// Decompiled from int __cdecl Y16X16::DirectionFast(int x, int y)
int __cdecl Y16X16::DirectionFast(int x, int y) {
  
  int v3; // [esp+0h] [ebp-8h]
  int v4; // [esp+4h] [ebp-4h]

  v3 = Y16X16::DeltaXFast(x, y);
  v4 = Y16X16::DeltaYFast(x, y);
  return Grid::DirectionFast(v3, v4);
}


// address=[0x156f830]
// Decompiled from EntityFlag __cdecl CheckRegister(char *a1, IEntity *a2)
void __cdecl CheckRegister(char * a1, class CSettler * a2) {
  
  EntityFlag result; // eax
  int v3; // eax

  result = IEntity::FlagBits(a2, EntityFlag_Registered);
  if ( result )
    return result;
  v3 = IEntity::ID(a2);
  return CTrace::Print("%s %u", a1, v3);
}


// address=[0x1570000]
// Decompiled from double __cdecl abs(float X)
float __cdecl abs(float X) {
  
  return j__fabsf(X);
}


// address=[0x1592da0]
// Decompiled from int __cdecl Y16X16::DistanceFast(Y16X16 *this, int a2)
int __cdecl Y16X16::DistanceFast(int a2, int a2) {
  
  int v3; // [esp+0h] [ebp-8h]
  int v4; // [esp+4h] [ebp-4h]

  v3 = Y16X16::DeltaXFast((int)this, a2);
  v4 = Y16X16::DeltaYFast((int)this, a2);
  return Grid::Distance(v3, v4);
}


// address=[0x15998c0]
// Decompiled from int __cdecl operator^<enum CFerryShip::TFerryJob>(int a1, int a2)
std::ostream & __cdecl operator^<enum CFerryShip::TFerryJob>(std::ostream & a1, enum CFerryShip::TFerryJob const & a2) {
  
  Serial::Serialize<enum CFerryShip::TFerryJob>(a1, a2);
  return a1;
}


// address=[0x15998e0]
// Decompiled from struct std::ostream *__cdecl Serial::Serialize<enum CFerryShip::TFerryJob>(struct std::ostream *a1, int *a2)
void __cdecl Serial::Serialize<enum CFerryShip::TFerryJob>(std::ostream & a1, enum CFerryShip::TFerryJob const & a2) {
  
  struct std::ostream *v2; // eax
  int v4; // [esp-8h] [ebp-8h]

  v4 = *a2;
  std::operator<<<std::char_traits<char>>(a1, 32);
  v2 = (struct std::ostream *)std::ostream::operator<<(v4);
  return std::operator<<<std::char_traits<char>>(v2, 32);
}


// address=[0x15b1910]
// Decompiled from _DWORD *__thiscall TStaticConfigIntArray<4>::TStaticConfigIntArray<4>(  _DWORD *this,  int a2,  int a3,  int a4,  int a5,  int a6,  int a7)
public: __thiscall TStaticConfigIntArray<4>::TStaticConfigIntArray<4>(char const * a2, char const * a3, int a4, int a5, int a6, int a7) {
  
  TStaticConfigIntArrayBase<4>::TStaticConfigIntArrayBase<4>(a2, a3);
  *this = &TStaticConfigIntArray_4_::_vftable_;
  this[2] = a4;
  this[3] = a5;
  this[4] = a6;
  this[5] = a7;
  return this;
}


// address=[0x15b19a0]
// Decompiled from _DWORD *__thiscall TStaticConfigIntArrayBase<4>::TStaticConfigIntArrayBase<4>(_DWORD *this, int a2, int a3)
private: __thiscall TStaticConfigIntArrayBase<4>::TStaticConfigIntArrayBase<4>(char const * a2, char const * a3) {
  
  CStaticConfigVar::CStaticConfigVar(this, a2, a3, 2, 4);
  *this = &TStaticConfigIntArrayBase_4_::_vftable_;
  return this;
}


// address=[0x15b19e0]
// Decompiled from int __thiscall TStaticConfigIntArray<4>::~TStaticConfigIntArray<4>(void *this)
public: __thiscall TStaticConfigIntArray<4>::~TStaticConfigIntArray<4>(void) {
  
  return TStaticConfigIntArrayBase<4>::~TStaticConfigIntArrayBase<4>(this, this);
}


// address=[0x15b1a00]
// Decompiled from CConfigVar *__thiscall TStaticConfigIntArrayBase<4>::~TStaticConfigIntArrayBase<4>(CStaticConfigVar *this)
public: __thiscall TStaticConfigIntArrayBase<4>::~TStaticConfigIntArrayBase<4>(void) {
  
  return CStaticConfigVar::~CStaticConfigVar(this);
}


// address=[0x15b1a20]
// Decompiled from int __thiscall TStaticConfigIntArrayBase<4>::operator[](void *this, int a2)
public: int & __thiscall TStaticConfigIntArrayBase<4>::operator[](int a2) {
  
  return (int)this + 4 * a2 + 8;
}


// address=[0x15b1ac0]
// Decompiled from char *__thiscall TStaticConfigIntArrayBase<4>::GetIntArray(char *this)
public: int * __thiscall TStaticConfigIntArrayBase<4>::GetIntArray(void) {
  
  return this + 8;
}


// address=[0x15b1ae0]
// Decompiled from char *__thiscall TStaticConfigIntArrayBase<4>::GetIntArray(char *this)
public: int const * __thiscall TStaticConfigIntArrayBase<4>::GetIntArray(void)const {
  
  return this + 8;
}


// address=[0x15cc520]
// Decompiled from double __cdecl pow<int,int>(int a1, int a2)
double __cdecl pow<int,int>(int a1, int a2) {
  
  return j__pow((double)a1, (double)a2);
}


// address=[0x15cc670]
// Decompiled from int CreateSimpleNet()
class ISimpleNet * __cdecl CreateSimpleNet(void) {
  
  std::bad_function_call *v2; // [esp+Ch] [ebp-10h]

  if ( !dword_415B978
    && BBSupportDbgReportF(
         2,
         "net\\SimpleNet.cpp",
         384,
         "One or more function ptrs to WS2_32.DLL are NULL. You must call ImportWSAFunctions() before !") == 1 )
  {
    __debugbreak();
  }
  if ( !dword_415B978 )
    return 0;
  v2 = (std::bad_function_call *)operator new(0x11BCu);
  if ( v2 )
    return CSimpleNet::CSimpleNet(v2);
  else
    return 0;
}


// address=[0x15cc720]
// Decompiled from char ImportWSAFunctions()
bool __cdecl ImportWSAFunctions(void) {
  
  hLibModule = LoadLibraryA("WS2_32.DLL");
  j___controlfp(0xA031Fu, (unsigned int)&loc_30F031E + 1);
  if ( hLibModule
    || (hLibModule = LoadLibraryA("wsock32.DLL"), j___controlfp(0xA031Fu, (unsigned int)&loc_30F031E + 1), hLibModule) )
  {
    WSACleanup = GetProcAddress(hLibModule, "WSACleanup");
    if ( WSACleanup )
    {
      WSAGetLastError = GetProcAddress(hLibModule, "WSAGetLastError");
      if ( WSAGetLastError )
      {
        inet_addr = (unsigned int (__stdcall *)(const char *))GetProcAddress(hLibModule, "inet_addr");
        if ( inet_addr )
        {
          closesocket = (int (__stdcall *)(SOCKET))GetProcAddress(hLibModule, "closesocket");
          if ( closesocket )
          {
            shutdown = (int (__stdcall *)(SOCKET, int))GetProcAddress(hLibModule, "shutdown");
            if ( shutdown )
            {
              inet_ntoa = (char *(__stdcall *)(struct in_addr))GetProcAddress(hLibModule, "inet_ntoa");
              if ( inet_ntoa )
              {
                socket = (SOCKET (__stdcall *)(int, int, int))GetProcAddress(hLibModule, "socket");
                if ( socket )
                {
                  getsockname = (int (__stdcall *)(SOCKET, struct sockaddr *, int *))GetProcAddress(
                                                                                       hLibModule,
                                                                                       "getsockname");
                  if ( getsockname )
                  {
                    getsockopt = (int (__stdcall *)(SOCKET, int, int, char *, int *))GetProcAddress(
                                                                                       hLibModule,
                                                                                       "getsockopt");
                    if ( getsockopt )
                    {
                      setsockopt = (int (__stdcall *)(SOCKET, int, int, const char *, int))GetProcAddress(
                                                                                             hLibModule,
                                                                                             "setsockopt");
                      if ( setsockopt )
                      {
                        bind = (int (__stdcall *)(SOCKET, const struct sockaddr *, int))GetProcAddress(
                                                                                          hLibModule,
                                                                                          "bind");
                        if ( bind )
                        {
                          htons = (u_short (__stdcall *)(u_short))GetProcAddress(hLibModule, "htons");
                          if ( htons )
                          {
                            select = (int (__stdcall *)(int, fd_set *, fd_set *, fd_set *, const struct timeval *))GetProcAddress(hLibModule, "select");
                            if ( select )
                            {
                              sendto = (int (__stdcall *)(SOCKET, const char *, int, int, const struct sockaddr *, int))GetProcAddress(hLibModule, "sendto");
                              if ( sendto )
                              {
                                recvfrom = (int (__stdcall *)(SOCKET, char *, int, int, struct sockaddr *, int *))GetProcAddress(hLibModule, "recvfrom");
                                if ( recvfrom )
                                {
                                  WSAIoctl = (int (__stdcall *)(SOCKET, DWORD, LPVOID, DWORD, LPVOID, DWORD, LPDWORD, LPWSAOVERLAPPED, LPWSAOVERLAPPED_COMPLETION_ROUTINE))GetProcAddress(hLibModule, "WSAIoctl");
                                  if ( !WSAIoctl )
                                    BBSupportTracePrintF(3, "Error getting WSAIoctl!");
                                  WSAStartup = (int (__stdcall *)(WORD, LPWSADATA))GetProcAddress(
                                                                                     hLibModule,
                                                                                     "WSAStartup");
                                  if ( WSAStartup )
                                  {
                                    gethostname = (int (__stdcall *)(char *, int))GetProcAddress(
                                                                                    hLibModule,
                                                                                    "gethostname");
                                    if ( gethostname )
                                    {
                                      gethostbyname = (struct hostent *(__stdcall *)(const char *))GetProcAddress(
                                                                                                     hLibModule,
                                                                                                     "gethostbyname");
                                      if ( gethostbyname )
                                      {
                                        ntohl = (u_long (__stdcall *)(u_long))GetProcAddress(hLibModule, "ntohl");
                                        if ( ntohl )
                                        {
                                          return 1;
                                        }
                                        else
                                        {
                                          BBSupportTracePrintF(3, "Error getting ntohl!");
                                          return 0;
                                        }
                                      }
                                      else
                                      {
                                        BBSupportTracePrintF(3, "Error getting WSAStartup!");
                                        return 0;
                                      }
                                    }
                                    else
                                    {
                                      BBSupportTracePrintF(3, "Error getting WSAStartup!");
                                      return 0;
                                    }
                                  }
                                  else
                                  {
                                    BBSupportTracePrintF(3, "Error getting WSAStartup!");
                                    return 0;
                                  }
                                }
                                else
                                {
                                  BBSupportTracePrintF(3, "Error getting recvfrom!");
                                  return 0;
                                }
                              }
                              else
                              {
                                BBSupportTracePrintF(3, "Error getting sendto!");
                                return 0;
                              }
                            }
                            else
                            {
                              BBSupportTracePrintF(3, "Error getting select!");
                              return 0;
                            }
                          }
                          else
                          {
                            BBSupportTracePrintF(3, "Error getting htons!");
                            return 0;
                          }
                        }
                        else
                        {
                          BBSupportTracePrintF(3, "Error getting bind!");
                          return 0;
                        }
                      }
                      else
                      {
                        BBSupportTracePrintF(3, "Error getting setsockopt!");
                        return 0;
                      }
                    }
                    else
                    {
                      BBSupportTracePrintF(3, "Error getting getsockopt!");
                      return 0;
                    }
                  }
                  else
                  {
                    BBSupportTracePrintF(3, "Error getting getsockname!");
                    return 0;
                  }
                }
                else
                {
                  BBSupportTracePrintF(3, "Error getting socket!");
                  return 0;
                }
              }
              else
              {
                BBSupportTracePrintF(3, "Error getting inet_ntoa!");
                return 0;
              }
            }
            else
            {
              BBSupportTracePrintF(3, "Error getting shutdown!");
              return 0;
            }
          }
          else
          {
            BBSupportTracePrintF(3, "Error getting closesocket!");
            return 0;
          }
        }
        else
        {
          BBSupportTracePrintF(3, "Error getting inet_addr!");
          return 0;
        }
      }
      else
      {
        BBSupportTracePrintF(3, "Error getting WSAGetLastError!");
        return 0;
      }
    }
    else
    {
      BBSupportTracePrintF(3, "Error getting WSACleanup!");
      return 0;
    }
  }
  else
  {
    BBSupportTracePrintF(3, "Error loading WS2_32.DLL or WSOCK32.DLL!");
    return 0;
  }
}


// address=[0x15ccbc0]
// Decompiled from BOOL ExitWSAFunctions()
void __cdecl ExitWSAFunctions(void) {
  
  BOOL result; // eax

  if ( !hLibModule )
    return result;
  result = FreeLibrary(hLibModule);
  hLibModule = 0;
  return result;
}


// address=[0x15d5e20]
// Decompiled from _DWORD *__thiscall TPriorityQueue<COpenListEntry16,32768>::TPriorityQueue<COpenListEntry16,32768>(_DWORD *this)
public: __thiscall TPriorityQueue<class COpenListEntry16,32768>::TPriorityQueue<class COpenListEntry16,32768>(void) {
  
  *this = 0;
  COpenListEntry16::MaxItem((std::_Basic_container_proxy_ptr12 *)(this + 1));
  return this;
}


// address=[0x15d5e60]
// Decompiled from _DWORD *__thiscall TPriorityQueue<COpenListEntry24,8192>::TPriorityQueue<COpenListEntry24,8192>(_DWORD *this)
public: __thiscall TPriorityQueue<class COpenListEntry24,8192>::TPriorityQueue<class COpenListEntry24,8192>(void) {
  
  *this = 0;
  COpenListEntry24::MaxItem((std::_Basic_container_proxy_ptr12 *)(this + 1));
  return this;
}


// address=[0x15d5fb0]
// Decompiled from bool __thiscall TBitArray<8192>::operator[](_DWORD *this, unsigned int a2)
public: bool __thiscall TBitArray<8192>::operator[](unsigned int a2) {
  
  return (this[a2 >> 5] & (1 << (a2 & 0x1F))) != 0;
}


// address=[0x15d6000]
// Decompiled from bool __thiscall TBitArray<32768>::operator[](_DWORD *this, unsigned int a2)
public: bool __thiscall TBitArray<32768>::operator[](unsigned int a2) {
  
  return (this[a2 >> 5] & (1 << (a2 & 0x1F))) != 0;
}


// address=[0x15d6050]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry16,32768>::operator[](void *this, int a2)
public: class COpenListEntry16 const & __thiscall TPriorityQueue<class COpenListEntry16,32768>::operator[](int a2)const {
  
  return (int)this + 8 * a2 + 4;
}


// address=[0x15d6070]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry24,8192>::operator[](void *this, int a2)
public: class COpenListEntry24 const & __thiscall TPriorityQueue<class COpenListEntry24,8192>::operator[](int a2)const {
  
  return (int)this + 8 * a2 + 4;
}


// address=[0x15d6130]
// Decompiled from void __thiscall TPriorityQueue<COpenListEntry24,8192>::Clear(std::_Basic_container_proxy_ptr12 *this)
public: void __thiscall TPriorityQueue<class COpenListEntry24,8192>::Clear(void) {
  
  *(_DWORD *)this = 0;
}


// address=[0x15d6150]
// Decompiled from void *__thiscall TBitArray<8192>::ClearArray(void *this)
public: void __thiscall TBitArray<8192>::ClearArray(void) {
  
  return memset(this, 0, 0x400u);
}


// address=[0x15d6180]
// Decompiled from void *__thiscall TBitArray<32768>::ClearArray(void *this)
public: void __thiscall TBitArray<32768>::ClearArray(void) {
  
  return memset(this, 0, 0x1000u);
}


// address=[0x15d62a0]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry16,32768>::DownHeap(int *this, int a2)
protected: void __thiscall TPriorityQueue<class COpenListEntry16,32768>::DownHeap(int a2) {
  
  int v2; // eax
  int v3; // eax
  int v4; // ecx
  int *v5; // esi
  int result; // eax
  int *v7; // ecx
  int v8; // [esp+4h] [ebp-18h] BYREF
  int v9; // [esp+8h] [ebp-14h]
  int v10; // [esp+Ch] [ebp-10h]
  int v11; // [esp+10h] [ebp-Ch]
  int *v12; // [esp+14h] [ebp-8h]
  int v13; // [esp+18h] [ebp-4h]

  v12 = this;
  v11 = a2;
  v10 = *this;
  v2 = this[2 * a2 + 2];
  v8 = this[2 * a2 + 1];
  v9 = v2;
  while ( v11 <= v10 >> 1 )
  {
    v13 = 2 * v11;
    if ( 2 * v11 < v10 && COpenListEntry16::operator<(&v12[2 * v13 + 1], &v12[2 * v13 + 3]) )
      ++v13;
    if ( !COpenListEntry16::operator<(&v8, &v12[2 * v13 + 1]) )
      break;
    v3 = v12[2 * v13 + 2];
    v4 = v11;
    v5 = v12;
    v12[2 * v11 + 1] = v12[2 * v13 + 1];
    v5[2 * v4 + 2] = v3;
    v11 = v13;
  }
  result = v11;
  v7 = v12;
  v12[2 * v11 + 1] = v8;
  v7[2 * result + 2] = v9;
  return result;
}


// address=[0x15d63b0]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry24,8192>::DownHeap(int *this, int a2)
protected: void __thiscall TPriorityQueue<class COpenListEntry24,8192>::DownHeap(int a2) {
  
  int v2; // eax
  int v3; // eax
  int v4; // ecx
  int *v5; // esi
  int result; // eax
  int *v7; // ecx
  int v8; // [esp+4h] [ebp-18h] BYREF
  int v9; // [esp+8h] [ebp-14h]
  int v10; // [esp+Ch] [ebp-10h]
  int v11; // [esp+10h] [ebp-Ch]
  int *v12; // [esp+14h] [ebp-8h]
  int v13; // [esp+18h] [ebp-4h]

  v12 = this;
  v11 = a2;
  v10 = *this;
  v2 = this[2 * a2 + 2];
  v8 = this[2 * a2 + 1];
  v9 = v2;
  while ( v11 <= v10 >> 1 )
  {
    v13 = 2 * v11;
    if ( 2 * v11 < v10 && COpenListEntry24::operator<(&v12[2 * v13 + 1], &v12[2 * v13 + 3]) )
      ++v13;
    if ( !COpenListEntry24::operator<(&v8, &v12[2 * v13 + 1]) )
      break;
    v3 = v12[2 * v13 + 2];
    v4 = v11;
    v5 = v12;
    v12[2 * v11 + 1] = v12[2 * v13 + 1];
    v5[2 * v4 + 2] = v3;
    v11 = v13;
  }
  result = v11;
  v7 = v12;
  v12[2 * v11 + 1] = v8;
  v7[2 * result + 2] = v9;
  return result;
}


// address=[0x15d64c0]
// Decompiled from bool __thiscall TPriorityQueue<COpenListEntry16,32768>::Empty(_DWORD *this)
public: bool __thiscall TPriorityQueue<class COpenListEntry16,32768>::Empty(void)const {
  
  return *this == 0;
}


// address=[0x15d6500]
// Decompiled from bool __thiscall TPriorityQueue<COpenListEntry24,8192>::Empty(_DWORD *this)
public: bool __thiscall TPriorityQueue<class COpenListEntry24,8192>::Empty(void)const {
  
  return *this == 0;
}


// address=[0x15d6540]
// Decompiled from _crt_argv_mode __cdecl TPriorityQueue<COpenListEntry16,32768>::First()
public: int __cdecl TPriorityQueue<class COpenListEntry16,32768>::First(void) {
  
  return 1;
}


// address=[0x15d6550]
// Decompiled from _crt_argv_mode __cdecl TPriorityQueue<COpenListEntry24,8192>::First()
public: int __cdecl TPriorityQueue<class COpenListEntry24,8192>::First(void) {
  
  return 1;
}


// address=[0x15d6700]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry16,32768>::Last(void *this)
public: int __thiscall TPriorityQueue<class COpenListEntry16,32768>::Last(void)const {
  
  return *(_DWORD *)this;
}


// address=[0x15d6720]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry24,8192>::Last(void *this)
public: int __thiscall TPriorityQueue<class COpenListEntry24,8192>::Last(void)const {
  
  return *(_DWORD *)this;
}


// address=[0x15d6820]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry16,32768>::Pop(int *this)
public: void __thiscall TPriorityQueue<class COpenListEntry16,32768>::Pop(void) {
  
  int v1; // ecx
  int v2; // eax
  int v3; // ecx

  v1 = *this;
  v2 = this[2 * v1 + 1];
  v3 = this[2 * v1 + 2];
  this[3] = v2;
  this[4] = v3;
  --*this;
  return TPriorityQueue<COpenListEntry16,32768>::DownHeap(this, 1);
}


// address=[0x15d6880]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry24,8192>::Pop(int *this)
public: void __thiscall TPriorityQueue<class COpenListEntry24,8192>::Pop(void) {
  
  int v1; // ecx
  int v2; // eax
  int v3; // ecx

  v1 = *this;
  v2 = this[2 * v1 + 1];
  v3 = this[2 * v1 + 2];
  this[3] = v2;
  this[4] = v3;
  --*this;
  return TPriorityQueue<COpenListEntry24,8192>::DownHeap(this, 1);
}


// address=[0x15d68e0]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry16,32768>::Push(int *this, int *a2)
public: void __thiscall TPriorityQueue<class COpenListEntry16,32768>::Push(class COpenListEntry16 const & a2) {
  
  int v2; // eax
  int v4; // [esp+4h] [ebp-8h]

  v4 = *this + 1;
  *this = v4;
  v2 = a2[1];
  this[2 * v4 + 1] = *a2;
  this[2 * v4 + 2] = v2;
  return TPriorityQueue<COpenListEntry16,32768>::UpHeap(*this);
}


// address=[0x15d6940]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry24,8192>::Push(int *this, int *a2)
public: void __thiscall TPriorityQueue<class COpenListEntry24,8192>::Push(class COpenListEntry24 const & a2) {
  
  int v2; // eax
  int v4; // [esp+4h] [ebp-8h]

  v4 = *this + 1;
  *this = v4;
  v2 = a2[1];
  this[2 * v4 + 1] = *a2;
  this[2 * v4 + 2] = v2;
  return TPriorityQueue<COpenListEntry24,8192>::UpHeap(*this);
}


// address=[0x15d6b70]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry16,32768>::Remove(int *this, int a2)
public: void __thiscall TPriorityQueue<class COpenListEntry16,32768>::Remove(int a2) {
  
  int v2; // ecx
  int v3; // eax
  int v4; // ecx

  v2 = *this;
  v3 = this[2 * v2 + 1];
  v4 = this[2 * v2 + 2];
  this[2 * a2 + 1] = v3;
  this[2 * a2 + 2] = v4;
  --*this;
  return TPriorityQueue<COpenListEntry16,32768>::DownHeap(this, a2);
}


// address=[0x15d6bd0]
// Decompiled from int __thiscall TPriorityQueue<COpenListEntry24,8192>::Remove(int *this, int a2)
public: void __thiscall TPriorityQueue<class COpenListEntry24,8192>::Remove(int a2) {
  
  int v2; // ecx
  int v3; // eax
  int v4; // ecx

  v2 = *this;
  v3 = this[2 * v2 + 1];
  v4 = this[2 * v2 + 2];
  this[2 * a2 + 1] = v3;
  this[2 * a2 + 2] = v4;
  --*this;
  return TPriorityQueue<COpenListEntry24,8192>::DownHeap(this, a2);
}


// address=[0x15d6c30]
// Decompiled from unsigned int __thiscall TBitArray<8192>::Set(_DWORD *this, unsigned int a2)
public: void __thiscall TBitArray<8192>::Set(unsigned int a2) {
  
  unsigned int result; // eax

  result = a2 >> 5;
  this[a2 >> 5] |= 1 << (a2 & 0x1F);
  return result;
}


// address=[0x15d6c70]
// Decompiled from unsigned int __thiscall TBitArray<32768>::Set(_DWORD *this, unsigned int a2)
public: void __thiscall TBitArray<32768>::Set(unsigned int a2) {
  
  unsigned int result; // eax

  result = a2 >> 5;
  this[a2 >> 5] |= 1 << (a2 & 0x1F);
  return result;
}


// address=[0x15d6f30]
// Decompiled from char *__thiscall TPriorityQueue<COpenListEntry16,32768>::Top(char *this)
public: class COpenListEntry16 const & __thiscall TPriorityQueue<class COpenListEntry16,32768>::Top(void)const {
  
  return this + 12;
}


// address=[0x15d6f50]
// Decompiled from char *__thiscall TPriorityQueue<COpenListEntry24,8192>::Top(char *this)
public: class COpenListEntry24 const & __thiscall TPriorityQueue<class COpenListEntry24,8192>::Top(void)const {
  
  return this + 12;
}


// address=[0x15d6f70]
// Decompiled from _DWORD *__thiscall TPriorityQueue<COpenListEntry16,32768>::UpHeap(_DWORD *this, int a2)
protected: void __thiscall TPriorityQueue<class COpenListEntry16,32768>::UpHeap(int a2) {
  
  int v2; // eax
  int v3; // edx
  _DWORD *v4; // esi
  _DWORD *result; // eax
  int v6; // [esp+4h] [ebp-Ch] BYREF
  int v7; // [esp+8h] [ebp-8h]
  _DWORD *v8; // [esp+Ch] [ebp-4h]

  v8 = this;
  v2 = this[2 * a2 + 2];
  v6 = this[2 * a2 + 1];
  v7 = v2;
  while ( COpenListEntry16::operator<(&v8[2 * (a2 >> 1) + 1], &v6) )
  {
    v3 = v8[2 * (a2 >> 1) + 2];
    v4 = v8;
    v8[2 * a2 + 1] = v8[2 * (a2 >> 1) + 1];
    v4[2 * a2 + 2] = v3;
    a2 >>= 1;
  }
  result = v8;
  v8[2 * a2 + 1] = v6;
  result[2 * a2 + 2] = v7;
  return result;
}


// address=[0x15d7010]
// Decompiled from _DWORD *__thiscall TPriorityQueue<COpenListEntry24,8192>::UpHeap(_DWORD *this, int a2)
protected: void __thiscall TPriorityQueue<class COpenListEntry24,8192>::UpHeap(int a2) {
  
  int v2; // eax
  int v3; // edx
  _DWORD *v4; // esi
  _DWORD *result; // eax
  int v6; // [esp+4h] [ebp-Ch] BYREF
  int v7; // [esp+8h] [ebp-8h]
  _DWORD *v8; // [esp+Ch] [ebp-4h]

  v8 = this;
  v2 = this[2 * a2 + 2];
  v6 = this[2 * a2 + 1];
  v7 = v2;
  while ( COpenListEntry24::operator<(&v8[2 * (a2 >> 1) + 1], &v6) )
  {
    v3 = v8[2 * (a2 >> 1) + 2];
    v4 = v8;
    v8[2 * a2 + 1] = v8[2 * (a2 >> 1) + 1];
    v4[2 * a2 + 2] = v3;
    a2 >>= 1;
  }
  result = v8;
  v8[2 * a2 + 1] = v6;
  result[2 * a2 + 2] = v7;
  return result;
}


// address=[0x15d7190]
// Decompiled from BOOL __cdecl Y16X16::XYNotNegative(unsigned int this)
int __cdecl Y16X16::XYNotNegative(int) {
  
  return (this & 0x80008000) == 0;
}


// address=[0x15dc4b0]
// Decompiled from int __cdecl Grid::Direction(Grid *this, int a2)
int __cdecl Grid::Direction(int a2, int a2) {
  
  return sub_15DC780(this, a2);
}


// address=[0x15dc4d0]
// Decompiled from int __cdecl Grid::Direction_0(float a1, float a2)
int __cdecl Grid::Direction(float a1, float a2) {
  
  return sub_15DC850(a1, a2);
}


// address=[0x15dc500]
// Decompiled from int __cdecl Grid::DirectionFast(int this, int a2)
int __cdecl Grid::DirectionFast(int a2, int a2) {
  
  return sub_15DC970(this, a2);
}


// address=[0x15dc520]
// Decompiled from int __cdecl Grid::DirectionFast_0(float a1, float a2)
int __cdecl Grid::DirectionFast(float a1, float a2) {
  
  return sub_15DCA00(a1, a2);
}


// address=[0x15dc550]
// Decompiled from int __cdecl Grid::Area(int width, int height)
int __cdecl Grid::Area(int width, int height) {
  
  BOOL v3; // [esp+8h] [ebp-18h]

  if ( !__PAIR64__(height, width) )
    return 0;
  v3 = height < 0 || width < 0 && height == 0;
  if ( !v3 )
    return 3 * v3 + (width <= height) + (width <= 0);
  width = -width;
  height = -height;
  return 3 * v3 + (width <= height) + (width <= 0);
}


// address=[0x15dc620]
// Decompiled from int __cdecl Grid::AreaFast(int a1, int a2)
int __cdecl Grid::AreaFast(int a1, int a2) {
  
  return (unsigned __int8)byte_37D8BF8[(a1 <= a2) | (2 * (a1 <= 0)) | (4 * (a2 < 0))];
}


// address=[0x15dc6a0]
// Decompiled from int __cdecl Grid::Distance(int a1, int a2)
int __cdecl Grid::Distance(int a1, int a2) {
  
  int v3; // [esp+0h] [ebp-8h]
  int Number; // [esp+10h] [ebp+8h]
  int v6; // [esp+14h] [ebp+Ch]

  v3 = a2 ^ a1;
  Number = j__abs(a1);
  v6 = j__abs(a2);
  if ( v3 < 0 )
    return v6 + Number;
  else
    return Max(Number, v6);
}


// address=[0x15dc700]
// [Decompilation failed for float __cdecl Grid::Distance(float,float)]

// address=[0x15ddbe0]
// Decompiled from int __cdecl Grid::Distance(const struct SPoint *a1, const struct SPoint *a2)
int __cdecl Grid::Distance(struct SPoint const & a1, struct SPoint const & a2) {
  
  return Grid::Distance(a2->x - a1->x, a2->y - a1->y);
}


// address=[0x15ddc10]
// Decompiled from int __cdecl Grid::Distance(const struct SPoint *this)
int __cdecl Grid::Distance(struct SPoint const &) {
  
  return Grid::Distance(this->x, this->y);
}


// address=[0x15ddc30]
// Decompiled from int __cdecl Max(int a1, int a2)
int __cdecl Max(int a1, int a2) {
  
  if ( a1 >= a2 )
    return a1;
  else
    return a2;
}


// address=[0x15ddc60]
// Decompiled from double __cdecl Max(float a1, float a2)
float __cdecl Max(float a1, float a2) {
  
  if ( a2 <= a1 )
    return a1;
  else
    return a2;
}


// address=[0x15ddd50]
// Decompiled from double __cdecl fabs(double x)
float __cdecl fabs(float) {
  
  return j__fabsf(*(float *)&x);
}


// address=[0x15f10f0]
// Decompiled from int NeighborAnalysis::CalcTileAreas()
void __cdecl NeighborAnalysis::CalcTileAreas(void) {
  
  int result; // eax
  int i; // [esp+0h] [ebp-4h]

  dword_45020DC = 0;
  dword_45020E0[0] = dword_45020C4[0];
  result = 0;
  dword_45020F8[0] = 0;
  for ( i = 1; i < 6; ++i )
  {
    result = i;
    if ( dword_45020C0[i] != dword_45020C4[i] )
    {
      dword_45020E0[++dword_45020DC] = dword_45020C4[i];
      result = dword_45020DC;
      dword_45020F8[dword_45020DC] = i;
    }
  }
  if ( dword_45020DC <= 0 )
    return result;
  result = dword_45020C4[0];
  if ( dword_45020C4[0] != dword_45020C4[5] )
    return result;
  result = dword_45020DC;
  dword_45020F8[0] = dword_45020F8[dword_45020DC--];
  return result;
}


// address=[0x15f11f0]
// Decompiled from int __cdecl NeighborAnalysis::Init(int a1, int a2, int a3)
void __cdecl NeighborAnalysis::Init(enum T_TILING_TYPE a1, int a2, int a3) {
  
  int v3; // eax
  _BYTE v5[4]; // [esp+0h] [ebp-10h] BYREF
  int v6; // [esp+4h] [ebp-Ch]
  int v7; // [esp+8h] [ebp-8h]
  int i; // [esp+Ch] [ebp-4h]

  dword_42CF98C = 1;
  if ( !CTilingWorld::WorldInInnerWorld1(a2, a3)
    && BBSupportDbgReport(2, "Pathing\\Tiling.cpp", 2917, "CTilingWorld::WorldInInnerWorld1(_iX, _iY)") == 1 )
  {
    __debugbreak();
  }
  dword_42CF9A4 = a1;
  dword_4300E6C = Y16X16::PackXYFast(a2, a3);
  dword_45020C0[0] = CTilingWorld::WorldIndex(a2, a3);
  CTileIdRef::CTileIdRef(v5, a1, dword_45020C0[0]);
  for ( i = 0; i < 6; ++i )
  {
    v3 = CTilingWorld::WorldNeighborRelIndex(i);
    v7 = CTileIdRef::TileId((CTileIdRef *)v5, v3);
    if ( CTiles::IsValidRealTile(v7) )
      v6 = v7;
    else
      v6 = 0;
    dword_45020C4[i] = v6;
  }
  return NeighborAnalysis::CalcTileAreas();
}


// address=[0x15f12f0]
// Decompiled from int NeighborAnalysis::ReInit()
void __cdecl NeighborAnalysis::ReInit(void) {
  
  NeighborAnalysis *v1; // [esp+0h] [ebp-Ch]
  int v2; // [esp+0h] [ebp-Ch]
  int v3; // [esp+4h] [ebp-8h]
  int v4; // [esp+8h] [ebp-4h]

  if ( !dword_42CF98C && BBSupportDbgReport(2, "Pathing\\Tiling.cpp", 2967, "s_iInitialized") == 1 )
    __debugbreak();
  v1 = (NeighborAnalysis *)dword_42CF9A4;
  v3 = Y16X16::UnpackXFast(dword_4300E6C);
  v4 = Y16X16::UnpackYFast(dword_4300E6C);
  NeighborAnalysis::Done(v1);
  return NeighborAnalysis::Init(v2, v3, v4);
}


// address=[0x15f1370]
// Decompiled from int __cdecl NeighborAnalysis::InitOld(NeighborAnalysis *this, int a2)
void __cdecl NeighborAnalysis::InitOld(int a2, int a2) {
  
  CTile *v2; // eax
  int result; // eax
  int i; // [esp+4h] [ebp-4h]
  int j; // [esp+4h] [ebp-4h]

  if ( !dword_42CF98C && BBSupportDbgReport(2, "Pathing\\Tiling.cpp", 2989, "s_iInitialized") == 1 )
    __debugbreak();
  dword_42CF990 = 1;
  dword_4502110 = (int)this;
  dword_4502114 = a2;
  if ( (NeighborAnalysis *)CTiling::TileId(dword_42CF9A4, dword_45020C0[0]) != this
    && BBSupportDbgReport(2, "Pathing\\Tiling.cpp", 2998, "CTiling::TileId(s_tTilingType, s_iWorldIdx) == s_iOldTileId") == 1 )
  {
    __debugbreak();
  }
  v2 = (CTile *)ITiling::Tile(dword_4502110);
  if ( CTile::OwnerId(v2) != dword_4502114
    && BBSupportDbgReport(2, "Pathing\\Tiling.cpp", 2999, "ITiling::Tile(s_iOldTileId).OwnerId() == s_iOldOwnerId") == 1 )
  {
    __debugbreak();
  }
  dword_4502118 = 0;
  for ( i = 0; ; ++i )
  {
    result = i;
    if ( i > dword_45020DC )
      break;
    if ( (NeighborAnalysis *)dword_45020E0[i] == this )
    {
      dword_4502118 = 1;
      result = i;
      dword_450211C = i;
      for ( j = i + 1; j <= dword_45020DC; ++j )
      {
        dword_4502118 += dword_45020E0[j] == (_DWORD)this;
        result = j + 1;
      }
      return result;
    }
  }
  return result;
}


// address=[0x15f14e0]
// Decompiled from int __cdecl NeighborAnalysis::InitNew(NeighborAnalysis *this, int a2, unsigned __int8 a3)
void __cdecl NeighborAnalysis::InitNew(int a2, int a3, bool a3) {
  
  int result; // eax

  if ( !dword_42CF98C && BBSupportDbgReport(2, "Pathing\\Tiling.cpp", 3034, "s_iInitialized") == 1 )
    __debugbreak();
  dword_42CF994 = 1;
  dword_4502120 = (int)this;
  dword_4502124 = a2;
  result = a3;
  dword_4502128 = a3;
  return result;
}


// address=[0x15f3d10]
// Decompiled from void *__thiscall TLimitedFIFO<int,256>::TLimitedFIFO<int,256>(void *this)
public: __thiscall TLimitedFIFO<int,256>::TLimitedFIFO<int,256>(void) {
  
  TLimitedFIFO<int,256>::Init(this);
  return this;
}


// address=[0x15f3d30]
// Decompiled from void *__thiscall TLimitedFIFO<int,576>::TLimitedFIFO<int,576>(void *this)
public: __thiscall TLimitedFIFO<int,576>::TLimitedFIFO<int,576>(void) {
  
  TLimitedFIFO<int,576>::Init(this);
  return this;
}


// address=[0x15f3d50]
// Decompiled from void *__thiscall TLimitedFIFO<int,32768>::TLimitedFIFO<int,32768>(void *this)
public: __thiscall TLimitedFIFO<int,32768>::TLimitedFIFO<int,32768>(void) {
  
  TLimitedFIFO<int,32768>::Init(this);
  return this;
}


// address=[0x15f3d70]
// Decompiled from void *__thiscall TPowerOf2Wrap<256>::TPowerOf2Wrap<256>(void *this)
protected: __thiscall TPowerOf2Wrap<256>::TPowerOf2Wrap<256>(void) {
  
  return this;
}


// address=[0x15f3d90]
// Decompiled from void *__thiscall TPowerOf2Wrap<4096>::TPowerOf2Wrap<4096>(void *this)
protected: __thiscall TPowerOf2Wrap<4096>::TPowerOf2Wrap<4096>(void) {
  
  return this;
}


// address=[0x15f3db0]
// Decompiled from void *__thiscall TPowerOf2Wrap<32768>::TPowerOf2Wrap<32768>(void *this)
protected: __thiscall TPowerOf2Wrap<32768>::TPowerOf2Wrap<32768>(void) {
  
  return this;
}


// address=[0x15f3dd0]
// Decompiled from std::_Basic_container_proxy_ptr12 *__thiscall TStaticArray<int,63>::TStaticArray<int,63>(  std::_Basic_container_proxy_ptr12 *this)
public: __thiscall TStaticArray<int,63>::TStaticArray<int,63>(void) {
  
  TStaticArray<int,63>::Init(this);
  return this;
}


// address=[0x15f3df0]
// Decompiled from void *__thiscall TStaticFIFO<int,256>::TStaticFIFO<int,256>(void *this)
public: __thiscall TStaticFIFO<int,256>::TStaticFIFO<int,256>(void) {
  
  TPowerOf2Wrap<256>::TPowerOf2Wrap<256>(this);
  TStaticFIFO<int,256>::Init(this);
  return this;
}


// address=[0x15f3e20]
// Decompiled from void *__thiscall TStaticFIFO<int,4096>::TStaticFIFO<int,4096>(void *this)
public: __thiscall TStaticFIFO<int,4096>::TStaticFIFO<int,4096>(void) {
  
  TPowerOf2Wrap<4096>::TPowerOf2Wrap<4096>(this);
  TStaticFIFO<int,4096>::Init(this);
  return this;
}


// address=[0x15f3e50]
// Decompiled from void *__thiscall TStaticList<int,32768>::TStaticList<int,32768>(void *this)
public: __thiscall TStaticList<int,32768>::TStaticList<int,32768>(void) {
  
  TPowerOf2Wrap<32768>::TPowerOf2Wrap<32768>(this);
  TStaticList<int,32768>::Init(this);
  return this;
}


// address=[0x15f3f80]
// Decompiled from bool __thiscall TBitArray<262144>::operator[](_DWORD *this, unsigned int a2)
public: bool __thiscall TBitArray<262144>::operator[](unsigned int a2) {
  
  return (this[a2 >> 5] & (1 << (a2 & 0x1F))) != 0;
}


// address=[0x15f3fd0]
// Decompiled from char *__thiscall TBoolArray<6>::operator[](char *this, int a2)
public: bool & __thiscall TBoolArray<6>::operator[](int a2) {
  
  return &this[a2];
}


// address=[0x15f3ff0]
// Decompiled from int __thiscall TStaticArray<int,63>::operator[](void *this, int a2)
public: int & __thiscall TStaticArray<int,63>::operator[](int a2) {
  
  return (int)this + 4 * a2 + 4;
}


// address=[0x15f4250]
// Decompiled from void *__thiscall TBitArray<262144>::ClearArray(void *this)
public: void __thiscall TBitArray<262144>::ClearArray(void) {
  
  return memset(this, 0, 0x8000u);
}


// address=[0x15f4320]
// Decompiled from int __thiscall TStaticArray<int,63>::Count(void *this)
public: int __thiscall TStaticArray<int,63>::Count(void)const {
  
  return *(_DWORD *)this;
}


// address=[0x15f4360]
// Decompiled from void NeighborAnalysis::Done()
void __cdecl NeighborAnalysis::Done(void) {
  
  dword_42CF98C = 0;
  dword_42CF990 = 0;
  dword_42CF994 = 0;
}


// address=[0x15f4420]
// Decompiled from bool __thiscall TLimitedFIFO<int,256>::Empty(_DWORD *this)
public: bool __thiscall TLimitedFIFO<int,256>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x15f4460]
// Decompiled from bool __thiscall TLimitedFIFO<int,576>::Empty(_DWORD *this)
public: bool __thiscall TLimitedFIFO<int,576>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x15f44a0]
// Decompiled from bool __thiscall TLimitedFIFO<int,32768>::Empty(_DWORD *this)
public: bool __thiscall TLimitedFIFO<int,32768>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x15f44e0]
// Decompiled from bool __thiscall TStaticArray<int,63>::Empty(_DWORD *this)
public: bool __thiscall TStaticArray<int,63>::Empty(void)const {
  
  return *this <= 0;
}


// address=[0x15f4520]
// Decompiled from bool __thiscall TStaticFIFO<int,256>::Empty(_DWORD *this)
public: bool __thiscall TStaticFIFO<int,256>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x15f4560]
// Decompiled from bool __thiscall TStaticFIFO<int,4096>::Empty(_DWORD *this)
public: bool __thiscall TStaticFIFO<int,4096>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x15f45a0]
// Decompiled from bool __thiscall TStaticList<int,32768>::Empty(_DWORD *this)
public: bool __thiscall TStaticList<int,32768>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x15f45e0]
// Decompiled from int __thiscall TStaticList<int,32768>::Front(_DWORD *this)
public: int & __thiscall TStaticList<int,32768>::Front(void) {
  
  return (int)&this[*this + 2];
}


// address=[0x15f4680]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,256>::Init(_DWORD *this)
public: void __thiscall TLimitedFIFO<int,256>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x15f46b0]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,576>::Init(_DWORD *this)
public: void __thiscall TLimitedFIFO<int,576>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x15f46e0]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,32768>::Init(_DWORD *this)
public: void __thiscall TLimitedFIFO<int,32768>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x15f4710]
// Decompiled from void __thiscall TStaticArray<int,63>::Init(std::_Basic_container_proxy_ptr12 *this)
public: void __thiscall TStaticArray<int,63>::Init(void) {
  
  *(_DWORD *)this = 0;
}


// address=[0x15f4730]
// Decompiled from _DWORD *__thiscall TStaticFIFO<int,256>::Init(_DWORD *this)
public: void __thiscall TStaticFIFO<int,256>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x15f4760]
// Decompiled from _DWORD *__thiscall TStaticFIFO<int,4096>::Init(_DWORD *this)
public: void __thiscall TStaticFIFO<int,4096>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x15f4790]
// Decompiled from _DWORD *__thiscall TStaticList<int,32768>::Init(_DWORD *this)
public: void __thiscall TStaticList<int,32768>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x15f5250]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,256>::Pop(_DWORD *this)
public: void __thiscall TLimitedFIFO<int,256>::Pop(void) {
  
  _DWORD *result; // eax

  result = this;
  ++*this;
  return result;
}


// address=[0x15f5270]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,576>::Pop(_DWORD *this)
public: void __thiscall TLimitedFIFO<int,576>::Pop(void) {
  
  _DWORD *result; // eax

  result = this;
  ++*this;
  return result;
}


// address=[0x15f5290]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,32768>::Pop(_DWORD *this)
public: void __thiscall TLimitedFIFO<int,32768>::Pop(void) {
  
  _DWORD *result; // eax

  result = this;
  ++*this;
  return result;
}


// address=[0x15f52b0]
// Decompiled from int __thiscall TStaticFIFO<int,256>::Pop(_DWORD *this)
public: void __thiscall TStaticFIFO<int,256>::Pop(void) {
  
  int result; // eax

  result = TPowerOf2Wrap<256>::Wrap(*this + 1);
  *this = result;
  return result;
}


// address=[0x15f52e0]
// Decompiled from int __thiscall TStaticFIFO<int,4096>::Pop(_DWORD *this)
public: void __thiscall TStaticFIFO<int,4096>::Pop(void) {
  
  int result; // eax

  result = TPowerOf2Wrap<4096>::Wrap(*this + 1);
  *this = result;
  return result;
}


// address=[0x15f5310]
// Decompiled from int __thiscall TStaticList<int,32768>::PopFront(_DWORD *this)
public: void __thiscall TStaticList<int,32768>::PopFront(void) {
  
  int result; // eax

  result = TPowerOf2Wrap<32768>::Wrap(*this + 1);
  *this = result;
  return result;
}


// address=[0x15f53a0]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,256>::Push(_DWORD *this, _DWORD *a2)
public: void __thiscall TLimitedFIFO<int,256>::Push(int const & a2) {
  
  _DWORD *result; // eax

  this[this[1] + 2] = *a2;
  result = this;
  ++this[1];
  return result;
}


// address=[0x15f53e0]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,576>::Push(_DWORD *this, _DWORD *a2)
public: void __thiscall TLimitedFIFO<int,576>::Push(int const & a2) {
  
  _DWORD *result; // eax

  this[this[1] + 2] = *a2;
  result = this;
  ++this[1];
  return result;
}


// address=[0x15f5420]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,32768>::Push(_DWORD *this, _DWORD *a2)
public: void __thiscall TLimitedFIFO<int,32768>::Push(int const & a2) {
  
  _DWORD *result; // eax

  this[this[1] + 2] = *a2;
  result = this;
  ++this[1];
  return result;
}


// address=[0x15f5460]
// Decompiled from int __thiscall TStaticFIFO<int,256>::Push(_DWORD *this, _DWORD *a2)
public: void __thiscall TStaticFIFO<int,256>::Push(int const & a2) {
  
  int result; // eax

  this[this[1] + 2] = *a2;
  result = TPowerOf2Wrap<256>::Wrap(this[1] + 1);
  this[1] = result;
  return result;
}


// address=[0x15f54b0]
// Decompiled from int __thiscall TStaticFIFO<int,4096>::Push(_DWORD *this, _DWORD *a2)
public: void __thiscall TStaticFIFO<int,4096>::Push(int const & a2) {
  
  int result; // eax

  this[this[1] + 2] = *a2;
  result = TPowerOf2Wrap<4096>::Wrap(this[1] + 1);
  this[1] = result;
  return result;
}


// address=[0x15f5500]
// Decompiled from int *__thiscall TStaticArray<int,63>::PushBack(int *this, int *a2)
public: void __thiscall TStaticArray<int,63>::PushBack(int const & a2) {
  
  int *result; // eax

  if ( *this >= 63
    && BBSupportDbgReport(
         2,
         "D:\\Projects\\TSHE\\PurpleLamp\\S4\\source\\BaseLib\\Include\\Misc\\Templates.h",
         154,
         "m_iSize < MAX_SIZE") == 1 )
  {
    __debugbreak();
  }
  this[*this + 1] = *a2;
  result = this;
  ++*this;
  return result;
}


// address=[0x15f5570]
// Decompiled from int __thiscall TStaticList<int,32768>::PushBack(_DWORD *this, _DWORD *a2)
public: void __thiscall TStaticList<int,32768>::PushBack(int const & a2) {
  
  int result; // eax

  this[this[1] + 2] = *a2;
  result = TPowerOf2Wrap<32768>::Wrap(this[1] + 1);
  this[1] = result;
  return result;
}


// address=[0x15f5680]
// Decompiled from unsigned int __thiscall TBitArray<262144>::Set(_DWORD *this, unsigned int a2)
public: void __thiscall TBitArray<262144>::Set(unsigned int a2) {
  
  unsigned int result; // eax

  result = a2 >> 5;
  this[a2 >> 5] |= 1 << (a2 & 0x1F);
  return result;
}


// address=[0x15f5730]
// Decompiled from char __thiscall TBitArray<32768>::SetIfNotSet(_DWORD *this, int a2)
public: bool __thiscall TBitArray<32768>::SetIfNotSet(int a2) {
  
  int v3; // [esp+0h] [ebp-Ch]

  v3 = 1 << (a2 & 0x1F);
  if ( (v3 & this[a2 >> 5]) != 0 )
    return 0;
  this[a2 >> 5] |= v3;
  return 1;
}


// address=[0x15f5a10]
// Decompiled from int __thiscall TLimitedFIFO<int,256>::Top(_DWORD *this)
public: int & __thiscall TLimitedFIFO<int,256>::Top(void) {
  
  return (int)&this[*this + 2];
}


// address=[0x15f5a30]
// Decompiled from int __thiscall TLimitedFIFO<int,576>::Top(_DWORD *this)
public: int & __thiscall TLimitedFIFO<int,576>::Top(void) {
  
  return (int)&this[*this + 2];
}


// address=[0x15f5a50]
// Decompiled from int __thiscall TLimitedFIFO<int,32768>::Top(_DWORD *this)
public: int & __thiscall TLimitedFIFO<int,32768>::Top(void) {
  
  return (int)&this[*this + 2];
}


// address=[0x15f5a70]
// Decompiled from int __thiscall TStaticFIFO<int,256>::Top(_DWORD *this)
public: int & __thiscall TStaticFIFO<int,256>::Top(void) {
  
  return (int)&this[*this + 2];
}


// address=[0x15f5a90]
// Decompiled from int __thiscall TStaticFIFO<int,4096>::Top(_DWORD *this)
public: int & __thiscall TStaticFIFO<int,4096>::Top(void) {
  
  return (int)&this[*this + 2];
}


// address=[0x15f5ab0]
// Decompiled from _DWORD *__thiscall TLimitedFIFO<int,576>::UndoPush(_DWORD *this, int a2)
public: void __thiscall TLimitedFIFO<int,576>::UndoPush(int a2) {
  
  _DWORD *result; // eax

  result = this;
  this[1] -= a2;
  return result;
}


// address=[0x15f6080]
// Decompiled from int __cdecl TPowerOf2Wrap<256>::Wrap(unsigned __int8 a1)
protected: int __cdecl TPowerOf2Wrap<256>::Wrap(int a1) {
  
  return a1;
}


// address=[0x15f6090]
// Decompiled from int __cdecl TPowerOf2Wrap<4096>::Wrap(__int16 a1)
protected: int __cdecl TPowerOf2Wrap<4096>::Wrap(int a1) {
  
  return a1 & 0xFFF;
}


// address=[0x15f60a0]
// Decompiled from int __cdecl TPowerOf2Wrap<32768>::Wrap(__int16 a1)
protected: int __cdecl TPowerOf2Wrap<32768>::Wrap(int a1) {
  
  return a1 & 0x7FFF;
}


// address=[0x15f60f0]
// Decompiled from void *__cdecl BB::ZeroMemPtr(void *a1, size_t Size)
void __cdecl BB::ZeroMemPtr(void * a1, unsigned int Size) {
  
  return memset(a1, 0, Size);
}


// address=[0x15f65a0]
// Decompiled from int __cdecl DbgGetFlags(struct _Cnd_internal_imp_t *a1, struct _Mtx_internal_imp_t *a2)
int __cdecl DbgGetFlags(int a1, int a2) {
  
  int v2; // eax

  v2 = CWorldManager::Index((int)a1, (int)a2);
  return CWorldManager::Flags(v2);
}


// address=[0x15f65c0]
// Decompiled from int __cdecl DbgGetSectorId(struct _Cnd_internal_imp_t *a1, struct _Mtx_internal_imp_t *a2)
int __cdecl DbgGetSectorId(int a1, int a2) {
  
  int v2; // eax

  v2 = CWorldManager::Index((int)a1, (int)a2);
  return ITiling::SectorId(v2);
}


// address=[0x15fe840]
// Decompiled from void *__cdecl SaveFilePath::BuildSaveFilePath(void *a1, int a2)
std::wstring __cdecl SaveFilePath::BuildSaveFilePath(std::wstring const & a1) {
  
  void *UserDirectoryPath; // [esp+4h] [ebp-78h]
  _BYTE v4[28]; // [esp+18h] [ebp-64h] BYREF
  _BYTE v5[28]; // [esp+34h] [ebp-48h] BYREF
  _BYTE v6[28]; // [esp+50h] [ebp-2Ch] BYREF
  int v7; // [esp+78h] [ebp-4h]

  std::wstring::wstring(v6);
  v7 = 0;
  UserDirectoryPath = FilePaths::GetUserDirectoryPath(v4);
  LOBYTE(v7) = 1;
  std::operator+<wchar_t>(v5, UserDirectoryPath, (_Cnd_internal_imp_t *)&unk_462B800);
  LOBYTE(v7) = 3;
  std::wstring::~wstring(v4);
  if ( std::wstring::find(v5, 0) )
    std::wstring::operator+=((int)v5);
  std::wstring::operator+=(a2);
  std::wstring::wstring(a1, v6);
  LOBYTE(v7) = 0;
  std::wstring::~wstring(v5);
  v7 = -1;
  std::wstring::~wstring(v6);
  return a1;
}


// address=[0x15fe950]
// Decompiled from void *__cdecl SaveFilePath::BuildSaveFilePathWithExtension(void *a1, int a2)
std::wstring __cdecl SaveFilePath::BuildSaveFilePathWithExtension(std::wstring const & a1) {
  
  _BYTE v3[28]; // [esp+8h] [ebp-2Ch] BYREF
  int v4; // [esp+30h] [ebp-4h]

  SaveFilePath::BuildSaveFilePath(v3, a2);
  v4 = 0;
  std::wstring::operator+=(v3, (wchar_t *)L".sav");
  std::wstring::wstring(a1, v3);
  v4 = -1;
  std::wstring::~wstring(v3);
  return a1;
}


// address=[0x15fe9f0]
// Decompiled from void *__cdecl SaveFilePath::GetSaveFileMapPattern(void *a1)
std::wstring __cdecl SaveFilePath::GetSaveFileMapPattern(void a1) {
  
  void *UserDirectoryPath; // [esp+4h] [ebp-54h]
  _BYTE v3[28]; // [esp+10h] [ebp-48h] BYREF
  _BYTE v4[28]; // [esp+2Ch] [ebp-2Ch] BYREF
  int v5; // [esp+54h] [ebp-4h]

  UserDirectoryPath = FilePaths::GetUserDirectoryPath(v3);
  v5 = 0;
  std::operator+<wchar_t>(v4, UserDirectoryPath, (_Cnd_internal_imp_t *)&unk_462B800);
  LOBYTE(v5) = 2;
  std::wstring::~wstring(v3);
  std::wstring::operator+=(v4, (wchar_t *)L"*");
  std::wstring::operator+=(v4, (wchar_t *)L".sav");
  std::wstring::wstring(a1, v4);
  v5 = -1;
  std::wstring::~wstring(v4);
  return a1;
}


// address=[0x16038b0]
// Decompiled from void __vcrt_va_start_verify_argument_type<enum EScriptType>()
void __cdecl __vcrt_va_start_verify_argument_type<enum EScriptType>(void) {
  
  ;
}


// address=[0x1603910]
// Decompiled from char *__cdecl ScriptExportVars(struct CLua *a1)
void __cdecl ScriptExportVars(class CLua & a1) {
  
  CLua::ExportTableTypes((int)"Buildings", "BUILDING_", (int)&unk_37EA308, 379);
  CLua::ExportTableTypes((int)"Effects", "EFFECT_", (int)&unk_37F8C38, 86);
  CLua::ExportTableTypes((int)"Goods", "GOOD_", (int)&unk_37FD850, 43);
  CLua::ExportTableTypes((int)"Settlers", "SETTLER_", (int)&unk_37FF108, 434);
  CLua::ExportTableTypes((int)"Sounds", "SOUND_", (int)&unk_37E8AF8, 109);
  CLua::ExportTableTypes((int)"Vehicles", "VEHICLE_", (int)&unk_37EDCF0, 59);
  CLua::ExportTableVar("Vehicles", "FOUNDATION_CART", DOUBLE_1030_0);
  CLua::ExportTableVars(a1, "Buildings", (struct CLua::SVarInfo *)&off_3D8C100);
  CLua::ExportTableVars(a1, "Game", (struct CLua::SVarInfo *)&off_3D8C3B8);
  CLua::ExportTableVars(a1, "Goods", (struct CLua::SVarInfo *)&off_3D8C510);
  CLua::ExportTableVars(a1, "Control", (struct CLua::SVarInfo *)&off_3D8C960);
  CLua::ExportTableVars(a1, "Dialog", (struct CLua::SVarInfo *)&off_3D8F170);
  CLua::ExportTableVars(a1, "Menu", (struct CLua::SVarInfo *)&off_3D8C588);
  CLua::ExportTableVars(a1, "Magic", (struct CLua::SVarInfo *)&off_3D8C6F8);
  CLua::ExportTableVars(a1, "Events", (struct CLua::SVarInfo *)&off_3D8C800);
  CLua::ExportTableVars(a1, "Settlers", (struct CLua::SVarInfo *)&off_3D8EF70);
  return CLua::ExportTableVars(a1, "Vehicles", (struct CLua::SVarInfo *)&off_3D8F0B8);
}


// address=[0x1603a90]
// Decompiled from void __cdecl ScriptExportFunctions(struct CLua *a1)
void __cdecl ScriptExportFunctions(class CLua &) {
  
  CLua::ExportTableFunctions(a1, "Buildings", (struct CLua::SFuncInfo *)&off_3D8C140);
  CLua::ExportTableFunctions(a1, "dbg", (struct CLua::SFuncInfo *)&off_3D8C1B8);
  CLua::ExportTableFunctions(a1, "Debug", (struct CLua::SFuncInfo *)&off_3D8C318);
  CLua::ExportTableFunctions(a1, "Effects", (struct CLua::SFuncInfo *)&off_3D8C3A8);
  CLua::ExportTableFunctions(a1, "Game", (struct CLua::SFuncInfo *)&off_3D8C418);
  CLua::ExportTableFunctions(a1, "Goods", (struct CLua::SFuncInfo *)&off_3D8C560);
  CLua::ExportTableFunctions(a1, "Magic", (struct CLua::SFuncInfo *)&off_3D8C788);
  CLua::ExportTableFunctions(a1, "Map", (struct CLua::SFuncInfo *)&off_3D8C7B8);
  CLua::ExportTableFunctions(a1, "Sounds", (struct CLua::SFuncInfo *)&off_3D8EF60);
  CLua::ExportTableFunctions(a1, "Statistic", (struct CLua::SFuncInfo *)&off_3D8EFE8);
  CLua::ExportTableFunctions(a1, "Tutorial", (struct CLua::SFuncInfo *)&off_3D8F030);
  CLua::ExportTableFunctions(a1, "Vehicles", (struct CLua::SFuncInfo *)&off_3D8F0F8);
  CLua::ExportTableFunctions(a1, "Settlers", (struct CLua::SFuncInfo *)&off_3D8EF90);
  CLua::ExportTableFunctions(a1, "DarkTribe", (struct CLua::SFuncInfo *)&off_3D8F148);
}


// address=[0x1603ba0]
// [Decompilation failed for void __cdecl ScriptDefaultVictoryConditionCheck(void)]

// address=[0x1603bc0]
// Decompiled from int ScriptEconomyModeVictoryConditionCheck()
void __cdecl ScriptEconomyModeVictoryConditionCheck(void) {
  
  int result; // eax
  float TickCounter; // xmm0_4
  CEvn_Event *v2; // eax
  int v3; // [esp+14h] [ebp-6Ch]
  int PlayerId; // [esp+18h] [ebp-68h]
  int Good; // [esp+28h] [ebp-58h]
  char *EconomyGoodsArray; // [esp+2Ch] [ebp-54h]
  int i; // [esp+34h] [ebp-4Ch]
  unsigned int v8; // [esp+38h] [ebp-48h]
  int v9; // [esp+3Ch] [ebp-44h]
  int v10; // [esp+40h] [ebp-40h]
  int v11; // [esp+44h] [ebp-3Ch]
  int v12; // [esp+48h] [ebp-38h]
  int j; // [esp+4Ch] [ebp-34h]
  int v14; // [esp+50h] [ebp-30h]
  int v15; // [esp+54h] [ebp-2Ch]
  CEvn_Event v16; // [esp+58h] [ebp-28h] BYREF
  int v17; // [esp+7Ch] [ebp-4h]

  sub_1609370();
  result = (unsigned __int8)sub_16094C0(0, 0);
  if ( (_BYTE)result )
    return result;
  TickCounter = (float)(unsigned int)CStateGame::GetTickCounter(g_pGame);
  result = (int)(float)(TickCounter * (float)(71.0 / 1000.0)) / 60;
  if ( result < 60 )
    return result;
  PlayerId = CPlayerManager::LastPlayerId();
  EconomyGoodsArray = CGameData::GetEconomyGoodsArray(g_pGameData);
  if ( !EconomyGoodsArray && BBSupportDbgReport(2, "Script\\Script.cpp", 4282, "pGoods != 0") == 1 )
    __debugbreak();
  v10 = 0;
  v9 = 0;
  v15 = 0;
  v14 = 0;
  for ( i = 0; i < 7; ++i )
  {
    v3 = (unsigned __int8)EconomyGoodsArray[i];
    v12 = 0;
    v11 = 0;
    for ( j = 1; j <= PlayerId; ++j )
    {
      Good = CStatistic::GetGood((CStatistic *)&g_cStatistic, j, v3);
      if ( CAlliances::AllianceId(j) == 1 )
        v12 += Good;
      else
        v11 += Good;
    }
    v10 += v12;
    v9 += v11;
    if ( v12 <= v11 )
    {
      if ( v12 < v11 )
        ++v14;
    }
    else
    {
      ++v15;
    }
  }
  if ( v15 > v14 )
    goto LABEL_21;
  if ( v15 >= v14 )
  {
    if ( v10 > v9 )
    {
      if ( v15 != v14
        && BBSupportDbgReport(2, "Script\\Script.cpp", 4336, "iTeam1CategoryWins == iTeam2CategoryWins") == 1 )
      {
        __debugbreak();
      }
LABEL_21:
      v2 = CEvn_Event::CEvn_Event(&v16, 0x37u, 1u, 0, 0);
LABEL_41:
      v17 = 0;
      IEventEngine::SendAMessage(g_pEvnEngine, v2);
      v17 = -1;
      return (int)CEvn_Event::~CEvn_Event(&v16);
    }
    if ( v10 >= v9 )
    {
      if ( v15 != v14
        && BBSupportDbgReport(2, "Script\\Script.cpp", 4348, "iTeam1CategoryWins == iTeam2CategoryWins") == 1 )
      {
        __debugbreak();
      }
      if ( v10 != v9 && BBSupportDbgReport(2, "Script\\Script.cpp", 4349, "iTeam1TotalAmount == iTeam2TotalAmount") == 1 )
        __debugbreak();
      v8 = (CStateGame::Rand(g_pGame) & 1) + 1;
      v2 = CEvn_Event::CEvn_Event(&v16, 0x37u, v8, 0, 0);
      goto LABEL_41;
    }
    if ( v15 != v14
      && BBSupportDbgReport(2, "Script\\Script.cpp", 4342, "iTeam1CategoryWins == iTeam2CategoryWins") == 1 )
    {
      __debugbreak();
    }
  }
  v2 = CEvn_Event::CEvn_Event(&v16, 0x37u, 2u, 0, 0);
  goto LABEL_41;
}


// address=[0x1603ef0]
// Decompiled from void ScriptTracePrintF(unsigned int a1, char *Format, ...)
void __cdecl ScriptTracePrintF(unsigned int a1, char const * Format, ... a3) {
  
  char Source[2048]; // [esp+Ch] [ebp-804h] BYREF
  va_list va; // [esp+820h] [ebp+10h] BYREF

  va_start(va, Format);
  if ( Format )
  {
    __vcrt_va_start_verify_argument_type<char const *>();
    j___vsnprintf(Source, 0x7FFu, Format, va);
    Source[2047] = 0;
    BBSupportTracePrint(1, Source);
    if ( a1 )
      CTextMsgHandler::AddTextMsg(Source, 0, 0, 0, a1 >= 2);
  }
}


// address=[0x1608150]
// Decompiled from int GameEnableLandExploredCheck()
void __cdecl GameEnableLandExploredCheck(void) {
  
  void **ScriptEnv; // [esp+4h] [ebp-8h]
  bool v2; // [esp+Bh] [ebp-1h]

  ScriptEnv = (void **)CGameScriptManager::GetScriptEnv((CGameScriptManager *)g_pScriptMgr);
  v2 = CLua::GetInt(ScriptEnv, 1) != 0;
  return (*(int (__thiscall **)(void *, bool))(*(_DWORD *)g_pFogging + 52))(g_pFogging, v2);
}


// address=[0x1608960]
// Decompiled from int GameResetFogging()
void __cdecl GameResetFogging(void) {
  
  return (*(int (__thiscall **)(void *))(*(_DWORD *)g_pFogging + 48))(g_pFogging);
}


// address=[0x1608980]
// Decompiled from int GameSetAlliesDontRevealFog()
void __cdecl GameSetAlliesDontRevealFog(void) {
  
  void **ScriptEnv; // [esp+4h] [ebp-8h]
  bool v2; // [esp+Bh] [ebp-1h]

  ScriptEnv = (void **)CGameScriptManager::GetScriptEnv((CGameScriptManager *)g_pScriptMgr);
  v2 = CLua::GetInt(ScriptEnv, 1) != 0;
  return (*(int (__thiscall **)(void *, bool))(*(_DWORD *)g_pFogging + 44))(g_pFogging, v2);
}


// address=[0x160aa80]
// Decompiled from int StatisticMushroomFarmsDestroyed()
void __cdecl StatisticMushroomFarmsDestroyed(void) {
  
  char *v0; // eax
  char *v1; // eax
  void **ScriptEnv; // [esp+0h] [ebp-Ch]
  int v4; // [esp+4h] [ebp-8h]
  int Int; // [esp+8h] [ebp-4h]

  ScriptEnv = (void **)CGameScriptManager::GetScriptEnv((CGameScriptManager *)g_pScriptMgr);
  Int = CLua::GetInt(ScriptEnv, 1);
  v4 = 0;
  if ( CAlliances::IsValidUsedPlayerId(Int) )
  {
    v0 = CPlayerManager::PlayerGameData(Int);
    v1 = CPlayerGameData::StaticData((CPlayerGameData *)v0);
    v4 = CPlayerStatisticData::MushroomFarmsDestroyed((CPlayerStatisticData *)v1);
  }
  else
  {
    ScriptTracePrintF(2u, "SCRIPT: Statistic.MushroomFarmsDestroyed(): Invalid player id %i!", Int);
  }
  return CLua::PushInt(ScriptEnv, v4);
}


// address=[0x160ab00]
// Decompiled from int StatisticServantsFreed()
void __cdecl StatisticServantsFreed(void) {
  
  char *v0; // eax
  char *v1; // eax
  void **ScriptEnv; // [esp+0h] [ebp-Ch]
  int v4; // [esp+4h] [ebp-8h]
  int Int; // [esp+8h] [ebp-4h]

  ScriptEnv = (void **)CGameScriptManager::GetScriptEnv((CGameScriptManager *)g_pScriptMgr);
  Int = CLua::GetInt(ScriptEnv, 1);
  v4 = 0;
  if ( CAlliances::IsValidUsedPlayerId(Int) )
  {
    v0 = CPlayerManager::PlayerGameData(Int);
    v1 = CPlayerGameData::StaticData((CPlayerGameData *)v0);
    v4 = CPlayerStatisticData::ServantsFreed((CPlayerStatisticData *)v1);
  }
  else
  {
    ScriptTracePrintF(2u, "SCRIPT: Statistic.ServantsFreed(): Invalid player id %i!", Int);
  }
  return CLua::PushInt(ScriptEnv, v4);
}


// address=[0x1615c30]
// Decompiled from bool __cdecl storm_if_constexpr(bool a1)
bool __cdecl storm_if_constexpr(bool) {
  
  return a1;
}


// address=[0x1634440]
// Decompiled from double __cdecl ceil(double x)
float __cdecl ceil(float) {
  
  return j__ceilf(*(float *)&x);
}


// address=[0x16a20a0]
// [Decompilation failed for unsigned int __cdecl GetVideoInterfaceVersion(void)]

// address=[0x16a5830]
// Decompiled from _DWORD *__thiscall TMap<unsigned char>::TMap<unsigned char>(_DWORD *this)
public: __thiscall TMap<unsigned char>::TMap<unsigned char>(void) {
  
  *this = 0;
  return this;
}


// address=[0x16a5850]
// Decompiled from _DWORD *__thiscall TMap<unsigned short>::TMap<unsigned short>(_DWORD *this)
public: __thiscall TMap<unsigned short>::TMap<unsigned short>(void) {
  
  *this = 0;
  return this;
}


// address=[0x16a5870]
// Decompiled from _DWORD *__thiscall TMap<T_GFX_MAP_ELEMENT>::TMap<T_GFX_MAP_ELEMENT>(_DWORD *this)
public: __thiscall TMap<struct T_GFX_MAP_ELEMENT>::TMap<struct T_GFX_MAP_ELEMENT>(void) {
  
  *this = 0;
  return this;
}


// address=[0x16a5890]
// Decompiled from int __thiscall TSparseMap<unsigned char>::TSparseMap<unsigned char>(int this, int a2, int a3, char a4)
public: __thiscall TSparseMap<unsigned char>::TSparseMap<unsigned char>(unsigned int a2, unsigned int a3, unsigned char a4) {
  
  std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>();
  *(_DWORD *)(this + 20) = a2;
  *(_DWORD *)(this + 24) = a3;
  *(_DWORD *)(this + 28) = 0;
  *(_BYTE *)(this + 32) = a4;
  TSparseMap<unsigned char>::Construct();
  return this;
}


// address=[0x16a5930]
// Decompiled from void *__thiscall TStaticFIFO<int,1024>::TStaticFIFO<int,1024>(void *this)
public: __thiscall TStaticFIFO<int,1024>::TStaticFIFO<int,1024>(void) {
  
  TPowerOf2Wrap<1024>::TPowerOf2Wrap<1024>(this);
  TStaticFIFO<int,1024>::Init(this);
  return this;
}


// address=[0x16a6110]
// Decompiled from int __thiscall TMap<unsigned char>::~TMap<unsigned char>(void *this)
public: __thiscall TMap<unsigned char>::~TMap<unsigned char>(void) {
  
  return TMap<unsigned char>::Done(this);
}


// address=[0x16a6160]
// Decompiled from int __thiscall TMap<unsigned short>::~TMap<unsigned short>(void *this)
public: __thiscall TMap<unsigned short>::~TMap<unsigned short>(void) {
  
  return TMap<unsigned short>::Done(this);
}


// address=[0x16a61b0]
// Decompiled from int __thiscall TMap<T_GFX_MAP_ELEMENT>::~TMap<T_GFX_MAP_ELEMENT>(void *this)
public: __thiscall TMap<struct T_GFX_MAP_ELEMENT>::~TMap<struct T_GFX_MAP_ELEMENT>(void) {
  
  return TMap<T_GFX_MAP_ELEMENT>::Done(this);
}


// address=[0x16a6200]
// Decompiled from int __thiscall TSparseMap<unsigned char>::~TSparseMap<unsigned char>(void *this)
public: __thiscall TSparseMap<unsigned char>::~TSparseMap<unsigned char>(void) {
  
  TSparseMap<unsigned char>::Destruct(this);
  return std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::~vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>();
}


// address=[0x16a6b60]
// Decompiled from _DWORD *__thiscall TSparseMap<unsigned char>::Construct(_DWORD *this)
private: void __thiscall TSparseMap<unsigned char>::Construct(void) {
  
  _DWORD *result; // eax
  _DWORD *v2; // [esp+Ch] [ebp-2Ch]
  _DWORD *v3; // [esp+10h] [ebp-28h]
  _DWORD *v4; // [esp+18h] [ebp-20h]
  _DWORD *v5; // [esp+1Ch] [ebp-1Ch]
  unsigned int i; // [esp+24h] [ebp-14h]

  std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::resize(this[6]);
  for ( i = 0; ; ++i )
  {
    result = this;
    if ( i >= this[6] )
      break;
    v5 = (_DWORD *)TSparseMap<unsigned char>::TNode::operator new(12);
    if ( v5 )
      v4 = TSparseMap<unsigned char>::TNode::TNode(v5);
    else
      v4 = 0;
    *v4 = this[5];
    *(_DWORD *)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](i) = v4;
    v3 = (_DWORD *)TSparseMap<unsigned char>::TNode::operator new(12);
    if ( v3 )
      v2 = TSparseMap<unsigned char>::TNode::TNode(v3);
    else
      v2 = 0;
    *((_BYTE *)v2 + 8) = 0;
    *v2 = this[5];
    v2[1] = 0;
    *(_DWORD *)(*(_DWORD *)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](i)
              + 4) = v2;
  }
  return result;
}


// address=[0x16a6cf0]
// Decompiled from _DWORD *__thiscall TSparseMap<unsigned char>::Destruct(_DWORD *this)
private: void __thiscall TSparseMap<unsigned char>::Destruct(void) {
  
  void **v1; // eax
  _DWORD *result; // eax
  void *v3; // [esp+4h] [ebp-14h]
  _DWORD *v4; // [esp+Ch] [ebp-Ch]
  unsigned int i; // [esp+14h] [ebp-4h]

  for ( i = 0; i < this[6]; ++i )
  {
    if ( *(_DWORD *)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](i) )
    {
      v4 = *(_DWORD **)(*(_DWORD *)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](i)
                      + 4);
      v1 = (void **)std::vector<TSparseMap<unsigned char>::TNode *,std::allocator<TSparseMap<unsigned char>::TNode *>>::operator[](i);
      TSparseMap<unsigned char>::TNode::operator delete(*v1);
      do
      {
        v3 = v4;
        v4 = (_DWORD *)v4[1];
        TSparseMap<unsigned char>::TNode::operator delete(v3);
      }
      while ( v4 );
    }
  }
  result = this;
  this[7] = 0;
  return result;
}


// address=[0x16a6dc0]
// Decompiled from int __thiscall TMap<unsigned char>::Done(void **this)
public: void __thiscall TMap<unsigned char>::Done(void) {
  
  int result; // eax

  result = (int)this;
  if ( *this )
    result = operator delete[](*this);
  *this = 0;
  return result;
}


// address=[0x16a6e00]
// Decompiled from int __thiscall TMap<unsigned short>::Done(void **this)
public: void __thiscall TMap<unsigned short>::Done(void) {
  
  int result; // eax

  result = (int)this;
  if ( *this )
    result = operator delete[](*this);
  *this = 0;
  return result;
}


// address=[0x16a6e40]
// Decompiled from int __thiscall TMap<T_GFX_MAP_ELEMENT>::Done(void **this)
public: void __thiscall TMap<struct T_GFX_MAP_ELEMENT>::Done(void) {
  
  int result; // eax

  result = (int)this;
  if ( *this )
    result = operator delete[](*this);
  *this = 0;
  return result;
}


// address=[0x16a6e80]
// Decompiled from bool __thiscall TStaticFIFO<int,1024>::Empty(_DWORD *this)
public: bool __thiscall TStaticFIFO<int,1024>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x16a6ec0]
// Decompiled from char __thiscall TSparseMap<unsigned char>::GetByX(int this, unsigned int a2)
public: unsigned char __thiscall TSparseMap<unsigned char>::GetByX(int a2) {
  
  return TSparseMap<unsigned char>::Get((_BYTE *)this, a2, *(_DWORD *)(this + 16));
}


// address=[0x16a6fe0]
// Decompiled from void *__thiscall TMap<unsigned char>::Init(void **this, int a2)
public: void __thiscall TMap<unsigned char>::Init(int a2) {
  
  TMap<unsigned char>::Done(this);
  *this = operator new[](a2 * a2);
  return memset(*this, 0, a2 * a2);
}


// address=[0x16a7040]
// Decompiled from void *__thiscall TMap<unsigned short>::Init(void **this, int a2)
public: void __thiscall TMap<unsigned short>::Init(int a2) {
  
  TMap<unsigned short>::Done(this);
  *this = operator new[](2 * a2 * a2);
  return memset(*this, 0, 2 * a2 * a2);
}


// address=[0x16a70c0]
// Decompiled from void *__thiscall TMap<T_GFX_MAP_ELEMENT>::Init(void **this, int a2)
public: void __thiscall TMap<struct T_GFX_MAP_ELEMENT>::Init(int a2) {
  
  TMap<T_GFX_MAP_ELEMENT>::Done(this);
  *this = operator new[](4 * a2 * a2);
  return memset(*this, 0, 4 * a2 * a2);
}


// address=[0x16a7140]
// Decompiled from _DWORD *__thiscall TStaticFIFO<int,1024>::Init(_DWORD *this)
public: void __thiscall TStaticFIFO<int,1024>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x16a7500]
// Decompiled from int __thiscall TStaticFIFO<int,1024>::Pop(_DWORD *this)
public: void __thiscall TStaticFIFO<int,1024>::Pop(void) {
  
  int result; // eax

  result = TPowerOf2Wrap<1024>::Wrap(*this + 1);
  *this = result;
  return result;
}


// address=[0x16a7530]
// Decompiled from int __thiscall TStaticFIFO<int,1024>::Push(_DWORD *this, _DWORD *a2)
public: void __thiscall TStaticFIFO<int,1024>::Push(int const & a2) {
  
  int result; // eax

  this[this[1] + 2] = *a2;
  result = TPowerOf2Wrap<1024>::Wrap(this[1] + 1);
  this[1] = result;
  return result;
}


// address=[0x16a78c0]
// Decompiled from _DWORD *__thiscall TSparseMap<unsigned char>::SetNewLine(_DWORD *this, int a2)
public: void __thiscall TSparseMap<unsigned char>::SetNewLine(int a2) {
  
  _DWORD *result; // eax

  result = this;
  this[4] = a2;
  return result;
}


// address=[0x16a7900]
// Decompiled from int __thiscall TStaticFIFO<int,1024>::Top(_DWORD *this)
public: int & __thiscall TStaticFIFO<int,1024>::Top(void) {
  
  return (int)&this[*this + 2];
}


// address=[0x17db000]
// Decompiled from double __cdecl nextafter<int,int>(int a1, int a2)
double __cdecl nextafter<int,int>(int a1, int a2) {
  
  return j__nextafter((double)a1, (double)a2);
}


// address=[0x191d250]
// Decompiled from void __cdecl TriggerAssert(char a1, void *a2, ubiservices::SystemChecker *a3, int a4, const char *a5, const char *a6)
void __cdecl TriggerAssert(bool a1, std::string const & a2, char const * a3, int a4, char const * a5, unsigned int a6) {
  
  int v6; // eax

  if ( a1 != ubiservices::SystemChecker::GetTrue() )
  {
    if ( !isUbiServicesSdkInitialized()
      || (v6 = std::string::c_str(a2), (unsigned __int8)EalLogAssert2(a4, a3, v6, a5, a6, 2, 0)) )
    {
      ubiservices::SystemChecker::assessExpression(a3, a5, a6);
    }
  }
}


// address=[0x1aefbc0]
// Decompiled from bool isUbiServicesSdkInitialized()
bool __cdecl isUbiServicesSdkInitialized(void) {
  
  return ubiservices::InstancesManager::getInstanceNoCheck(-858993460) != 0;
}


// address=[0x1eb40a0]
// Decompiled from signed __int64 __cdecl _InterlockedOr64_INLINE(volatile __int64 *a1, __int64 a2)
__int64 __cdecl _InterlockedOr64_INLINE(__int64 volatile * a1, __int64 a2) {
  
  signed __int64 v3; // [esp+18h] [ebp-8h]

  do
    v3 = *a1;
  while ( v3 != _InterlockedCompareExchange64(a1, a2 | v3, v3) );
  return v3;
}


// address=[0x269fb70]
// Decompiled from double __cdecl pow(double x)
float __cdecl pow(float x, float a2) {
  
  return j__powf(*(float *)&x, *((float *)&x + 1));
}


// address=[0x27ca2c0]
// Decompiled from bool __cdecl isfinite<float>(float Px)
bool __cdecl isfinite<float>(float Px) {
  
  return fpclassify(Px) <= 0;
}


// address=[0x284f440]
// Decompiled from int __cdecl fpclassify(float Px)
int __cdecl fpclassify(float Px) {
  
  return j___fdtest(&Px);
}


// address=[0x296dcd0]
// Decompiled from double __cdecl acos(double x)
float __cdecl acos(float) {
  
  return j__acosf(*(float *)&x);
}


// address=[0x296f540]
// Decompiled from double __cdecl asin(double x)
float __cdecl asin(float) {
  
  return j__asinf(*(float *)&x);
}


// address=[0x296f570]
// Decompiled from double __cdecl atan2(double y)
float __cdecl atan2(float y, float a2) {
  
  return j__atan2f(*(float *)&y, *((float *)&y + 1));
}


// address=[0x2971ef0]
// Decompiled from double __cdecl cos(double x)
float __cdecl cos(float) {
  
  return j__cosf(*(float *)&x);
}


// address=[0x298b750]
// Decompiled from double __cdecl sin(double x)
float __cdecl sin(float) {
  
  return j__sinf(*(float *)&x);
}


// address=[0x29bf0f0]
// Decompiled from signed __int64 __cdecl _InterlockedExchange64_INLINE(volatile __int64 *a1, __int64 a2)
__int64 __cdecl _InterlockedExchange64_INLINE(__int64 volatile * a1, __int64 a2) {
  
  volatile signed __int64 v3; // [esp+10h] [ebp-8h]

  do
    v3 = *a1;
  while ( v3 != _InterlockedCompareExchange64(a1, a2, *a1) );
  return v3;
}


// address=[0x29c27c0]
// Decompiled from unsigned __int64 __cdecl abs(__int64 a1)
__int64 __cdecl abs(__int64 a1) {
  
  return abs64(a1);
}


// address=[0x2bb3170]
// Decompiled from double __cdecl pow(double x)
float __cdecl pow(float x, int a2) {
  
  if ( HIDWORD(x) == 2 )
    return (float)(*(float *)&x * *(float *)&x);
  else
    return j__powf(*(float *)&x, (float)SHIDWORD(x));
}


// address=[0x2d5a300]
// Decompiled from int __cdecl SimplAlloc(unsigned int a1, unsigned int a2, unsigned int a3, int a4)
void * __cdecl SimplAlloc(unsigned long a1, unsigned int a2, unsigned long a3, int a4) {
  
  _DWORD v5[5]; // [esp+0h] [ebp-14h] BYREF

  memset(v5, 204, sizeof(v5));
  if ( (!a2 || (a2 & (a2 - 1)) != 0)
    && j___CrtDbgReportW(
         2,
         (char)L"D:/Projects/TSHE/PurpleLamp/S3/source/Storm/SDKs/Private/External/eal/Src/ealmem.cpp",
         171,
         0,
         (wchar_t *)L"%ls",
         0) == 1 )
  {
    __debugbreak();
  }
  v5[4] = a2 + a1 + 56;
  v5[3] = j__malloc(v5[4]);
  if ( !v5[3] )
    return 0;
  v5[2] = SimplEalRound<int,unsigned int>(v5[3] + 52, a2);
  if ( v5[2] % a2 )
  {
    if ( j___CrtDbgReportW(
           2,
           (char)L"D:/Projects/TSHE/PurpleLamp/S3/source/Storm/SDKs/Private/External/eal/Src/ealmem.cpp",
           190,
           0,
           (wchar_t *)L"%ls",
           0) == 1 )
      __debugbreak();
  }
  v5[1] = sub_2DD12A0(v5[2]);
  memset((void *)v5[1], 0, 0x34u);
  *(_DWORD *)(v5[1] + 4) = v5[3];
  *(_DWORD *)(v5[1] + 8) = v5[4];
  *(_DWORD *)(v5[1] + 12) = a2;
  *(_DWORD *)(v5[1] + 16) = a4;
  *(_DWORD *)(v5[1] + 20) = a3;
  *(_DWORD *)v5[1] = sub_2DD12B0(v5[0]);
  v5[0] = sub_2DD1270(v5[1]);
  *(_DWORD *)v5[0] = 0;
  *(_DWORD *)v5[0] = sub_2DD1290();
  ++SIMPL_NS::g_allocations_current;
  ++SIMPL_NS::g_allocations_total_count;
  SIMPL_NS::g_allocations_total_size += a1;
  return v5[2];
}


// address=[0x2d5a4a0]
// Decompiled from __int64 __cdecl SimplFree(void *a1)
void __cdecl SimplFree(void * a1) {
  
  _DWORD *v1; // esi
  __int64 result; // rax
  CHAR OutputString[516]; // [esp+10h] [ebp-20Ch] BYREF
  int v4; // [esp+214h] [ebp-8h]

  v4 = sub_2DD12A0(a1);
  if ( *(_DWORD *)v4 != sub_2DD12B0() || (v1 = (_DWORD *)sub_2DD1270(v4), *v1 != sub_2DD1290()) )
  {
    SIMPL_NS::g_memoryCorruption = 1;
    if ( *(_DWORD *)(v4 + 32) )
      j__sprintf_s(
        OutputString,
        0x200u,
        "Memory corruption found from %s, at %u",
        *(const char **)(v4 + 32),
        *(_DWORD *)(v4 + 28));
    else
      j__sprintf_s(
        OutputString,
        0x200u,
        "Memory corruption found from %s, at %u",
        "Unknown Location",
        *(_DWORD *)(v4 + 28));
    j__printf(OutputString);
    OutputDebugStringA(OutputString);
  }
  j__free(*(void **)(v4 + 4));
  LODWORD(result) = (unsigned __int64)(SIMPL_NS::g_allocations_current - 1) >> 32;
  HIDWORD(result) = --SIMPL_NS::g_allocations_current;
  return result;
}


// address=[0x2d5cb50]
// Decompiled from int __stdcall _WindowsThreadCallback(void (__cdecl **a1)(_DWORD))
unsigned int __stdcall _WindowsThreadCallback(void * a1) {
  
  if ( a1[1] )
    a1[1](a1[2]);
  return 0;
}


// address=[0x2d61c50]
// [Decompilation failed for void __cdecl EnableDisableTrack(int,bool)]

// address=[0x2d61cc0]
// Decompiled from void DetachTrackMetaDataCallBack()
void __cdecl DetachTrackMetaDataCallBack(void *) {
  
  _DWORD *v0; // eax
  int v1; // [esp-4h] [ebp-42Ch]
  FAProfiler *v2; // [esp+0h] [ebp-428h]
  int v3; // [esp+4h] [ebp-424h] BYREF
  unsigned int j; // [esp+8h] [ebp-420h]
  unsigned int v5; // [esp+Ch] [ebp-41Ch]
  unsigned int i; // [esp+10h] [ebp-418h]
  unsigned int v7; // [esp+14h] [ebp-414h]
  int v8; // [esp+18h] [ebp-410h]
  _DWORD Src[257]; // [esp+20h] [ebp-408h] BYREF

  FAProfiler::spin_lock::lock((FAProfiler::spin_lock *)&g_EALPerfLock);
  v8 = std::vector<int,FAProfiler::StdAllocator<int>>::size(dword_4654C54);
  if ( v8 )
  {
    v1 = 0;
    FAProfiler::LogMetaDataBlockBegin((FAProfiler *)"fa/profiler/detachedtrack/v1", 0, v1);
    v7 = (unsigned int)(v8 + 255) >> 8;
    for ( i = 0; i < v7; ++i )
    {
      v3 = v8 - (i << 8);
      v5 = *(_DWORD *)std::min<unsigned int>(&v3, &unk_3A94DD4);
      for ( j = 0; j < v5; ++j )
      {
        v0 = (_DWORD *)std::vector<int,FAProfiler::StdAllocator<int>>::operator[](j + (i << 8));
        Src[j] = *v0;
      }
      FAProfiler::LogMetaDataBlock(Src, 4 * v5);
    }
    FAProfiler::LogMetaDataBlockEnd(v2);
  }
  FAProfiler::spin_lock::unlock((FAProfiler::spin_lock *)&g_EALPerfLock);
}


// address=[0x2d7a0c0]
// Decompiled from int __cdecl SimplEalRound<int,unsigned int>(int a1, int a2)
int __cdecl SimplEalRound<int,unsigned int>(int a1, unsigned int a2) {
  
  return ~(a2 - 1) & (a1 + a2 - 1);
}


// address=[0x2da5850]
// Decompiled from void __vcrt_va_start_verify_argument_type<double>()
void __cdecl __vcrt_va_start_verify_argument_type<double>(void) {
  
  ;
}


// address=[0x2da5860]
// Decompiled from void __vcrt_va_start_verify_argument_type<unsigned __int64>()
void __cdecl __vcrt_va_start_verify_argument_type<unsigned __int64>(void) {
  
  ;
}


// address=[0x2da5870]
// Decompiled from int _snprintf_s<256>(char *Buffer, size_t MaxCount, char *Format, ...)
int __cdecl _snprintf_s<256>(char (&)[256] Buffer, unsigned int MaxCount, char const * Format, ... a4) {
  
  va_list va; // [esp+18h] [ebp+14h] BYREF

  va_start(va, Format);
  __vcrt_va_start_verify_argument_type<char const *>(-858993460);
  return j___vsnprintf_s(Buffer, 0x100u, MaxCount, Format, va);
}


// address=[0x2da58d0]
// Decompiled from int _snprintf_s<512>(char *Buffer, size_t MaxCount, char *Format, ...)
int __cdecl _snprintf_s<512>(char (&)[512] Buffer, unsigned int MaxCount, char const * Format, ... a4) {
  
  va_list va; // [esp+18h] [ebp+14h] BYREF

  va_start(va, Format);
  __vcrt_va_start_verify_argument_type<char const *>(-858993460);
  return j___vsnprintf_s(Buffer, 0x200u, MaxCount, Format, va);
}


// address=[0x2da5930]
// Decompiled from int _snprintf_s<64>(char *Buffer, size_t MaxCount, char *Format, ...)
int __cdecl _snprintf_s<64>(char (&)[64] Buffer, unsigned int MaxCount, char const * Format, ... a4) {
  
  va_list va; // [esp+18h] [ebp+14h] BYREF

  va_start(va, Format);
  __vcrt_va_start_verify_argument_type<char const *>(-858993460);
  return j___vsnprintf_s(Buffer, 0x40u, MaxCount, Format, va);
}


// address=[0x2dd0a20]
// Decompiled from unsigned __int64 __cdecl ConvertToFAPTime(unsigned __int64 a1)
unsigned __int64 __cdecl ConvertToFAPTime(unsigned __int64) {
  
  return ValidateTime(a1 * g_EalToFAPTimeFactor);
}


// address=[0x2dd2990]
// Decompiled from char __cdecl MetaDataTrackEnabled(int a1)
bool __cdecl MetaDataTrackEnabled(int a1) {
  
  int v1; // eax
  _DWORD v3[3]; // [esp+4h] [ebp-Ch] BYREF

  memset(v3, 204, sizeof(v3));
  v1 = std::bitset<1024>::operator[](v3, (a1 & 0x3FF00000) >> 20);
  HIBYTE(v3[2]) = std::bitset<1024>::reference::operator bool(v1, v3[0]);
  std::bitset<1024>::reference::~reference(v3);
  return HIBYTE(v3[2]);
}


// address=[0x2dd4030]
// Decompiled from HRESULT __stdcall StringCbCopyA(STRSAFE_LPSTR pszDest, size_t cbDest, STRSAFE_LPCSTR pszSrc)
long __stdcall StringCbCopyA(char * pszDest, unsigned int cbDest, char const * pszSrc) {
  
  HRESULT v4; // [esp+4h] [ebp-4h]

  v4 = sub_2D61E70(pszDest, cbDest, 0x7FFFFFFF);
  if ( v4 >= 0 )
    return sub_2D61EA0(pszDest, cbDest, 0, pszSrc, 2147483646);
  if ( cbDest )
    *pszDest = 0;
  return v4;
}


// address=[0x2dd4570]
// Decompiled from char __cdecl TrackEnabled(int a1)
bool __cdecl TrackEnabled(int a1) {
  
  int v2; // eax
  _DWORD v3[3]; // [esp+4h] [ebp-Ch] BYREF

  memset(v3, 204, sizeof(v3));
  if ( !FAProfiler::IsChannelEnabled(0, 0xCCCCCCCC80000000uLL) )
    return 0;
  v2 = std::bitset<1024>::operator[](v3, (a1 & 0x3FF00000) >> 20);
  HIBYTE(v3[2]) = std::bitset<1024>::reference::operator bool(v2, v3[0]);
  std::bitset<1024>::reference::~reference(v3);
  return HIBYTE(v3[2]);
}


// address=[0x2dd50e0]
// Decompiled from unsigned __int64 __cdecl ValidateTime(unsigned __int64 a1)
unsigned __int64 __cdecl ValidateTime(unsigned __int64) {
  
  return a1;
}


// address=[0x2debb70]
// Decompiled from signed __int64 __cdecl _InterlockedExchangeAdd64_INLINE(volatile __int64 *a1, __int64 a2)
__int64 __cdecl _InterlockedExchangeAdd64_INLINE(__int64 volatile * a1, __int64 a2) {
  
  signed __int64 v3; // [esp+18h] [ebp-8h]

  do
    v3 = *a1;
  while ( v3 != _InterlockedCompareExchange64(a1, a2 + v3, v3) );
  return v3;
}


// address=[0x2dfec60]
// Decompiled from int __stdcall SIMPL_NS::EalStdAllocator<std::_Tree_node<std::pair<int const,unsigned __int64>,void *>,1111490559>::allocate(  int a1,  int a2)
public: struct std::_Tree_node<struct std::pair<int const ,unsigned __int64>,void *> * __thiscall SIMPL_NS::EalStdAllocator<struct std::_Tree_node<struct std::pair<int const ,unsigned __int64>,void *>,1111490559>::allocate(unsigned int a1, void const * a2) {
  
  if ( a1 == -1
    && j___CrtDbgReportW(
         2,
         (char)L"d:\\projects\\tshe\\purplelamp\\s3\\source\\storm\\sdks\\private\\external\\eal\\src\\simpleutils.h",
         277,
         0,
         (wchar_t *)L"%ls",
         0) == 1 )
  {
    __debugbreak();
  }
  return SimplAlloc(32 * a1, 8u, 1u, 0x40000000);
}


// address=[0x2dfece0]
// Decompiled from int __stdcall SIMPL_NS::EalStdAllocator<std::_Container_proxy,1111490559>::allocate(int a1, int a2)
public: struct std::_Container_proxy * __thiscall SIMPL_NS::EalStdAllocator<struct std::_Container_proxy,1111490559>::allocate(unsigned int a1, void const * a2) {
  
  if ( a1 == -1
    && j___CrtDbgReportW(
         2,
         (char)L"d:\\projects\\tshe\\purplelamp\\s3\\source\\storm\\sdks\\private\\external\\eal\\src\\simpleutils.h",
         277,
         0,
         (wchar_t *)L"%ls",
         0) == 1 )
  {
    __debugbreak();
  }
  return SimplAlloc(8 * a1, 4u, 1u, 0x40000000);
}


// address=[0x2e14590]
// Decompiled from int __thiscall SIMPL_NS::EalStdAllocator<std::_Tree_node<std::pair<int const,unsigned __int64>,void *>,1111490559>::max_size(  void *this)
public: unsigned int __thiscall SIMPL_NS::EalStdAllocator<struct std::_Tree_node<struct std::pair<int const ,unsigned __int64>,void *>,1111490559>::max_size(void)const {
  
  return std::numeric_limits<unsigned int>::max(this);
}


// address=[0x2ed6af0]
// Decompiled from errno_t __cdecl strncpy_s<256>(char *Destination, char *Source, rsize_t MaxCount)
int __cdecl strncpy_s<256>(char (&)[256] Destination, char const * Source, unsigned int MaxCount) {
  
  return j__strncpy_s(Destination, 0x100u, Source, MaxCount);
}


// address=[0x2ed6b30]
// Decompiled from errno_t __cdecl strncpy_s<1024>(char *Destination, char *Source, rsize_t MaxCount)
int __cdecl strncpy_s<1024>(char (&)[1024] Destination, char const * Source, unsigned int MaxCount) {
  
  return j__strncpy_s(Destination, 0x400u, Source, MaxCount);
}


// address=[0x2efe0d0]
// Decompiled from _BYTE *__cdecl FilePaths::SplitPath(_BYTE *a1, _Cnd_internal_imp_t *a2)
struct FilePaths::PathSplitResult __cdecl FilePaths::SplitPath(std::wstring const & a1) {
  
  _DWORD *v3; // esi
  int v4; // eax
  int v5; // eax
  wchar_t *v6; // [esp+8h] [ebp-ACh]
  wchar_t *v7; // [esp+Ch] [ebp-A8h]
  wchar_t *v8; // [esp+14h] [ebp-A0h]
  int v9; // [esp+18h] [ebp-9Ch]
  wchar_t *Str; // [esp+1Ch] [ebp-98h]
  _BYTE v11[28]; // [esp+20h] [ebp-94h] BYREF
  _BYTE v12[28]; // [esp+3Ch] [ebp-78h] BYREF
  _BYTE v13[48]; // [esp+58h] [ebp-5Ch] BYREF
  _BYTE v14[28]; // [esp+88h] [ebp-2Ch] BYREF
  int v15; // [esp+B0h] [ebp-4h]

  FilePaths::PathSplitResult::PathSplitResult(v12);
  v15 = 0;
  if ( (unsigned __int8)std::wstring::empty(a2) )
  {
    FilePaths::PathSplitResult::PathSplitResult(a1, v12);
    v15 = -1;
    FilePaths::PathSplitResult::~PathSplitResult(v12);
    return a1;
  }
  else
  {
    Str = (wchar_t *)std::wstring::c_str(a2);
    if ( j__wcschr(Str, 0x3Au) )
    {
      v7 = j__wcschr(Str, 0x3Au) + 1;
      std::wstring::assign(Str, (int)v7);
      Str = v7;
    }
    if ( *Str == 92 || *Str == 47 )
    {
      v13[44] = 1;
      ++Str;
    }
    while ( *Str )
    {
      v6 = j__wcschr(Str, 0x2Fu);
      v8 = j__wcschr(Str, 0x5Cu);
      v9 = (int)v6;
      if ( v6 )
      {
        if ( v8 && v8 < v6 )
          v9 = (int)v8;
      }
      else
      {
        v9 = (int)v8;
      }
      if ( !v9 )
      {
        std::wstring::wstring(v14);
        LOBYTE(v15) = 2;
        v3 = std::wstring::c_str(a2);
        v4 = std::wstring::size(a2);
        std::wstring::assign(Str, (int)v3 + 2 * v4);
        std::vector<std::wstring>::push_back(v14);
        LOBYTE(v15) = 0;
        std::wstring::~wstring(v14);
        break;
      }
      std::wstring::wstring(v11);
      LOBYTE(v15) = 1;
      std::wstring::assign(Str, v9);
      std::vector<std::wstring>::push_back(v11);
      Str = (wchar_t *)(v9 + 2);
      LOBYTE(v15) = 0;
      std::wstring::~wstring(v11);
    }
    if ( !(unsigned __int8)sub_2EFE900(a2, 92) && !(unsigned __int8)sub_2EFE900(a2, 47) )
    {
      v5 = std::vector<std::wstring>::back();
      std::wstring::operator=(v5);
      std::vector<std::wstring>::pop_back(v13);
    }
    FilePaths::PathSplitResult::PathSplitResult(a1, v12);
    v15 = -1;
    FilePaths::PathSplitResult::~PathSplitResult(v12);
    return a1;
  }
}


// address=[0x2efe3b0]
// Decompiled from void *__cdecl FilePaths::GetCurrentWorkingDirectory(void *a1)
std::wstring __cdecl FilePaths::GetCurrentWorkingDirectory(void a1) {
  
  std::wstring::wstring(a1, (wchar_t *)&word_3AB4660);
  return a1;
}


// address=[0x2efe3e0]
// Decompiled from void *__cdecl FilePaths::GetUserDirectoryPath(void *a1)
std::wstring __cdecl FilePaths::GetUserDirectoryPath(void a1) {
  
  void *v2; // [esp+4h] [ebp-284h]
  void *v3; // [esp+Ch] [ebp-27Ch]
  _BYTE v4[28]; // [esp+1Ch] [ebp-26Ch] BYREF
  _BYTE v5[28]; // [esp+38h] [ebp-250h] BYREF
  _BYTE v6[28]; // [esp+54h] [ebp-234h] BYREF
  WCHAR pszPath[260]; // [esp+70h] [ebp-218h] BYREF
  int v8; // [esp+284h] [ebp-4h]

  if ( SHGetFolderPathW(0, 5, 0, 0, pszPath) )
  {
    FilePaths::GetCurrentWorkingDirectory(a1);
  }
  else
  {
    std::wstring::wstring(v6, pszPath);
    v8 = 0;
    v3 = (void *)sub_2EFE950(v4, v6);
    LOBYTE(v8) = 1;
    v2 = std::operator+<wchar_t>(v5, v3, (_Cnd_internal_imp_t *)&unk_4685398);
    LOBYTE(v8) = 2;
    std::operator+<wchar_t>(a1, v2, (_Cnd_internal_imp_t *)&unk_468537C);
    LOBYTE(v8) = 1;
    std::wstring::~wstring(v5);
    LOBYTE(v8) = 0;
    std::wstring::~wstring(v4);
    v8 = -1;
    std::wstring::~wstring(v6);
  }
  return a1;
}


// address=[0x2efe550]
// Decompiled from int __cdecl FilePaths::EnsurePathExists(int a1)
void __cdecl FilePaths::EnsurePathExists(std::wstring const & a1) {
  
  const WCHAR *v1; // eax
  _BYTE v3[12]; // [esp+4h] [ebp-174h] BYREF
  _BYTE v4[12]; // [esp+10h] [ebp-168h] BYREF
  int v5; // [esp+1Ch] [ebp-15Ch]
  int v6; // [esp+20h] [ebp-158h]
  int v7; // [esp+24h] [ebp-154h]
  int v8; // [esp+28h] [ebp-150h]
  int v9; // [esp+2Ch] [ebp-14Ch]
  int v10; // [esp+30h] [ebp-148h]
  void *v11; // [esp+34h] [ebp-144h]
  void *CurrentWorkingDirectory; // [esp+38h] [ebp-140h]
  int v13; // [esp+3Ch] [ebp-13Ch]
  BOOL DirectoryW; // [esp+40h] [ebp-138h]
  int v15; // [esp+44h] [ebp-134h]
  int v16; // [esp+48h] [ebp-130h]
  _BYTE *v17; // [esp+4Ch] [ebp-12Ch]
  bool v18; // [esp+53h] [ebp-125h]
  int v19; // [esp+54h] [ebp-124h]
  _BYTE v20[28]; // [esp+58h] [ebp-120h] BYREF
  _BYTE v21[48]; // [esp+74h] [ebp-104h] BYREF
  _BYTE v22[28]; // [esp+A4h] [ebp-D4h] BYREF
  _BYTE v23[28]; // [esp+C0h] [ebp-B8h] BYREF
  _BYTE v24[28]; // [esp+DCh] [ebp-9Ch] BYREF
  _BYTE v25[28]; // [esp+F8h] [ebp-80h] BYREF
  _BYTE v26[28]; // [esp+114h] [ebp-64h] BYREF
  _BYTE v27[28]; // [esp+130h] [ebp-48h] BYREF
  _BYTE v28[28]; // [esp+14Ch] [ebp-2Ch] BYREF
  int v29; // [esp+174h] [ebp-4h]

  v19 = 0;
  FilePaths::SplitPath((int)v20, a1);
  v29 = 0;
  std::wstring::wstring(v27);
  LOBYTE(v29) = 1;
  if ( v21[44] )
  {
    v13 = std::operator+<wchar_t>(v26, v20, &unk_468537C);
    std::wstring::operator=(v13);
    std::wstring::~wstring(v26);
  }
  else
  {
    CurrentWorkingDirectory = FilePaths::GetCurrentWorkingDirectory(v24);
    v11 = CurrentWorkingDirectory;
    LOBYTE(v29) = 2;
    v10 = sub_2EFE950(v25, CurrentWorkingDirectory);
    std::wstring::operator=(v10);
    std::wstring::~wstring(v25);
    LOBYTE(v29) = 1;
    std::wstring::~wstring(v24);
  }
  std::wstring::wstring(v28);
  LOBYTE(v29) = 3;
  v17 = v21;
  std::vector<std::wstring>::begin(v4);
  LOBYTE(v29) = 4;
  std::vector<std::wstring>::end(v3);
  LOBYTE(v29) = 5;
  while ( (unsigned __int8)std::_Vector_const_iterator<std::_Vector_val<std::_Simple_types<std::wstring>>>::operator!=((std::_Iterator_base12 *)v3) )
  {
    v16 = std::_Vector_iterator<std::_Vector_val<std::_Simple_types<std::wstring>>>::operator*(v4);
    if ( (unsigned __int8)std::wstring::empty(v28) )
    {
      v9 = std::operator+<wchar_t>(v22, v27, v16);
      v8 = v9;
      LOBYTE(v29) = 6;
      v19 |= 1u;
      v15 = v9;
    }
    else
    {
      v7 = std::operator+<wchar_t>(v23, &unk_468537C, v16);
      v6 = v7;
      v29 = 7;
      v19 |= 2u;
      v15 = v7;
    }
    v5 = v15;
    std::wstring::operator+=(v15);
    v29 = 6;
    if ( (v19 & 2) != 0 )
    {
      v19 &= ~2u;
      std::wstring::~wstring(v23);
    }
    v29 = 5;
    if ( (v19 & 1) != 0 )
    {
      v19 &= ~1u;
      std::wstring::~wstring(v22);
    }
    if ( !(unsigned __int8)std::wstring::empty(v28) && !(unsigned __int8)sub_2EFE9F0(v28) )
    {
      v1 = (const WCHAR *)std::wstring::c_str((_Cnd_internal_imp_t *)v28);
      DirectoryW = CreateDirectoryW(v1, 0);
      v18 = DirectoryW;
      if ( !DirectoryW )
        break;
    }
    std::_Vector_iterator<std::_Vector_val<std::_Simple_types<std::wstring>>>::operator++(v4);
  }
  LOBYTE(v29) = 4;
  std::_Vector_iterator<std::_Vector_val<std::_Simple_types<std::wstring>>>::~_Vector_iterator<std::_Vector_val<std::_Simple_types<std::wstring>>>(v3);
  LOBYTE(v29) = 3;
  std::_Vector_iterator<std::_Vector_val<std::_Simple_types<std::wstring>>>::~_Vector_iterator<std::_Vector_val<std::_Simple_types<std::wstring>>>(v4);
  LOBYTE(v29) = 1;
  std::wstring::~wstring(v28);
  LOBYTE(v29) = 0;
  std::wstring::~wstring(v27);
  v29 = -1;
  return FilePaths::PathSplitResult::~PathSplitResult(v20);
}


// address=[0x2efe8b0]
// Decompiled from bool __cdecl FilePaths::FileExists(_Cnd_internal_imp_t *a1)
bool __cdecl FilePaths::FileExists(std::wstring const & a1) {
  
  const WCHAR *v1; // eax
  DWORD FileAttributesW; // [esp+8h] [ebp-4h]

  v1 = (const WCHAR *)std::wstring::c_str(a1);
  FileAttributesW = GetFileAttributesW(v1);
  return FileAttributesW != -1 && (FileAttributesW & 0x10) == 0;
}


// address=[0x2f025d0]
// Decompiled from void __vcrt_va_start_verify_argument_type<int>()
void __cdecl __vcrt_va_start_verify_argument_type<int>(void) {
  
  ;
}


// address=[0x2f03690]
// Decompiled from int __stdcall Adler32(unsigned __int8 *a1, unsigned int a2, unsigned int a3)
unsigned int __stdcall Adler32(void const * a1, unsigned int a2, unsigned int a3) {
  
  int v4; // [esp+0h] [ebp-14h]
  int v5; // [esp+4h] [ebp-10h]
  unsigned __int8 *v6; // [esp+8h] [ebp-Ch]
  unsigned int v7; // [esp+Ch] [ebp-8h]
  int v8; // [esp+Ch] [ebp-8h]
  int v9; // [esp+Ch] [ebp-8h]
  int v10; // [esp+Ch] [ebp-8h]
  int v11; // [esp+Ch] [ebp-8h]
  int v12; // [esp+Ch] [ebp-8h]
  int v13; // [esp+Ch] [ebp-8h]
  int v14; // [esp+Ch] [ebp-8h]
  int v15; // [esp+Ch] [ebp-8h]
  int v16; // [esp+Ch] [ebp-8h]
  int v17; // [esp+Ch] [ebp-8h]
  int v18; // [esp+Ch] [ebp-8h]
  int v19; // [esp+Ch] [ebp-8h]
  int v20; // [esp+Ch] [ebp-8h]
  int v21; // [esp+Ch] [ebp-8h]
  int v22; // [esp+Ch] [ebp-8h]
  unsigned int v23; // [esp+10h] [ebp-4h]
  int v24; // [esp+10h] [ebp-4h]
  int v25; // [esp+10h] [ebp-4h]
  int v26; // [esp+10h] [ebp-4h]
  int v27; // [esp+10h] [ebp-4h]
  int v28; // [esp+10h] [ebp-4h]
  int v29; // [esp+10h] [ebp-4h]
  int v30; // [esp+10h] [ebp-4h]
  int v31; // [esp+10h] [ebp-4h]
  int v32; // [esp+10h] [ebp-4h]
  int v33; // [esp+10h] [ebp-4h]
  int v34; // [esp+10h] [ebp-4h]
  int v35; // [esp+10h] [ebp-4h]
  int v36; // [esp+10h] [ebp-4h]
  int v37; // [esp+10h] [ebp-4h]
  int v38; // [esp+10h] [ebp-4h]

  v6 = a1;
  if ( !a1 )
    return a3;
  v23 = (unsigned __int16)a3;
  v7 = HIWORD(a3);
  while ( a2 )
  {
    if ( a2 >= 0x15B0 )
      v4 = 5552;
    else
      v4 = a2;
    v5 = v4;
    a2 -= v4;
    while ( v5 >= 16 )
    {
      v24 = v23 + *v6;
      v8 = v24 + v7;
      v25 = v24 + v6[1];
      v9 = v25 + v8;
      v26 = v25 + v6[2];
      v10 = v26 + v9;
      v27 = v26 + v6[3];
      v11 = v27 + v10;
      v28 = v27 + v6[4];
      v12 = v28 + v11;
      v29 = v28 + v6[5];
      v13 = v29 + v12;
      v30 = v29 + v6[6];
      v14 = v30 + v13;
      v31 = v30 + v6[7];
      v15 = v31 + v14;
      v32 = v31 + v6[8];
      v16 = v32 + v15;
      v33 = v32 + v6[9];
      v17 = v33 + v16;
      v34 = v33 + v6[10];
      v18 = v34 + v17;
      v35 = v34 + v6[11];
      v19 = v35 + v18;
      v36 = v35 + v6[12];
      v20 = v36 + v19;
      v37 = v36 + v6[13];
      v21 = v37 + v20;
      v38 = v37 + v6[14];
      v22 = v38 + v21;
      v23 = v38 + v6[15];
      v7 = v23 + v22;
      v6 += 16;
      v5 -= 16;
    }
    for ( ; v5; --v5 )
    {
      v23 += *v6;
      v7 += v23;
      ++v6;
    }
    v23 %= 0xFFF1u;
    v7 %= 0xFFF1u;
  }
  return v23 | (v7 << 16);
}


// address=[0x2f055d0]
// Decompiled from bool __stdcall greater_ptr<CDestructor>::operator()(_DWORD **a1, int *a2)
public: bool __thiscall greater_ptr<class CDestructor>::operator()(class CDestructor * const & a1, class CDestructor * const & a2)const {
  
  return CDestructor::operator>(*a1, *a2);
}


// address=[0x2f05d40]
// Decompiled from _DWORD *__cdecl BB::Max<unsigned int>(_DWORD *a1, _DWORD *a2)
unsigned int const & __cdecl BB::Max<unsigned int>(unsigned int const & a1, unsigned int const & a2) {
  
  if ( *a1 >= *a2 )
    return a1;
  else
    return a2;
}


// address=[0x2f11800]
// Decompiled from void __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Reset(std::_Basic_container_proxy_ptr12 *this)
public: void __thiscall cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Reset(void) {
  
  *(_DWORD *)this = 0;
}


// address=[0x2f174d0]
// Decompiled from unsigned int __cdecl AdvXMLParser::NormalizeWhiteSpaces(int a1)
void __cdecl AdvXMLParser::NormalizeWhiteSpaces(std::string & a1) {
  
  unsigned int result; // eax
  int v2; // eax
  int first_not_of; // [esp+0h] [ebp-Ch]
  unsigned int i; // [esp+4h] [ebp-8h]
  int v5; // [esp+8h] [ebp-4h]

  for ( i = 0; ; i = v5 + 1 )
  {
    result = std::string::size(a1);
    if ( i >= result )
      break;
    result = std::string::find_first_of(" \t\r\n", i);
    v5 = result;
    if ( result == std::basic_string_char_std::char_traits_char__std::allocator_char___::npos )
      break;
    first_not_of = std::string::find_first_not_of(" \t\r\n", result);
    if ( first_not_of == std::basic_string_char_std::char_traits_char__std::allocator_char___::npos )
    {
      v2 = std::string::size(a1);
      return std::string::replace(v5, v2 - v5, 1u, 32);
    }
    std::string::replace(v5, first_not_of - v5, 1u, 32);
  }
  return result;
}


// address=[0x2f17580]
// Decompiled from unsigned int __cdecl AdvXMLParser::TrimSpaces(int a1)
void __cdecl AdvXMLParser::TrimSpaces(std::string & a1) {
  
  unsigned int result; // eax
  unsigned int last_not_of; // [esp+0h] [ebp-8h]
  int first_not_of; // [esp+4h] [ebp-4h]

  first_not_of = std::string::find_first_not_of(" \t\r\n", 0);
  if ( first_not_of == std::basic_string_char_std::char_traits_char__std::allocator_char___::npos )
    return std::string::erase(0);
  if ( first_not_of )
    std::string::erase(0, first_not_of);
  last_not_of = std::string::find_last_not_of(
                  " \t\r\n",
                  std::basic_string_char_std::char_traits_char__std::allocator_char___::npos);
  result = std::string::size(a1) - 1;
  if ( last_not_of < result )
    return std::string::erase(last_not_of);
  return result;
}


// address=[0x2f17600]
// Decompiled from void AdvXMLParser::FillMap()
void __cdecl AdvXMLParser::FillMap(void) {
  
  _BYTE v0[28]; // [esp+4h] [ebp-9Ch] BYREF
  _BYTE v1[28]; // [esp+20h] [ebp-80h] BYREF
  _BYTE v2[28]; // [esp+3Ch] [ebp-64h] BYREF
  _BYTE v3[28]; // [esp+58h] [ebp-48h] BYREF
  _BYTE v4[28]; // [esp+74h] [ebp-2Ch] BYREF
  int v5; // [esp+9Ch] [ebp-4h]

  std::string::string(v4, "lt");
  v5 = 0;
  *(_BYTE *)std::map<std::string,char>::operator[](v4) = 60;
  v5 = -1;
  std::string::~string(v4);
  std::string::string(v3, "gt");
  v5 = 1;
  *(_BYTE *)std::map<std::string,char>::operator[](v3) = 62;
  v5 = -1;
  std::string::~string(v3);
  std::string::string(v2, "amp");
  v5 = 2;
  *(_BYTE *)std::map<std::string,char>::operator[](v2) = 38;
  v5 = -1;
  std::string::~string(v2);
  std::string::string(v1, "apos");
  v5 = 3;
  *(_BYTE *)std::map<std::string,char>::operator[](v1) = 39;
  v5 = -1;
  std::string::~string(v1);
  std::string::string(v0, "quot");
  v5 = 4;
  *(_BYTE *)std::map<std::string,char>::operator[](v0) = 34;
  v5 = -1;
  std::string::~string(v0);
}


// address=[0x2f17760]
// [Decompilation failed for void __cdecl BreakInDebugger(void)]

// address=[0x2f28260]
// Decompiled from int __cdecl AdvXMLParser::HexDigitValue(AdvXMLParser *this)
int __cdecl AdvXMLParser::HexDigitValue(char) {
  
  if ( (char)this >= 48 && (char)this <= 57 )
    return (char)this - 48;
  if ( (char)this < 97 || (char)this > 102 )
    return (char)this - 55;
  else
    return (char)this - 87;
}


// address=[0x2f282d0]
// Decompiled from bool __cdecl AdvXMLParser::IsAlpha(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsAlpha(char) {
  
  return (char)this >= 97 && (char)this <= 122 || (char)this >= 65 && (char)this <= 90;
}


// address=[0x2f28320]
// Decompiled from bool __cdecl AdvXMLParser::IsAlphaDigit(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsAlphaDigit(char) {
  
  char v1; // cl
  char v3; // [esp+0h] [ebp-4h]

  v3 = v1;
  return AdvXMLParser::IsAlpha((AdvXMLParser *)(unsigned __int8)this)
      || AdvXMLParser::IsDigit((AdvXMLParser *)(unsigned __int8)this, v3);
}


// address=[0x2f28380]
// Decompiled from char AdvXMLParser::IsCombiningChar()
bool __cdecl AdvXMLParser::IsCombiningChar(char) {
  
  return 0;
}


// address=[0x2f28390]
// Decompiled from bool __cdecl AdvXMLParser::IsDigit(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsDigit(char) {
  
  return (char)this >= 48 && (char)this <= 57;
}


// address=[0x2f283d0]
// Decompiled from bool __cdecl AdvXMLParser::IsExtender(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsExtender(char) {
  
  return (unsigned __int8)this == 183;
}


// address=[0x2f28410]
// Decompiled from bool __cdecl AdvXMLParser::IsHexDigit(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsHexDigit(char) {
  
  char v1; // cl

  return AdvXMLParser::IsDigit((AdvXMLParser *)(unsigned __int8)this, v1)
      || (char)this >= 97 && (char)this <= 102
      || (char)this >= 65 && (char)this <= 70;
}


// address=[0x2f28480]
// Decompiled from bool __cdecl AdvXMLParser::IsLetter(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsLetter(char) {
  
  return (unsigned __int8)this >= 0x41u && (unsigned __int8)this <= 0x5Au
      || (unsigned __int8)this >= 0x61u && (unsigned __int8)this <= 0x7Au
      || (unsigned __int8)this >= 0xC0u && (unsigned __int8)this <= 0xD6u
      || (unsigned __int8)this >= 0xD8u && (unsigned __int8)this <= 0xF6u
      || (unsigned __int8)this >= 0xF8u;
}


// address=[0x2f28530]
// Decompiled from bool __cdecl AdvXMLParser::IsNameChar(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsNameChar(char) {
  
  char v1; // cl
  char v3; // [esp+0h] [ebp-4h]

  v3 = v1;
  return AdvXMLParser::IsLetter((AdvXMLParser *)(unsigned __int8)this)
      || AdvXMLParser::IsDigit((AdvXMLParser *)(unsigned __int8)this, v3)
      || (char)this == 46
      || (char)this == 45
      || (char)this == 95
      || (char)this == 58
      || AdvXMLParser::IsCombiningChar()
      || AdvXMLParser::IsExtender((AdvXMLParser *)(unsigned __int8)this);
}


// address=[0x2f285f0]
// Decompiled from bool __cdecl AdvXMLParser::IsSpace(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsSpace(char) {
  
  return (char)this == 32 || (char)this == 9 || (char)this == 13 || (char)this == 10;
}


// address=[0x2f28640]
// Decompiled from bool __cdecl AdvXMLParser::IsXmlChar(AdvXMLParser *this)
bool __cdecl AdvXMLParser::IsXmlChar(char) {
  
  return (char)this == 9 || (char)this == 10 || (char)this == 13 || (char)this >= 32;
}


// address=[0x2f28690]
// Decompiled from char __cdecl AdvXMLParser::LowCase(AdvXMLParser *this)
char __cdecl AdvXMLParser::LowCase(char) {
  
  if ( (char)this < 65 || (char)this > 90 )
    return (char)this;
  else
    return (_BYTE)this + 32;
}


// address=[0x2f2a440]
// Decompiled from int __cdecl _calcHash(const unsigned __int8 *a1)
unsigned long __cdecl _calcHash(unsigned char const * a1) {
  
  const unsigned __int8 *i; // [esp+4h] [ebp-8h]
  int v3; // [esp+8h] [ebp-4h]
  int v4; // [esp+8h] [ebp-4h]

  v3 = 0;
  for ( i = a1; i < a1 + 5; ++i )
  {
    v4 = v3 ^ *i;
    v3 = __ROL4__(v4, 5);
  }
  return v3;
}


// address=[0x2f2bce0]
// Decompiled from int __cdecl shellSort(struct HuffStatTmpStruct *a1, int a2)
void __cdecl shellSort(struct HuffStatTmpStruct * a1, int a2) {
  
  int result; // eax
  int v3; // [esp+0h] [ebp-10h] BYREF
  int j; // [esp+4h] [ebp-Ch]
  int k; // [esp+8h] [ebp-8h]
  int i; // [esp+Ch] [ebp-4h]

  if ( a2 / 9 < 13 && BBSupportDbgReport(2, "Source\\compression\\huff.cpp", 64, "13 <= N / 9") == 1 )
    __debugbreak();
  result = a2 / 9;
  if ( a2 / 9 >= 40 )
  {
    result = BBSupportDbgReport(2, "Source\\compression\\huff.cpp", 65, "40 > N / 9");
    if ( result == 1 )
      __debugbreak();
  }
  for ( i = 40; i > 0; i /= 3 )
  {
    for ( j = i + 1; j <= a2; ++j )
    {
      v3 = *((_DWORD *)a1 + j);
      for ( k = j; k > i && operator<(&v3, (char *)a1 + 4 * (k - i)); k -= i )
        *((_DWORD *)a1 + k) = *((_DWORD *)a1 + k - i);
      *((_DWORD *)a1 + k) = v3;
    }
    result = i / 3;
  }
  return result;
}


// address=[0x2f2c320]
// Decompiled from BOOL __cdecl operator<(const struct HuffStatTmpStruct *a1, const struct HuffStatTmpStruct *a2)
int __cdecl operator<(struct HuffStatTmpStruct const & a1, struct HuffStatTmpStruct const & a2) {
  
  return (int)cmpHuffStatTmpStruct(a1, a2) < 0;
}


// address=[0x2f2c980]
// Decompiled from int __cdecl cmpHuffStatTmpStruct(const struct HuffStatTmpStruct *a1, const struct HuffStatTmpStruct *a2)
int __cdecl cmpHuffStatTmpStruct(struct HuffStatTmpStruct const & a1, struct HuffStatTmpStruct const & a2) {
  
  if ( *((__int16 *)a2 + 1) == *((__int16 *)a1 + 1) )
    return *(__int16 *)a2 - *(__int16 *)a1;
  else
    return *((__int16 *)a2 + 1) - *((__int16 *)a1 + 1);
}


// address=[0x2f2d320]
// [Decompilation failed for void __cdecl AdvXMLParser::operator<<(class AdvXMLParser::Value,int)]

// address=[0x2f2d360]
// [Decompilation failed for void __cdecl AdvXMLParser::operator<<(class AdvXMLParser::Value,unsigned int)]

// address=[0x2f2d3a0]
// [Decompilation failed for void __cdecl AdvXMLParser::operator<<(class AdvXMLParser::Value,double)]

// address=[0x2f2d3f0]
// Decompiled from char *__cdecl AdvXMLParser::Int2Chars(int this, unsigned int a2, char *a3)
char * __cdecl AdvXMLParser::Int2Chars(int a2, char * a3, int a3) {
  
  char *v4; // [esp+4h] [ebp-4h]

  v4 = &a3[a2 - 2];
  v4[1] = 0;
  while ( this > 0 )
  {
    *v4-- = byte_3AB98CC[this & 0xF];
    this /= 16;
    if ( (unsigned int)v4 < a2 && BBSupportDbgReport(2, "Source\\Xml\\writer.cpp", 201, "pDigit >= szBuffer") == 1 )
      __debugbreak();
  }
  return v4;
}


// address=[0x2f2d880]
// Decompiled from int BBSupportActivateDbgReportHook()
void __stdcall BBSupportActivateDbgReportHook(void) {
  
  j___CrtSetReportMode(0, 2);
  j___CrtSetReportMode(1, 2);
  j___CrtSetReportMode(2, 4);
  return j___CrtSetReportHook(sub_2F2DFF0);
}


// address=[0x2f2d8c0]
// Decompiled from int __stdcall BBSupportDbgReport(int a1, const char *a2, int a3, const char *a4)
int __stdcall BBSupportDbgReport(int a1, char const * a2, unsigned int a3, char const * a4) {
  
  bool v4; // sf
  const WCHAR *v6; // eax
  UINT v7; // [esp+18h] [ebp-2ED0h]
  const char *v8; // [esp+1Ch] [ebp-2ECCh]
  const char *v10; // [esp+34h] [ebp-2EB4h]
  int v11; // [esp+3Ch] [ebp-2EACh]
  HWND LastActivePopup; // [esp+40h] [ebp-2EA8h]
  const char *v13; // [esp+44h] [ebp-2EA4h]
  const char *v14; // [esp+50h] [ebp-2E98h]
  HWND hWnd; // [esp+54h] [ebp-2E94h]
  bool v16; // [esp+5Ah] [ebp-2E8Eh]
  bool v17; // [esp+5Bh] [ebp-2E8Dh]
  char v18[88]; // [esp+5Ch] [ebp-2E8Ch] BYREF
  int v19[7]; // [esp+B4h] [ebp-2E34h] BYREF
  char Str[4096]; // [esp+D0h] [ebp-2E18h] BYREF
  char Source[2048]; // [esp+10D0h] [ebp-1E18h] BYREF
  WCHAR Caption[1024]; // [esp+18D0h] [ebp-1618h] BYREF
  CHAR OutputString[1024]; // [esp+20D0h] [ebp-E18h] BYREF
  CHAR v24[1024]; // [esp+24D0h] [ebp-A18h] BYREF
  CHAR v25[1024]; // [esp+28D0h] [ebp-618h] BYREF
  _WORD v26[260]; // [esp+2CD0h] [ebp-218h] BYREF
  int v27; // [esp+2EE4h] [ebp-4h]
  signed int v28; // [esp+2EF0h] [ebp+8h]

  v16 = (a1 & 0x40000000) != 0;
  v4 = a1 < 0;
  v28 = a1 & 0xBFFFFFFF;
  if ( v4 || v28 > 3 )
    return -1;
  memset(v24, 0, sizeof(v24));
  memset(v25, 0, sizeof(v25));
  if ( a2 )
  {
    _wsprintfA(v24, "File %s, line %u.", a2, a3);
    _wsprintfA(v25, "%s (%u)", a2, a3);
  }
  if ( _InterlockedIncrement(&dword_3E2E224) <= 0 )
  {
    if ( a4 )
      v13 = a4;
    else
      v13 = (const char *)&unk_3AB990E;
    if ( a2 )
      v8 = ": ";
    else
      v8 = (const char *)&unk_3AB990F;
    if ( v16 )
      j___snprintf(Source, 0x7FFu, "%s%s%s%s: %s", "CRT ", off_3AB9960[v28], v8, v25, v13);
    else
      j___snprintf(Source, 0x7FFu, "%s%s%s%s: %s", (const char *)&unk_3AB9921, off_3AB9960[v28], v8, v25, v13);
    Source[2047] = 0;
    BBSupportTracePrint(dword_3AB98E0[v28], Source);
    BBSupportTracePrint(dword_3AB98E0[v28], v24);
    if ( v28 == 3 || !v28 && (v16 || !byte_4686D4A) )
    {
      BBSupportLib::BBSTraceStackDump();
      _InterlockedDecrement(&dword_3E2E224);
      return 0;
    }
    else
    {
      if ( v28 )
        BBSupportLib::BBSTraceStackDump();
      if ( BBSupportLib::g_iBBSErrorhandlingMode == 3 )
      {
        _InterlockedDecrement(&dword_3E2E224);
        j__raise(22);
        j___exit(3);
      }
      BBSupportLib::BBSCopyTextToClipboard(Source);
      memset(Caption, 0, sizeof(Caption));
      memset(v26, 0, sizeof(v26));
      BBSupportLib::BBSGetModuleFileName(0, v26, 0x208u);
      if ( v26[0] )
        _wsprintfW(Caption, L"%s%s%s", v26, L" - ", off_3AB98F0[v28]);
      else
        _wsprintfW(Caption, L"%s%s%s", v26, &unk_3AB99F4, off_3AB98F0[v28]);
      v17 = BBSupportLib::g_iBBSDeveloperErrorHandling != 0;
      v14 = "(Press Retry to debug the application.)\t\t";
      if ( !BBSupportLib::g_iBBSDeveloperErrorHandling )
      {
        if ( v28 )
          v10 = "Application will be terminated.\t\t";
        else
          v10 = "Press Ok to continue.\t\t\t";
        v14 = v10;
      }
      memset(Str, 0, sizeof(Str));
      if ( v16 )
      {
        j___snprintf(Str, 0xFFFu, "%s\n%s\n", v13, v14);
      }
      else if ( a2 )
      {
        j___snprintf(Str, 0xFFFu, "%s: %s%s%s\n\n%s\n", off_3AB98F0[v28], v13, "\nLocation: ", v25, v14);
      }
      else
      {
        j___snprintf(Str, 0xFFFu, "%s: %s%s%s\n\n%s\n", off_3AB98F0[v28], v13, byte_3AB9922, v25, v14);
      }
      LastActivePopup = 0;
      hWnd = GetActiveWindow();
      if ( hWnd )
      {
        LastActivePopup = GetLastActivePopup(hWnd);
        if ( (unsigned __int8)BBSupportLib::BBSIsFullscreenWindow(hWnd) )
          ShowWindow(hWnd, 6);
      }
      if ( v17 )
        v7 = 73746;
      else
        v7 = 73744;
      std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v18);
      v27 = 0;
      std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::from_bytes(
        (int)v19,
        Str);
      v6 = (const WCHAR *)std::wstring::c_str((_Cnd_internal_imp_t *)v19);
      v11 = MessageBoxW(LastActivePopup, v6, Caption, v7);
      _InterlockedDecrement(&dword_3E2E224);
      if ( !v28 )
        goto LABEL_54;
      if ( !v17 || v11 == 3 )
      {
        j__raise(22);
        j___exit(3);
      }
      if ( v11 == 4 )
      {
        std::wstring::~wstring(v19);
        v27 = -1;
        std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v18);
        return 1;
      }
      else
      {
LABEL_54:
        std::wstring::~wstring(v19);
        v27 = -1;
        std::wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>::~wstring_convert<std::codecvt_utf8_utf16<wchar_t,1114111,0>,wchar_t,std::allocator<wchar_t>,std::allocator<char>>(v18);
        return 0;
      }
    }
  }
  else
  {
    memset(OutputString, 0, sizeof(OutputString));
    _wsprintfA(OutputString, "Second chance %s: File %s, Line %d\n", off_3AB9930[v28], a2, a3);
    OutputDebugStringA(OutputString);
    _InterlockedDecrement(&dword_3E2E224);
    __debugbreak();
    return -1;
  }
}


// address=[0x2f2df30]
// Decompiled from int BBSupportDbgReportF(int a1, const char *a2, int a3, char *Format, ...)
int __cdecl BBSupportDbgReportF(int a1, char const * a2, unsigned int a3, char const * Format, ... a5) {
  
  char Buffer[3072]; // [esp+4h] [ebp-C04h] BYREF
  va_list va; // [esp+C20h] [ebp+18h] BYREF

  va_start(va, Format);
  if ( !Format )
    return BBSupportDbgReport(a1, a2, a3, 0);
  memset(Buffer, 0, sizeof(Buffer));
  __vcrt_va_start_verify_argument_type<char const *>();
  j___vsnprintf(Buffer, 0xBFFu, Format, va);
  return BBSupportDbgReport(a1, a2, a3, Buffer);
}


// address=[0x2f2dfe0]
// [Decompilation failed for void __stdcall BBSupportWarningMessageBoxes(bool)]

// address=[0x2f2e210]
// Decompiled from int __stdcall BBSupportOpenTraceFile(int a1, const wchar_t *a2)
void __stdcall BBSupportOpenTraceFile(int a1, wchar_t const * a2) {
  
  int result; // eax
  CBBSupportLogFile *v3; // eax
  int v4; // [esp+0h] [ebp-4h]

  BBSupportSetErrorHandlingMode(-1);
  result = BBSupportLib::CBBSupportTraceFilePtr::operator BBSupportLib::IBBSupportTraceFile *(&BBSupportLib::g_pBBSTraceFile);
  if ( !result )
    return result;
  v3 = (CBBSupportLogFile *)BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
  result = CBBSupportLogFile::IsOpen(v3);
  if ( (_BYTE)result )
    return result;
  v4 = BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
  return (*(int (__thiscall **)(int, int, int, const wchar_t *))(*(_DWORD *)v4 + 12))(v4, v4, a1, a2);
}


// address=[0x2f2e270]
// Decompiled from int __stdcall BBSupportSmartOpenTraceFile(const wchar_t *a1, const wchar_t *a2)
void __stdcall BBSupportSmartOpenTraceFile(wchar_t const * a1, wchar_t const * a2) {
  
  int result; // eax
  CBBSupportLogFile *v3; // eax
  int v4; // [esp+0h] [ebp-1A88h]
  int v5; // [esp+0h] [ebp-1A88h]
  int v6; // [esp+4h] [ebp-1A84h]
  size_t v7; // [esp+Ch] [ebp-1A7Ch]
  const wchar_t *v8; // [esp+10h] [ebp-1A78h]
  const WCHAR *v9; // [esp+14h] [ebp-1A74h]
  int v10; // [esp+18h] [ebp-1A70h]
  HANDLE hFindFile; // [esp+1Ch] [ebp-1A6Ch]
  int v12; // [esp+24h] [ebp-1A64h]
  unsigned int i; // [esp+28h] [ebp-1A60h]
  int v14; // [esp+2Ch] [ebp-1A5Ch]
  int v15; // [esp+30h] [ebp-1A58h]
  const char *lpFileName; // [esp+34h] [ebp-1A54h]
  int v17; // [esp+38h] [ebp-1A50h]
  int j; // [esp+3Ch] [ebp-1A4Ch]
  int v19; // [esp+40h] [ebp-1A48h]
  int v20; // [esp+44h] [ebp-1A44h]
  int v21; // [esp+44h] [ebp-1A44h]
  char v22; // [esp+4Bh] [ebp-1A3Dh]
  struct _WIN32_FIND_DATAW FindFileData; // [esp+4Ch] [ebp-1A3Ch] BYREF
  WCHAR v24[1024]; // [esp+29Ch] [ebp-17ECh] BYREF
  WCHAR FileName[1024]; // [esp+A9Ch] [ebp-FECh] BYREF
  CHAR v26[1024]; // [esp+129Ch] [ebp-7ECh] BYREF
  _BYTE v27[1000]; // [esp+169Ch] [ebp-3ECh] BYREF

  BBSupportSetErrorHandlingMode(-1);
  result = BBSupportLib::CBBSupportTraceFilePtr::operator BBSupportLib::IBBSupportTraceFile *(&BBSupportLib::g_pBBSTraceFile);
  if ( !result )
    return result;
  v3 = (CBBSupportLogFile *)BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
  result = CBBSupportLogFile::IsOpen(v3);
  if ( (_BYTE)result )
    return result;
  if ( a1 && *a1 )
    v9 = a1;
  else
    v9 = L"Log\\";
  lpFileName = (const char *)v9;
  if ( a2 && *a2 )
    v8 = a2;
  else
    v8 = L"Trace";
  v22 = BBSupportLib::BBSIsDirectory(v9);
  if ( !v22 )
  {
    if ( CreateDirectoryW(v9, 0) )
      v22 = BBSupportLib::BBSIsDirectory(v9);
    else
      v22 = 0;
  }
  if ( !v22 )
    lpFileName = (const char *)&unk_3AB9B74;
  v15 = 1000;
  v19 = 0;
  v20 = 0;
  memset(v27, 0, sizeof(v27));
  memset(FileName, 0, sizeof(FileName));
  _wsprintfW(FileName, L"%s%s???.txt", lpFileName, v8);
  v7 = j__wcslen(v8) + 7;
  hFindFile = FindFirstFileW(FileName, &FindFileData);
  if ( hFindFile != (HANDLE)-1 )
  {
    do
    {
      if ( j__wcslen(FindFileData.cFileName) == v7 )
      {
        v17 = sub_2F2F240((char *)&FindFileData.nFileSizeHigh + 2 * v7 + 2, v4);
        if ( v17 >= 1 && v17 <= 999 )
        {
          v27[v17] = 1;
          if ( v17 < v15 )
            v15 = v17;
          if ( v17 > v19 )
            v19 = v17;
          ++v20;
        }
      }
    }
    while ( FindNextFileW(hFindFile, &FindFileData) );
    FindClose(hFindFile);
  }
  v12 = 0;
  if ( v19 < 900 )
  {
    if ( v20 >= 10 )
      v12 = v20 - 9;
  }
  else
  {
    v12 = v20;
  }
  if ( v12 > 0 )
  {
    v10 = 0;
    for ( i = v15; (int)i <= v19 && v10 < v12; ++i )
    {
      _wsprintfA(v26, "%s%s%03u.txt", lpFileName, (const char *)v8, i);
      if ( DeleteFileA(v26) )
      {
        if ( i >= 0x3E8 )
          j____report_rangecheckfailure();
        v27[i] = 0;
        ++v10;
      }
    }
    v14 = v15;
    v5 = v19;
    v19 = -1;
    v21 = 0;
    while ( v14 <= v5 )
    {
      if ( v27[v14] )
      {
        v19 = v14;
        ++v21;
      }
      ++v14;
    }
  }
  j = v19 + 1;
  if ( v19 + 1 < 1 || j > 900 )
  {
    for ( j = 1; j < 999 && v27[j]; ++j )
      ;
  }
  _wsprintfW(v24, L"%s%s%03u.txt", lpFileName, v8, j);
  v6 = BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
  return (*(int (__thiscall **)(int, int, int, WCHAR *))(*(_DWORD *)v6 + 12))(v6, v6, 1, v24);
}


// address=[0x2f2e770]
// Decompiled from char __stdcall BBSupportGetTraceFilePath(wchar_t *a1, unsigned int a2)
bool __stdcall BBSupportGetTraceFilePath(wchar_t * a1, unsigned int a2) {
  
  int v3; // [esp+0h] [ebp-4h]

  if ( BBSupportLib::CBBSupportTraceFilePtr::operator BBSupportLib::IBBSupportTraceFile *(&BBSupportLib::g_pBBSTraceFile) )
  {
    v3 = BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
    return (*(int (__stdcall **)(int, wchar_t *, unsigned int))(*(_DWORD *)v3 + 48))(v3, a1, a2);
  }
  else
  {
    BBSupportLib::BBSCopyString<wchar_t>(a1, &unk_3AB9BBC, a2);
    return 0;
  }
}


// address=[0x2f2e7d0]
// Decompiled from void __stdcall BBSupportTracePrint(int a1, char *Source)
void __stdcall BBSupportTracePrint(unsigned int a1, char const * Source) {
  
  DWORD TickCount; // eax
  DWORD CurrentThreadId; // [esp-8h] [ebp-830h]
  int v4; // [esp+4h] [ebp-824h]
  int v5; // [esp+8h] [ebp-820h]
  int v6; // [esp+1Ch] [ebp-80Ch]
  signed int i; // [esp+20h] [ebp-808h]
  CHAR OutputString[2048]; // [esp+24h] [ebp-804h] BYREF

  v6 = a1 & 0x7FFFFFFF;
  if ( (a1 & 0x7FFFFFFFu) >= 0xC8 )
    v6 = 0;
  if ( BBSupportLib::CBBSupportTraceFilePtr::operator BBSupportLib::IBBSupportTraceFile *(&BBSupportLib::g_pBBSTraceFile) != 0
    && Source != 0
    && (unsigned __int8)byte_4686FAC[v6] >= 4u )
  {
    EnterCriticalSection(&CriticalSection);
    j__strncpy(OutputString, Source, 0x7FFu);
    OutputString[2047] = 0;
    for ( i = j__strlen(OutputString); i > 0 && (unsigned __int8)OutputString[i - 1] - 1 <= 31; OutputString[i] = 0 )
    {
      if ( (unsigned int)--i >= 0x800 )
        j____report_rangecheckfailure();
    }
    if ( a1 < 0 || (BBSupportLib::BBSGetDevelopmentFlags() & 1) != 0 )
    {
      v4 = BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
      (*(void (**)(int, const char *, ...))(*(_DWORD *)v4 + 24))(v4, "%s\r\n", OutputString);
    }
    else
    {
      v5 = BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
      CurrentThreadId = GetCurrentThreadId();
      TickCount = GetTickCount();
      (*(void (**)(int, const char *, ...))(*(_DWORD *)v5 + 24))(
        v5,
        "%10u  %08x    %s\r\n",
        TickCount,
        CurrentThreadId,
        OutputString);
    }
    OutputString[i++] = 10;
    if ( (unsigned int)i >= 0x800 )
      j____report_rangecheckfailure();
    OutputString[i] = 0;
    OutputDebugStringA(OutputString);
    LeaveCriticalSection(&CriticalSection);
  }
}


// address=[0x2f2ea40]
// Decompiled from void __stdcall BBSupportTracePrint(int a1, wchar_t *Source)
void __stdcall BBSupportTracePrint(unsigned int a1, wchar_t const * Source) {
  
  DWORD TickCount; // eax
  DWORD CurrentThreadId; // [esp-8h] [ebp-1034h]
  int v4; // [esp+8h] [ebp-1024h]
  int v5; // [esp+Ch] [ebp-1020h]
  int v6; // [esp+20h] [ebp-100Ch]
  signed int i; // [esp+24h] [ebp-1008h]
  wchar_t Destination[2048]; // [esp+28h] [ebp-1004h] BYREF

  v6 = a1 & 0x7FFFFFFF;
  if ( (a1 & 0x7FFFFFFFu) >= 0xC8 )
    v6 = 0;
  if ( BBSupportLib::CBBSupportTraceFilePtr::operator BBSupportLib::IBBSupportTraceFile *(&BBSupportLib::g_pBBSTraceFile) != 0
    && Source != 0
    && (unsigned __int8)byte_4686FAC[v6] >= 4u )
  {
    EnterCriticalSection(&CriticalSection);
    j__wcsncpy(Destination, Source, 0x7FFu);
    Destination[2047] = 0;
    for ( i = j__wcslen(Destination); i > 0 && LOBYTE(Destination[i - 1]) - 1 <= 31; Destination[i] = 0 )
    {
      --i;
      if ( (unsigned int)(2 * i) >= 0x1000 )
        j____report_rangecheckfailure();
    }
    if ( a1 < 0 || (BBSupportLib::BBSGetDevelopmentFlags() & 1) != 0 )
    {
      v4 = BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
      (*(void (**)(int, const char *, ...))(*(_DWORD *)v4 + 24))(v4, "%s\r\n", Destination);
    }
    else
    {
      v5 = BBSupportLib::CBBSupportTraceFilePtr::operator->(&BBSupportLib::g_pBBSTraceFile);
      CurrentThreadId = GetCurrentThreadId();
      TickCount = GetTickCount();
      (*(void (**)(int, const char *, ...))(*(_DWORD *)v5 + 24))(
        v5,
        "%10u  %08x    %s\r\n",
        TickCount,
        CurrentThreadId,
        Destination);
    }
    Destination[i++] = 10;
    if ( (unsigned int)(2 * i) >= 0x1000 )
      j____report_rangecheckfailure();
    Destination[i] = 0;
    OutputDebugStringW(Destination);
    LeaveCriticalSection(&CriticalSection);
  }
}


// address=[0x2f2ecc0]
// Decompiled from void BBSupportTracePrintF(int a1, char *Format, ...)
void __cdecl BBSupportTracePrintF(unsigned int a1, char const * Format, ... a3) {
  
  char Source[2048]; // [esp+8h] [ebp-804h] BYREF
  va_list va; // [esp+81Ch] [ebp+10h] BYREF

  va_start(va, Format);
  if ( Format )
  {
    __vcrt_va_start_verify_argument_type<char const *>();
    j___vsnprintf(Source, 0x7FFu, Format, va);
    Source[2047] = 0;
    BBSupportTracePrint(a1, Source);
  }
}


// address=[0x2f2ed60]
// [Decompilation failed for unsigned int __stdcall BBSupportReserveTraceLevel(void)]

// address=[0x2f2edb0]
// Decompiled from int __stdcall BBSupportEnableTraceLevel(unsigned int a1)
void __stdcall BBSupportEnableTraceLevel(unsigned int a1) {
  
  int result; // eax

  result = (a1 < 0xC8) & (BBSupportLib::CBBSupportTraceFilePtr::operator BBSupportLib::IBBSupportTraceFile *(&BBSupportLib::g_pBBSTraceFile) != 0);
  if ( !result )
    return result;
  result = a1;
  byte_4686FAC[a1] |= 4u;
  return result;
}


// address=[0x2f2ee20]
// Decompiled from int __stdcall BBSupportDisableTraceLevel(unsigned int a1)
void __stdcall BBSupportDisableTraceLevel(unsigned int a1) {
  
  int result; // eax

  result = (a1 < 0xC8) & (BBSupportLib::CBBSupportTraceFilePtr::operator BBSupportLib::IBBSupportTraceFile *(&BBSupportLib::g_pBBSTraceFile) != 0);
  if ( !result )
    return result;
  result = a1;
  byte_4686FAC[a1] &= ~4u;
  return result;
}


// address=[0x2f2f800]
// Decompiled from BOOL __stdcall BBSupportLib::BBSCopyString<wchar_t>(int a1, _WORD *a2, int a3)
void __stdcall BBSupportLib::BBSCopyString<wchar_t>(wchar_t * a1, wchar_t const * a2, unsigned int a3) {
  
  BOOL result; // eax
  unsigned int v4; // [esp+Ch] [ebp-4h]
  unsigned int v5; // [esp+20h] [ebp+10h]

  result = a3 != 0 && a1 != 0;
  if ( a3 == 0 || a1 == 0 )
    return result;
  v5 = a3 - 1;
  v4 = 0;
  if ( *a2 )
  {
    while ( v4 < v5 && a2[v4] )
    {
      *(_WORD *)(a1 + 2 * v4) = a2[v4];
      ++v4;
    }
  }
  result = a1;
  *(_WORD *)(a1 + 2 * v4) = 0;
  return result;
}


// address=[0x2f2f9e0]
// Decompiled from int BBSupportLib::BBSGetDevelopmentFlags()
int __stdcall BBSupportLib::BBSGetDevelopmentFlags(void) {
  
  if ( BBSupportLib::g_iBBSDevelopmentFlags < 0 )
    return BBSupportLib::BBSGetDevelopmentFlagsEx();
  else
    return BBSupportLib::g_iBBSDevelopmentFlags;
}


// address=[0x2f2fa10]
// Decompiled from bool __cdecl BBSupportLib::BBSIsNumber(BBSupportLib *this)
bool __cdecl BBSupportLib::BBSIsNumber(char) {
  
  return (unsigned __int8)this - 48 < 10;
}


// address=[0x2f2fa40]
// Decompiled from int __cdecl BBSupportLib::BBSNumberValue(BBSupportLib *this)
unsigned int __cdecl BBSupportLib::BBSNumberValue(char) {
  
  return (unsigned __int8)this - 48;
}


// address=[0x2f2fa80]
// [Decompilation failed for unsigned int __stdcall BBSupportDllVersion(void)]

// address=[0x2f2fa90]
// Decompiled from const char *BBSupportDllVersionString()
char const * __cdecl BBSupportDllVersionString(void) {
  
  return "1.46";
}


// address=[0x2f2faa0]
// Decompiled from bool __stdcall BBSupportSetErrorHandlingMode(unsigned int a1)
void __stdcall BBSupportSetErrorHandlingMode(int a1) {
  
  bool result; // al

  if ( a1 == -1 )
  {
    a1 = BBSupportLib::g_iBBSErrorhandlingMode;
  }
  else if ( a1 >= 4 )
  {
    a1 = 0;
  }
  result = BBSupportLib::BBSIsDevelopmentMachine();
  BBSupportLib::g_iBBSErrorhandlingMode = a1;
  if ( a1 )
  {
    result = BBSupportLib::g_iBBSErrorhandlingMode == 2;
    BBSupportLib::g_iBBSDeveloperErrorHandling = BBSupportLib::g_iBBSErrorhandlingMode == 2;
  }
  else
  {
    BBSupportLib::g_iBBSDeveloperErrorHandling = BBSupportLib::g_iBBSIsDevelopmentMachine > 0;
  }
  return result;
}


// address=[0x2f2fb40]
// Decompiled from bool BBSupportIsDevelopmentMachine()
bool __stdcall BBSupportIsDevelopmentMachine(void) {
  
  LSTATUS v1; // [esp+0h] [ebp-30h]
  DWORD Type; // [esp+4h] [ebp-2Ch] BYREF
  DWORD cbData; // [esp+8h] [ebp-28h] BYREF
  int v5; // [esp+10h] [ebp-20h]
  BYTE Data[4]; // [esp+14h] [ebp-1Ch] BYREF
  HKEY phkResult; // [esp+18h] [ebp-18h] BYREF
  CHAR ValueName[16]; // [esp+1Ch] [ebp-14h] BYREF

  phkResult = 0;
  Type = 4;
  *(_DWORD *)Data = 0;
  cbData = 4;
  if ( RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\\BlueByte", 0, 0xF003Fu, &phkResult) )
    return 0;
  strcpy(ValueName, "Developer");
  v5 = 9;
  v1 = RegQueryValueExA(phkResult, ValueName, 0, &Type, Data, &cbData);
  memset(ValueName, 0, sizeof(ValueName));
  RegCloseKey(phkResult);
  return !v1 && (*(_UNKNOWN **)Data == (_UNKNOWN *)((char *)&loc_1BB7352 + 1) || *(_DWORD *)Data == 688265585);
}


// address=[0x2f2fca0]
// Decompiled from int BBSupportDevelopmentMachineId()
unsigned int __stdcall BBSupportDevelopmentMachineId(void) {
  
  LSTATUS v1; // [esp+0h] [ebp-30h]
  DWORD Type; // [esp+4h] [ebp-2Ch] BYREF
  DWORD cbData[2]; // [esp+8h] [ebp-28h] BYREF
  BYTE Data[4]; // [esp+10h] [ebp-20h] BYREF
  HKEY phkResult; // [esp+14h] [ebp-1Ch] BYREF
  CHAR ValueName[16]; // [esp+1Ch] [ebp-14h] BYREF

  if ( !BBSupportIsDevelopmentMachine() )
    return 0;
  phkResult = 0;
  Type = 4;
  *(_DWORD *)Data = 0;
  cbData[0] = 4;
  if ( RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\\BlueByte", 0, 0xF003Fu, &phkResult) )
    return *(_DWORD *)Data;
  strcpy(ValueName, "DeveloperId");
  cbData[1] = 11;
  v1 = RegQueryValueExA(phkResult, ValueName, 0, &Type, Data, cbData);
  memset(ValueName, 0, sizeof(ValueName));
  if ( v1 )
    *(_DWORD *)Data = 0;
  RegCloseKey(phkResult);
  return *(_DWORD *)Data;
}


// address=[0x2f2fe10]
// Decompiled from int __thiscall BBSupportGetModuleTimeDateStamp(ATL::CComCriticalSection *this, int a2)
unsigned int __stdcall BBSupportGetModuleTimeDateStamp(void * a2) {
  
  int v3; // [esp+14h] [ebp-20h]

  v3 = 0;
  if ( a2 && *(_WORD *)a2 == 23117 )
    return *(_DWORD *)(*(_DWORD *)(a2 + 60) + a2 + 8);
  return v3;
}


// address=[0x2f2feb0]
// Decompiled from BBSupportLib *__userpurge BBSupportLib::BBSGetFileNameFromFilePath@<eax>(BBSupportLib *this, const wchar_t *a2)
wchar_t const * __stdcall BBSupportLib::BBSGetFileNameFromFilePath(wchar_t const * a2) {
  
  __int64 v3; // [esp+0h] [ebp-10h]
  int v4; // [esp+8h] [ebp-8h]
  int v5; // [esp+Ch] [ebp-4h]

  if ( !this )
    return 0;
  v5 = 0;
  v4 = 0;
  while ( *((_WORD *)this + v5) )
  {
    HIDWORD(v3) = *((unsigned __int16 *)this + v5) == '\\';
    LODWORD(v3) = *((unsigned __int16 *)this + v5) == '/';
    if ( v3 )
      v4 = v5;
    ++v5;
  }
  if ( v4 >= v5 - 1 )
    return 0;
  if ( v4 )
    return (BBSupportLib *)((char *)this + 2 * v4 + 2);
  return this;
}


// address=[0x2f2ff70]
// Decompiled from unsigned int __stdcall BBSupportLib::BBSGetModuleFileDir(HMODULE hModule, LPWSTR lpFilename, DWORD nSize)
unsigned int __stdcall BBSupportLib::BBSGetModuleFileDir(struct HINSTANCE__ * hModule, wchar_t * lpFilename, unsigned int nSize) {
  
  int v4; // [esp+0h] [ebp-14h]
  BBSupportLib *v5; // [esp+4h] [ebp-10h]
  unsigned int v6; // [esp+10h] [ebp-4h]

  v4 = 0;
  if ( nSize == 0 || lpFilename == 0 )
    return v4;
  *lpFilename = 0;
  if ( !GetModuleFileNameW(hModule, lpFilename, nSize) )
    return v4;
  v5 = BBSupportLib::BBSGetFileNameFromFilePath((BBSupportLib *)lpFilename, 0);
  if ( !v5 )
    return v4;
  v6 = (v5 - (BBSupportLib *)lpFilename) >> 1;
  if ( v6 <= 2 || v6 >= nSize )
  {
    *lpFilename = 0;
  }
  else
  {
    lpFilename[v6] = 0;
    return v6 - 1;
  }
  return v4;
}


// address=[0x2f30040]
// Decompiled from size_t __stdcall BBSupportLib::BBSGetModuleFileName(HMODULE hModule, _WORD *a2, unsigned int a3)
unsigned int __stdcall BBSupportLib::BBSGetModuleFileName(struct HINSTANCE__ * hModule, wchar_t * a2, unsigned int a3) {
  
  int v4; // [esp+0h] [ebp-220h]
  const wchar_t *Src; // [esp+Ch] [ebp-214h]
  size_t v6; // [esp+10h] [ebp-210h]
  WCHAR Filename[260]; // [esp+14h] [ebp-20Ch] BYREF

  v4 = 0;
  if ( a3 == 0 || a2 == 0 )
    return v4;
  *a2 = 0;
  if ( !GetModuleFileNameW(hModule, Filename, 0x208u) )
    return v4;
  Src = BBSupportLib::BBSGetFileNameFromFilePath((BBSupportLib *)Filename, 0);
  if ( !Src )
    return v4;
  v6 = j__wcslen(Src);
  if ( !v6 )
    return v4;
  if ( v6 + 1 >= a3 )
    return v4;
  j__memcpy(a2, Src, v6 + 1);
  return v6;
}


// address=[0x2f30160]
// Decompiled from bool __stdcall BBSupportLib::BBSIsDirectory(LPCWSTR lpFileName)
bool __stdcall BBSupportLib::BBSIsDirectory(wchar_t const * lpFileName) {
  
  DWORD dwErrCode; // [esp+0h] [ebp-10h]
  bool v3; // [esp+4h] [ebp-Ch]
  DWORD FileAttributesW; // [esp+8h] [ebp-8h]
  bool v5; // [esp+Fh] [ebp-1h]

  v5 = 0;
  if ( !lpFileName || !*lpFileName )
    return v5;
  dwErrCode = GetLastError();
  FileAttributesW = GetFileAttributesW(lpFileName);
  v3 = FileAttributesW != -1 && (FileAttributesW & 0x10) != 0;
  v5 = v3;
  SetLastError(dwErrCode);
  return v5;
}


// address=[0x2f301d0]
// Decompiled from int BBSupportLib::BBSGetDevelopmentFlagsEx()
int __stdcall BBSupportLib::BBSGetDevelopmentFlagsEx(void) {
  
  LSTATUS v1; // [esp+0h] [ebp-2Ch]
  DWORD Type; // [esp+4h] [ebp-28h] BYREF
  DWORD cbData; // [esp+8h] [ebp-24h] BYREF
  BYTE Data[4]; // [esp+Ch] [ebp-20h] BYREF
  int v5; // [esp+10h] [ebp-1Ch]
  HKEY phkResult; // [esp+14h] [ebp-18h] BYREF
  CHAR ValueName[16]; // [esp+18h] [ebp-14h] BYREF

  BBSupportLib::g_iBBSDevelopmentFlags = 0x80000000;
  if ( !BBSupportLib::BBSIsDevelopmentMachine() )
    return BBSupportLib::g_iBBSDevelopmentFlags;
  phkResult = 0;
  Type = 4;
  *(_DWORD *)Data = 0;
  cbData = 4;
  if ( RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\\BlueByte", 0, 0xF003Fu, &phkResult) )
    return BBSupportLib::g_iBBSDevelopmentFlags;
  strcpy(ValueName, "DeveloperFlags");
  v5 = 14;
  v1 = RegQueryValueExA(phkResult, ValueName, 0, &Type, Data, &cbData);
  memset(ValueName, 0, sizeof(ValueName));
  if ( !v1 )
    BBSupportLib::g_iBBSDevelopmentFlags = *(_DWORD *)Data & 0x7FFFFFFF;
  RegCloseKey(phkResult);
  return BBSupportLib::g_iBBSDevelopmentFlags;
}


// address=[0x2f30370]
// Decompiled from int BBSupportLib::BBSGetSupportFlagsEx()
int __stdcall BBSupportLib::BBSGetSupportFlagsEx(void) {
  
  DWORD Type; // [esp+4h] [ebp-10h] BYREF
  DWORD cbData; // [esp+8h] [ebp-Ch] BYREF
  BYTE Data[4]; // [esp+Ch] [ebp-8h] BYREF
  HKEY phkResult; // [esp+10h] [ebp-4h] BYREF

  BBSupportLib::g_iBBSSupportFlags = 0x80000000;
  phkResult = 0;
  Type = 4;
  *(_DWORD *)Data = 0;
  cbData = 4;
  if ( RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\\BlueByte", 0, 0xF003Fu, &phkResult) )
    return BBSupportLib::g_iBBSSupportFlags;
  if ( !RegQueryValueExA(phkResult, "SupportFlags", 0, &Type, Data, &cbData) )
    BBSupportLib::g_iBBSSupportFlags = *(_DWORD *)Data & 0x7FFFFFFF;
  RegCloseKey(phkResult);
  return BBSupportLib::g_iBBSSupportFlags;
}


// address=[0x2f30410]
// Decompiled from bool BBSupportLib::BBSIsDevelopmentMachine()
bool __stdcall BBSupportLib::BBSIsDevelopmentMachine(void) {
  
  int v1; // [esp+4h] [ebp-4h]

  if ( BBSupportLib::g_iBBSIsDevelopmentMachine )
    return BBSupportLib::g_iBBSIsDevelopmentMachine > 0;
  if ( BBSupportIsDevelopmentMachine() )
    v1 = 1;
  else
    v1 = -1;
  BBSupportLib::g_iBBSIsDevelopmentMachine = v1;
  return BBSupportLib::g_iBBSIsDevelopmentMachine > 0;
}


// address=[0x2f30470]
// Decompiled from bool __stdcall BBSupportLib::BBSIsFullscreenWindow(HWND hWnd)
bool __stdcall BBSupportLib::BBSIsFullscreenWindow(struct HWND__ * hWnd) {
  
  int v3; // [esp+4h] [ebp-20h]
  int SystemMetrics; // [esp+8h] [ebp-1Ch]
  char v5; // [esp+Fh] [ebp-15h]
  struct tagRECT Rect; // [esp+10h] [ebp-14h] BYREF

  v5 = 0;
  if ( !hWnd )
    return v5;
  SystemMetrics = GetSystemMetrics(0);
  v3 = GetSystemMetrics(1);
  if ( SystemMetrics > 0 && v3 > 0 && GetWindowRect(hWnd, &Rect) )
    return !Rect.left && Rect.right == SystemMetrics && !Rect.top && Rect.bottom == v3;
  return v5;
}


// address=[0x2f30510]
// Decompiled from unsigned int __stdcall BBSupportLib::BBSCopyTextToClipboard(const char *Src)
void __stdcall BBSupportLib::BBSCopyTextToClipboard(char const * Src) {
  
  unsigned int result; // eax
  LPVOID v2; // [esp+0h] [ebp-Ch]
  HGLOBAL hMem; // [esp+4h] [ebp-8h]
  unsigned int v4; // [esp+8h] [ebp-4h]

  result = j__strlen(Src);
  v4 = result;
  if ( !result )
    return result;
  if ( result > 0x1000 )
    return result;
  result = OpenClipboard(0);
  if ( !result )
    return result;
  EmptyClipboard();
  hMem = GlobalAlloc(2u, v4 + 1);
  if ( !hMem )
    return CloseClipboard();
  v2 = GlobalLock(hMem);
  j__memcpy(v2, Src, v4 + 1);
  GlobalUnlock(hMem);
  SetClipboardData(1u, hMem);
  return CloseClipboard();
}


// address=[0x2f305b0]
// [Decompilation failed for void __stdcall BBSupportLib::BBSCopyTextToClipboard(wchar_t const *)]

// address=[0x2f30ca0]
// Decompiled from char __stdcall BBSupportLib::BBSCopyString<char>(int a1, char *a2, int a3)
void __stdcall BBSupportLib::BBSCopyString<char>(char * a1, char const * a2, unsigned int a3) {
  
  char result; // al
  unsigned int v4; // [esp+8h] [ebp-4h]
  unsigned int v5; // [esp+1Ch] [ebp+10h]

  result = a3 != 0 && a1 != 0;
  if ( !result )
    return result;
  v5 = a3 - 1;
  v4 = 0;
  result = *a2;
  if ( *a2 )
  {
    while ( v4 < v5 )
    {
      result = a2[v4];
      if ( !result )
        break;
      result = a2[v4];
      *(_BYTE *)(v4 + a1) = result;
      ++v4;
    }
  }
  *(_BYTE *)(v4 + a1) = 0;
  return result;
}


// address=[0x2f30da0]
// Decompiled from int __stdcall BBSupportLoadDbgHelpDll(int a1)
int __stdcall BBSupportLoadDbgHelpDll(int a1) {
  
  int v3; // [esp+8h] [ebp-4h]

  if ( !dword_4687124 )
  {
    sub_2F31570();
    sub_2F31630(a1);
  }
  if ( dword_4687124 <= 0 )
    v3 = 0;
  else
    v3 = dword_4687124;
  if ( dword_468712C <= 0 )
    return -v3;
  else
    return v3;
}


// address=[0x2f30e00]
// Decompiled from int BBSupportTraceDumpModules()
void __stdcall BBSupportTraceDumpModules(void) {
  
  ATL::CComCriticalSection *v0; // ecx
  int ModuleTimeDateStamp; // eax
  BOOL (__stdcall *Module32Next)(HANDLE, LPMODULEENTRY32); // [esp+0h] [ebp-23Ch]
  BOOL (__stdcall *Module32First)(HANDLE, LPMODULEENTRY32); // [esp+4h] [ebp-238h]
  HANDLE (__stdcall *CreateToolhelp32Snapshot)(DWORD, DWORD); // [esp+8h] [ebp-234h]
  HANDLE hObject; // [esp+Ch] [ebp-230h]
  HMODULE hModule; // [esp+10h] [ebp-22Ch]
  _DWORD v8[137]; // [esp+14h] [ebp-228h] BYREF

  CreateToolhelp32Snapshot = 0;
  Module32First = 0;
  Module32Next = 0;
  hModule = GetModuleHandleA("KERNEL32.DLL");
  if ( hModule )
  {
    CreateToolhelp32Snapshot = (HANDLE (__stdcall *)(DWORD, DWORD))GetProcAddress(hModule, "CreateToolhelp32Snapshot");
    Module32First = (BOOL (__stdcall *)(HANDLE, LPMODULEENTRY32))GetProcAddress(hModule, "Module32First");
    Module32Next = (BOOL (__stdcall *)(HANDLE, LPMODULEENTRY32))GetProcAddress(hModule, "Module32Next");
  }
  if ( !CreateToolhelp32Snapshot || !Module32First || !Module32Next )
    return BBSupportTracePrintF(2, "Failed to get snapshot functions!");
  hObject = CreateToolhelp32Snapshot(8, 0);
  if ( !hObject )
    return BBSupportTracePrintF(2, "Failed to get module snapshot!");
  memset(v8, 0, sizeof(v8));
  v8[0] = 548;
  if ( Module32First(hObject, (LPMODULEENTRY32)v8) )
  {
    do
    {
      ModuleTimeDateStamp = BBSupportGetModuleTimeDateStamp(v0);
      BBSupportTracePrintF(1, "0x%08x (0x%08x) %s (0x%08x)", v8[5], v8[6], (const char *)&v8[8], ModuleTimeDateStamp);
    }
    while ( Module32Next(hObject, (LPMODULEENTRY32)v8) );
  }
  return CloseHandle(hObject);
}


// address=[0x2f31050]
// Decompiled from bool BBSupportLib::BBSSymbolHandlerInitialized()
bool __stdcall BBSupportLib::BBSSymbolHandlerInitialized(void) {
  
  return dword_468712C > 0;
}


// address=[0x2f31080]
// Decompiled from HANDLE BBSupportLib::BBSSymbolHandlerProcessHandle()
void * __stdcall BBSupportLib::BBSSymbolHandlerProcessHandle(void) {
  
  if ( dword_468712C <= 0 )
    return 0;
  else
    return TargetHandle;
}


// address=[0x2f310b0]
// Decompiled from int __userpurge BBSupportLib::BBSGetSymbolAndLine@<eax>(CHAR *this, char *a2, unsigned int a3)
int __stdcall BBSupportLib::BBSGetSymbolAndLine(char * a2, unsigned int a3) {
  
  int v3; // eax
  int v4; // eax
  _DWORD v6[5]; // [esp+10h] [ebp-44Ch] BYREF
  int v7; // [esp+24h] [ebp-438h] BYREF
  const char *v8; // [esp+28h] [ebp-434h]
  int v9; // [esp+2Ch] [ebp-430h] BYREF
  BOOL v10; // [esp+30h] [ebp-42Ch]
  BOOL v11; // [esp+34h] [ebp-428h]
  const char *v12; // [esp+38h] [ebp-424h]
  int v13; // [esp+3Ch] [ebp-420h]
  _DWORD v14[256]; // [esp+40h] [ebp-41Ch] BYREF
  CPPEH_RECORD ms_exc; // [esp+444h] [ebp-18h]

  v13 = 0;
  v11 = this != 0;
  v10 = dword_468712C > 0;
  if ( !v10 || !v11 )
    return v13;
  ms_exc.registration.TryLevel = 0;
  *this = 0;
  memset(v14, 0, sizeof(v14));
  v12 = (const char *)v14;
  v14[0] = 24;
  v14[4] = 999;
  v9 = 0;
  if ( dword_468714C(TargetHandle, a2, &v9, v14) )
  {
    v3 = _wsprintfA(&this[v13], "%s+%u", v12 + 20, v9);
    v13 += v3;
  }
  memset(v6, 0, sizeof(v6));
  v6[0] = 20;
  v7 = 0;
  if ( dword_4687150(TargetHandle, a2, &v7, v6) )
  {
    if ( v13 <= 0 )
      v8 = (const char *)&unk_3AB9E15;
    else
      v8 = "  ";
    v4 = _wsprintfA(&this[v13], "%s%s(%u)", v8, (const char *)v6[3], v6[2]);
    v13 += v4;
  }
  ms_exc.registration.TryLevel = -2;
  return v13;
}


// address=[0x2f312e0]
// Decompiled from bool BBSupportLib::BBSTraceStackDump()
bool __stdcall BBSupportLib::BBSTraceStackDump(void) {
  
  HANDLE v0; // eax
  HANDLE CurrentThread; // [esp-18h] [ebp-34h]
  HANDLE CurrentProcess; // [esp-14h] [ebp-30h]
  DWORD ThreadId; // [esp+4h] [ebp-18h] BYREF
  BOOL v5; // [esp+8h] [ebp-14h]
  DWORD ExitCode; // [esp+Ch] [ebp-10h] BYREF
  HANDLE TargetHandle; // [esp+10h] [ebp-Ch] BYREF
  HANDLE hHandle; // [esp+14h] [ebp-8h]
  bool v9; // [esp+1Bh] [ebp-1h]

  v9 = 0;
  if ( !_InterlockedIncrement(&dword_3E2E234) && BBSupportLib::BBSSymbolHandlerInitialized() )
  {
    TargetHandle = 0;
    CurrentProcess = GetCurrentProcess();
    CurrentThread = GetCurrentThread();
    v0 = GetCurrentProcess();
    if ( DuplicateHandle(v0, CurrentThread, CurrentProcess, &TargetHandle, 0, 0, 2u) )
    {
      hHandle = 0;
      ThreadId = 0;
      hHandle = CreateThread(0, 0, StartAddress, TargetHandle, 0, &ThreadId);
      if ( hHandle )
      {
        WaitForSingleObject(hHandle, 0xFFFFFFFF);
        ExitCode = 0;
        v5 = GetExitCodeThread(hHandle, &ExitCode) && ExitCode;
        v9 = v5;
        CloseHandle(hHandle);
      }
      CloseHandle(TargetHandle);
    }
  }
  _InterlockedDecrement(&dword_3E2E234);
  return v9;
}


// address=[0x2f32070]
// Decompiled from bool __cdecl TGetProcAddress<int __stdcall (unsigned long,void *,void *,_tagSTACKFRAME *,void *,int (__stdcall *)(void *,unsigned long,void *,unsigned long,unsigned long *),void * (__stdcall *)(void *,unsigned long),unsigned long (__stdcall *)(void *,unsigned long),unsigned long (__stdcall *)(void *,void *,_tagADDRESS *))>(  FARPROC *a1,  HMODULE hModule,  LPCSTR lpProcName)
bool __cdecl TGetProcAddress<int __stdcall(unsigned long a1, void * hModule, void * lpProcName, struct _tagSTACKFRAME * a4, void * a5, int (__stdcall*)(void *,unsigned long,void *,unsigned long,unsigned long *) a6, void * (__stdcall*)(void *,unsigned long) a7, unsigned long (__stdcall*)(void *,unsigned long) a8, unsigned long (__stdcall*)(void *,void *,struct _tagADDRESS *))>(int (__stdcall*&)(unsigned long,void *,void *,struct _tagSTACKFRAME *,void *,int (__stdcall*)(void *,unsigned long,void *,unsigned long,unsigned long *),void * (__stdcall*)(void *,unsigned long),unsigned long (__stdcall*)(void *,unsigned long),unsigned long (__stdcall*)(void *,void *,struct _tagADDRESS *)),struct HINSTANCE__ *,char const * a9) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f320c0]
// Decompiled from bool __cdecl TGetProcAddress<int __stdcall (void *)>(FARPROC *a1, HMODULE hModule, LPCSTR lpProcName)
bool __cdecl TGetProcAddress<int __stdcall(void *)>(int (__stdcall*&)(void *),struct HINSTANCE__ *,char const * a1) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f32110]
// Decompiled from bool __cdecl TGetProcAddress<int __stdcall (void *,unsigned long,unsigned long *,_IMAGEHLP_LINE *)>(  FARPROC *a1,  HMODULE hModule,  LPCSTR lpProcName)
bool __cdecl TGetProcAddress<int __stdcall(void * a1, unsigned long hModule, unsigned long * lpProcName, struct _IMAGEHLP_LINE *)>(int (__stdcall*&)(void *,unsigned long,unsigned long *,struct _IMAGEHLP_LINE *),struct HINSTANCE__ *,char const * a4) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f32160]
// Decompiled from bool __cdecl TGetProcAddress<int __stdcall (void *,unsigned long,unsigned long *,_IMAGEHLP_SYMBOL *)>(  FARPROC *a1,  HMODULE hModule,  LPCSTR lpProcName)
bool __cdecl TGetProcAddress<int __stdcall(void * a1, unsigned long hModule, unsigned long * lpProcName, struct _IMAGEHLP_SYMBOL *)>(int (__stdcall*&)(void *,unsigned long,unsigned long *,struct _IMAGEHLP_SYMBOL *),struct HINSTANCE__ *,char const * a4) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f321b0]
// Decompiled from bool __cdecl TGetProcAddress<int __stdcall (void *,char *,int)>(FARPROC *a1, HMODULE hModule, LPCSTR lpProcName)
bool __cdecl TGetProcAddress<int __stdcall(void * a1, char * hModule, int)>(int (__stdcall*&)(void *,char *,int),struct HINSTANCE__ *,char const * lpProcName) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f32200]
// Decompiled from bool __cdecl TGetProcAddress<int __stdcall (void *,wchar_t const *)>(FARPROC *a1, HMODULE hModule, LPCSTR lpProcName)
bool __cdecl TGetProcAddress<int __stdcall(void * a1, wchar_t const *)>(int (__stdcall*&)(void *,wchar_t const *),struct HINSTANCE__ *,char const * hModule) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f32250]
// Decompiled from bool __cdecl TGetProcAddress<unsigned long __stdcall (unsigned long)>(FARPROC *a1, HMODULE hModule, LPCSTR lpProcName)
bool __cdecl TGetProcAddress<unsigned long __stdcall(unsigned long)>(unsigned long (__stdcall*&)(unsigned long),struct HINSTANCE__ *,char const * a1) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f322a0]
// Decompiled from bool __cdecl TGetProcAddress<unsigned long __stdcall (void *,unsigned long)>(  FARPROC *a1,  HMODULE hModule,  LPCSTR lpProcName)
bool __cdecl TGetProcAddress<unsigned long __stdcall(void * a1, unsigned long)>(unsigned long (__stdcall*&)(void *,unsigned long),struct HINSTANCE__ *,char const * hModule) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f322f0]
// Decompiled from bool __cdecl TGetProcAddress<API_VERSION * __stdcall (void)>(FARPROC *a1, HMODULE hModule, LPCSTR lpProcName)
bool __cdecl TGetProcAddress<struct API_VERSION * __stdcall(void)>(struct API_VERSION * (__stdcall*&)(void),struct HINSTANCE__ *,char const * a1) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f32340]
// Decompiled from bool __cdecl TGetProcAddress<void * __stdcall (void *,unsigned long)>(FARPROC *a1, HMODULE hModule, LPCSTR lpProcName)
bool __cdecl TGetProcAddress<void * __stdcall(void * a1, unsigned long)>(void * (__stdcall*&)(void *,unsigned long),struct HINSTANCE__ *,char const * hModule) {
  
  *a1 = GetProcAddress(hModule, lpProcName);
  return *a1 != 0;
}


// address=[0x2f32390]
// Decompiled from LPTOP_LEVEL_EXCEPTION_FILTER BBSupportActivateUnhandledExceptionFilter()
void __stdcall BBSupportActivateUnhandledExceptionFilter(void) {
  
  BBSupportSetErrorHandlingMode(-1);
  return SetUnhandledExceptionFilter(__scrt_is_nonwritable_in_current_image);
}


// address=[0x2f323b0]
// [Decompilation failed for void __stdcall BBSupportActivateSETranslator(void)]

// address=[0x2f33210]
// Decompiled from void __cdecl __noreturn SETranslator(int a1, struct _EXCEPTION_POINTERS *ExceptionInfo)
void __cdecl SETranslator(unsigned int a1, struct _EXCEPTION_POINTERS * ExceptionInfo) {
  
  if ( !__scrt_is_nonwritable_in_current_image(ExceptionInfo) )
    sub_2F32EC0(ExceptionInfo);
  ExitProcess(1u);
}


// address=[0x2f33610]
// Decompiled from _PNH BBSupportActivateNewHandler()
void __stdcall BBSupportActivateNewHandler(void) {
  
  j___set_new_mode(0);
  if ( !dword_4687168 )
    dword_4687168 = (int)j__malloc(0x400u);
  return j___set_new_handler(NewHandler);
}


// address=[0x2f33650]
// [Decompilation failed for void * __stdcall BBMalloc(unsigned int)]

// address=[0x2f33680]
// [Decompilation failed for void __stdcall BBFree(void *)]

// address=[0x2f34640]
// Decompiled from int BBSupportLib::BBSGetSupportFlags()
int __stdcall BBSupportLib::BBSGetSupportFlags(void) {
  
  if ( BBSupportLib::g_iBBSSupportFlags < 0 )
    return BBSupportLib::BBSGetSupportFlagsEx();
  else
    return BBSupportLib::g_iBBSSupportFlags;
}


// address=[0x2f49cf0]
// [Decompilation failed for double __cdecl min(double,double)]

// address=[0x2f5a380]
// Decompiled from int GetGfxInterfaceVersion()
unsigned int __cdecl GetGfxInterfaceVersion(void) {
  
  return 229;
}


// address=[0x2f5d0f0]
// Decompiled from int __cdecl ConvertMapIndexToScreenPosition(__int64 a1, int *a2, int *a3, int *a4, int *a5)
void __cdecl ConvertMapIndexToScreenPosition(int a1, int a2, int & a3, int & a4, int & a5, int & a6) {
  
  int result; // eax
  int v6; // [esp+8h] [ebp-24h]
  int v7; // [esp+Ch] [ebp-20h]
  int v8; // [esp+10h] [ebp-1Ch]
  int v9; // [esp+14h] [ebp-18h]
  int v10; // [esp+18h] [ebp-14h]
  int v11; // [esp+1Ch] [ebp-10h]
  int v12; // [esp+20h] [ebp-Ch]
  int v13; // [esp+24h] [ebp-8h]
  unsigned __int8 *v14; // [esp+28h] [ebp-4h]

  result = dword_3E2E2A0;
  v14 = (unsigned __int8 *)dword_3E2E2A0;
  if ( dword_3E2E2A0 )
  {
    *a3 = -8 * dword_3E2E290 - (dword_3E2E2B4 << 16);
    *a3 += dword_3E2E290 * (HIDWORD(a1) - (dword_3E2E2AC - 7));
    if ( (a1 & 0x100000000LL) != 0 )
    {
      *a2 = (dword_3E2E2BC - dword_3E2E2B0 - (dword_3E2E28C >> 16) - ((30 * dword_3E2E28C) >> 16)) << 16;
      v12 = 1;
    }
    else
    {
      *a2 = ((dword_3E2E2BC - dword_3E2E2B0 - (dword_3E2E28C >> 16) - ((30 * dword_3E2E28C) >> 16)) << 16)
          + -dword_3E2E28C / 2;
      v12 = 0;
    }
    *a2 += dword_3E2E28C * (a1 - v12 - (dword_3E2E2A8 + SHIDWORD(a1) / 2 - 30));
    if ( (int)(HIDWORD(a1) | a1) >= 0 && (int)a1 < (int)Size && SHIDWORD(a1) < (int)Size )
      v14 += 4 * a1 + 4 * Size * HIDWORD(a1);
    v13 = (int)CalcFinalHeightOffset(*v14) >> 16;
    *a3 -= v13 << 16;
    *a2 >>= 16;
    *a3 >>= 16;
    if ( (int)a1 > 0 && SHIDWORD(a1) > 0 )
    {
      v11 = (int)CalcFinalHeightOffset(v14[-4 * Size]) >> 16;
      v10 = (int)CalcFinalHeightOffset(v14[-4 * Size - 4]) >> 16;
      if ( v11 >= v10 )
        v9 = v10;
      else
        v9 = v11;
      *a4 = ((dword_3E2E290 >> 16) - (v13 - v9)) / 2;
    }
    else
    {
      *a4 = (dword_3E2E290 >> 16) / 2;
    }
    if ( (int)a1 < (int)(Size - 1) && SHIDWORD(a1) < (int)(Size - 1) )
    {
      v8 = (int)CalcFinalHeightOffset(v14[4 * Size + 4]) >> 16;
      v7 = (int)CalcFinalHeightOffset(v14[4 * Size]) >> 16;
      if ( v8 <= v7 )
        v6 = v7;
      else
        v6 = v8;
      result = ((dword_3E2E290 >> 16) - (v13 - v6)) / 2;
      *a5 = result;
    }
    else
    {
      result = (dword_3E2E290 >> 16) / 2;
      *a5 = result;
    }
  }
  else
  {
    *a3 = 0;
    *a2 = 0;
  }
  return result;
}


// address=[0x2f5d3a0]
// Decompiled from int *__cdecl ConvertMapIndexToScreenPosition(__int64 a1, int *a2, int *a3)
void __cdecl ConvertMapIndexToScreenPosition(int a1, int a2, int & a3, int & a4) {
  
  int *result; // eax
  int v4; // [esp+8h] [ebp-8h]
  unsigned __int8 *v5; // [esp+Ch] [ebp-4h]

  result = (int *)dword_3E2E2A0;
  v5 = (unsigned __int8 *)dword_3E2E2A0;
  if ( dword_3E2E2A0 )
  {
    *a3 = -8 * dword_3E2E290 - (dword_3E2E2B4 << 16);
    *a3 += dword_3E2E290 * (HIDWORD(a1) - (dword_3E2E2AC - 7));
    if ( (a1 & 0x100000000LL) != 0 )
    {
      *a2 = (dword_3E2E2BC - dword_3E2E2B0 - (dword_3E2E28C >> 16) - ((30 * dword_3E2E28C) >> 16)) << 16;
      v4 = 1;
    }
    else
    {
      *a2 = ((dword_3E2E2BC - dword_3E2E2B0 - (dword_3E2E28C >> 16) - ((30 * dword_3E2E28C) >> 16)) << 16)
          + -dword_3E2E28C / 2;
      v4 = 0;
    }
    *a2 += dword_3E2E28C * (a1 - v4 - (dword_3E2E2A8 + SHIDWORD(a1) / 2 - 30));
    if ( (int)(HIDWORD(a1) | a1) >= 0 && (int)a1 < (int)Size && SHIDWORD(a1) < (int)Size )
      v5 += 4 * a1 + 4 * Size * HIDWORD(a1);
    *a3 -= CalcFinalHeightOffset(*v5);
    *a2 >>= 16;
    result = a3;
    *a3 >>= 16;
  }
  else
  {
    *a3 = 0;
    *a2 = 0;
  }
  return result;
}


// address=[0x2f5d520]
// Decompiled from int __cdecl CalculateDistance(int a1, int a2, int a3, int a4)
int __cdecl CalculateDistance(int a1, int a2, int a3, int a4) {
  
  return (a4 - a2) * (a4 - a2) + (a3 - a1) * (a3 - a1);
}


// address=[0x2f5d550]
// Decompiled from size_t __cdecl SearchMapPoint(int a1, int a2, int *a3, int *a4, bool a5)
int __cdecl SearchMapPoint(int a1, int a2, int & a3, int & a4, bool a5) {
  
  float v6; // xmm0_4
  __int64 v7; // [esp-18h] [ebp-98h]
  __int64 v8; // [esp-10h] [ebp-90h]
  int v9; // [esp+8h] [ebp-78h]
  int v10; // [esp+Ch] [ebp-74h]
  int v11; // [esp+10h] [ebp-70h]
  int v12; // [esp+14h] [ebp-6Ch] BYREF
  int v13; // [esp+18h] [ebp-68h] BYREF
  int v14; // [esp+1Ch] [ebp-64h]
  int v15; // [esp+20h] [ebp-60h]
  int v16; // [esp+24h] [ebp-5Ch]
  float v17; // [esp+28h] [ebp-58h]
  unsigned int NewValue; // [esp+2Ch] [ebp-54h]
  int v19; // [esp+30h] [ebp-50h]
  int v20; // [esp+34h] [ebp-4Ch]
  int v21; // [esp+38h] [ebp-48h]
  int v22; // [esp+3Ch] [ebp-44h] BYREF
  int i; // [esp+40h] [ebp-40h]
  int Number; // [esp+44h] [ebp-3Ch]
  int v25; // [esp+48h] [ebp-38h] BYREF
  int v26; // [esp+4Ch] [ebp-34h]
  int v27; // [esp+50h] [ebp-30h]
  int v28; // [esp+54h] [ebp-2Ch] BYREF
  int v29; // [esp+58h] [ebp-28h] BYREF
  char v30; // [esp+5Fh] [ebp-21h]
  int v31; // [esp+60h] [ebp-20h]
  int v32; // [esp+64h] [ebp-1Ch]
  int v33; // [esp+68h] [ebp-18h]
  int v34; // [esp+6Ch] [ebp-14h]
  int v35; // [esp+70h] [ebp-10h]
  int v36; // [esp+74h] [ebp-Ch]
  int v37; // [esp+78h] [ebp-8h]
  int v38; // [esp+88h] [ebp+8h]
  int v39; // [esp+8Ch] [ebp+Ch]

  if ( dword_3E2E2A0 )
  {
    NewValue = j___controlfp(0x300u, 0x300u);
    v27 = a2;
    v26 = a1;
    v38 = a1 + dword_3E2E2B0 + (dword_3E2E28C >> 17);
    v39 = a2 + dword_3E2E2B4 + (dword_3E2E290 >> 17);
    if ( g_iCameraMode == 1 )
      v39 *= 2;
    *a4 = v39 / (dword_3E2E28C >> 16) + dword_3E2E2AC + 1;
    if ( (*a4 & 1) != 0 )
      v25 = dword_3E2E2BC - dword_3E2E2B0 - (dword_3E2E28C >> 16) - ((30 * dword_3E2E28C) >> 16);
    else
      v25 = dword_3E2E2BC - dword_3E2E2B0 - (dword_3E2E28C >> 16) - ((30 * dword_3E2E28C) >> 16) - (dword_3E2E28C >> 17);
    *a3 = dword_3E2E2A8 + *a4 / 2 - 30 + (v38 - v25) / (dword_3E2E28C >> 16);
    if ( *a3 >= 0 && *a4 >= 0 && *a3 < (int)Size && *a4 < (int)Size )
    {
      v14 = (dword_3E2E28C >> 16) / 2 + 1;
      v21 = 5;
      v17 = FLOAT_0_75;
      if ( !g_iCameraMode )
        v17 = FLOAT_0_375;
      do
      {
        HIDWORD(v7) = *a4;
        LODWORD(v7) = *a3;
        ConvertMapIndexToScreenPosition(v7, &v25, &v22, &v13, &v12);
        v11 = (int)(float)((float)(v27 - v22) / (float)((float)((float)(dword_3E2E28C >> 16) / 32.0) * 1.65));
        Number = (int)(float)((float)(v11 / 7) * v17);
        if ( v26 - v25 >= 0 )
          v6 = (float)((float)(v26 - v25) / (float)(dword_3E2E28C >> 16)) + 0.5;
        else
          v6 = (float)((float)(v26 - v25) / (float)(dword_3E2E28C >> 16)) - 0.5;
        v19 = (int)v6;
        v30 = 1;
        if ( j__abs(Number) <= 0 || v27 >= v22 - v13 && v27 < v12 + v22 )
        {
          v16 = Number <= 1;
          if ( j__abs(v16) && (v15 = v19 != 0, j__abs(v15)) && (v26 < v25 - v14 || v26 >= v14 + v25) )
          {
            *a3 += v19;
            v30 = 0;
          }
          else if ( (v27 < v22 - v13 || v27 > v12 + v22) && --v21 >= 0 )
          {
            if ( j__abs(Number) < 1 )
            {
              if ( v11 >= 0 )
                Number = 1;
              else
                Number = -1;
            }
            *a4 += Number;
            v30 = 0;
          }
        }
        else
        {
          *a4 += Number;
          *a3 += Number / 2;
          v30 = 0;
        }
        if ( (*a4 | *a3) < 0 || *a3 >= (int)Size || *a4 >= (int)Size )
        {
          BBSupportTracePrintF(1, "GFX ENGINE: Error while calculating coordinates!");
          *a4 = 0;
          *a3 = 0;
          j___controlfp(NewValue, 0x300u);
          return -1;
        }
      }
      while ( !v30 && v21 >= 0 );
      v31 = 30000;
      v32 = 30000;
      v33 = 30000;
      v34 = 30000;
      v35 = 30000;
      v36 = 30000;
      v37 = 30000;
      v31 = CalculateDistance(v28, v29, v26, v27);
      if ( *a3 > 0 )
      {
        HIDWORD(v8) = *a4;
        LODWORD(v8) = *a3 - 1;
        ConvertMapIndexToScreenPosition(v8, &v28, &v29);
        v32 = CalculateDistance(v28, v29, v26, v27);
      }
      if ( *a3 < (int)(Size - 1) )
        v33 = CalculateDistance(v28, v29, v26, v27);
      if ( *a4 > 0 )
        v34 = CalculateDistance(v28, v29, v26, v27);
      if ( *a4 > 0 && *a3 > 0 )
        v35 = CalculateDistance(v28, v29, v26, v27);
      if ( *a4 < (int)(Size - 1) && *a3 < (int)(Size - 1) )
        v36 = CalculateDistance(v28, v29, v26, v27);
      if ( *a4 < (int)(Size - 1) )
        v37 = CalculateDistance(v28, v29, v26, v27);
      v10 = 30000;
      v9 = 0;
      for ( i = 0; i < 7; ++i )
      {
        if ( *(&v31 + i) < v10 )
        {
          v10 = *(&v31 + i);
          v9 = i;
        }
      }
      v20 = v9 - 1;
      switch ( v9 )
      {
        case 1:
          --*a3;
          break;
        case 2:
          ++*a3;
          break;
        case 3:
          --*a4;
          break;
        case 4:
          --*a4;
          --*a3;
          break;
        case 5:
          ++*a4;
          ++*a3;
          break;
        case 6:
          ++*a4;
          break;
        default:
          break;
      }
      j___controlfp(NewValue, 0x300u);
      return *a3 + Size * *a4;
    }
    else
    {
      if ( !a5 )
      {
        *a4 = 0;
        *a3 = 0;
      }
      j___controlfp(NewValue, 0x300u);
      return -1;
    }
  }
  else
  {
    *a4 = 0;
    *a3 = 0;
    return -1;
  }
}


// address=[0x2f5dd20]
// Decompiled from int InitGradientTable()
void __cdecl InitGradientTable(void) {
  
  int result; // eax
  int i; // [esp+0h] [ebp-4h]

  for ( i = 0; i < 512; ++i )
  {
    g_iDestSizeTable[i] = (int)(float)((float)i * *(float *)&dword_3E2E2F4);
    result = i + 1;
  }
  return result;
}


// address=[0x2f5dd60]
// Decompiled from int InitCamGradientTable()
void __cdecl InitCamGradientTable(void) {
  
  int result; // eax
  int i; // [esp+0h] [ebp-4h]

  for ( i = 0; i < 512; ++i )
  {
    g_iCamDestSizeTable[i] = (int)(float)((float)i * *(float *)&dword_3E2E2F8);
    result = i + 1;
  }
  return result;
}


// address=[0x2f5dda0]
// Decompiled from BOOL RenderTmpText()
void __cdecl RenderTmpText(void) {
  
  BOOL result; // eax
  size_t v1; // eax
  size_t v2; // eax
  HGDIOBJ v3; // [esp+0h] [ebp-Ch]
  HFONT h; // [esp+4h] [ebp-8h]
  HDC hdc; // [esp+8h] [ebp-4h] BYREF

  result = 1;
  if ( !g_cTextTmp[0] )
    return result;
  ((void (__thiscall *)(CSurfaceV7 *, HDC *))D3DObjectPtr->FinalRenderSurface->j_?GetDC@CSurfaceV7@@UAEJPAPAUHDC__@@@Z)(
    D3DObjectPtr->FinalRenderSurface,
    &hdc);
  SetBkMode(hdc, 1);
  SetTextColor(hdc, g_iTextTmpColor);
  SetTextAlign(hdc, 0x18u);
  h = CreateFontA(g_iTextTmpWidth, g_iTextTmpHeight, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0x20u, 0);
  v3 = SelectObject(hdc, h);
  v1 = j__strlen(g_cTextTmp);
  TextOutA(hdc, g_iTextTmpPosX, g_iTextTmpPosY, g_cTextTmp, v1);
  v2 = j__strlen("Hallo");
  TextOutA(hdc, 50, 50, "Hallo", v2);
  SelectObject(hdc, v3);
  ((void (__thiscall *)(CSurfaceV7 *, HDC))D3DObjectPtr->FinalRenderSurface->j_?ReleaseDC@CSurfaceV7@@UAEJPAUHDC__@@@Z)(
    D3DObjectPtr->FinalRenderSurface,
    hdc);
  return DeleteObject(h);
}


// address=[0x2f5dee0]
// Decompiled from void __cdecl EnableCamRenderSettings(bool a1)
void __cdecl EnableCamRenderSettings(bool) {
  
  if ( a1 )
  {
    SetObjectMovement(dword_3E2E2D4, dword_3E2E2D8);
    dword_3E2E284 = dword_3E2E2D4;
    dword_3E2E288 = dword_3E2E2D8;
    g_pDestSizeTable = (int)&g_iCamDestSizeTable;
    g_pZoomGradient = (int)&g_iCamZoomGradient;
  }
  else
  {
    SetObjectMovement(0, 0);
    dword_3E2E288 = 0;
    dword_3E2E284 = 0;
    g_pDestSizeTable = (int)&g_iDestSizeTable;
    g_pZoomGradient = (int)&g_iZoomGradient;
  }
  Swap32Bit(&dword_3E2E2C4, &dword_3E2E2A8);
  Swap32Bit(&dword_3E2E2C8, &dword_3E2E2AC);
  Swap32Bit(&dword_3E2E2CC, &dword_3E2E2B0);
  Swap32Bit(&dword_3E2E2D0, &dword_3E2E2B4);
  Swap32Bit(&dword_3E2E294, &dword_3E2E28C);
  Swap32Bit(&dword_3E2E298, &dword_3E2E290);
  Swap32Bit(&dword_3E2E2D4, &WindowPositionX);
  Swap32Bit(&dword_3E2E2D8, &WindowPositionY);
  Swap32Bit(&dword_3E2E2DC, &OutputWidth);
  Swap32Bit(&dword_3E2E2E0, &OutputHeight);
  Swap32Bit(&unk_3E2E2C0, &dword_3E2E2BC);
  Swap32Bit(&dword_3E2E2F8, &dword_3E2E2F4);
  Swap32Bit(&g_fCamVertexSize, &g_fVertexSize);
}


// address=[0x2f5f2f0]
// Decompiled from int __cdecl CalcFinalHeightOffset(int a1)
int __cdecl CalcFinalHeightOffset(int a1) {
  
  return (int)(float)((float)((float)a1 * 0.051562499) * *(float *)&g_fVertexSize);
}


// address=[0x2f5f320]
// Decompiled from int __cdecl CalcStaticHeightOffset(int a1)
int __cdecl CalcStaticHeightOffset(int a1) {
  
  return (int)(float)((float)((float)a1 * 0.051562499) * 24.0);
}


// address=[0x2f5f350]
// Decompiled from int __cdecl CalcStaticHeightOffsetInt(int a1)
int __cdecl CalcStaticHeightOffsetInt(int a1) {
  
  return (81024 * a1) >> 16;
}


// address=[0x2f5f440]
// Decompiled from int __cdecl Swap32Bit(int *a1, int *a2)
void __cdecl Swap32Bit(void * a1, void * a2) {
  
  int result; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = *a2;
  *a2 = *a1;
  result = v3;
  *a1 = v3;
  return result;
}


// address=[0x2f5f510]
// Decompiled from char __cdecl ReadTextureBitmap(int a1, char *Src, char a3, char a4)
bool __cdecl ReadTextureBitmap(int a1, void * Src, bool a3, bool a4) {
  
  _BYTE v5[4]; // [esp+0h] [ebp-Ch] BYREF
  void *v6; // [esp+4h] [ebp-8h] BYREF
  int v7; // [esp+8h] [ebp-4h]

  if ( a3 )
  {
    v7 = ((int (__thiscall *)(CSurfaceV7 *, _BYTE *, void **, _DWORD))D3DObjectPtr->LandscapeTextureTable[a1]->Lock)(
           D3DObjectPtr->LandscapeTextureTable[a1],
           v5,
           &v6,
           0);
    if ( v7 )
    {
      WriteError(v7, "LockTextureSurfaceForContentLoad");
      return 0;
    }
    if ( a4 )
      j__memcpy(v6, Src, 0x20000u);
    else
      j__memcpy(v6, Src, 0x8000u);
    v7 = ((int (__thiscall *)(CSurfaceV7 *))D3DObjectPtr->LandscapeTextureTable[a1]->Unlock)(D3DObjectPtr->LandscapeTextureTable[a1]);
    if ( v7 )
    {
      WriteError(v7, "UnlockTextureSurfaceForContentLoad");
      return 0;
    }
  }
  else
  {
    j__memcpy((void *)(g_pSoftwareTexturePages + (a1 << 16)), Src, 0x10000u);
    j__memcpy((char *)&g_uColorPalettes + 768 * a1, Src + 0x10000, 0x300u);
  }
  return 1;
}


// address=[0x2f5f640]
// [Decompilation failed for void __cdecl SetWindowPositionToRenderer(int,int)]

// address=[0x2f5f660]
// Decompiled from char __cdecl BlitRenderedSurfaceToDIB(HWND hWnd, HGDIOBJ h)
bool __cdecl BlitRenderedSurfaceToDIB(struct HWND__ * hWnd, struct HBITMAP__ * h) {
  
  if ( D3DObjectPtr && D3DObjectPtr->LandscapeSurface )
    return CInterfaceD3D::BlitSurfaceToDIB(hWnd, h);
  else
    return 0;
}


// address=[0x2f5f690]
// Decompiled from bool Initialize()
bool __cdecl Initialize(void) {
  
  CMFCPropertyGridProperty *v1; // [esp+Ch] [ebp-14h]
  CInterfaceD3D *C; // [esp+10h] [ebp-10h]

  if ( D3DObjectPtr )
  {
    BBSupportTracePrintF(1, "GFX ENGINE: Engine is already initialized!");
    return 0;
  }
  else
  {
    C = (CInterfaceD3D *)operator new(0x794u);
    if ( C )
      v1 = CInterfaceD3D::CInterfaceD3D(C);
    else
      v1 = 0;
    D3DObjectPtr = v1;
    if ( !v1 )
      BBSupportTracePrintF(1, "GFX ENGINE: GFX ENGINE: Couldn't create gfx engine interface object!");
    return D3DObjectPtr != 0;
  }
}


// address=[0x2f5f760]
// Decompiled from char DeleteEngine()
bool __cdecl DeleteEngine(void) {
  
  BBSupportTracePrintF(1, "GFX ENGINE: Begin destroying DD interface object.");
  if ( D3DObjectPtr )
  {
    delete D3DObjectPtr;
    D3DObjectPtr = 0;
    return 1;
  }
  else
  {
    BBSupportTracePrintF(1, "GFX ENGINE: Engine is not initialized!");
    return 0;
  }
}


// address=[0x2f5f7d0]
// Decompiled from bool HardwareIsRunning()
bool __cdecl HardwareIsRunning(void) {
  
  return D3DObjectPtr && D3DObjectPtr->field_71D;
}


// address=[0x2f5f810]
// Decompiled from bool SoftwareIsRunning()
bool __cdecl SoftwareIsRunning(void) {
  
  return D3DObjectPtr && D3DObjectPtr->field_71C;
}


// address=[0x2f606c0]
// Decompiled from char __cdecl ReadTextureBitmapSet(bool a1, char a2, bool a3, int a4)
bool __cdecl ReadTextureBitmapSet(bool a1, bool a2, bool a3, int a4) {
  
  int v5; // [esp+0h] [ebp-18h]
  int k; // [esp+4h] [ebp-14h]
  int j; // [esp+8h] [ebp-10h]
  int i; // [esp+Ch] [ebp-Ch]
  int v9; // [esp+10h] [ebp-8h]
  char v10; // [esp+17h] [ebp-1h]

  if ( !g_pfForceReload )
    return 0;
  v9 = g_pfForceReload(1, (unsigned __int8)a2, a3);
  if ( !v9 )
    return 0;
  if ( *(unsigned __int8 *)(v9 + 3) != a4 )
    return 0;
  v10 = 1;
  while ( *(_DWORD *)(v9 + 4) && ((*(_WORD *)v9 & 2) != 0 && a1 || (*(_WORD *)v9 & 2) == 0 && !a1) )
    v9 += *(_DWORD *)(v9 + 4) + 8;
  if ( !*(_DWORD *)(v9 + 4) && ((*(_WORD *)v9 & 2) != 0 && a1 || (*(_WORD *)v9 & 2) == 0 && !a1) )
    return 0;
  v5 = v9 + 8;
  if ( a1 )
  {
    if ( a2 )
    {
      for ( i = 0; i < a4; ++i )
      {
        if ( !(unsigned __int8)ReadTextureBitmap(i, (void *)(v5 + (i << 17)), 1, a2) )
        {
          v10 = 0;
          break;
        }
      }
    }
    else
    {
      for ( j = 0; j < a4; ++j )
      {
        if ( !(unsigned __int8)ReadTextureBitmap(j, (void *)(v5 + (j << 15)), 1, 0) )
        {
          v10 = 0;
          break;
        }
      }
    }
  }
  else
  {
    for ( k = 0; k < a4; ++k )
    {
      if ( !(unsigned __int8)ReadTextureBitmap(k, (void *)(v5 + 66304 * k), 0, 1) )
      {
        v10 = 0;
        break;
      }
    }
  }
  g_pfForceReload(0, 1, dword_3E2E2B8 == 1);
  return v10;
}


// address=[0x2f608c0]
// Decompiled from int __cdecl WriteError(int a1, char *a2)
void __cdecl WriteError(int a1, char * a2) {
  
  char Buffer[200]; // [esp+4h] [ebp-CCh] BYREF

  if ( a1 > -2005532152 )
  {
    if ( a1 > -2005530624 )
    {
      if ( a1 > 0 )
        goto WriteError___def_33609C9;
      if ( a1 )
      {
        switch ( a1 )
        {
          case -2005530622:
            j__sprintf(Buffer, "D3DERR_COLORKEYATTACHED");
            break;
          case -2005530612:
            j__sprintf(Buffer, "D3DERR_VERTEXBUFFEROPTIMIZED");
            break;
          case -2005530611:
            j__sprintf(Buffer, "D3DERR_VBUF_CREATE_FAILED");
            break;
          case -2005530610:
            j__sprintf(Buffer, "D3DERR_VERTEXBUFFERLOCKED");
            break;
          case -2005530609:
            j__sprintf(Buffer, "D3DERR_VERTEXBUFFERUNLOCKFAILED");
            break;
          case -2005530602:
            j__sprintf(Buffer, "D3DERR_ZBUFFER_NOTPRESENT");
            break;
          case -2005530601:
            j__sprintf(Buffer, "D3DERR_STENCILBUFFER_NOTPRESENT");
            break;
          case -2005530600:
            j__sprintf(Buffer, "D3DERR_WRONGTEXTUREFORMAT");
            break;
          case -2005530599:
            j__sprintf(Buffer, "D3DERR_UNSUPPORTEDCOLOROPERATION");
            break;
          case -2005530598:
            j__sprintf(Buffer, "D3DERR_UNSUPPORTEDCOLORARG");
            break;
          case -2005530597:
            j__sprintf(Buffer, "D3DERR_UNSUPPORTEDALPHAOPERATION");
            break;
          case -2005530596:
            j__sprintf(Buffer, "D3DERR_UNSUPPORTEDALPHAARG");
            break;
          case -2005530595:
            j__sprintf(Buffer, "D3DERR_TOOMANYOPERATIONS");
            break;
          case -2005530594:
            j__sprintf(Buffer, "D3DERR_CONFLICTINGTEXTUREFILTER");
            break;
          case -2005530593:
            j__sprintf(Buffer, "D3DERR_UNSUPPORTEDFACTORVALUE");
            break;
          case -2005530591:
            j__sprintf(Buffer, "D3DERR_CONFLICTINGRENDERSTATE");
            break;
          case -2005530590:
            j__sprintf(Buffer, "D3DERR_UNSUPPORTEDTEXTUREFILTER");
            break;
          case -2005530589:
            j__sprintf(Buffer, "D3DERR_TOOMANYPRIMITIVES");
            break;
          case -2005530588:
            j__sprintf(Buffer, "D3DERR_INVALIDMATRIX");
            break;
          case -2005530586:
            j__sprintf(Buffer, "D3DERR_CONFLICTINGTEXTUREPALETTE");
            break;
          case -2005530572:
            j__sprintf(Buffer, "D3DERR_INVALIDSTATEBLOCK");
            break;
          case -2005530571:
            j__sprintf(Buffer, "D3DERR_INBEGINSTATEBLOCK");
            break;
          case -2005530570:
            j__sprintf(Buffer, "D3DERR_NOTINBEGINSTATEBLOCK");
            break;
          default:
            goto WriteError___def_33609C9;
        }
      }
      else
      {
        j__sprintf(Buffer, "DD_OK");
      }
    }
    else if ( a1 == -2005530624 )
    {
      j__sprintf(Buffer, "D3DERR_INVALIDVERTEXFORMAT");
    }
    else
    {
      switch ( a1 )
      {
        case -2005532151:
          j__sprintf(Buffer, "DDERR_INVALIDSTREAM");
          break;
        case -2005532135:
          j__sprintf(Buffer, "DDERR_VERTICALBLANKINPROGRESS");
          break;
        case -2005532132:
          j__sprintf(Buffer, "DDERR_WASSTILLDRAWING");
          break;
        case -2005532112:
          j__sprintf(Buffer, "DDERR_XALIGN");
          break;
        case -2005532111:
          j__sprintf(Buffer, "DDERR_INVALIDDIRECTDRAWGUID");
          break;
        case -2005532110:
          j__sprintf(Buffer, "DDERR_DIRECTDRAWALREADYCREATED");
          break;
        case -2005532109:
          j__sprintf(Buffer, "DDERR_NODIRECTDRAWHW");
          break;
        case -2005532108:
          j__sprintf(Buffer, "DDERR_PRIMARYSURFACEALREADYEXISTS");
          break;
        case -2005532107:
          j__sprintf(Buffer, "DDERR_NOEMULATION");
          break;
        case -2005532106:
          j__sprintf(Buffer, "DDERR_REGIONTOOSMALL");
          break;
        case -2005532105:
          j__sprintf(Buffer, "DDERR_CLIPPERISUSINGHWND");
          break;
        case -2005532104:
          j__sprintf(Buffer, "DDERR_NOCLIPPERATTACHED");
          break;
        case -2005532103:
          j__sprintf(Buffer, "DDERR_NOHWND");
          break;
        case -2005532102:
          j__sprintf(Buffer, "DDERR_HWNDSUBCLASSED");
          break;
        case -2005532101:
          j__sprintf(Buffer, "DDERR_HWNDALREADYSET");
          break;
        case -2005532100:
          j__sprintf(Buffer, "DDERR_NOPALETTEATTACHED");
          break;
        case -2005532099:
          j__sprintf(Buffer, "DDERR_NOPALETTEHW");
          break;
        case -2005532098:
          j__sprintf(Buffer, "DDERR_BLTFASTCANTCLIP");
          break;
        case -2005532097:
          j__sprintf(Buffer, "DDERR_NOBLTHW");
          break;
        case -2005532096:
          j__sprintf(Buffer, "DDERR_NODDROPSHW");
          break;
        case -2005532095:
          j__sprintf(Buffer, "DDERR_OVERLAYNOTVISIBLE");
          break;
        case -2005532093:
          j__sprintf(Buffer, "DDERR_INVALIDPOSITION");
          break;
        case -2005532092:
          j__sprintf(Buffer, "DDERR_NOTAOVERLAYSURFACE");
          break;
        case -2005532091:
          j__sprintf(Buffer, "DDERR_EXCLUSIVEMODEALREADYSET");
          break;
        case -2005532090:
          j__sprintf(Buffer, "DDERR_NOTFLIPPABLE");
          break;
        case -2005532089:
          j__sprintf(Buffer, "DDERR_CANTDUPLICATE");
          break;
        case -2005532088:
          j__sprintf(Buffer, "DDERR_NOTLOCKED");
          break;
        case -2005532087:
          j__sprintf(Buffer, "DDERR_CANTCREATEDC");
          break;
        case -2005532086:
          j__sprintf(Buffer, "DDERR_NODC");
          break;
        case -2005532085:
          j__sprintf(Buffer, "DDERR_WRONGMODE");
          break;
        case -2005532084:
          j__sprintf(Buffer, "DDERR_IMPLICITLYCREATED");
          break;
        case -2005532083:
          j__sprintf(Buffer, "DDERR_NOTPALETTIZED");
          break;
        case -2005532082:
          j__sprintf(Buffer, "DDERR_UNSUPPORTEDMODE");
          break;
        case -2005532081:
          j__sprintf(Buffer, "DDERR_NOMIPMAPHW");
          break;
        case -2005532080:
          j__sprintf(Buffer, "DDERR_INVALIDSURFACETYPE");
          break;
        case -2005532072:
          j__sprintf(Buffer, "DDERR_NOOPTIMIZEHW");
          break;
        case -2005532071:
          j__sprintf(Buffer, "DDERR_NOTLOADED");
          break;
        case -2005532070:
          j__sprintf(Buffer, "DDERR_NOFOCUSWINDOW");
          break;
        case -2005532052:
          j__sprintf(Buffer, "DDERR_DCALREADYCREATED");
          break;
        case -2005532042:
          j__sprintf(Buffer, "DDERR_NONONLOCALVIDMEM");
          break;
        case -2005532032:
          j__sprintf(Buffer, "DDERR_CANTPAGELOCK");
          break;
        case -2005532012:
          j__sprintf(Buffer, "DDERR_CANTPAGEUNLOCK");
          break;
        case -2005531992:
          j__sprintf(Buffer, "DDERR_NOTPAGELOCKED");
          break;
        case -2005531982:
          j__sprintf(Buffer, "DDERR_MOREDATA");
          break;
        case -2005531981:
          j__sprintf(Buffer, "DDERR_EXPIRED");
          break;
        case -2005531977:
          j__sprintf(Buffer, "DDERR_VIDEONOTACTIVE");
          break;
        case -2005531973:
          j__sprintf(Buffer, "DDERR_DEVICEDOESNTOWNSURFACE");
          break;
        case -2005531972:
          j__sprintf(Buffer, "D3DERR_BADMAJORVERSION");
          break;
        case -2005531971:
          j__sprintf(Buffer, "D3DERR_BADMINORVERSION");
          break;
        case -2005531967:
          j__sprintf(Buffer, "D3DERR_INVALID_DEVICE");
          break;
        case -2005531966:
          j__sprintf(Buffer, "D3DERR_INITFAILED");
          break;
        case -2005531965:
          j__sprintf(Buffer, "D3DERR_DEVICEAGGREGATED");
          break;
        case -2005531952:
          j__sprintf(Buffer, "D3DERR_TEXTURE_NO_SUPPORT");
          break;
        case -2005531951:
          j__sprintf(Buffer, "D3DERR_TEXTURE_CREATE_FAILED");
          break;
        case -2005531950:
          j__sprintf(Buffer, "D3DERR_TEXTURE_DESTROY_FAILED");
          break;
        case -2005531949:
          j__sprintf(Buffer, "D3DERR_TEXTURE_LOCK_FAILED");
          break;
        case -2005531948:
          j__sprintf(Buffer, "D3DERR_TEXTURE_UNLOCK_FAILED");
          break;
        case -2005531947:
          j__sprintf(Buffer, "D3DERR_TEXTURE_LOAD_FAILED");
          break;
        case -2005531946:
          j__sprintf(Buffer, "D3DERR_TEXTURE_SWAP_FAILED");
          break;
        case -2005531945:
          j__sprintf(Buffer, "D3DERR_TEXTURE_LOCKED");
          break;
        case -2005531944:
          j__sprintf(Buffer, "D3DERR_TEXTURE_NOT_LOCKED");
          break;
        case -2005531943:
          j__sprintf(Buffer, "D3DERR_TEXTURE_GETSURF_FAILED");
          break;
        case -2005531942:
          j__sprintf(Buffer, "D3DERR_MATRIX_CREATE_FAILED");
          break;
        case -2005531941:
          j__sprintf(Buffer, "D3DERR_MATRIX_DESTROY_FAILED");
          break;
        case -2005531940:
          j__sprintf(Buffer, "D3DERR_MATRIX_SETDATA_FAILED");
          break;
        case -2005531939:
          j__sprintf(Buffer, "D3DERR_MATRIX_GETDATA_FAILED");
          break;
        case -2005531938:
          j__sprintf(Buffer, "D3DERR_SETVIEWPORTDATA_FAILED");
          break;
        case -2005531937:
          j__sprintf(Buffer, "D3DERR_INVALIDCURRENTVIEWPORT");
          break;
        case -2005531936:
          j__sprintf(Buffer, "D3DERR_INVALIDPRIMITIVETYPE");
          break;
        case -2005531935:
          j__sprintf(Buffer, "D3DERR_INVALIDVERTEXTYPE");
          break;
        case -2005531934:
          j__sprintf(Buffer, "D3DERR_TEXTURE_BADSIZE");
          break;
        case -2005531933:
          j__sprintf(Buffer, "D3DERR_INVALIDRAMPTEXTURE");
          break;
        case -2005531932:
          j__sprintf(Buffer, "D3DERR_MATERIAL_CREATE_FAILED");
          break;
        case -2005531931:
          j__sprintf(Buffer, "D3DERR_MATERIAL_DESTROY_FAILED");
          break;
        case -2005531930:
          j__sprintf(Buffer, "D3DERR_MATERIAL_SETDATA_FAILED");
          break;
        case -2005531929:
          j__sprintf(Buffer, "D3DERR_MATERIAL_GETDATA_FAILED");
          break;
        case -2005531928:
          j__sprintf(Buffer, "D3DERR_INVALIDPALETTE");
          break;
        case -2005531927:
          j__sprintf(Buffer, "D3DERR_ZBUFF_NEEDS_SYSTEMMEMORY");
          break;
        case -2005531926:
          j__sprintf(Buffer, "D3DERR_ZBUFF_NEEDS_VIDEOMEMORY");
          break;
        case -2005531925:
          j__sprintf(Buffer, "D3DERR_SURFACENOTINVIDMEM");
          break;
        case -2005531922:
          j__sprintf(Buffer, "D3DERR_LIGHT_SET_FAILED");
          break;
        case -2005531921:
          j__sprintf(Buffer, "D3DERR_LIGHTHASVIEWPORT");
          break;
        case -2005531920:
          j__sprintf(Buffer, "D3DERR_LIGHTNOTINTHISVIEWPORT");
          break;
        case -2005531912:
          j__sprintf(Buffer, "D3DERR_SCENE_IN_SCENE");
          break;
        case -2005531911:
          j__sprintf(Buffer, "D3DERR_SCENE_NOT_IN_SCENE");
          break;
        case -2005531910:
          j__sprintf(Buffer, "D3DERR_SCENE_BEGIN_FAILED");
          break;
        case -2005531909:
          j__sprintf(Buffer, "D3DERR_SCENE_END_FAILED");
          break;
        case -2005531902:
          j__sprintf(Buffer, "D3DERR_INBEGIN");
          break;
        case -2005531901:
          j__sprintf(Buffer, "D3DERR_NOTINBEGIN");
          break;
        case -2005531900:
          j__sprintf(Buffer, "D3DERR_NOVIEWPORTS");
          break;
        case -2005531899:
          j__sprintf(Buffer, "D3DERR_VIEWPORTDATANOTSET");
          break;
        case -2005531898:
          j__sprintf(Buffer, "D3DERR_VIEWPORTHASNODEVICE");
          break;
        case -2005531897:
          j__sprintf(Buffer, "D3DERR_NOCURRENTVIEWPORT");
          break;
        default:
          goto WriteError___def_33609C9;
      }
    }
  }
  else if ( a1 == -2005532152 )
  {
    j__sprintf(Buffer, "DDERR_UNSUPPORTEDMASK");
  }
  else if ( a1 > -2005532667 )
  {
    if ( a1 > -2005532402 )
    {
      switch ( a1 )
      {
        case -2005532392:
          j__sprintf(Buffer, "DDERR_NORASTEROPHW");
          break;
        case -2005532382:
          j__sprintf(Buffer, "DDERR_NOROTATIONHW");
          break;
        case -2005532362:
          j__sprintf(Buffer, "DDERR_NOSTRETCHHW");
          break;
        case -2005532356:
          j__sprintf(Buffer, "DDERR_NOT4BITCOLOR");
          break;
        case -2005532355:
          j__sprintf(Buffer, "DDERR_NOT4BITCOLORINDEX");
          break;
        case -2005532352:
          j__sprintf(Buffer, "DDERR_NOT8BITCOLOR");
          break;
        case -2005532342:
          j__sprintf(Buffer, "DDERR_NOTEXTUREHW");
          break;
        case -2005532337:
          j__sprintf(Buffer, "DDERR_NOVSYNCHW");
          break;
        case -2005532332:
          j__sprintf(Buffer, "DDERR_NOZBUFFERHW");
          break;
        case -2005532322:
          j__sprintf(Buffer, "DDERR_NOZOVERLAYHW");
          break;
        case -2005532312:
          j__sprintf(Buffer, "DDERR_OUTOFCAPS");
          break;
        case -2005532292:
          j__sprintf(Buffer, "DDERR_OUTOFVIDEOMEMORY");
          break;
        case -2005532290:
          j__sprintf(Buffer, "DDERR_OVERLAYCANTCLIP");
          break;
        case -2005532288:
          j__sprintf(Buffer, "DDERR_OVERLAYCOLORKEYONLYONEACTIVE");
          break;
        case -2005532285:
          j__sprintf(Buffer, "DDERR_PALETTEBUSY");
          break;
        case -2005532272:
          j__sprintf(Buffer, "DDERR_COLORKEYNOTSET");
          break;
        case -2005532262:
          j__sprintf(Buffer, "DDERR_SURFACEALREADYATTACHED");
          break;
        case -2005532252:
          j__sprintf(Buffer, "DDERR_SURFACEALREADYDEPENDENT");
          break;
        case -2005532242:
          j__sprintf(Buffer, "DDERR_SURFACEBUSY");
          break;
        case -2005532237:
          j__sprintf(Buffer, "DDERR_CANTLOCKSURFACE");
          break;
        case -2005532232:
          j__sprintf(Buffer, "DDERR_SURFACEISOBSCURED");
          break;
        case -2005532222:
          j__sprintf(Buffer, "DDERR_SURFACELOST");
          break;
        case -2005532212:
          j__sprintf(Buffer, "DDERR_SURFACENOTATTACHED");
          break;
        case -2005532202:
          j__sprintf(Buffer, "DDERR_TOOBIGHEIGHT");
          break;
        case -2005532192:
          j__sprintf(Buffer, "DDERR_TOOBIGSIZE");
          break;
        case -2005532182:
          j__sprintf(Buffer, "DDERR_TOOBIGWIDTH");
          break;
        case -2005532162:
          j__sprintf(Buffer, "DDERR_UNSUPPORTEDFORMAT");
          break;
        default:
          goto WriteError___def_33609C9;
      }
    }
    else if ( a1 == -2005532402 )
    {
      j__sprintf(Buffer, "DDERR_OVERLAPPINGRECTS");
    }
    else
    {
      switch ( a1 )
      {
        case -2005532662:
          j__sprintf(Buffer, "DDERR_CANNOTATTACHSURFACE");
          break;
        case -2005532652:
          j__sprintf(Buffer, "DDERR_CANNOTDETACHSURFACE");
          break;
        case -2005532632:
          j__sprintf(Buffer, "DDERR_CURRENTLYNOTAVAIL");
          break;
        case -2005532617:
          j__sprintf(Buffer, "DDERR_EXCEPTION");
          break;
        case -2005532582:
          j__sprintf(Buffer, "DDERR_HEIGHTALIGN");
          break;
        case -2005532577:
          j__sprintf(Buffer, "DDERR_INCOMPATIBLEPRIMARY");
          break;
        case -2005532572:
          j__sprintf(Buffer, "DDERR_INVALIDCAPS");
          break;
        case -2005532562:
          j__sprintf(Buffer, "DDERR_INVALIDCLIPLIST");
          break;
        case -2005532552:
          j__sprintf(Buffer, "DDERR_INVALIDMODE");
          break;
        case -2005532542:
          j__sprintf(Buffer, "DDERR_INVALIDOBJECT");
          break;
        case -2005532527:
          j__sprintf(Buffer, "DDERR_INVALIDPIXELFORMAT");
          break;
        case -2005532522:
          j__sprintf(Buffer, "DDERR_INVALIDRECT");
          break;
        case -2005532512:
          j__sprintf(Buffer, "DDERR_LOCKEDSURFACES");
          break;
        case -2005532502:
          j__sprintf(Buffer, "DDERR_NO3D");
          break;
        case -2005532492:
          j__sprintf(Buffer, "DDERR_NOALPHAHW");
          break;
        case -2005532491:
          j__sprintf(Buffer, "DDERR_NOSTEREOHARDWARE");
          break;
        case -2005532490:
          j__sprintf(Buffer, "DDERR_NOSURFACELEFT");
          break;
        case -2005532467:
          j__sprintf(Buffer, "DDERR_NOCLIPLIST");
          break;
        case -2005532462:
          j__sprintf(Buffer, "DDERR_NOCOLORCONVHW");
          break;
        case -2005532460:
          j__sprintf(Buffer, "DDERR_NOCOOPERATIVELEVELSET");
          break;
        case -2005532457:
          j__sprintf(Buffer, "DDERR_NOCOLORKEY");
          break;
        case -2005532452:
          j__sprintf(Buffer, "DDERR_NOCOLORKEYHW");
          break;
        case -2005532450:
          j__sprintf(Buffer, "DDERR_NODIRECTDRAWSUPPORT");
          break;
        case -2005532447:
          j__sprintf(Buffer, "DDERR_NOEXCLUSIVEMODE");
          break;
        case -2005532442:
          j__sprintf(Buffer, "DDERR_NOFLIPHW");
          break;
        case -2005532432:
          j__sprintf(Buffer, "DDERR_NOGDI");
          break;
        case -2005532422:
          j__sprintf(Buffer, "DDERR_NOMIRRORHW");
          break;
        case -2005532417:
          j__sprintf(Buffer, "DDERR_NOTFOUND");
          break;
        case -2005532412:
          j__sprintf(Buffer, "DDERR_NOOVERLAYHW");
          break;
        default:
          goto WriteError___def_33609C9;
      }
    }
  }
  else if ( a1 == -2005532667 )
  {
    j__sprintf(Buffer, "DDERR_ALREADYINITIALIZED");
  }
  else if ( a1 > -2147221008 )
  {
    if ( a1 == -2147024882 )
    {
      j__sprintf(Buffer, "DDERR_OUTOFMEMORY");
    }
    else
    {
      if ( a1 != -2147024809 )
        goto WriteError___def_33609C9;
      j__sprintf(Buffer, "DDERR_INVALIDPARAMS");
    }
  }
  else
  {
    switch ( a1 )
    {
      case -2147221008:
        j__sprintf(Buffer, "DDERR_NOTINITIALIZED");
        break;
      case -2147467263:
        j__sprintf(Buffer, "DDERR_UNSUPPORTED");
        break;
      case -2147467259:
        j__sprintf(Buffer, "DDERR_GENERIC");
        break;
      default:
WriteError___def_33609C9:
        j__sprintf(Buffer, "UNKNOWN ERROR!");
        return BBSupportTracePrintF(1, "GFX ENGINE: %s: %s", a2, Buffer);
    }
  }
  return BBSupportTracePrintF(1, "GFX ENGINE: %s: %s", a2, Buffer);
}


// address=[0x2f62280]
// Decompiled from char __cdecl CheckConfiguration(struct SGfxRenderConfiguration *a1)
bool __cdecl CheckConfiguration(struct SGfxRenderConfiguration & a1) {
  
  unsigned __int8 IsHardwareLandscapeEngine; // al
  unsigned __int8 IsHardwareObjectEngine; // al
  bool IsHQTextureSet; // al
  bool IsFiltering; // al

  if ( *((_BYTE *)a1 + 2) )
  {
    SGfxRenderConfiguration::EnableHardwareLandscapeEngine(a1, 0);
    SGfxRenderConfiguration::EnableHardwareObjectEngine(a1, 0);
  }
  BBSupportTracePrintF(1, "GFX ENGINE: ---------------------");
  BBSupportTracePrintF(1, "GFX ENGINE: Requested render configuration is:");
  IsHardwareLandscapeEngine = SGfxRenderConfiguration::IsHardwareLandscapeEngine(a1);
  BBSupportTracePrintF(1, "GFX ENGINE: Hardware(Lsc): %d", IsHardwareLandscapeEngine);
  IsHardwareObjectEngine = SGfxRenderConfiguration::IsHardwareObjectEngine(a1);
  BBSupportTracePrintF(1, "GFX ENGINE: Hardware(Obj): %d", IsHardwareObjectEngine);
  IsHQTextureSet = SGfxRenderConfiguration::IsHQTextureSet(a1);
  BBSupportTracePrintF(1, "GFX ENGINE: HQTextQuality: %d", IsHQTextureSet);
  IsFiltering = SGfxRenderConfiguration::IsFiltering(a1);
  BBSupportTracePrintF(1, "GFX ENGINE: Filtering:     %d", IsFiltering);
  BBSupportTracePrintF(1, "GFX ENGINE: DD3-Interface: %d", *((unsigned __int8 *)a1 + 2));
  BBSupportTracePrintF(1, "GFX ENGINE: GUI only mode: %d", *((unsigned __int8 *)a1 + 1));
  BBSupportTracePrintF(1, "GFX ENGINE: Width:         %d", *((_DWORD *)a1 + 3));
  BBSupportTracePrintF(1, "GFX ENGINE: Height:        %d", *((_DWORD *)a1 + 4));
  BBSupportTracePrintF(1, "GFX ENGINE: X:             %d", *((_DWORD *)a1 + 5));
  BBSupportTracePrintF(1, "GFX ENGINE: Y:             %d", *((_DWORD *)a1 + 6));
  BBSupportTracePrintF(1, "GFX ENGINE: hWnd:          %d", *((_DWORD *)a1 + 2));
  BBSupportTracePrintF(1, "GFX ENGINE: ---------------------");
  if ( *((int *)a1 + 3) < 1 )
    *((_DWORD *)a1 + 3) = 1;
  if ( *((int *)a1 + 4) < 1 )
    *((_DWORD *)a1 + 4) = 1;
  BBSupportTracePrintF(
    1,
    "GFX ENGINE: Set window setup: x:%d y:%d width:%d height:%d",
    *((_DWORD *)a1 + 5),
    *((_DWORD *)a1 + 6),
    *((_DWORD *)a1 + 3),
    *((_DWORD *)a1 + 4));
  return 1;
}


// address=[0x2f69ee0]
// Decompiled from char __cdecl BlitSettler(int a1, int a2, int a3, struct SGfxObjectInfo *a4)
bool __cdecl BlitSettler(int a1, int a2, int a3, struct SGfxObjectInfo * a4) {
  
  int v5; // [esp+0h] [ebp-28h]
  void *v6; // [esp+4h] [ebp-24h] BYREF
  unsigned __int16 *v7; // [esp+8h] [ebp-20h]
  unsigned __int16 *v8; // [esp+Ch] [ebp-1Ch]
  unsigned __int16 *v9; // [esp+10h] [ebp-18h]
  unsigned __int8 *v10; // [esp+14h] [ebp-14h]
  int v11; // [esp+18h] [ebp-10h]
  int v12; // [esp+1Ch] [ebp-Ch]
  int v13; // [esp+20h] [ebp-8h]
  int v14; // [esp+24h] [ebp-4h]

  if ( !*((_DWORD *)a4 + 1) )
    return 0;
  v10 = *(unsigned __int8 **)a4;
  *(_DWORD *)a4 = 0;
  if ( v10 )
  {
    j__memcpy(&g_uColorPalette, *((const void **)a4 + 1), 0x180u);
    j__memcpy(&unk_468A760, (char *)&g_cColorGradient + 64 * *((unsigned __int8 *)a4 + 715), 0x40u);
    j__memcpy(&unk_468A7A0, (const void *)(*((_DWORD *)a4 + 1) + (*((unsigned __int8 *)a4 + 715) << 6) + 512), 0x40u);
    v12 = *v10;
    v11 = v10[1];
    v10 += 2;
    v14 = (a2 - (int)(float)((float)(*v10++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    v13 = (a3 - (int)(float)((float)(*v10 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    if ( v14 <= OutputWidth
      && v13 <= OutputHeight
      && *(_DWORD *)(g_pDestSizeTable + 4 * v12) + v14 >= dword_3E2E2BC
      && *(_DWORD *)(g_pDestSizeTable + 4 * v11) + v13 >= 0 )
    {
      v6 = &g_uColorPalette;
      sub_2F6FD80(&v6, a1);
      ZoomBobNormal(v6, v10 + 5, v12, v11, v14, v13, 0, (void *)g_pBeginOfRenderBuffer, 0);
    }
  }
  if ( !g_pIconPalette )
    return 1;
  if ( *((_BYTE *)a4 + 22) )
  {
    v7 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 22)];
    v5 = *((unsigned __int8 *)a4 + 22);
    *((_BYTE *)a4 + 22) = 0;
    v12 = *v7++;
    v11 = *v7++;
    if ( v12 > 512 || v11 > 512 )
      BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
    v14 = (a2 - (int)(float)((float)(*v7++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    v13 = (a3 - (int)(float)((float)(*v7 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    if ( v14 <= OutputWidth
      && v13 <= OutputHeight
      && *(_DWORD *)(g_pDestSizeTable + 4 * v12) + v14 >= dword_3E2E2BC
      && *(_DWORD *)(g_pDestSizeTable + 4 * v11) + v13 >= 0 )
    {
      g_iSettlerSelections[3 * g_iSettlerSelectionCounter] = v14;
      g_iSettlerSelections[3 * g_iSettlerSelectionCounter + 1] = v13;
      g_iSettlerSelections[3 * g_iSettlerSelectionCounter++ + 2] = v5;
    }
  }
  if ( *((_BYTE *)a4 + 20) )
  {
    v9 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 20)];
    *((_BYTE *)a4 + 20) = 0;
    v12 = *v9++;
    v11 = *v9++;
    if ( v12 > 512 || v11 > 512 )
      BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
    v14 = (a2 - (int)(float)((float)(*v9++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    v13 = (a3 - (int)(float)((float)(*v9 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    if ( v14 <= OutputWidth
      && v13 <= OutputHeight
      && *(_DWORD *)(g_pDestSizeTable + 4 * v12) + v14 >= dword_3E2E2BC
      && *(_DWORD *)(g_pDestSizeTable + 4 * v11) + v13 >= 0 )
    {
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter] = v14;
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter + 1] = v13;
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter + 2] = v12;
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter + 3] = v11;
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter++ + 4] = (int)v9;
    }
  }
  if ( !*((_BYTE *)a4 + 21) )
    return 1;
  v8 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 21)];
  *((_BYTE *)a4 + 21) = 0;
  v12 = *v8++;
  v11 = *v8++;
  if ( v12 > 512 || v11 > 512 )
    BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
  v14 = (a2 - (int)(float)((float)(*v8++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  v13 = (a3 - (int)(float)((float)(*v8 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  if ( v14 > OutputWidth
    || v13 > OutputHeight
    || *(_DWORD *)(g_pDestSizeTable + 4 * v12) + v14 < dword_3E2E2BC
    || *(_DWORD *)(g_pDestSizeTable + 4 * v11) + v13 < 0 )
  {
    return 1;
  }
  g_iSettlerMagic[5 * g_iSettlerMagicCounter] = v14;
  g_iSettlerMagic[5 * g_iSettlerMagicCounter + 1] = v13;
  g_iSettlerMagic[5 * g_iSettlerMagicCounter + 2] = v12;
  g_iSettlerMagic[5 * g_iSettlerMagicCounter + 3] = v11;
  g_iSettlerMagic[5 * g_iSettlerMagicCounter++ + 4] = (int)v8;
  return 1;
}


// address=[0x2f6a540]
// Decompiled from char __cdecl BlitObject(int a1, int a2, int a3, struct SGfxObjectInfo *a4)
bool __cdecl BlitObject(int a1, int a2, int a3, struct SGfxObjectInfo * a4) {
  
  int v5; // [esp+0h] [ebp-24h]
  int v6; // [esp+4h] [ebp-20h]
  int v7; // [esp+Ch] [ebp-18h]
  int v8; // [esp+Ch] [ebp-18h]
  int v9; // [esp+10h] [ebp-14h]
  int v10; // [esp+10h] [ebp-14h]
  unsigned __int16 *v11; // [esp+14h] [ebp-10h]
  unsigned __int16 *v12; // [esp+14h] [ebp-10h]
  unsigned __int16 *v13; // [esp+14h] [ebp-10h]
  int v14; // [esp+18h] [ebp-Ch]
  int v15; // [esp+18h] [ebp-Ch]
  int v16; // [esp+18h] [ebp-Ch]
  int v17; // [esp+1Ch] [ebp-8h]
  int v18; // [esp+1Ch] [ebp-8h]
  int v19; // [esp+1Ch] [ebp-8h]
  unsigned __int16 *v20; // [esp+20h] [ebp-4h]
  unsigned __int16 *v21; // [esp+20h] [ebp-4h]
  unsigned __int16 *v22; // [esp+20h] [ebp-4h]
  unsigned __int16 *v23; // [esp+20h] [ebp-4h]

  if ( !*((_DWORD *)a4 + 1) )
    return 0;
  sub_2F6FD80((char *)a4 + 4, a1);
  v20 = *(unsigned __int16 **)a4;
  *(_DWORD *)a4 = 0;
  if ( v20 )
  {
    v7 = *v20;
    v9 = v20[1];
    v21 = v20 + 2;
    if ( v7 > 512 || v9 > 512 )
      BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of object is too big! Object will be ignored!");
    v6 = dword_3E2E2F4;
    v5 = *(_DWORD *)g_pZoomGradient;
    if ( (v21[2] & 0x10) != 0 )
    {
      *(int *)g_pZoomGradient >>= 1;
      *(float *)&dword_3E2E2F4 = *(float *)&dword_3E2E2F4 * 0.5;
      v14 = (a2 - (int)(float)((float)(*v21 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
      v22 = v21 + 1;
      v17 = (a3 - (int)(float)((float)(*v22 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
      if ( v14 <= OutputWidth
        && v17 <= OutputHeight
        && v14 + (*(int *)(g_pDestSizeTable + 4 * v7) >> 1) >= dword_3E2E2BC
        && v17 + (*(int *)(g_pDestSizeTable + 4 * v9) >> 1) >= 0 )
      {
        ZoomBobNormal(*((void **)a4 + 1), v22 + 3, v7, v9, v14, v17, 0, (void *)g_pBeginOfRenderBuffer, 1);
      }
    }
    else
    {
      v15 = (a2 - (int)(float)((float)(*v21 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
      v23 = v21 + 1;
      v18 = (a3 - (int)(float)((float)(*v23 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
      if ( v15 <= OutputWidth
        && v18 <= OutputHeight
        && *(_DWORD *)(g_pDestSizeTable + 4 * v7) + v15 >= dword_3E2E2BC
        && *(_DWORD *)(g_pDestSizeTable + 4 * v9) + v18 >= 0 )
      {
        ZoomBobNormal(*((void **)a4 + 1), v23 + 3, v7, v9, v15, v18, 0, (void *)g_pBeginOfRenderBuffer, 0);
      }
    }
    dword_3E2E2F4 = v6;
    *(_DWORD *)g_pZoomGradient = v5;
  }
  if ( !*((_BYTE *)a4 + 22) || !g_pIconPalette )
    return 1;
  v11 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 22)];
  *((_BYTE *)a4 + 22) = 0;
  v8 = *v11;
  v10 = v11[1];
  v12 = v11 + 2;
  if ( v8 > 512 || v10 > 512 )
    BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
  v16 = (a2 - (int)(float)((float)(*v12 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  v13 = v12 + 1;
  v19 = (a3 - (int)(float)((float)(*v13 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  if ( v16 <= OutputWidth
    && v19 <= OutputHeight
    && *(_DWORD *)(g_pDestSizeTable + 4 * v8) + v16 >= dword_3E2E2BC
    && *(_DWORD *)(g_pDestSizeTable + 4 * v10) + v19 >= 0 )
  {
    ZoomBobNormal((void *)g_pIconPalette, v13 + 3, v8, v10, v16, v19, 0, (void *)g_pBeginOfRenderBuffer, 0);
  }
  return 1;
}


// address=[0x2f6a900]
// Decompiled from char __cdecl BlitVehicle(int a1, int a2, int a3, struct SGfxObjectInfo *a4)
bool __cdecl BlitVehicle(int a1, int a2, int a3, struct SGfxObjectInfo * a4) {
  
  int v5; // [esp+Ch] [ebp-40h]
  int v6; // [esp+10h] [ebp-3Ch]
  int v7; // [esp+14h] [ebp-38h]
  int v8; // [esp+1Ch] [ebp-30h]
  void *v9; // [esp+20h] [ebp-2Ch]
  void *v10; // [esp+24h] [ebp-28h] BYREF
  void *v11; // [esp+28h] [ebp-24h]
  unsigned __int16 *v12; // [esp+2Ch] [ebp-20h]
  unsigned __int16 *v13; // [esp+30h] [ebp-1Ch]
  unsigned __int16 *v14; // [esp+34h] [ebp-18h]
  int v15; // [esp+38h] [ebp-14h]
  int v16; // [esp+3Ch] [ebp-10h]
  int v17; // [esp+40h] [ebp-Ch]
  int v18; // [esp+44h] [ebp-8h]
  unsigned __int16 *v19; // [esp+48h] [ebp-4h]

  if ( !*((_DWORD *)a4 + 1) )
    return 0;
  v19 = *(unsigned __int16 **)a4;
  *(_DWORD *)a4 = 0;
  v7 = (unsigned __int16)*((_DWORD *)a4 + 23);
  *((_DWORD *)a4 + 23) = 0;
  if ( v19 )
  {
    j__memcpy(&g_uColorPalette, *((const void **)a4 + 1), 0x180u);
    j__memcpy(&unk_468A760, (char *)&g_cColorGradient + 64 * *((unsigned __int8 *)a4 + 715), 0x40u);
    j__memcpy(&unk_468A7A0, (const void *)(*((_DWORD *)a4 + 1) + (*((unsigned __int8 *)a4 + 715) << 6) + 512), 0x40u);
    v10 = &g_uColorPalette;
    sub_2F6FD80(&v10, a1);
    v15 = *v19++;
    v16 = *v19++;
    if ( v15 > 512 || v16 > 512 )
      BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of vehicle object is too big! Object will be ignored!");
    v17 = (a2 - (int)(float)((float)(*v19++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    v18 = (a3 - (int)(float)((float)(*v19 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    v11 = (void *)g_pBeginOfRenderBuffer;
    if ( !v7 || v7 == 0xFFFF )
    {
      if ( v17 <= OutputWidth
        && v18 <= OutputHeight
        && *(_DWORD *)(g_pDestSizeTable + 4 * v15) + v17 >= dword_3E2E2BC
        && *(_DWORD *)(g_pDestSizeTable + 4 * v16) + v18 >= 0 )
      {
        ZoomBobNormal(v10, v19 + 3, v15, v16, v17, v18, 0, (void *)g_pBeginOfRenderBuffer, 0);
      }
    }
    else
    {
      v5 = v7 * (int)(float)((float)v16 * *(float *)&dword_3E2E2F4) / 0xFFFFu + v18;
      v8 = v5 - (int)(float)(*(float *)&dword_3E2E2F4 * 10.0);
      v11 = (void *)(g_iScanlineLength
                   + g_pRenderAdress
                   + g_iRenderPitch * (v5 - 1)
                   - g_iRenderPitch * (int)(float)(*(float *)&dword_3E2E2F4 * 10.0));
      v6 = v5;
      v9 = (void *)(g_iScanlineLength + g_pRenderAdress + g_iRenderPitch * (v5 - 1));
      if ( (unsigned int)v11 < g_pBeginOfRenderBuffer )
      {
        v11 = (void *)g_pBeginOfRenderBuffer;
        v8 = 0;
      }
      if ( (unsigned int)v11 > g_pEndOfRenderBuffer )
      {
        v11 = (void *)g_pEndOfRenderBuffer;
        v8 = OutputHeight - 1;
      }
      if ( (unsigned int)v9 < g_pBeginOfRenderBuffer )
      {
        v9 = (void *)g_pBeginOfRenderBuffer;
        v6 = 0;
      }
      if ( (unsigned int)v9 > g_pEndOfRenderBuffer )
      {
        v9 = (void *)g_pEndOfRenderBuffer;
        v6 = OutputHeight - 1;
      }
      if ( v17 <= OutputWidth
        && v18 <= OutputHeight
        && *(_DWORD *)(g_pDestSizeTable + 4 * v15) + v17 >= dword_3E2E2BC
        && *(_DWORD *)(g_pDestSizeTable + 4 * v16) + v18 >= 0 )
      {
        ZoomBobNormal(v10, v19 + 3, v15, v16, v17, v18, v6, v9, 0);
        ZoomBobBuildState(v10, v19 + 3, v15, v16, v17, v18, v8, v11, v9);
      }
    }
    if ( *((_DWORD *)a4 + 3) )
    {
      v19 = (unsigned __int16 *)*((_DWORD *)a4 + 3);
      *((_DWORD *)a4 + 3) = 0;
      v15 = *v19++;
      v16 = *v19++;
      if ( v15 > 512 || v16 > 512 )
        BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of vehicle object is too big! Object will be ignored!");
      v17 = (a2 - (int)(float)((float)(*v19++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
      v18 = (a3 - (int)(float)((float)(*v19 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
      if ( v17 <= OutputWidth
        && v18 <= OutputHeight
        && *(_DWORD *)(g_pDestSizeTable + 4 * v15) + v17 >= dword_3E2E2BC
        && *(_DWORD *)(g_pDestSizeTable + 4 * v16) + v18 >= 0 )
      {
        v10 = (void *)*((_DWORD *)a4 + 4);
        sub_2F6FD80(&v10, a1);
        ZoomBobNormal(v10, v19 + 3, v15, v16, v17, v18, 0, (void *)g_pBeginOfRenderBuffer, 0);
      }
    }
  }
  if ( !g_pIconPalette )
    return 1;
  *((_DWORD *)a4 + 23) = 0;
  if ( *((_BYTE *)a4 + 22) )
  {
    v14 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 22)];
    *((_BYTE *)a4 + 22) = 0;
    v15 = *v14++;
    v16 = *v14++;
    if ( v15 > 512 || v16 > 512 )
      BBSupportTracePrintF(
        0,
        "GFX ENGINE: DATA ERROR: Size of vehicle selection object is too big! Object will be ignored!");
    v17 = (a2 - (int)(float)((float)(*v14++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    v18 = (a3 - (int)(float)((float)(*v14 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    if ( v17 <= OutputWidth
      && v18 <= OutputHeight
      && *(_DWORD *)(g_pDestSizeTable + 4 * v15) + v17 >= dword_3E2E2BC
      && *(_DWORD *)(g_pDestSizeTable + 4 * v16) + v18 >= 0 )
    {
      ZoomBobNormal((void *)g_pIconPalette, v14 + 3, v15, v16, v17, v18, 0, (void *)g_pBeginOfRenderBuffer, 0);
    }
  }
  if ( *((_BYTE *)a4 + 21) )
  {
    v13 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 21)];
    *((_BYTE *)a4 + 21) = 0;
    v15 = *v13++;
    v16 = *v13++;
    if ( v15 > 512 || v16 > 512 )
      BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
    v17 = (a2 - (int)(float)((float)(*v13++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    v18 = (a3 - (int)(float)((float)(*v13 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
    if ( v17 <= OutputWidth
      && v18 <= OutputHeight
      && *(_DWORD *)(g_pDestSizeTable + 4 * v15) + v17 >= dword_3E2E2BC
      && *(_DWORD *)(g_pDestSizeTable + 4 * v16) + v18 >= 0 )
    {
      ZoomBobNormal((void *)g_pIconPalette, v13 + 3, v15, v16, v17, v18, 0, (void *)g_pBeginOfRenderBuffer, 0);
    }
  }
  if ( !*((_BYTE *)a4 + 20) )
    return 1;
  v12 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 20)];
  *((_BYTE *)a4 + 20) = 0;
  v15 = *v12++;
  v16 = *v12++;
  if ( v15 > 512 || v16 > 512 )
    BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
  v17 = (a2 - (int)(float)((float)(*v12++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  v18 = (a3 - (int)(float)((float)(*v12 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  if ( v17 <= OutputWidth
    && v18 <= OutputHeight
    && *(_DWORD *)(g_pDestSizeTable + 4 * v15) + v17 >= dword_3E2E2BC
    && *(_DWORD *)(g_pDestSizeTable + 4 * v16) + v18 >= 0 )
  {
    ZoomBobNormal((void *)g_pIconPalette, v12 + 3, v15, v16, v17, v18, 0, (void *)g_pBeginOfRenderBuffer, 0);
  }
  return 1;
}


// address=[0x2f6b180]
// Decompiled from char __cdecl BlitBuilding(int a1, int a2, int a3, struct SGfxObjectInfo *a4, int *a5, int *a6)
bool __cdecl BlitBuilding(int a1, int a2, int a3, struct SGfxObjectInfo * a4, int * a5, int & a6) {
  
  void *v7; // [esp+10h] [ebp-29Ch] BYREF
  void *v8; // [esp+14h] [ebp-298h] BYREF
  unsigned int v9; // [esp+18h] [ebp-294h]
  void *v10; // [esp+1Ch] [ebp-290h] BYREF
  void *v11; // [esp+20h] [ebp-28Ch] BYREF
  void *v12; // [esp+24h] [ebp-288h] BYREF
  int v13; // [esp+28h] [ebp-284h]
  int v14; // [esp+2Ch] [ebp-280h]
  int v15; // [esp+30h] [ebp-27Ch]
  int v16; // [esp+34h] [ebp-278h]
  int v17; // [esp+38h] [ebp-274h]
  int v18; // [esp+3Ch] [ebp-270h]
  int v19; // [esp+40h] [ebp-26Ch]
  int v20; // [esp+44h] [ebp-268h]
  int v21; // [esp+48h] [ebp-264h]
  int v22; // [esp+4Ch] [ebp-260h]
  int v23; // [esp+50h] [ebp-25Ch]
  int v24; // [esp+54h] [ebp-258h]
  int v25; // [esp+58h] [ebp-254h]
  int v26; // [esp+5Ch] [ebp-250h]
  int v27; // [esp+60h] [ebp-24Ch]
  unsigned int i; // [esp+64h] [ebp-248h]
  int v29; // [esp+68h] [ebp-244h]
  char *v30; // [esp+6Ch] [ebp-240h]
  int v31; // [esp+70h] [ebp-23Ch]
  int v32; // [esp+74h] [ebp-238h]
  void *v33; // [esp+78h] [ebp-234h]
  int v34; // [esp+7Ch] [ebp-230h]
  int v35; // [esp+80h] [ebp-22Ch]
  void *Src; // [esp+84h] [ebp-228h] BYREF
  unsigned __int16 *v37; // [esp+88h] [ebp-224h]
  unsigned __int8 *v38; // [esp+8Ch] [ebp-220h]
  int v39; // [esp+90h] [ebp-21Ch]
  int v40; // [esp+94h] [ebp-218h]
  int v41; // [esp+98h] [ebp-214h]
  int v42; // [esp+9Ch] [ebp-210h]
  unsigned int j; // [esp+A0h] [ebp-20Ch]
  char *v44; // [esp+A4h] [ebp-208h]
  _BYTE v45[512]; // [esp+A8h] [ebp-204h] BYREF

  if ( !*((_DWORD *)a4 + 1) )
    return 0;
  v44 = *(char **)a4;
  v26 = (unsigned __int16)*((_DWORD *)a4 + 23);
  Src = (void *)*((_DWORD *)a4 + 1);
  if ( a1 < 255 )
  {
    sub_2F6FD80(&Src, a1);
    j__memcpy(v45, Src, sizeof(v45));
    Src = v45;
  }
  if ( *((_DWORD *)a4 + 22) )
  {
    v44 = (char *)*((_DWORD *)a4 + 22);
    if ( *(_DWORD *)a4 )
    {
      v39 = *(unsigned __int16 *)v44;
      v44 += 2;
      v40 = *(unsigned __int16 *)v44;
      v44 += 2;
      if ( v39 > 512 || v40 > 512 )
        BBSupportTracePrintF(
          0,
          "GFX ENGINE: DATA ERROR: Size of build layer object is too big! Object will be ignored!");
      v41 = (a2 - (int)(float)((float)(*(unsigned __int16 *)v44 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
      v44 += 2;
      v42 = (a3 - (int)(float)((float)(*(unsigned __int16 *)v44 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
      if ( v41 <= OutputWidth
        && v42 <= OutputHeight
        && *(_DWORD *)(g_pDestSizeTable + 4 * v39) + v41 >= dword_3E2E2BC
        && *(_DWORD *)(g_pDestSizeTable + 4 * v40) + v42 >= 0 )
      {
        ZoomBobNormal(Src, v44 + 6, v39, v40, v41, v42, 0, (void *)g_pBeginOfRenderBuffer, 0);
      }
      v44 = *(char **)a4;
    }
  }
  if ( v44 )
  {
    v39 = *(unsigned __int16 *)v44;
    v44 += 2;
    v40 = *(unsigned __int16 *)v44;
    v44 += 2;
    if ( v39 > 512 || v40 > 512 )
      BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of building object is too big! Object will be ignored!");
    v41 = a2 - (int)(float)((float)(*(unsigned __int16 *)v44 << 16) * *(float *)&dword_3E2E2F4);
    v44 += 2;
    v42 = a3 - (int)(float)((float)(*(unsigned __int16 *)v44 << 16) * *(float *)&dword_3E2E2F4);
    v44 += 6;
    v33 = (void *)g_pBeginOfRenderBuffer;
    v29 = 0;
    if ( !v26 || v26 == 0xFFFF )
    {
      if ( v26 != 0xFFFF )
      {
        if ( v41 >> 16 <= OutputWidth
          && v42 >> 16 <= OutputHeight
          && *(_DWORD *)(g_pDestSizeTable + 4 * v39) + (v41 >> 16) >= dword_3E2E2BC
          && *(_DWORD *)(g_pDestSizeTable + 4 * v40) + (v42 >> 16) >= 0 )
        {
          ZoomBobNormal(Src, v44, v39, v40, v41 >> 16, v42 >> 16, 0, (void *)g_pBeginOfRenderBuffer, 0);
          for ( i = 0; i < 4; ++i )
          {
            if ( *((_DWORD *)a4 + i + 8) )
              ZoomBobNormal(
                Src,
                (void *)(*((_DWORD *)a4 + i + 8) + 12),
                v39,
                v40,
                v41 >> 16,
                v42 >> 16,
                0,
                (void *)g_pBeginOfRenderBuffer,
                0);
          }
          if ( *((_DWORD *)a4 + 12) && *a6 < 511 )
          {
            *a5 = -1;
            a5[1] = v41;
            a5[2] = v42;
            a5[3] = *((_DWORD *)a4 + 12);
            a5[4] = *((_DWORD *)a4 + 1);
            a5[5] = a1;
            ++*a6;
          }
        }
        for ( j = 0; j < 0xA; ++j )
        {
          v44 = (char *)*((_DWORD *)a4 + 4 * j + 134);
          if ( v44 )
          {
            v20 = *(unsigned __int16 *)v44;
            v44 += 2;
            v21 = *(unsigned __int16 *)v44;
            v44 += 2;
            if ( *((_DWORD *)a4 + 4 * j + 135) )
            {
              if ( v20 > 512 || v21 > 512 )
                BBSupportTracePrintF(
                  0,
                  "GFX ENGINE: DATA ERROR: Size of building object is too big! Object will be ignored!");
              v22 = (a2
                   - (int)(float)((float)((*(unsigned __int16 *)v44 - *((_DWORD *)a4 + 4 * j + 136)) << 16)
                                * *(float *)&dword_3E2E2F4)) >> 16;
              v44 += 2;
              v23 = (a3
                   - (int)(float)((float)((*(unsigned __int16 *)v44 - *((_DWORD *)a4 + 4 * j + 137)) << 16)
                                * *(float *)&dword_3E2E2F4)) >> 16;
              if ( v22 <= OutputWidth
                && v23 <= OutputHeight
                && *(_DWORD *)(g_pDestSizeTable + 4 * v20) + v22 >= dword_3E2E2BC
                && *(_DWORD *)(g_pDestSizeTable + 4 * v21) + v23 >= 0 )
              {
                v12 = (void *)*((_DWORD *)a4 + 4 * j + 135);
                sub_2F6FD80(&v12, a1);
                ZoomBobNormal(v12, v44 + 6, v20, v21, v22, v23, 0, (void *)g_pBeginOfRenderBuffer, 0);
              }
            }
            else
            {
              BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: No building pile palette!");
            }
          }
        }
        for ( j = 0; j < 0x15; ++j )
        {
          v38 = (unsigned __int8 *)*((_DWORD *)a4 + 4 * j + 50);
          if ( v38 )
          {
            v18 = *v38++;
            v19 = *v38++;
            if ( *((_DWORD *)a4 + 4 * j + 51) )
            {
              v24 = (a2 - (int)(float)((float)((*v38++ - *((_DWORD *)a4 + 4 * j + 52)) << 16) * *(float *)&dword_3E2E2F4)) >> 16;
              v25 = (a3 - (int)(float)((float)((*v38 - *((_DWORD *)a4 + 4 * j + 53)) << 16) * *(float *)&dword_3E2E2F4)) >> 16;
              j__memcpy(&g_uColorPalette, *((const void **)a4 + 4 * j + 51), 0x180u);
              j__memcpy(&unk_468A760, (char *)&g_cColorGradient + 64 * *((unsigned __int8 *)a4 + 715), 0x40u);
              j__memcpy(
                &unk_468A7A0,
                (const void *)(*((_DWORD *)a4 + 4 * j + 51) + (*((unsigned __int8 *)a4 + 715) << 6) + 512),
                0x40u);
              v11 = &g_uColorPalette;
              sub_2F6FD80(&v11, a1);
              if ( v24 <= OutputWidth
                && v25 <= OutputHeight
                && *(_DWORD *)(g_pDestSizeTable + 4 * v18) + v24 >= dword_3E2E2BC
                && *(_DWORD *)(g_pDestSizeTable + 4 * v19) + v25 >= 0 )
              {
                if ( j == 20 && *a6 < 511 )
                {
                  a5[6] = -2;
                  a5[7] = v24;
                  a5[8] = v25;
                  a5[9] = *((_DWORD *)a4 + 4 * j + 50);
                  a5[10] = *((_DWORD *)a4 + 4 * j + 51);
                  a5[11] = a1 + (*((unsigned __int8 *)a4 + 715) << 16);
                  ++*a6;
                }
                else
                {
                  ZoomBobNormal(v11, v38 + 5, v18, v19, v24, v25, 0, (void *)g_pBeginOfRenderBuffer, 0);
                }
              }
            }
            else
            {
              BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: No settler patch palette!");
            }
          }
        }
        if ( v41 >> 16 <= OutputWidth
          && v42 >> 16 <= OutputHeight
          && *(_DWORD *)(g_pDestSizeTable + 4 * v39) + (v41 >> 16) >= dword_3E2E2BC
          && *(_DWORD *)(g_pDestSizeTable + 4 * v40) + (v42 >> 16) >= 0 )
        {
          for ( j = 5; j < 0xA; ++j )
          {
            if ( *((_DWORD *)a4 + j + 8) )
              ZoomBobNormal(
                Src,
                (void *)(*((_DWORD *)a4 + j + 8) + 12),
                v39,
                v40,
                v41 >> 16,
                v42 >> 16,
                0,
                (void *)g_pBeginOfRenderBuffer,
                0);
          }
        }
        if ( *((_DWORD *)a4 + 20) && *((_DWORD *)a4 + 21) )
        {
          v44 = (char *)*((_DWORD *)a4 + 20);
          v31 = *(unsigned __int16 *)v44;
          v44 += 2;
          v32 = *(unsigned __int16 *)v44;
          v44 += 2;
          if ( v31 > 512 || v32 > 512 )
            BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of building flag is too big! Object will be ignored!");
          v34 = a2
              - (int)(float)((float)((*(unsigned __int16 *)v44 - *((_DWORD *)a4 + 6)) << 16) * *(float *)&dword_3E2E2F4);
          v44 += 2;
          v35 = a3
              - (int)(float)((float)((*(unsigned __int16 *)v44 - *((_DWORD *)a4 + 7)) << 16) * *(float *)&dword_3E2E2F4);
          if ( v34 >> 16 <= OutputWidth
            && v35 >> 16 <= OutputHeight
            && *(_DWORD *)(g_pDestSizeTable + 4 * v31) + (v34 >> 16) >= dword_3E2E2BC
            && *(_DWORD *)(g_pDestSizeTable + 4 * v32) + (v35 >> 16) >= 0 )
          {
            v10 = (void *)*((_DWORD *)a4 + 21);
            sub_2F6FD80(&v10, a1);
            ZoomBobNormal(v10, v44 + 6, v31, v32, v34 >> 16, v35 >> 16, 0, (void *)g_pBeginOfRenderBuffer, 0);
          }
          if ( *((_DWORD *)a4 + 18) && *((_DWORD *)a4 + 19) )
          {
            v44 = (char *)*((_DWORD *)a4 + 18);
            v31 = *(unsigned __int16 *)v44;
            v44 += 2;
            v32 = *(unsigned __int16 *)v44;
            v44 += 2;
            if ( v31 > 512 || v32 > 512 )
              BBSupportTracePrintF(
                0,
                "GFX ENGINE: DATA ERROR: Size of heraldic figure is too big! Object will be ignored!");
            v34 -= (int)(float)((float)(*(unsigned __int16 *)v44 << 16) * *(float *)&dword_3E2E2F4);
            v44 += 2;
            v35 -= (int)(float)((float)(*(unsigned __int16 *)v44 << 16) * *(float *)&dword_3E2E2F4);
            if ( v34 >> 16 <= OutputWidth
              && v35 >> 16 <= OutputHeight
              && *(_DWORD *)(g_pDestSizeTable + 4 * v31) + (v34 >> 16) >= dword_3E2E2BC
              && *(_DWORD *)(g_pDestSizeTable + 4 * v32) + (v35 >> 16) >= 0 )
            {
              v7 = (void *)*((_DWORD *)a4 + 19);
              sub_2F6FD80(&v7, a1);
              ZoomBobNormal(v7, v44 + 6, v31, v32, v34 >> 16, v35 >> 16, 0, (void *)g_pBeginOfRenderBuffer, 0);
            }
          }
        }
        for ( j = 0; j < 6; ++j )
        {
          if ( *((_DWORD *)a4 + 4 * j + 26) && *((_DWORD *)a4 + 4 * j + 27) )
          {
            v44 = (char *)*((_DWORD *)a4 + 4 * j + 26);
            *((_DWORD *)a4 + 4 * j + 26) = 0;
            v13 = *(unsigned __int16 *)v44;
            v44 += 2;
            v15 = *(unsigned __int16 *)v44;
            v44 += 2;
            if ( v13 > 512 || v15 > 512 )
              BBSupportTracePrintF(
                0,
                "GFX ENGINE: DATA ERROR: Size of building-effect is too big! Object will be ignored!");
            v16 = (a2
                 - (int)(float)((float)((*(unsigned __int16 *)v44 - *((_DWORD *)a4 + 4 * j + 28)) << 16)
                              * *(float *)&dword_3E2E2F4)) >> 16;
            v44 += 2;
            v17 = (a3
                 - (int)(float)((float)((*(unsigned __int16 *)v44 - *((_DWORD *)a4 + 4 * j + 29)) << 16)
                              * *(float *)&dword_3E2E2F4)) >> 16;
            if ( v16 <= OutputWidth
              && v17 <= OutputHeight
              && *(_DWORD *)(g_pDestSizeTable + 4 * v13) + v16 >= dword_3E2E2BC
              && *(_DWORD *)(g_pDestSizeTable + 4 * v15) + v17 >= 0 )
            {
              v8 = (void *)*((_DWORD *)a4 + 4 * j + 27);
              sub_2F6FD80(&v8, a1);
              ZoomBobNormal(v8, v44 + 6, v13, v15, v16, v17, 0, (void *)g_pBeginOfRenderBuffer, 0);
            }
          }
        }
      }
    }
    else
    {
      v27 = (int)(float)(*(float *)&dword_3E2E2F4 * 10.0);
      v9 = v26 * (int)(float)((float)v40 * *(float *)&dword_3E2E2F4) / 0xFFFFu + (v42 >> 16);
      v29 = v9 - v27;
      v33 = (void *)(g_iScanlineLength + g_pRenderAdress + g_iRenderPitch * (v9 - 1) - g_iRenderPitch * v27);
      v14 = v9;
      v30 = (char *)(g_iScanlineLength + g_pRenderAdress + g_iRenderPitch * (v9 - 1));
      if ( (unsigned int)&v30[-(g_iRenderPitch * v27)] < g_pBeginOfRenderBuffer )
      {
        v33 = (void *)g_pBeginOfRenderBuffer;
        v29 = 0;
      }
      if ( (unsigned int)v33 > g_pEndOfRenderBuffer )
      {
        v33 = (void *)g_pEndOfRenderBuffer;
        v29 = OutputHeight - 1;
      }
      if ( (unsigned int)v30 < g_pBeginOfRenderBuffer )
      {
        v30 = (char *)g_pBeginOfRenderBuffer;
        v14 = 0;
      }
      if ( (unsigned int)v30 > g_pEndOfRenderBuffer )
      {
        v30 = (char *)g_pEndOfRenderBuffer;
        v14 = OutputHeight - 1;
      }
      if ( v41 >> 16 <= OutputWidth
        && v42 >> 16 <= OutputHeight
        && *(_DWORD *)(g_pDestSizeTable + 4 * v39) + (v41 >> 16) >= dword_3E2E2BC
        && *(_DWORD *)(g_pDestSizeTable + 4 * v40) + (v42 >> 16) >= 0 )
      {
        ZoomBobNormal(Src, v44, v39, v40, v41 >> 16, v42 >> 16, v14, v30, 0);
        ZoomBobBuildState(Src, v44, v39, v40, v41 >> 16, v42 >> 16, v29, v33, v30);
      }
    }
  }
  if ( !*((_BYTE *)a4 + 22) || !g_pIconPalette )
    return 1;
  v37 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 22)];
  v39 = *v37++;
  v40 = *v37++;
  if ( v39 > 512 || v40 > 512 )
    BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
  v41 = (a2 - (int)(float)((float)(*v37++ << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  v42 = (a3 - (int)(float)((float)(*v37 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  if ( v41 <= OutputWidth
    && v42 <= OutputHeight
    && *(_DWORD *)(g_pDestSizeTable + 4 * v39) + v41 >= dword_3E2E2BC
    && *(_DWORD *)(g_pDestSizeTable + 4 * v40) + v42 >= 0 )
  {
    ZoomBobNormal((void *)g_pIconPalette, v37 + 3, v39, v40, v41, v42, 0, (void *)g_pBeginOfRenderBuffer, 0);
  }
  return 1;
}


// address=[0x2f6c700]
// Decompiled from char __cdecl BlitBorderstone(int a1, int a2, int a3, int a4)
bool __cdecl BlitBorderstone(int a1, int a2, int a3, int a4) {
  
  void *v5; // [esp+4h] [ebp-18h] BYREF
  int v6; // [esp+8h] [ebp-14h]
  int v7; // [esp+Ch] [ebp-10h]
  int v8; // [esp+10h] [ebp-Ch]
  int v9; // [esp+14h] [ebp-8h]
  unsigned __int16 *v10; // [esp+18h] [ebp-4h]

  if ( !g_pBorderstonePalette )
    return 0;
  if ( a4 < 1 || a4 > 8 )
    BBSupportTracePrintF(0, "GFX ENGINE: Illegal value of owner id.");
  v10 = (unsigned __int16 *)g_pBorderstoneGfx[a4];
  if ( !v10 )
    return 1;
  v6 = *v10;
  v7 = v10[1];
  v10 += 2;
  if ( v6 > 512 || v7 > 512 )
    BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of borderstone object is too big! Object will be ignored!");
  v8 = (a2 - (int)(float)((float)*v10++ * *(float *)&dword_3E2E2F4)) >> 16;
  v9 = (a3 - (int)(float)((float)*v10 * *(float *)&dword_3E2E2F4)) >> 16;
  if ( v8 > OutputWidth
    || v9 > OutputHeight
    || *(_DWORD *)(g_pDestSizeTable + 4 * v6) + v8 < dword_3E2E2BC
    || *(_DWORD *)(g_pDestSizeTable + 4 * v7) + v9 < 0 )
  {
    return 1;
  }
  v5 = (void *)g_pBorderstonePalette;
  sub_2F6FD80(&v5, a1);
  ZoomBobNormal(v5, v10 + 3, v6, v7, v8, v9, 0, (void *)g_pBeginOfRenderBuffer, 0);
  return 1;
}


// address=[0x2f6c870]
// Decompiled from char __cdecl BlitAccessoryIcon(int a1, int a2, int a3, int a4)
bool __cdecl BlitAccessoryIcon(int a1, int a2, int a3, int a4) {
  
  int v5; // [esp+0h] [ebp-14h]
  int v6; // [esp+4h] [ebp-10h]
  int v7; // [esp+8h] [ebp-Ch]
  int v8; // [esp+Ch] [ebp-8h]
  unsigned __int16 *v9; // [esp+10h] [ebp-4h]
  unsigned __int16 *v10; // [esp+10h] [ebp-4h]
  unsigned __int16 *v11; // [esp+10h] [ebp-4h]

  if ( !g_pIconPalette )
    return 0;
  v9 = (unsigned __int16 *)g_pIconGfx[a4];
  if ( !v9 )
    return 1;
  v5 = *v9;
  v6 = v9[1];
  v10 = v9 + 2;
  if ( v5 > 512 || v6 > 512 )
    BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
  v7 = (a2 - (int)(float)((float)(*v10 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  v11 = v10 + 1;
  v8 = (a3 - (int)(float)((float)(*v11 << 16) * *(float *)&dword_3E2E2F4)) >> 16;
  if ( v7 <= OutputWidth
    && v8 <= OutputHeight
    && *(_DWORD *)(g_pDestSizeTable + 4 * v5) + v7 >= dword_3E2E2BC
    && *(_DWORD *)(g_pDestSizeTable + 4 * v6) + v8 >= 0 )
  {
    ZoomBobNormal((void *)g_pIconPalette, v11 + 3, v5, v6, v7, v8, 0, (void *)g_pBeginOfRenderBuffer, 0);
  }
  return 1;
}


// address=[0x2f6c9b0]
// Decompiled from char __cdecl BlitWave(int a1, int a2, int a3, int a4, int a5)
bool __cdecl BlitWave(int a1, int a2, int a3, int a4, int a5) {
  
  void *v6; // [esp+4h] [ebp-18h] BYREF
  int v7; // [esp+8h] [ebp-14h]
  int v8; // [esp+Ch] [ebp-10h]
  int v9; // [esp+10h] [ebp-Ch]
  int v10; // [esp+14h] [ebp-8h]
  unsigned __int16 *v11; // [esp+18h] [ebp-4h]

  if ( !g_pWavePalettes[a4] )
    return 0;
  v11 = (unsigned __int16 *)g_pWaveGfx[20 * a4 + a5];
  if ( !v11 )
    return 1;
  v7 = *v11;
  v8 = v11[1];
  v11 += 2;
  if ( v7 > 512 || v8 > 512 )
    BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of wave object is too big! Object will be ignored!");
  v9 = (a2 - (int)(float)((float)*v11++ * *(float *)&dword_3E2E2F4)) >> 16;
  v10 = (a3 - (int)(float)((float)*v11 * *(float *)&dword_3E2E2F4)) >> 16;
  if ( v9 > OutputWidth
    || v10 > OutputHeight
    || *(_DWORD *)(g_pDestSizeTable + 4 * v7) + v9 < dword_3E2E2BC
    || *(_DWORD *)(g_pDestSizeTable + 4 * v8) + v10 < 0 )
  {
    return 1;
  }
  v6 = (void *)g_pWavePalettes[a4];
  sub_2F6FD80(&v6, a1);
  ZoomBobNormal(v6, v11 + 3, v7, v8, v9, v10, 0, (void *)g_pBeginOfRenderBuffer, 0);
  return 1;
}


// address=[0x2f6cb10]
// Decompiled from char __cdecl RenderObjectLayer(bool a1)
bool __cdecl RenderObjectLayer(bool a1) {
  
  int OwnerID; // eax
  int v3; // esi
  int v4; // esi
  int v5; // esi
  int v6; // esi
  int v7; // esi
  int v8; // esi
  int v9; // esi
  int v10; // esi
  int v11; // esi
  int v12; // esi
  int v13; // esi
  int v14; // esi
  __int16 v15; // cx
  __int16 *v16; // edi
  __int16 *v17; // ebx
  __int16 *v18; // esi
  __int16 *v19; // edi
  int v20; // edx
  int v22; // [esp+28h] [ebp-6820h]
  int v23; // [esp+2Ch] [ebp-681Ch]
  int v24; // [esp+38h] [ebp-6810h]
  int v25; // [esp+3Ch] [ebp-680Ch]
  int v26; // [esp+40h] [ebp-6808h]
  int v27; // [esp+44h] [ebp-6804h]
  int v28; // [esp+48h] [ebp-6800h]
  int v29; // [esp+50h] [ebp-67F8h]
  int v30; // [esp+54h] [ebp-67F4h]
  int v31; // [esp+5Ch] [ebp-67ECh]
  int v32; // [esp+64h] [ebp-67E4h] BYREF
  int v33; // [esp+68h] [ebp-67E0h] BYREF
  size_t v34; // [esp+6Ch] [ebp-67DCh]
  int v35; // [esp+70h] [ebp-67D8h]
  int v36; // [esp+74h] [ebp-67D4h]
  int v37; // [esp+78h] [ebp-67D0h]
  int v38; // [esp+7Ch] [ebp-67CCh]
  int v39; // [esp+80h] [ebp-67C8h]
  int v40; // [esp+84h] [ebp-67C4h]
  int v41; // [esp+88h] [ebp-67C0h]
  int v42; // [esp+8Ch] [ebp-67BCh]
  int v43; // [esp+90h] [ebp-67B8h]
  int v44; // [esp+94h] [ebp-67B4h]
  int v45; // [esp+98h] [ebp-67B0h]
  int v46; // [esp+9Ch] [ebp-67ACh]
  int v47; // [esp+A0h] [ebp-67A8h]
  int v48; // [esp+A4h] [ebp-67A4h]
  float v49; // [esp+A8h] [ebp-67A0h]
  int v50; // [esp+ACh] [ebp-679Ch]
  int v51; // [esp+B0h] [ebp-6798h]
  void *v52; // [esp+B4h] [ebp-6794h] BYREF
  int v53; // [esp+B8h] [ebp-6790h]
  void *v54; // [esp+BCh] [ebp-678Ch] BYREF
  int v55; // [esp+C0h] [ebp-6788h]
  int v56; // [esp+C4h] [ebp-6784h] BYREF
  int v57; // [esp+C8h] [ebp-6780h]
  int v58; // [esp+CCh] [ebp-677Ch]
  int v59; // [esp+D0h] [ebp-6778h] BYREF
  int v60; // [esp+D4h] [ebp-6774h]
  unsigned __int8 *v61; // [esp+D8h] [ebp-6770h]
  int v62; // [esp+DCh] [ebp-676Ch]
  int v63; // [esp+E0h] [ebp-6768h]
  int v64; // [esp+E4h] [ebp-6764h]
  int v65; // [esp+E8h] [ebp-6760h]
  int v66; // [esp+ECh] [ebp-675Ch]
  int v67; // [esp+F0h] [ebp-6758h]
  int v68; // [esp+F4h] [ebp-6754h]
  unsigned __int16 *v69; // [esp+F8h] [ebp-6750h]
  int v70; // [esp+FCh] [ebp-674Ch]
  int v71; // [esp+100h] [ebp-6748h]
  int v72; // [esp+104h] [ebp-6744h]
  int v73; // [esp+108h] [ebp-6740h]
  unsigned __int16 *v74; // [esp+10Ch] [ebp-673Ch]
  int v75; // [esp+110h] [ebp-6738h]
  int v76; // [esp+114h] [ebp-6734h]
  int v77; // [esp+118h] [ebp-6730h]
  int v78; // [esp+11Ch] [ebp-672Ch]
  int v79; // [esp+120h] [ebp-6728h]
  int v80; // [esp+124h] [ebp-6724h]
  int i; // [esp+128h] [ebp-6720h]
  bool v82; // [esp+12Fh] [ebp-6719h]
  int v83; // [esp+130h] [ebp-6718h]
  size_t v84; // [esp+134h] [ebp-6714h]
  int v85; // [esp+138h] [ebp-6710h] BYREF
  unsigned __int8 IconObjectByX; // [esp+13Fh] [ebp-6709h]
  int v87; // [esp+140h] [ebp-6708h]
  int v88; // [esp+144h] [ebp-6704h]
  int v89; // [esp+148h] [ebp-6700h]
  int v90; // [esp+14Ch] [ebp-66FCh]
  int v91; // [esp+150h] [ebp-66F8h]
  int v92; // [esp+154h] [ebp-66F4h]
  struct T_GFX_MAP_ELEMENT *v93; // [esp+158h] [ebp-66F0h]
  unsigned __int8 v94; // [esp+15Fh] [ebp-66E9h]
  int v95; // [esp+160h] [ebp-66E8h]
  void *GfxObjectInfo; // [esp+164h] [ebp-66E4h]
  int v97; // [esp+168h] [ebp-66E0h]
  int v98; // [esp+16Ch] [ebp-66DCh]
  int j; // [esp+170h] [ebp-66D8h]
  _DWORD v100[5]; // [esp+174h] [ebp-66D4h] BYREF
  char v101; // [esp+18Ah] [ebp-66BEh]
  _OWORD v102[1536]; // [esp+444h] [ebp-6404h] BYREF
  _BYTE v103[1024]; // [esp+6444h] [ebp-404h] BYREF

  v77 = 0;
  v85 = 0;
  memset(v103, 255, Size);
  g_iSettlerSelectionCounter = 0;
  g_iSettlerFitnessCounter = 0;
  g_iSettlerMagicCounter = 0;
  v94 = 0;
  if ( !g_pfGetGfxObjectInfo || !dword_3E2E2E8 || !dword_3E2E2EC || !g_pfGetOwnerID )
    return 1;
  v84 = Size;
  v57 = dword_3E2E2A0;
  if ( !dword_3E2E2A0 )
  {
    BBSupportTracePrintF(0, "GFX ENGINE: Can't render objects without having a world!");
    return 1;
  }
  v95 = dword_3E2E28C;
  v90 = dword_3E2E290;
  v51 = (((OutputWidth - dword_3E2E2BC) << 16) + 4 * dword_3E2E28C) / dword_3E2E28C;
  v42 = (dword_3E2E290 + (OutputHeight << 16)) / dword_3E2E290;
  v80 = v42 + dword_3E2E2AC + 2;
  if ( v80 < g_iMapSize && v80 > 0 )
    v80 += (unsigned __int8)g_uMaxYTable[v80] / 8;
  v80 += 11;
  v97 = -8 * v90 - (dword_3E2E2B4 << 16);
  v41 = -v95 / 2;
  v22 = v95 / 2;
  v88 = 0;
  v49 = (float)v95 / 65536.0;
  v48 = (int)(float)((float)dword_3E2E2A8 * v49);
  v35 = (int)(float)((float)dword_3E2E2AC * (float)((float)v90 / 65536.0));
  if ( D3DObjectPtr->field_71D && byte_3E2E30E )
  {
    v87 = CInterfaceD3D::BeginObjectScene(D3DObjectPtr);
    if ( v87 )
    {
      WriteError(v87, "BeginObjectScene");
      return 0;
    }
  }
  else
  {
    v87 = ((int (__thiscall *)(CSurfaceV7 *, int *, int *, int))D3DObjectPtr->FinalRenderSurface->Lock)(
            D3DObjectPtr->FinalRenderSurface,
            &v59,
            &v56,
            1);
    if ( v87 )
    {
      WriteError(v87, "LockObjectRenderSurfaceSW");
      return 0;
    }
    g_pRenderAdress = v56 + v59 * dword_3E2E288 + 2 * dword_3E2E284;
    g_pBeginOfRenderBuffer = g_pRenderAdress;
    g_iRenderPitch = v59;
    g_iScanlineLength = 2 * OutputWidth;
    g_pEndOfRenderBuffer = 2 * OutputWidth + g_pRenderAdress + v59 * (OutputHeight - 1);
  }
  GfxObjectInfo = 0;
  v93 = 0;
  if ( s_pEffectSystem )
  {
    v67 = dword_3E2E2AC - 7;
    v38 = dword_3E2E2A8 + (dword_3E2E2AC - 7) / 2 - 30;
    v40 = v80;
    v39 = v38 + (v80 - (dword_3E2E2AC - 7)) / 2;
    (**(void (__thiscall ***)(int, int, int, int, int, int))s_pEffectSystem)(
      s_pEffectSystem,
      v38,
      dword_3E2E2AC - 7,
      v39,
      v80,
      v51 + dword_3E2E2A8 + v39 + (dword_3E2E2AC - 7) / 2 + 9);
  }
  j = dword_3E2E2AC - 7;
  while ( j < v80 )
  {
    if ( (j & 1) != 0 )
    {
      v98 = (dword_3E2E2BC - dword_3E2E2B0 - (v95 >> 16) - ((30 * v95) >> 16)) << 16;
      v88 = 1;
    }
    else
    {
      v98 = v41 + ((dword_3E2E2BC - dword_3E2E2B0 - (v95 >> 16) - ((30 * v95) >> 16)) << 16);
      v88 = 0;
    }
    g_iUsedFogFadeStep = g_iFogFadeStep;
    if ( j < g_iFadeYBorder )
      g_iUsedFogFadeStep = 0;
    v23 = v51 + dword_3E2E2A8 + j / 2 + 1;
    v73 = dword_3E2E2A8 + v84 * j + j / 2 - 30;
    v29 = dword_3E2E2A8 + j / 2 - 30;
    if ( FastIndexValidation(j) )
    {
      v78 = v29;
      while ( v78 < v23 + 8 )
      {
        if ( FastIndexValidation(v88 + v78) )
        {
          v93 = (struct T_GFX_MAP_ELEMENT *)(v57 + 4 * (v88 + v73));
          if ( (*((_BYTE *)v93 + 3) & 0x80) != 0 )
          {
            v89 = CalcFinalHeightOffset(*(unsigned __int8 *)v93);
            v37 = CalcCurrentFog(v93);
            if ( v37 > 59
              && (!SGfxRenderConfiguration::IsEditorMode((SGfxRenderConfiguration *)&GfxEngineSetup)
               || *((unsigned __int8 *)v93 + 1) > 8u) )
            {
              OwnerID = g_pfGetOwnerID(v88 + v73);
              g_pfBlitBorderstone(v37, v98, v97 - v89, OwnerID);
            }
          }
          v82 = (*((_BYTE *)v93 + 2) & 0x20) != 0;
          sub_2F6F620(v98, v97, v88 + v78, j, *((unsigned __int8 *)v93 + 1));
          v65 = *(unsigned __int16 *)(dword_3E2E2E8 + 2 * (v88 + v73));
          v36 = *(unsigned __int16 *)(dword_3E2E2EC + 2 * (v88 + v73));
          if ( v36 )
          {
            v72 = CalcCurrentFog(v93);
            if ( v72 > 17 )
            {
              GfxObjectInfo = (void *)g_pfGetGfxObjectInfo(v36, -1);
              if ( GfxObjectInfo )
              {
                if ( *((_BYTE *)GfxObjectInfo + 714) )
                {
                  v89 = CalcFinalHeightOffset(*(unsigned __int8 *)v93);
                  if ( *((_BYTE *)GfxObjectInfo + 712) == 8 )
                  {
                    if ( v72 > 59 )
                      g_pfBlitBuilding(v72, v98, v97 - v89, GfxObjectInfo, (char *)&v102[768] + 24 * v85, &v85);
                    memset(GfxObjectInfo, 0, 0x2D0u);
                  }
                  else if ( *((_BYTE *)GfxObjectInfo + 712) != 16 || v72 > 59 )
                  {
                    g_pfBlitObject(v72, v98, v97 - v89, GfxObjectInfo);
                  }
                }
              }
            }
          }
          if ( v65 )
          {
            v79 = CalcCurrentFog(v93);
            if ( v79 > 59 )
            {
              GfxObjectInfo = (void *)g_pfGetGfxObjectInfo(v65, -1);
              if ( GfxObjectInfo )
              {
                if ( *((_BYTE *)GfxObjectInfo + 714) )
                {
                  v89 = CalcFinalHeightOffset(*(unsigned __int8 *)v93);
                  v91 = 0;
                  v92 = 0;
                  v83 = *((unsigned __int8 *)GfxObjectInfo + 716);
                  v75 = v98;
                  v76 = v97;
                  v66 = *((unsigned __int8 *)GfxObjectInfo + 712);
                  switch ( --v66 )
                  {
                    case 0:
                      v64 = *((char *)GfxObjectInfo + 717);
                      switch ( ++v64 )
                      {
                        case 0:
                          v83 = 0;
                          v75 = v98 + ((*((_DWORD *)GfxObjectInfo + 6) * (v95 >> 16) / 256) << 16);
                          v76 = v97 + ((*((_DWORD *)GfxObjectInfo + 7) * (v90 >> 16) / 256) << 16);
                          break;
                        case 1:
                          v91 = v98 - v95;
                          v92 = v97 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4));
                          break;
                        case 2:
                          v91 = v98 - v95 / 2;
                          v11 = v97 - v90;
                          v92 = v11 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4 * v84 - 4));
                          break;
                        case 3:
                          v91 = v98 + v95 / 2;
                          v12 = v97 - v90;
                          v92 = v12 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4 * v84));
                          break;
                        case 4:
                          v91 = v95 + v98;
                          v92 = v97 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4));
                          break;
                        case 5:
                          v91 = v98 + v95 / 2;
                          v13 = v90 + v97;
                          v92 = v13 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4 * v84 + 4));
                          break;
                        case 6:
                          v91 = v98 - v95 / 2;
                          v14 = v90 + v97;
                          v92 = v14 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4 * v84));
                          break;
                        default:
                          BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Illegal value in iDirection");
                          break;
                      }
                      if ( v83 )
                        g_pfBlitSettler(
                          v79,
                          v98 - ((v83 * (v98 - v91)) >> 8),
                          v97 - v89 - ((v83 * (v97 - v89 - v92)) >> 8),
                          GfxObjectInfo);
                      else
                        g_pfBlitSettler(v79, v75, v76 - v89, GfxObjectInfo);
                      break;
                    case 1:
                    case 3:
                      v50 = *((char *)GfxObjectInfo + 717);
                      switch ( v50 )
                      {
                        case 0:
                          v91 = v98 - v95;
                          v92 = v97 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4));
                          break;
                        case 1:
                          v91 = v98 - v95 / 2;
                          v3 = v97 - v90;
                          v92 = v3 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4 * v84 - 4));
                          break;
                        case 2:
                          v91 = v98 + v95 / 2;
                          v4 = v97 - v90;
                          v92 = v4 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4 * v84));
                          break;
                        case 3:
                          v91 = v95 + v98;
                          v92 = v97 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4));
                          break;
                        case 4:
                          v91 = v98 + v95 / 2;
                          v5 = v90 + v97;
                          v92 = v5 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4 * v84 + 4));
                          break;
                        case 5:
                          v91 = v98 - v95 / 2;
                          v6 = v90 + v97;
                          v92 = v6 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4 * v84));
                          break;
                        default:
                          BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Illegal value in iDirection");
                          break;
                      }
                      if ( *((_BYTE *)GfxObjectInfo + 712) == 2 )
                      {
                        if ( v85 < 512 )
                        {
                          *((_DWORD *)&v102[768] + 6 * v85) = v65;
                          *((_DWORD *)&v102[768] + 6 * v85 + 1) = v98 - ((v83 * (v98 - v91)) >> 8);
                          *((_DWORD *)&v102[768] + 6 * v85 + 2) = v97 - v89 - ((v83 * (v97 - v89 - v92)) >> 8);
                          *((_DWORD *)&v102[769] + 6 * v85++ + 1) = v79;
                        }
                      }
                      else
                      {
                        v103[v88 + v78] = v94;
                        LODWORD(v102[v94]) = v65;
                        DWORD1(v102[v94]) = v98 - ((v83 * (v98 - v91)) >> 8);
                        DWORD2(v102[v94]) = v97 - v89 - ((v83 * (v97 - v89 - v92)) >> 8);
                        HIDWORD(v102[v94++]) = v79;
                      }
                      *((_DWORD *)GfxObjectInfo + 23) = 0;
                      *(_DWORD *)GfxObjectInfo = 0;
                      *((_DWORD *)GfxObjectInfo + 3) = 0;
                      *((_BYTE *)GfxObjectInfo + 22) = 0;
                      *((_BYTE *)GfxObjectInfo + 20) = 0;
                      *((_BYTE *)GfxObjectInfo + 21) = 0;
                      break;
                    case 7:
                      g_pfBlitBuilding(v79, v75, v76 - v89, GfxObjectInfo, (char *)&v102[768] + 24 * v85, &v85);
                      memset(GfxObjectInfo, 0, 0x2D0u);
                      break;
                    case 127:
                      v60 = *((char *)GfxObjectInfo + 717);
                      switch ( ++v60 )
                      {
                        case 0:
                          v83 = 0;
                          v75 = v98 + ((*((_DWORD *)GfxObjectInfo + 6) * (v95 >> 16) / 256) << 16);
                          v76 = v97 + ((*((_DWORD *)GfxObjectInfo + 7) * (v90 >> 16) / 256) << 16);
                          break;
                        case 1:
                          v91 = v98 - v95;
                          v92 = v97 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4));
                          break;
                        case 2:
                          v91 = v98 - v95 / 2;
                          v7 = v97 - v90;
                          v92 = v7 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4 * v84 - 4));
                          break;
                        case 3:
                          v91 = v98 + v95 / 2;
                          v8 = v97 - v90;
                          v92 = v8 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 - 4 * v84));
                          break;
                        case 4:
                          v91 = v95 + v98;
                          v92 = v97 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4));
                          break;
                        case 5:
                          v91 = v98 + v95 / 2;
                          v9 = v90 + v97;
                          v92 = v9 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4 * v84 + 4));
                          break;
                        case 6:
                          v91 = v98 - v95 / 2;
                          v10 = v90 + v97;
                          v92 = v10 - CalcFinalHeightOffset(*((unsigned __int8 *)v93 + 4 * v84));
                          break;
                        default:
                          BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Illegal value in iDirection");
                          break;
                      }
                      if ( !v83 )
                        goto RenderObjectLayer___def_336D47A;
                      g_pfBlitObject(
                        v79,
                        v98 - ((v83 * (v98 - v91)) >> 8),
                        v97 - v89 - ((v83 * (v97 - v89 - v92)) >> 8),
                        GfxObjectInfo);
                      break;
                    default:
RenderObjectLayer___def_336D47A:
                      g_pfBlitObject(v79, v75, v76 - v89, GfxObjectInfo);
                      break;
                  }
                }
              }
            }
          }
          if ( (unsigned __int8)v103[v88 + v78] != 255 )
          {
            v63 = (unsigned __int8)v103[v88 + v78];
            v103[v88 + v78] = -1;
            GfxObjectInfo = (void *)g_pfGetGfxObjectInfo(v102[v63], -1);
            g_pfBlitVehicle(HIDWORD(v102[v63]), DWORD1(v102[v63]), DWORD2(v102[v63]), GfxObjectInfo);
          }
        }
        v98 += v95;
        ++v78;
        ++v73;
      }
      if ( s_pEffectSystem )
      {
        v34 = dword_3E2E2A0 + 4 * Size * j;
        for ( i = (*(int (__thiscall **)(int, int))(*(_DWORD *)s_pEffectSystem + 4))(s_pEffectSystem, j);
              i;
              i = (*(int (__thiscall **)(int))(*(_DWORD *)s_pEffectSystem + 8))(s_pEffectSystem) )
        {
          v70 = (int)(float)((float)(*(float *)(i + 696) - 24.0) * *(float *)&dword_3E2E2F4)
              + dword_3E2E2BC
              - (v22 >> 16)
              - v48;
          v71 = (int)(float)((float)(*(float *)(i + 700) - 12.0) * *(float *)&dword_3E2E2F4) - v35 - dword_3E2E2B4;
          v70 -= dword_3E2E2B0;
          v62 = CalcCurrentFog((struct T_GFX_MAP_ELEMENT *)(v34 + 4 * *(_DWORD *)(i + 704)));
          if ( v62 > 59 )
          {
            if ( *(_BYTE *)(i + 712) == 1 )
            {
              g_pfBlitSettler(v62, v70 << 16, v71 << 16, i);
            }
            else if ( *(unsigned __int8 *)(i + 713) < 0xC0u )
            {
              g_pfBlitObject(v62, v70 << 16, v71 << 16, i);
            }
            else if ( v77 < 512 )
            {
              LODWORD(v102[v77 + 256]) = *(_DWORD *)i;
              DWORD1(v102[v77 + 256]) = v70 + (v71 << 16);
              DWORD2(v102[v77 + 256]) = *(_DWORD *)(i + 4);
              HIDWORD(v102[v77++ + 256]) = v62;
            }
          }
        }
      }
    }
    ++j;
    v97 += v90;
  }
  v48 = (int)(float)((float)(dword_3E2E2A8 + j / 2) * v49);
  if ( g_sGfxObjectCursorBuilding >= 0
    && byte_3E2E664
    && !CFixCursor::IsVisible((CMFCScanliner *)&D3DObjectPtr->MoveCursor)
    && !CFixCursor::IsVisible((CMFCScanliner *)&D3DObjectPtr->ZoomCursor) )
  {
    IGfxEngine::GetScreenOffsetsByMapIndices(dword_3E2E38C, dword_3E2E390, &v32, &v33);
    g_pfBlitBuilding(255, v32 << 16, v33 << 16, &unk_3E2E394, (char *)&v102[768] + 24 * v85, &v85);
  }
  for ( j = 0; j < v85; ++j )
  {
    if ( *((_DWORD *)&v102[768] + 6 * j) == -1 )
    {
      v54 = (void *)*((_DWORD *)&v102[769] + 6 * j);
      if ( (unsigned __int8)SGfxRenderConfiguration::IsHardwareObjectEngine(&GfxEngineSetup) )
      {
        v55 = (unsigned __int8)*((_DWORD *)&v102[769] + 6 * j + 1);
        RenderGfx(
          (char *)&dword_8F0000[157088] + j,
          v54,
          (void *)(*((_DWORD *)&v102[768] + 6 * j + 3) + 12),
          **((unsigned __int16 **)&v102[768] + 6 * j + 3),
          *(unsigned __int16 *)(*((_DWORD *)&v102[768] + 6 * j + 3) + 2),
          (float)*((int *)&v102[768] + 6 * j + 1),
          (float)*((int *)&v102[768] + 6 * j + 2),
          65793 * v55,
          0,
          0,
          0);
      }
      else
      {
        sub_2F6FD80(&v54, *((_DWORD *)&v102[769] + 6 * j + 1));
        ZoomBobNormal(
          v54,
          (void *)(*((_DWORD *)&v102[768] + 6 * j + 3) + 12),
          **((unsigned __int16 **)&v102[768] + 6 * j + 3),
          *(unsigned __int16 *)(*((_DWORD *)&v102[768] + 6 * j + 3) + 2),
          *((int *)&v102[768] + 6 * j + 1) >> 16,
          *((int *)&v102[768] + 6 * j + 2) >> 16,
          0,
          (void *)g_pBeginOfRenderBuffer,
          0);
      }
    }
    else if ( *((_DWORD *)&v102[768] + 6 * j) == -2 )
    {
      v61 = (unsigned __int8 *)*((_DWORD *)&v102[768] + 6 * j + 3);
      v47 = *((int *)&v102[769] + 6 * j + 1) >> 16;
      j__memcpy(&g_uColorPalette, *((const void **)&v102[769] + 6 * j), 0x180u);
      j__memcpy(&unk_468A760, (char *)&g_cColorGradient + 64 * v47, 0x40u);
      j__memcpy(&unk_468A7A0, (const void *)(*((_DWORD *)&v102[769] + 6 * j) + (v47 << 6) + 512), 0x40u);
      v52 = &g_uColorPalette;
      v45 = *v61++;
      v46 = *v61;
      if ( (unsigned __int8)SGfxRenderConfiguration::IsHardwareObjectEngine(&GfxEngineSetup) )
      {
        v53 = (unsigned __int8)*((_DWORD *)&v102[769] + 6 * j + 1);
        RenderGfx(
          (char *)&dword_9BC178[198098] + j,
          v52,
          (void *)(*((_DWORD *)&v102[768] + 6 * j + 3) + 8),
          v45,
          v46,
          (float)*((int *)&v102[768] + 6 * j + 1),
          (float)*((int *)&v102[768] + 6 * j + 2),
          65793 * v53,
          0,
          0,
          0);
      }
      else
      {
        sub_2F6FD80(&v52, (unsigned __int8)*((_DWORD *)&v102[769] + 6 * j + 1));
        ZoomBobNormal(
          v52,
          (void *)(*((_DWORD *)&v102[768] + 6 * j + 3) + 8),
          v45,
          v46,
          *((_DWORD *)&v102[768] + 6 * j + 1),
          *((_DWORD *)&v102[768] + 6 * j + 2),
          0,
          (void *)g_pBeginOfRenderBuffer,
          0);
      }
    }
    else
    {
      GfxObjectInfo = (void *)g_pfGetGfxObjectInfo(*((_DWORD *)&v102[768] + 6 * j), -1);
      g_pfBlitVehicle(
        *((_DWORD *)&v102[769] + 6 * j + 1),
        *((_DWORD *)&v102[768] + 6 * j + 1),
        *((_DWORD *)&v102[768] + 6 * j + 2),
        GfxObjectInfo);
    }
  }
  for ( j = 0; j < v77; ++j )
  {
    v100[0] = v102[j + 256];
    v100[1] = DWORD2(v102[j + 256]);
    v101 = 0;
    g_pfBlitObject(
      HIDWORD(v102[j + 256]),
      (unsigned __int16)DWORD1(v102[j + 256]) << 16,
      DWORD1(v102[j + 256]) & 0xFFFF0000,
      v100);
  }
  if ( g_iSettlerSelectionCounter )
  {
    if ( byte_3E2E30E )
    {
      for ( j = 0; j < g_iSettlerSelectionCounter; ++j )
      {
        v74 = (unsigned __int16 *)g_pIconGfx[g_iSettlerSelections[3 * j + 2]];
        v31 = *v74++;
        CacheRenderingStandard(
          (void *)g_pIconPalette,
          v74 + 5,
          v74[4],
          64,
          v31,
          *v74,
          (float)g_iSettlerSelections[3 * j],
          (float)g_iSettlerSelections[3 * j + 1],
          0,
          (char *)&dword_F29144[220078] + 3,
          0,
          0);
      }
    }
    else
    {
      for ( j = 0; j < g_iSettlerSelectionCounter; ++j )
      {
        v69 = (unsigned __int16 *)g_pIconGfx[g_iSettlerSelections[3 * j + 2]];
        v30 = *v69++;
        ZoomBobNormal(
          (void *)g_pIconPalette,
          v69 + 5,
          v30,
          *v69,
          g_iSettlerSelections[3 * j],
          g_iSettlerSelections[3 * j + 1],
          0,
          (void *)g_pBeginOfRenderBuffer,
          0);
      }
    }
  }
  if ( g_iSettlerMagicCounter )
  {
    if ( byte_3E2E30E )
    {
      for ( j = 0; j < g_iSettlerMagicCounter; ++j )
      {
        v44 = g_iSettlerMagic[5 * j + 4];
        CacheRenderingStandard(
          (void *)g_pIconPalette,
          (void *)(v44 + 6),
          *(unsigned __int16 *)(v44 + 4),
          64,
          g_iSettlerMagic[5 * j + 2],
          g_iSettlerMagic[5 * j + 3],
          (float)g_iSettlerMagic[5 * j],
          (float)g_iSettlerMagic[5 * j + 1],
          0,
          (char *)&dword_F29144[220078] + 3,
          0,
          0);
      }
    }
    else
    {
      for ( j = 0; j < g_iSettlerMagicCounter; ++j )
        ZoomBobNormal(
          (void *)g_pIconPalette,
          (void *)(g_iSettlerMagic[5 * j + 4] + 6),
          g_iSettlerMagic[5 * j + 2],
          g_iSettlerMagic[5 * j + 3],
          g_iSettlerMagic[5 * j],
          g_iSettlerMagic[5 * j + 1],
          0,
          (void *)g_pBeginOfRenderBuffer,
          0);
    }
  }
  if ( g_iSettlerFitnessCounter )
  {
    if ( byte_3E2E30E )
    {
      for ( j = 0; j < g_iSettlerFitnessCounter; ++j )
      {
        v43 = g_iSettlerFitness[5 * j + 4];
        CacheRenderingStandard(
          (void *)g_pIconPalette,
          (void *)(v43 + 6),
          *(unsigned __int16 *)(v43 + 4),
          64,
          g_iSettlerFitness[5 * j + 2],
          g_iSettlerFitness[5 * j + 3],
          (float)g_iSettlerFitness[5 * j],
          (float)g_iSettlerFitness[5 * j + 1],
          0,
          (char *)&dword_F29144[220078] + 3,
          0,
          0);
      }
    }
    else
    {
      for ( j = 0; j < g_iSettlerFitnessCounter; ++j )
        ZoomBobNormal(
          (void *)g_pIconPalette,
          (void *)(g_iSettlerFitness[5 * j + 4] + 6),
          g_iSettlerFitness[5 * j + 2],
          g_iSettlerFitness[5 * j + 3],
          g_iSettlerFitness[5 * j],
          g_iSettlerFitness[5 * j + 1],
          0,
          (void *)g_pBeginOfRenderBuffer,
          0);
    }
  }
  if ( byte_3E2E30D && g_pfSetNumberOfNextLine && g_pfGetIconObjectByX )
  {
    v97 = -8 * v90 - (dword_3E2E2B4 << 16);
    j = dword_3E2E2AC - 7;
    while ( j < v42 + dword_3E2E2AC + 16 )
    {
      if ( (j & 1) != 0 )
      {
        v98 = (dword_3E2E2BC - dword_3E2E2B0 - (v95 >> 16) - ((30 * v95) >> 16)) << 16;
        v88 = 1;
      }
      else
      {
        v98 = v41 + ((dword_3E2E2BC - dword_3E2E2B0 - (v95 >> 16) - ((30 * v95) >> 16)) << 16);
        v88 = 0;
      }
      v27 = v51 + dword_3E2E2A8 + j / 2 + 1;
      v58 = dword_3E2E2A8 + v84 * j + j / 2 - 30;
      v28 = dword_3E2E2A8 + j / 2 - 30;
      if ( FastIndexValidation(j) )
      {
        g_pfSetNumberOfNextLine(j);
        v68 = v28;
        while ( v68 < v27 + 8 )
        {
          if ( FastIndexValidation(v88 + v68) )
          {
            IconObjectByX = g_pfGetIconObjectByX(v88 + v68);
            if ( IconObjectByX == 255 )
              break;
            if ( IconObjectByX )
            {
              v93 = (struct T_GFX_MAP_ELEMENT *)(v57 + 4 * (v88 + v58));
              v26 = CalcFinalHeightOffset(*(unsigned __int8 *)v93);
              g_pfBlitAccessoryIcon(0, v98, v97 - v26, IconObjectByX);
            }
          }
          v98 += v95;
          ++v68;
          ++v58;
        }
      }
      ++j;
      v97 += v90;
    }
  }
  if ( D3DObjectPtr->field_71D && byte_3E2E30E )
    FlushCacheList();
  if ( Src && !a1 )
  {
    if ( D3DObjectPtr->field_71D && byte_3E2E30E )
    {
      v87 = ((int (__thiscall *)(CSurfaceV7 *, int *, int *, int))D3DObjectPtr->FinalRenderSurface->Lock)(
              D3DObjectPtr->FinalRenderSurface,
              &v59,
              &v56,
              1);
      if ( v87 )
      {
        WriteError(v87, "LockSoftwareObjectSurface");
        return 0;
      }
      g_pRenderAdress = v56;
      g_pBeginOfRenderBuffer = v56;
      g_iRenderPitch = v59;
      g_iScanlineLength = 2 * OutputWidth;
    }
    j__memcpy(&dword_468DCEC, Src, 0x10u);
    if ( dword_468DCEC > dword_468DCF4 )
    {
      v25 = dword_468DCEC;
      dword_468DCEC = dword_468DCF4;
      dword_468DCF4 = v25;
    }
    if ( dword_468DCF0 > dword_468DCF8 )
    {
      v24 = dword_468DCF0;
      dword_468DCF0 = dword_468DCF8;
      dword_468DCF8 = v24;
    }
    if ( dword_468DCEC < 0 )
      dword_468DCEC = 0;
    if ( dword_468DCF0 < 0 )
      dword_468DCF0 = 0;
    if ( dword_468DCF8 >= OutputHeight )
      dword_468DCF8 = OutputHeight - 1;
    if ( dword_468DCF4 >= OutputWidth )
      dword_468DCF4 = OutputWidth - 1;
    v15 = word_3E2E2FC;
    v16 = (__int16 *)(dword_468DCEC + dword_468DCEC + g_iRenderPitch * dword_468DCF0 + g_pBeginOfRenderBuffer);
    v17 = v16;
    v18 = (__int16 *)((char *)v16 + dword_468DCF4 - dword_468DCEC + dword_468DCF4 - dword_468DCEC);
    do
      *v16++ = v15;
    while ( (int)v16 <= (int)v18 );
    v19 = v17;
    v20 = dword_468DCF8 - dword_468DCF0;
    if ( dword_468DCF8 != dword_468DCF0 )
    {
      do
      {
        v18 = (__int16 *)((char *)v18 + g_iRenderPitch);
        v19 = (__int16 *)((char *)v19 + g_iRenderPitch);
        *v19 = v15;
        *v18 = v15;
      }
      while ( v20-- > 1 );
      do
        *++v19 = v15;
      while ( (int)v19 < (int)v18 );
    }
    if ( D3DObjectPtr->field_71D )
    {
      if ( byte_3E2E30E )
      {
        v87 = ((int (__thiscall *)(CSurfaceV7 *))D3DObjectPtr->FinalRenderSurface->Unlock)(D3DObjectPtr->FinalRenderSurface);
        if ( v87 )
        {
          WriteError(v87, "UnlockFinalObjectRenderSurface");
          return 0;
        }
      }
    }
  }
  if ( D3DObjectPtr->field_71D && byte_3E2E30E )
  {
    v87 = CInterfaceD3D::EndObjectScene(D3DObjectPtr);
    if ( v87 )
    {
      WriteError(v87, "EndObjectScene");
      return 0;
    }
  }
  else
  {
    v87 = ((int (__thiscall *)(CSurfaceV7 *))D3DObjectPtr->FinalRenderSurface->Unlock)(D3DObjectPtr->FinalRenderSurface);
    if ( v87 )
    {
      WriteError(v87, "UnlockFinalObjectRenderSurface");
      return 0;
    }
  }
  return 1;
}


// address=[0x2f6fab0]
// [Decompilation failed for int __cdecl EncodeImage(unsigned char *,unsigned char *,int,int)]

// address=[0x2f71c50]
// Decompiled from int __cdecl CalcCurrentFog(struct T_GFX_MAP_ELEMENT *a1)
int __cdecl CalcCurrentFog(struct T_GFX_MAP_ELEMENT * a1) {
  
  int OldFogging; // eax
  int NewFogging; // [esp-4h] [ebp-4h]

  NewFogging = T_GFX_MAP_ELEMENT::GetNewFogging(a1);
  OldFogging = T_GFX_MAP_ELEMENT::GetOldFogging(a1);
  return CHeightAndTypeTable::GetObjectFog(
           (CHeightAndTypeTable *)g_cHeightAndTypeTable,
           g_iUsedFogFadeStep,
           OldFogging,
           NewFogging);
}


// address=[0x2f71c80]
// Decompiled from bool __cdecl FastIndexValidation(int a1)
bool __cdecl FastIndexValidation(int a1) {
  
  return a1 >= 0 && a1 < g_iMapSize;
}


// address=[0x2f71d20]
// Decompiled from unsigned __int64 __cdecl ZoomBobBuildState(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9)
void __cdecl ZoomBobBuildState(void * a1, void * a2, int a3, int a4, int a5, int a6, int a7, void * a8, void * a9) {
  
  int v9; // edx
  unsigned __int8 *v10; // esi
  int v11; // ebp
  int v12; // eax
  int v13; // ebx
  unsigned __int8 v14; // al
  int v15; // ecx
  int v16; // edx
  int v17; // edi
  int v18; // edx
  unsigned int v19; // edx
  int v20; // eax
  int v21; // edi
  int v22; // ebx
  char v23; // cc
  __int16 v24; // dx
  bool v25; // of
  int v26; // ebx
  unsigned __int8 v27; // al
  int v28; // eax
  unsigned int v29; // edx
  int v30; // ebx
  int v31; // eax
  unsigned int v32; // edx
  int v33; // edx
  int v34; // ebp
  int v35; // edx
  unsigned __int8 *v37; // esi
  int v38; // ebp
  int v39; // eax
  int v40; // ebx
  unsigned __int8 v41; // al
  int v42; // ecx
  int v43; // edx
  int v44; // edi
  int v45; // eax
  int v46; // eax
  int v47; // edx
  unsigned int v48; // edx
  int v49; // eax
  int v50; // edi
  int v51; // ebx
  char v52; // cc
  __int16 v53; // dx
  int v54; // ebx
  unsigned __int8 v55; // al
  int v56; // eax
  unsigned int v57; // edx
  int v58; // ebx
  int v59; // edx
  char v60; // cc
  __int64 v61; // [esp-20h] [ebp-2Ch]
  unsigned __int64 v62; // [esp-20h] [ebp-2Ch]

  operator|| = a1;
  operator|| = a2;
  operator|| = a3;
  operator|| = a4;
  operator|| = *(_DWORD *)(g_pDestSizeTable + 4 * a3);
  operator|| = *(_DWORD *)(g_pDestSizeTable + 4 * a4);
  operator|| = a5;
  operator|| = a6;
  operator|| = a7;
  operator|| = a8;
  v9 = a9;
  operator|| = a9;
  operator|| = *(_DWORD *)g_pZoomGradient;
  if ( a5 < 0 || (v9 = operator|| + operator||, operator|| + operator|| >= OutputWidth) )
  {
    v62 = __PAIR64__(v9, g_pZoomGradient);
    if ( operator|| >= OutputHeight
      || operator|| + operator|| < 0 != __OFADD__(operator||, operator||)
      || operator|| >= OutputWidth
      || operator|| + operator|| < 0 != __OFADD__(operator||, operator||) )
    {
      return v62;
    }
    v37 = (unsigned __int8 *)operator||;
    v38 = operator||;
    operator|| = g_iRenderPitch * (operator|| - 1) + g_pRenderAdress;
    operator|| = operator|| + operator|| + operator||;
    operator|| = operator||;
    operator|| = 0;
    v39 = 0;
    operator|| = operator||;
    operator|| = g_iZoomInit;
    operator|| = g_iZoomInit;
    while ( 1 )
    {
LABEL_61:
      v40 = 0;
LABEL_62:
      HIWORD(v42) = HIWORD(g_iZoomInit);
      v43 = operator||;
      while ( 1 )
      {
        v23 = (operator|| + v43 < 0) ^ __OFADD__(operator||, v43);
        v43 += operator||;
        if ( !v23 )
          break;
        operator|| = v43;
        if ( v40 <= 0 )
          v40 += operator||;
        do
        {
          while ( 1 )
          {
            v41 = *v37++;
            if ( v41 <= 1u )
              break;
            v23 = v40-- <= 1;
            if ( v23 )
              goto LABEL_60;
          }
          LOBYTE(v39) = *v37++;
          if ( !(_BYTE)v39 )
            return v62;
          v23 = v40 <= v39;
          v40 -= v39;
        }
        while ( !v23 );
LABEL_60:
        operator|| = (int)v37;
      }
      v44 = g_iRenderPitch + operator||;
      v45 = g_iRenderPitch + operator||;
      operator|| = v45;
      if ( v45 < operator|| )
        v45 = operator||;
      operator|| = v45;
      v46 = g_iScanlineLength + v45;
      if ( v46 >= operator|| )
        v46 = operator||;
      operator|| = v46;
      ++operator||;
      v39 = 0;
      v40 += operator||;
      v23 = v43 < 0x10000;
      v47 = v43 - 0x10000;
      if ( v23 )
      {
        operator|| = v47;
        operator|| += g_iRenderPitch;
        v49 = operator|| * (operator|| - v40);
        v48 = (unsigned int)(v49 + g_iZoomInit + 0x10000) >> 16;
        LOWORD(v42) = v49 + g_iZoomInit;
        operator|| = v48;
        operator|| = v40;
        operator|| = v42;
        operator|| = (int)v37;
        v39 = 0;
      }
      else
      {
        v37 = (unsigned __int8 *)operator||;
        operator|| = v47 - operator||;
        v48 = operator||;
        operator|| += g_iRenderPitch;
        v40 = operator||;
        v42 = operator||;
      }
      v50 = v44 + 2 * v48;
      if ( v50 >= g_iScanlineLength + operator|| )
      {
        if ( v50 < operator|| )
          goto LABEL_73;
        return v62;
      }
      v39 = 0;
      if ( operator|| > operator|| )
        break;
      while ( 1 )
      {
        v23 = v40-- < 1;
        if ( v23 )
          break;
        v55 = *v37++;
        if ( v55 <= 1u )
        {
          v54 = v40 + 1;
          LOBYTE(v39) = *v37++;
          if ( !(_BYTE)v39 )
            return v62;
          v23 = v54 < v39;
          v40 = v54 - v39;
          if ( v23 )
            goto LABEL_62;
        }
      }
    }
    while ( 1 )
    {
      while ( 1 )
      {
LABEL_73:
        v23 = v40-- < 1;
        if ( v23 )
          goto LABEL_61;
        LOBYTE(v39) = *v37++;
        if ( (_BYTE)v39 )
          break;
        v51 = v40 + 1;
        LOBYTE(v39) = *v37++;
LABEL_104:
        v23 = v51 < v39;
        v40 = v51 - v39;
        if ( v23 )
          goto LABEL_62;
        v56 = operator|| * v39;
        v57 = (unsigned int)(v56 + v42 + 0x10000) >> 16;
        LOWORD(v42) = v56 + v42;
        v50 += 2 * v57;
        v39 = 0;
      }
      if ( (_BYTE)v39 == 1 )
      {
        v58 = v40 + 1;
        LOBYTE(v39) = *v37++;
        if ( !(_BYTE)v39 )
          return v62;
        v40 = v58 - v39++;
        v59 = v50 & 2;
        if ( (v50 & 2) == 0 )
          --v59;
        if ( (operator|| & 1) != 0 )
          v59 = -v59;
        while ( --v39 )
        {
          v60 = (operator|| + v42 < 0) ^ __OFADD__(operator||, v42);
          for ( v42 += operator||; !v60; v60 = (v42 < 0) ^ v25 )
          {
            v59 = -v59;
            if ( v59 >= 1 && v50 >= operator|| && v50 < operator|| )
              *(_WORD *)v50 = 0;
            v50 += 2;
            v23 = v42 < 0x10000;
            v42 -= 0x10000;
            if ( v23 )
              break;
            v59 = -v59;
            if ( v59 >= 1 && v50 >= operator|| && v50 < operator|| )
              *(_WORD *)v50 = 0;
            v50 += 2;
            v23 = v42 < 0x10000;
            v42 -= 0x10000;
            if ( v23 )
              break;
            v59 = -v59;
            if ( v59 >= 1 && v50 >= operator|| && v50 < operator|| )
              *(_WORD *)v50 = 0;
            v50 += 2;
            v23 = v42 < 0x10000;
            v42 -= 0x10000;
            if ( v23 )
              break;
            v59 = -v59;
            if ( v59 >= 1 && v50 >= operator|| && v50 < operator|| )
              *(_WORD *)v50 = 0;
            v50 += 2;
            v25 = __OFSUB__(v42, 0x10000);
            v42 -= 0x10000;
          }
        }
      }
      else
      {
        if ( (v40 & 8) != 0 )
        {
          v39 = 1;
          v51 = v40 + 1;
          goto LABEL_104;
        }
        v52 = (operator|| + v42 < 0) ^ __OFADD__(operator||, v42);
        for ( v42 += operator||; !v52; v52 = (v42 < 0) ^ v25 )
        {
          v53 = *(_WORD *)(v38 + 2 * v39);
          if ( v50 >= operator|| && v50 < operator|| )
            *(_WORD *)v50 = v53;
          v50 += 2;
          v23 = v42 < 0x10000;
          v42 -= 0x10000;
          if ( v23 )
            break;
          if ( v50 >= operator|| && v50 < operator|| )
            *(_WORD *)v50 = v53;
          v50 += 2;
          v23 = v42 < 0x10000;
          v42 -= 0x10000;
          if ( v23 )
            break;
          if ( v50 >= operator|| && v50 < operator|| )
            *(_WORD *)v50 = v53;
          v50 += 2;
          v23 = v42 < 0x10000;
          v42 -= 0x10000;
          if ( v23 )
            break;
          if ( v50 >= operator|| && v50 < operator|| )
            *(_WORD *)v50 = v53;
          v50 += 2;
          v25 = __OFSUB__(v42, 0x10000);
          v42 -= 0x10000;
        }
      }
    }
  }
  HIDWORD(v61) = operator|| + operator||;
  LODWORD(v61) = g_pZoomGradient;
  if ( operator|| >= OutputHeight || operator|| + operator|| < 0 != __OFADD__(operator||, operator||) )
    return v61;
  v10 = (unsigned __int8 *)operator||;
  v11 = operator||;
  operator|| = operator|| + operator|| + g_iRenderPitch * (operator|| - 1) + g_pRenderAdress;
  operator|| = operator||;
  operator|| = 0;
  v12 = 0;
  operator|| = operator||;
  operator|| = g_iZoomInit;
  operator|| = g_iZoomInit;
LABEL_13:
  while ( 1 )
  {
    v13 = 0;
LABEL_14:
    HIWORD(v15) = HIWORD(g_iZoomInit);
    v16 = operator||;
    while ( 1 )
    {
      v23 = (operator|| + v16 < 0) ^ __OFADD__(operator||, v16);
      v16 += operator||;
      if ( !v23 )
        break;
      operator|| = v16;
      if ( v13 <= 0 )
        v13 += operator||;
      do
      {
        while ( 1 )
        {
          v14 = *v10++;
          if ( v14 <= 1u )
            break;
          v23 = v13-- <= 1;
          if ( v23 )
            goto LABEL_12;
        }
        LOBYTE(v12) = *v10++;
        if ( !(_BYTE)v12 )
          return v61;
        v23 = v13 <= v12;
        v13 -= v12;
      }
      while ( !v23 );
LABEL_12:
      operator|| = (int)v10;
    }
    v17 = g_iRenderPitch + operator||;
    ++operator||;
    v13 += operator||;
    v23 = v16 < 0x10000;
    v18 = v16 - 0x10000;
    if ( v23 )
    {
      operator|| = v18;
      operator|| += g_iRenderPitch;
      v20 = operator|| * (operator|| - v13);
      v19 = (unsigned int)(v20 + g_iZoomInit + 0x10000) >> 16;
      LOWORD(v15) = v20 + g_iZoomInit;
      operator|| = v19;
      operator|| = v13;
      operator|| = v15;
      operator|| = (int)v10;
      v12 = 0;
    }
    else
    {
      v10 = (unsigned __int8 *)operator||;
      operator|| = v18 - operator||;
      v19 = operator||;
      operator|| += g_iRenderPitch;
      v13 = operator||;
      v15 = operator||;
    }
    v21 = v17 + 2 * v19;
    if ( v21 >= operator|| )
      break;
    while ( 1 )
    {
      v23 = v13-- < 1;
      if ( v23 )
        break;
      v27 = *v10++;
      if ( v27 <= 1u )
      {
        v26 = v13 + 1;
        LOBYTE(v12) = *v10++;
        if ( !(_BYTE)v12 )
          return v61;
        v23 = v26 < v12;
        v13 = v26 - v12;
        if ( v23 )
          goto LABEL_14;
      }
    }
  }
  if ( v21 < operator|| )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        v23 = v13-- < 1;
        if ( v23 )
          goto LABEL_13;
        LOBYTE(v12) = *v10++;
        if ( (_BYTE)v12 )
          break;
        v22 = v13 + 1;
        LOBYTE(v12) = *v10++;
LABEL_38:
        v23 = v22 < v12;
        v13 = v22 - v12;
        if ( v23 )
          goto LABEL_14;
        v28 = operator|| * v12;
        v29 = (unsigned int)(v28 + v15 + 0x10000) >> 16;
        LOWORD(v15) = v28 + v15;
        v21 += 2 * v29;
        v12 = 0;
      }
      if ( (_BYTE)v12 == 1 )
      {
        v30 = v13 + 1;
        LOBYTE(v12) = *v10++;
        if ( !(_BYTE)v12 )
          return v61;
        v13 = v30 - v12;
        v31 = operator|| * v12;
        v32 = v31 + v15 + 0x10000;
        LOWORD(v15) = v31 + v15;
        v33 = HIWORD(v32);
        v34 = v21 + 2 * v33;
        if ( (v21 & 2) != ((2 * (_BYTE)operator||) & 2) )
        {
          --v33;
          v21 += 2;
        }
        while ( v33 >= 8 )
        {
          *(_WORD *)v21 = 0;
          *(_WORD *)(v21 + 4) = 0;
          *(_WORD *)(v21 + 8) = 0;
          *(_WORD *)(v21 + 12) = 0;
          v33 -= 8;
          v21 += 16;
        }
        while ( 1 )
        {
          v23 = v33 < 1;
          v35 = v33 - 1;
          if ( v23 )
            break;
          *(_WORD *)v21 = 0;
          v33 = v35 - 1;
          v21 += 4;
        }
        v21 = v34;
        v12 = 0;
        v11 = operator||;
      }
      else
      {
        if ( (v13 & 8) != 0 )
        {
          v12 = 1;
          v22 = v13 + 1;
          goto LABEL_38;
        }
        v23 = (operator|| + v15 < 0) ^ __OFADD__(operator||, v15);
        for ( v15 += operator||; !v23; v23 = (v15 < 0) ^ v25 )
        {
          v24 = *(_WORD *)(v11 + 2 * v12);
          *(_WORD *)v21 = v24;
          v21 += 2;
          v23 = v15 < 0x10000;
          v15 -= 0x10000;
          if ( v23 )
            break;
          *(_WORD *)v21 = v24;
          v21 += 2;
          v23 = v15 < 0x10000;
          v15 -= 0x10000;
          if ( v23 )
            break;
          *(_WORD *)v21 = v24;
          v21 += 2;
          v23 = v15 < 0x10000;
          v15 -= 0x10000;
          if ( v23 )
            break;
          *(_WORD *)v21 = v24;
          v21 += 2;
          v25 = __OFSUB__(v15, 0x10000);
          v15 -= 0x10000;
        }
      }
    }
  }
  return v61;
}


// address=[0x2f72630]
// Decompiled from unsigned __int64 __cdecl ZoomBobNormal(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, char a9)
void __cdecl ZoomBobNormal(void * a1, void * a2, int a3, int a4, int a5, int a6, int a7, void * a8, int a9) {
  
  int v9; // edx
  unsigned __int8 *v10; // esi
  int v11; // ebp
  int v12; // eax
  int v13; // ebx
  unsigned __int8 v14; // al
  int v15; // ecx
  int v16; // edx
  int v17; // edi
  int v18; // edx
  unsigned int v19; // edx
  int v20; // eax
  int v21; // edi
  char v22; // cc
  __int16 v23; // dx
  bool v24; // of
  int v25; // ebx
  unsigned __int8 v26; // al
  int v27; // ebx
  int v28; // eax
  unsigned int v29; // edx
  int v30; // ebx
  int v31; // eax
  unsigned int v32; // edx
  int v33; // edx
  int v34; // ebp
  int v35; // edx
  unsigned __int8 *v37; // esi
  int v38; // ebp
  int v39; // eax
  int v40; // ebx
  unsigned __int8 v41; // al
  int v42; // ecx
  int v43; // edx
  int v44; // edi
  int v45; // eax
  int v46; // eax
  int v47; // edx
  unsigned int v48; // edx
  int v49; // eax
  int v50; // edi
  char v51; // cc
  __int16 v52; // dx
  int v53; // ebx
  unsigned __int8 v54; // al
  int v55; // ebx
  int v56; // eax
  unsigned int v57; // edx
  int v58; // ebx
  int v59; // edx
  char v60; // cc
  __int64 v61; // [esp-20h] [ebp-2Ch]
  unsigned __int64 v62; // [esp-20h] [ebp-2Ch]

  operator|| = a1;
  operator|| = a2;
  operator|| = a3;
  operator|| = a4;
  operator|| = *(int *)(g_pDestSizeTable + 4 * a3) >> a9;
  operator|| = *(int *)(g_pDestSizeTable + 4 * a4) >> a9;
  operator|| = a5;
  operator|| = a6;
  operator|| = a7;
  operator|| = a8;
  v9 = g_pEndOfRenderBuffer;
  operator|| = g_pEndOfRenderBuffer;
  operator|| = *(_DWORD *)g_pZoomGradient;
  if ( a5 < 0 || (v9 = operator|| + operator||, operator|| + operator|| >= OutputWidth) )
  {
    v62 = __PAIR64__(v9, g_pZoomGradient);
    if ( operator|| >= OutputHeight
      || operator|| + operator|| < 0 != __OFADD__(operator||, operator||)
      || operator|| >= OutputWidth
      || operator|| + operator|| < 0 != __OFADD__(operator||, operator||) )
    {
      return v62;
    }
    v37 = (unsigned __int8 *)operator||;
    v38 = operator||;
    operator|| = g_iRenderPitch * (operator|| - 1) + g_pRenderAdress;
    operator|| = operator|| + operator|| + operator||;
    operator|| = operator||;
    operator|| = 0;
    v39 = 0;
    operator|| = operator||;
    operator|| = g_iZoomInit;
    operator|| = g_iZoomInit;
    while ( 1 )
    {
      v40 = 0;
LABEL_59:
      HIWORD(v42) = HIWORD(g_iZoomInit);
      v43 = operator||;
      while ( 1 )
      {
        v22 = (operator|| + v43 < 0) ^ __OFADD__(operator||, v43);
        v43 += operator||;
        if ( !v22 )
          break;
        operator|| = v43;
        if ( v40 <= 0 )
          v40 += operator||;
        do
        {
          while ( 1 )
          {
            v41 = *v37++;
            if ( v41 <= 1u )
              break;
            v22 = v40-- <= 1;
            if ( v22 )
              goto LABEL_57;
          }
          LOBYTE(v39) = *v37++;
          if ( !(_BYTE)v39 )
            return v62;
          v22 = v40 <= v39;
          v40 -= v39;
        }
        while ( !v22 );
LABEL_57:
        operator|| = (int)v37;
      }
      v44 = g_iRenderPitch + operator||;
      v45 = g_iRenderPitch + operator||;
      operator|| = v45;
      if ( v45 < operator|| )
        v45 = operator||;
      operator|| = v45;
      v46 = g_iScanlineLength + v45;
      if ( v46 >= operator|| )
        v46 = operator||;
      operator|| = v46;
      ++operator||;
      v39 = 0;
      v40 += operator||;
      v22 = v43 < 0x10000;
      v47 = v43 - 0x10000;
      if ( v22 )
      {
        operator|| = v47;
        operator|| += g_iRenderPitch;
        v49 = operator|| * (operator|| - v40);
        v48 = (unsigned int)(v49 + g_iZoomInit + 0x10000) >> 16;
        LOWORD(v42) = v49 + g_iZoomInit;
        operator|| = v48;
        operator|| = v40;
        operator|| = v42;
        operator|| = (int)v37;
        v39 = 0;
      }
      else
      {
        v37 = (unsigned __int8 *)operator||;
        operator|| = v47 - operator||;
        v48 = operator||;
        operator|| += g_iRenderPitch;
        v40 = operator||;
        v42 = operator||;
      }
      v50 = v44 + 2 * v48;
      if ( v50 >= g_iScanlineLength + operator|| )
        break;
      v39 = 0;
      if ( operator|| > operator|| )
      {
LABEL_70:
        while ( 1 )
        {
          v22 = v40-- < 1;
          if ( v22 )
            break;
          LOBYTE(v39) = *v37++;
          if ( (_BYTE)v39 )
          {
            if ( (_BYTE)v39 == 1 )
            {
              v58 = v40 + 1;
              LOBYTE(v39) = *v37++;
              if ( !(_BYTE)v39 )
                return v62;
              v40 = v58 - v39++;
              v59 = v50 & 2;
              if ( (v50 & 2) == 0 )
                --v59;
              if ( (operator|| & 1) != 0 )
                v59 = -v59;
              while ( --v39 )
              {
                v60 = (operator|| + v42 < 0) ^ __OFADD__(operator||, v42);
                for ( v42 += operator||; !v60; v60 = (v42 < 0) ^ v24 )
                {
                  v59 = -v59;
                  if ( v59 >= 1 && v50 >= operator|| && v50 < operator|| )
                    *(_WORD *)v50 = 0;
                  v50 += 2;
                  v22 = v42 < 0x10000;
                  v42 -= 0x10000;
                  if ( v22 )
                    break;
                  v59 = -v59;
                  if ( v59 >= 1 && v50 >= operator|| && v50 < operator|| )
                    *(_WORD *)v50 = 0;
                  v50 += 2;
                  v22 = v42 < 0x10000;
                  v42 -= 0x10000;
                  if ( v22 )
                    break;
                  v59 = -v59;
                  if ( v59 >= 1 && v50 >= operator|| && v50 < operator|| )
                    *(_WORD *)v50 = 0;
                  v50 += 2;
                  v22 = v42 < 0x10000;
                  v42 -= 0x10000;
                  if ( v22 )
                    break;
                  v59 = -v59;
                  if ( v59 >= 1 && v50 >= operator|| && v50 < operator|| )
                    *(_WORD *)v50 = 0;
                  v50 += 2;
                  v24 = __OFSUB__(v42, 0x10000);
                  v42 -= 0x10000;
                }
              }
            }
            else
            {
              v51 = (operator|| + v42 < 0) ^ __OFADD__(operator||, v42);
              for ( v42 += operator||; !v51; v51 = (v42 < 0) ^ v24 )
              {
                v52 = *(_WORD *)(v38 + 2 * v39);
                if ( v50 >= operator|| && v50 < operator|| )
                  *(_WORD *)v50 = v52;
                v50 += 2;
                v22 = v42 < 0x10000;
                v42 -= 0x10000;
                if ( v22 )
                  break;
                if ( v50 >= operator|| && v50 < operator|| )
                  *(_WORD *)v50 = v52;
                v50 += 2;
                v22 = v42 < 0x10000;
                v42 -= 0x10000;
                if ( v22 )
                  break;
                if ( v50 >= operator|| && v50 < operator|| )
                  *(_WORD *)v50 = v52;
                v50 += 2;
                v22 = v42 < 0x10000;
                v42 -= 0x10000;
                if ( v22 )
                  break;
                if ( v50 >= operator|| && v50 < operator|| )
                  *(_WORD *)v50 = v52;
                v50 += 2;
                v24 = __OFSUB__(v42, 0x10000);
                v42 -= 0x10000;
              }
            }
          }
          else
          {
            v55 = v40 + 1;
            LOBYTE(v39) = *v37++;
            v22 = v55 < v39;
            v40 = v55 - v39;
            if ( v22 )
              goto LABEL_59;
            v56 = operator|| * v39;
            v57 = (unsigned int)(v56 + v42 + 0x10000) >> 16;
            LOWORD(v42) = v56 + v42;
            v50 += 2 * v57;
            v39 = 0;
          }
        }
      }
      else
      {
        while ( 1 )
        {
          v22 = v40-- < 1;
          if ( v22 )
            break;
          v54 = *v37++;
          if ( v54 <= 1u )
          {
            v53 = v40 + 1;
            LOBYTE(v39) = *v37++;
            if ( !(_BYTE)v39 )
              return v62;
            v22 = v53 < v39;
            v40 = v53 - v39;
            if ( v22 )
              goto LABEL_59;
          }
        }
      }
    }
    if ( v50 < operator|| )
      goto LABEL_70;
    return v62;
  }
  else
  {
    HIDWORD(v61) = operator|| + operator||;
    LODWORD(v61) = g_pZoomGradient;
    if ( operator|| >= OutputHeight || operator|| + operator|| < 0 != __OFADD__(operator||, operator||) )
      return v61;
    v10 = (unsigned __int8 *)operator||;
    v11 = operator||;
    operator|| = operator|| + operator|| + g_iRenderPitch * (operator|| - 1) + g_pRenderAdress;
    operator|| = operator||;
    operator|| = 0;
    v12 = 0;
    operator|| = operator||;
    operator|| = g_iZoomInit;
    operator|| = g_iZoomInit;
    while ( 1 )
    {
      while ( 1 )
      {
        v13 = 0;
LABEL_14:
        HIWORD(v15) = HIWORD(g_iZoomInit);
        v16 = operator||;
        while ( 1 )
        {
          v22 = (operator|| + v16 < 0) ^ __OFADD__(operator||, v16);
          v16 += operator||;
          if ( !v22 )
            break;
          operator|| = v16;
          if ( v13 <= 0 )
            v13 += operator||;
          do
          {
            while ( 1 )
            {
              v14 = *v10++;
              if ( v14 <= 1u )
                break;
              v22 = v13-- <= 1;
              if ( v22 )
                goto LABEL_12;
            }
            LOBYTE(v12) = *v10++;
            if ( !(_BYTE)v12 )
              return v61;
            v22 = v13 <= v12;
            v13 -= v12;
          }
          while ( !v22 );
LABEL_12:
          operator|| = (int)v10;
        }
        v17 = g_iRenderPitch + operator||;
        ++operator||;
        v13 += operator||;
        v22 = v16 < 0x10000;
        v18 = v16 - 0x10000;
        if ( v22 )
        {
          operator|| = v18;
          operator|| += g_iRenderPitch;
          v20 = operator|| * (operator|| - v13);
          v19 = (unsigned int)(v20 + g_iZoomInit + 0x10000) >> 16;
          LOWORD(v15) = v20 + g_iZoomInit;
          operator|| = v19;
          operator|| = v13;
          operator|| = v15;
          operator|| = (int)v10;
          v12 = 0;
        }
        else
        {
          v10 = (unsigned __int8 *)operator||;
          operator|| = v18 - operator||;
          v19 = operator||;
          operator|| += g_iRenderPitch;
          v13 = operator||;
          v15 = operator||;
        }
        v21 = v17 + 2 * v19;
        if ( v21 >= operator|| )
          break;
        while ( 1 )
        {
          v22 = v13-- < 1;
          if ( v22 )
            break;
          v26 = *v10++;
          if ( v26 <= 1u )
          {
            v25 = v13 + 1;
            LOBYTE(v12) = *v10++;
            if ( !(_BYTE)v12 )
              return v61;
            v22 = v25 < v12;
            v13 = v25 - v12;
            if ( v22 )
              goto LABEL_14;
          }
        }
      }
      if ( v21 >= operator|| )
        break;
      while ( 1 )
      {
        v22 = v13-- < 1;
        if ( v22 )
          break;
        LOBYTE(v12) = *v10++;
        if ( (_BYTE)v12 )
        {
          if ( (_BYTE)v12 == 1 )
          {
            v30 = v13 + 1;
            LOBYTE(v12) = *v10++;
            if ( !(_BYTE)v12 )
              return v61;
            v13 = v30 - v12;
            v31 = operator|| * v12;
            v32 = v31 + v15 + 0x10000;
            LOWORD(v15) = v31 + v15;
            v33 = HIWORD(v32);
            v34 = v21 + 2 * v33;
            if ( (v21 & 2) != ((2 * (_BYTE)operator||) & 2) )
            {
              --v33;
              v21 += 2;
            }
            while ( v33 >= 8 )
            {
              *(_WORD *)v21 = 0;
              *(_WORD *)(v21 + 4) = 0;
              *(_WORD *)(v21 + 8) = 0;
              *(_WORD *)(v21 + 12) = 0;
              v33 -= 8;
              v21 += 16;
            }
            while ( 1 )
            {
              v22 = v33 < 1;
              v35 = v33 - 1;
              if ( v22 )
                break;
              *(_WORD *)v21 = 0;
              v33 = v35 - 1;
              v21 += 4;
            }
            v21 = v34;
            v12 = 0;
            v11 = operator||;
          }
          else
          {
            v22 = (operator|| + v15 < 0) ^ __OFADD__(operator||, v15);
            for ( v15 += operator||; !v22; v22 = (v15 < 0) ^ v24 )
            {
              v23 = *(_WORD *)(v11 + 2 * v12);
              *(_WORD *)v21 = v23;
              v21 += 2;
              v22 = v15 < 0x10000;
              v15 -= 0x10000;
              if ( v22 )
                break;
              *(_WORD *)v21 = v23;
              v21 += 2;
              v22 = v15 < 0x10000;
              v15 -= 0x10000;
              if ( v22 )
                break;
              *(_WORD *)v21 = v23;
              v21 += 2;
              v22 = v15 < 0x10000;
              v15 -= 0x10000;
              if ( v22 )
                break;
              *(_WORD *)v21 = v23;
              v21 += 2;
              v24 = __OFSUB__(v15, 0x10000);
              v15 -= 0x10000;
            }
          }
        }
        else
        {
          v27 = v13 + 1;
          LOBYTE(v12) = *v10++;
          v22 = v27 < v12;
          v13 = v27 - v12;
          if ( v22 )
            goto LABEL_14;
          v28 = operator|| * v12;
          v29 = (unsigned int)(v28 + v15 + 0x10000) >> 16;
          LOWORD(v15) = v28 + v15;
          v21 += 2 * v29;
          v12 = 0;
        }
      }
    }
    return v61;
  }
}


// address=[0x2f73b40]
// Decompiled from char AddGuiPatches()
bool __cdecl AddGuiPatches(void) {
  
  int v1; // [esp+0h] [ebp-Ch]
  int v2; // [esp+4h] [ebp-8h]
  unsigned int i; // [esp+8h] [ebp-4h]

  if ( !D3DObjectPtr )
    return 1;
  if ( !D3DObjectPtr->FinalRenderSurface )
    return 1;
  if ( SGfxRenderConfiguration::IsEditorMode((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    if ( !D3DObjectPtr->field_138[0] || !byte_468E2E8[0] )
      return 1;
    if ( !(unsigned __int8)sub_2F74710((RECT *)&unk_468DFA8) )
      return 1;
    v2 = (*(int (__thiscall **)(DWORD, char *, CSurfaceV7 *, char *, _DWORD, _DWORD))(*(_DWORD *)D3DObjectPtr->field_138[0]
                                                                                    + 24))(
           D3DObjectPtr->field_138[0],
           byte_468E208,
           D3DObjectPtr->FinalRenderSurface,
           byte_468E128,
           0,
           0);
    if ( !v2 && D3DObjectPtr->field_138[1] && byte_468E2E8[1] )
    {
      if ( !(unsigned __int8)sub_2F74710((RECT *)((char *)&unk_468DFA8 + 28)) )
        return 1;
      if ( byte_468DFB8[28] )
      {
        (*(void (__thiscall **)(DWORD, int, void *))(*(_DWORD *)D3DObjectPtr->field_138[1] + 52))(
          D3DObjectPtr->field_138[1],
          8,
          &g_sColorKeyGui);
        v2 = (*(int (__thiscall **)(DWORD, char *, DWORD, char *, int, _DWORD))(*(_DWORD *)D3DObjectPtr->field_138[0]
                                                                              + 24))(
               D3DObjectPtr->field_138[0],
               &byte_468E208[16],
               D3DObjectPtr->field_138[1],
               &byte_468E128[16],
               0x8000,
               0);
      }
      else
      {
        v2 = (*(int (__thiscall **)(DWORD, char *, DWORD, char *, _DWORD, _DWORD))(*(_DWORD *)D3DObjectPtr->field_138[0]
                                                                                 + 24))(
               D3DObjectPtr->field_138[0],
               &byte_468E208[16],
               D3DObjectPtr->field_138[1],
               &byte_468E128[16],
               0,
               0);
      }
    }
    if ( v2 )
    {
      WriteError(v2, "BlitGuiSurface");
      BBSupportTracePrintF(0, "GFX ENGINE: Problem with gui surfaces! Stop rendering...");
      D3DObjectPtr->field_740 = 1;
      return 0;
    }
    D3DObjectPtr->field_743 = 1;
  }
  else
  {
    for ( i = 0; i < 0xE; ++i )
    {
      if ( D3DObjectPtr->field_138[i]
        && byte_468E2E8[i]
        && (unsigned __int8)sub_2F74710((RECT *)((char *)&unk_468DFA8 + 28 * i)) )
      {
        if ( byte_468DFB8[28 * i] )
        {
          (*(void (__thiscall **)(DWORD, int, void *))(*(_DWORD *)D3DObjectPtr->field_138[i] + 52))(
            D3DObjectPtr->field_138[i],
            8,
            &g_sColorKeyGui);
          v1 = ((int (__thiscall *)(CSurfaceV7 *, char *, DWORD, char *, int, _DWORD))D3DObjectPtr->FinalRenderSurface->Blt)(
                 D3DObjectPtr->FinalRenderSurface,
                 &byte_468E208[16 * i],
                 D3DObjectPtr->field_138[i],
                 &byte_468E128[16 * i],
                 0x8000,
                 0);
        }
        else
        {
          v1 = ((int (__thiscall *)(CSurfaceV7 *, char *, DWORD, char *, _DWORD, _DWORD))D3DObjectPtr->FinalRenderSurface->Blt)(
                 D3DObjectPtr->FinalRenderSurface,
                 &byte_468E208[16 * i],
                 D3DObjectPtr->field_138[i],
                 &byte_468E128[16 * i],
                 0,
                 0);
        }
        if ( v1 )
        {
          WriteError(v1, "BlitGuiSurface");
          BBSupportTracePrintF(0, "GFX ENGINE: Problem with gui surfaces! Stop rendering...");
          D3DObjectPtr->field_740 = 1;
          return 0;
        }
        D3DObjectPtr->field_743 = 1;
      }
    }
  }
  return 1;
}


// address=[0x2f73f90]
// Decompiled from void __cdecl AddDebugStrings(int a1)
void __cdecl AddDebugStrings(int a1) {
  
  const char *v1; // eax
  const CHAR *v2; // eax
  size_t v3; // eax
  size_t v4; // eax
  size_t v5; // [esp+8h] [ebp-130h]
  HGDIOBJ v6; // [esp+10h] [ebp-128h]
  int v7; // [esp+14h] [ebp-124h]
  int v8; // [esp+1Ch] [ebp-11Ch]
  size_t v9; // [esp+24h] [ebp-114h]
  int v10; // [esp+28h] [ebp-110h]
  int v11; // [esp+2Ch] [ebp-10Ch]
  int v12; // [esp+30h] [ebp-108h]
  HFONT h; // [esp+38h] [ebp-100h]
  HFONT ho; // [esp+3Ch] [ebp-FCh]
  int v15; // [esp+40h] [ebp-F8h]
  int v16; // [esp+44h] [ebp-F4h]
  int v17; // [esp+48h] [ebp-F0h]
  int v18; // [esp+4Ch] [ebp-ECh]
  int v19; // [esp+50h] [ebp-E8h]
  int v20; // [esp+54h] [ebp-E4h]
  int v21; // [esp+58h] [ebp-E0h]
  int j; // [esp+5Ch] [ebp-DCh]
  int v23; // [esp+60h] [ebp-D8h]
  HDC hdc; // [esp+64h] [ebp-D4h] BYREF
  int i; // [esp+68h] [ebp-D0h]
  CHAR Str[100]; // [esp+6Ch] [ebp-CCh] BYREF
  CHAR String[100]; // [esp+D0h] [ebp-68h] BYREF

  if ( dword_468DF98 || dword_468DF9C )
  {
    ((void (__thiscall *)(CSurfaceV7 *, HDC *))D3DObjectPtr->FinalRenderSurface->j_?GetDC@CSurfaceV7@@UAEJPAPAUHDC__@@@Z)(
      D3DObjectPtr->FinalRenderSurface,
      &hdc);
    SetBkMode(hdc, 1);
    SetTextColor(hdc, (COLORREF)&dword_F29144[220078] + 3);
    SetTextAlign(hdc, 0x1Eu);
    ho = CreateFontA(11, 5, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0x20u, "Arial");
    h = CreateFontA(18, 5, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0x20u, "Arial");
    v6 = SelectObject(hdc, h);
    if ( dword_468DF9C )
    {
      v1 = (const char *)dword_468DF9C();
      v5 = j__strlen(v1);
      v2 = (const CHAR *)dword_468DF9C();
      TextOutA(hdc, OutputWidth / 2, 16, v2, v5);
      j__sprintf(String, "RndTime: %.3f sec/frame", (float)((float)a1 / 1000.0));
      v3 = j__strlen(String);
      TextOutA(hdc, OutputWidth / 2, 32, String, v3);
    }
    SelectObject(hdc, ho);
    if ( !dword_468DF98 )
      goto LABEL_21;
    v9 = Size;
    v17 = dword_3E2E2A0;
    if ( dword_3E2E2A0 )
    {
      v23 = dword_3E2E28C;
      v15 = dword_3E2E290;
      v10 = (((OutputWidth - dword_3E2E2BC) << 16) + 4 * dword_3E2E28C) / dword_3E2E28C;
      v12 = (dword_3E2E290 + (OutputHeight << 16)) / dword_3E2E290;
      v18 = -dword_3E2E290 - (dword_3E2E2B4 << 16);
      if ( D3DObjectPtr )
      {
        v11 = -dword_3E2E28C / 2;
        for ( i = dword_3E2E2AC; i < v12 + dword_3E2E2AC + 16; ++i )
        {
          if ( (i & 1) != 0 )
          {
            v20 = (dword_3E2E2BC - dword_3E2E2B0 - (v23 >> 16)) << 16;
            v21 = 1;
          }
          else
          {
            v20 = v11 + ((dword_3E2E2BC - dword_3E2E2B0 - (v23 >> 16)) << 16);
            v21 = 0;
          }
          v8 = v10 + dword_3E2E2A8 + i / 2 + 1;
          v19 = i / 2 + dword_3E2E2A8 + v9 * i;
          for ( j = dword_3E2E2A8 + i / 2; j < v8; ++j )
          {
            if ( FastIndexValidation(i) && FastIndexValidation(v21 + j) )
            {
              v7 = CalcFinalHeightOffset(*(unsigned __int8 *)(v17 + 4 * (v21 + v19)));
              v16 = dword_468DF98(v21 + j, i);
              if ( v16 > 0 )
              {
                j__sprintf(Str, "%d", v16);
                v4 = j__strlen(Str);
                TextOutA(hdc, v20 >> 16, ((v18 - v7) >> 16) + 5, Str, v4);
              }
            }
            v20 += v23;
            ++v19;
          }
          v18 += v15;
        }
LABEL_21:
        SelectObject(hdc, v6);
        ((void (__thiscall *)(CSurfaceV7 *, HDC))D3DObjectPtr->FinalRenderSurface->j_?ReleaseDC@CSurfaceV7@@UAEJPAUHDC__@@@Z)(
          D3DObjectPtr->FinalRenderSurface,
          hdc);
        DeleteObject(ho);
        DeleteObject(h);
      }
    }
  }
}


// address=[0x2f744d0]
// Decompiled from int *__cdecl ClipGuiSurface(int a1)
void __cdecl ClipGuiSurface(int a1) {
  
  int *result; // eax
  _BYTE v2[16]; // [esp+0h] [ebp-58h] BYREF
  float v3; // [esp+10h] [ebp-48h]
  float v4; // [esp+14h] [ebp-44h]
  float v5; // [esp+18h] [ebp-40h]
  float v6; // [esp+1Ch] [ebp-3Ch]
  LPRECT lprcDst; // [esp+20h] [ebp-38h]
  char *v8; // [esp+24h] [ebp-34h]
  LPRECT v9; // [esp+28h] [ebp-30h]
  int *v10; // [esp+2Ch] [ebp-2Ch]
  _DWORD *v11; // [esp+30h] [ebp-28h]
  RECT rcSrc2; // [esp+34h] [ebp-24h] BYREF
  RECT v13; // [esp+44h] [ebp-14h]

  v10 = &dword_468DFA0[7 * a1];
  v8 = &byte_468E128[16 * a1];
  lprcDst = (LPRECT)&byte_468E208[16 * a1];
  v13 = *(RECT *)sub_2F74660(v2);
  rcSrc2 = v13;
  IntersectRect(lprcDst, (const RECT *)(v10 + 2), &rcSrc2);
  v11 = v10 + 2;
  v9 = lprcDst;
  v6 = sub_2F746D0(lprcDst->left, v10[2], v10[4]);
  *(_DWORD *)v8 = (int)(float)(v6 * (float)*v10);
  v5 = sub_2F746D0(v9->top, v11[1], v11[3]);
  *((_DWORD *)v8 + 1) = (int)(float)(v5 * (float)v10[1]);
  v4 = sub_2F746D0(v9->right, *v11, v11[2]);
  *((_DWORD *)v8 + 2) = (int)(float)(v4 * (float)*v10);
  v3 = sub_2F746D0(v9->bottom, v11[1], v11[3]);
  result = v10;
  *((_DWORD *)v8 + 3) = (int)(float)(v3 * (float)v10[1]);
  return result;
}


// address=[0x2f750f0]
// Decompiled from char __cdecl DrawTexturedLandscapeDelta(int a1, int a2)
bool __cdecl DrawTexturedLandscapeDelta(int a1, int a2) {
  
  int v3; // [esp+8h] [ebp-180h]
  int v4; // [esp+Ch] [ebp-17Ch]
  int v5; // [esp+10h] [ebp-178h]
  int v6; // [esp+14h] [ebp-174h]
  int v7; // [esp+18h] [ebp-170h]
  int v8; // [esp+1Ch] [ebp-16Ch]
  int v9; // [esp+20h] [ebp-168h]
  int v10; // [esp+24h] [ebp-164h]
  int v11; // [esp+28h] [ebp-160h]
  int v12; // [esp+2Ch] [ebp-15Ch] BYREF
  int v13; // [esp+30h] [ebp-158h] BYREF
  int v14; // [esp+34h] [ebp-154h]
  CSurfaceV7 *v15; // [esp+38h] [ebp-150h]
  int v16; // [esp+3Ch] [ebp-14Ch]
  int v17; // [esp+40h] [ebp-148h]
  BOOL v18; // [esp+44h] [ebp-144h]
  BOOL v19; // [esp+48h] [ebp-140h]
  BOOL v20; // [esp+4Ch] [ebp-13Ch]
  BOOL v21; // [esp+50h] [ebp-138h]
  BOOL v22; // [esp+54h] [ebp-134h]
  BOOL v23; // [esp+58h] [ebp-130h]
  int v24; // [esp+5Ch] [ebp-12Ch]
  int v25; // [esp+60h] [ebp-128h]
  int v26; // [esp+64h] [ebp-124h]
  BOOL v27; // [esp+68h] [ebp-120h]
  BOOL v28; // [esp+6Ch] [ebp-11Ch]
  BOOL v29; // [esp+70h] [ebp-118h]
  BOOL v30; // [esp+74h] [ebp-114h]
  BOOL v31; // [esp+78h] [ebp-110h]
  BOOL v32; // [esp+7Ch] [ebp-10Ch]
  int v33; // [esp+80h] [ebp-108h]
  int v34; // [esp+84h] [ebp-104h]
  BOOL v35; // [esp+88h] [ebp-100h]
  BOOL v36; // [esp+8Ch] [ebp-FCh]
  int v37; // [esp+90h] [ebp-F8h]
  BOOL v38; // [esp+94h] [ebp-F4h]
  BOOL v39; // [esp+98h] [ebp-F0h]
  int v40; // [esp+9Ch] [ebp-ECh]
  BOOL v41; // [esp+A0h] [ebp-E8h]
  BOOL v42; // [esp+A4h] [ebp-E4h]
  int v43; // [esp+A8h] [ebp-E0h]
  BOOL v44; // [esp+ACh] [ebp-DCh]
  BOOL v45; // [esp+B0h] [ebp-D8h]
  int v46; // [esp+B4h] [ebp-D4h]
  BOOL v47; // [esp+B8h] [ebp-D0h]
  CSurfaceV7 *v48; // [esp+BCh] [ebp-CCh]
  CSurfaceV7 *LandscapeRenderTargetSurface; // [esp+C0h] [ebp-C8h]
  int v50; // [esp+C4h] [ebp-C4h]
  int v51; // [esp+C8h] [ebp-C0h]
  int v52; // [esp+CCh] [ebp-BCh]
  int v53; // [esp+D0h] [ebp-B8h]
  int v54; // [esp+D4h] [ebp-B4h]
  int v55; // [esp+D8h] [ebp-B0h]
  int v56; // [esp+DCh] [ebp-ACh]
  int v57; // [esp+E0h] [ebp-A8h]
  int OldFogging; // [esp+E4h] [ebp-A4h]
  int NewFogging; // [esp+E8h] [ebp-A0h]
  int v60; // [esp+ECh] [ebp-9Ch]
  int v61; // [esp+F0h] [ebp-98h]
  int v62; // [esp+F4h] [ebp-94h]
  int v63; // [esp+F8h] [ebp-90h]
  int LightFog; // [esp+FCh] [ebp-8Ch]
  int ShadowFog; // [esp+100h] [ebp-88h]
  int v66; // [esp+104h] [ebp-84h]
  int v67; // [esp+108h] [ebp-80h]
  int v68; // [esp+10Ch] [ebp-7Ch]
  int v69; // [esp+110h] [ebp-78h]
  int v70; // [esp+114h] [ebp-74h]
  int v71; // [esp+118h] [ebp-70h]
  int v72; // [esp+11Ch] [ebp-6Ch]
  int v73; // [esp+120h] [ebp-68h]
  bool v74; // [esp+124h] [ebp-64h]
  unsigned __int8 v75; // [esp+125h] [ebp-63h]
  bool v76; // [esp+126h] [ebp-62h]
  unsigned __int8 v77; // [esp+127h] [ebp-61h]
  int v78; // [esp+128h] [ebp-60h]
  int v79; // [esp+12Ch] [ebp-5Ch]
  int v80; // [esp+130h] [ebp-58h]
  int v81; // [esp+134h] [ebp-54h]
  int v82; // [esp+138h] [ebp-50h]
  bool v83; // [esp+13Eh] [ebp-4Ah]
  bool v84; // [esp+13Fh] [ebp-49h]
  bool v85; // [esp+140h] [ebp-48h]
  bool v86; // [esp+141h] [ebp-47h]
  bool v87; // [esp+142h] [ebp-46h]
  bool v88; // [esp+143h] [ebp-45h]
  float *v89; // [esp+144h] [ebp-44h] BYREF
  float *v90; // [esp+148h] [ebp-40h] BYREF
  bool v91; // [esp+14Fh] [ebp-39h]
  bool v92; // [esp+150h] [ebp-38h]
  bool v93; // [esp+151h] [ebp-37h]
  bool v94; // [esp+152h] [ebp-36h]
  bool v95; // [esp+153h] [ebp-35h]
  int v96; // [esp+154h] [ebp-34h]
  int v97; // [esp+158h] [ebp-30h]
  unsigned __int8 v98; // [esp+15Ch] [ebp-2Ch]
  bool v99; // [esp+15Dh] [ebp-2Bh]
  bool v100; // [esp+15Eh] [ebp-2Ah]
  unsigned __int8 v101; // [esp+15Fh] [ebp-29h]
  int v102; // [esp+160h] [ebp-28h] BYREF
  int Number; // [esp+164h] [ebp-24h]
  int v104; // [esp+168h] [ebp-20h] BYREF
  unsigned __int8 v105; // [esp+16Eh] [ebp-1Ah]
  unsigned __int8 v106; // [esp+16Fh] [ebp-19h]
  unsigned __int8 *v107; // [esp+170h] [ebp-18h]
  unsigned __int8 *v108; // [esp+174h] [ebp-14h]
  int v109; // [esp+178h] [ebp-10h] BYREF
  int v110; // [esp+17Ch] [ebp-Ch] BYREF
  T_GFX_MAP_ELEMENT *v111; // [esp+180h] [ebp-8h]
  char v112; // [esp+187h] [ebp-1h]

  g_bRenderSuccess = 1;
  if ( dword_3E2E314 == 2000 )
    return g_bRenderSuccess;
  g_iMapSize = Size;
  v46 = dword_3E2E2A0;
  if ( !dword_3E2E2A0 )
    return 1;
  dword_3E2E708 = LODWORD(FLOAT_0_001953125);
  if ( !SGfxRenderConfiguration::IsHQTextureSet((SGfxRenderConfiguration *)&GfxEngineSetup) )
    dword_3E2E708 = LODWORD(FLOAT_0_00390625);
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    if ( !D3DObjectPtr )
      return 0;
    if ( !D3DObjectPtr->field_71D )
      return 0;
    LandscapeRenderTargetSurface = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    if ( ((int (__thiscall *)(CSurfaceV7 *))LandscapeRenderTargetSurface->j_?IsLost@CSurfaceV7@@UAEJXZ)(LandscapeRenderTargetSurface) == -2005532222 )
      return 0;
  }
  else
  {
    dword_3E2E708 = 0;
    if ( !D3DObjectPtr )
      return 0;
    if ( !D3DObjectPtr->field_71C )
      return 0;
  }
  v82 = dword_3E2E28C;
  v81 = dword_3E2E290;
  g_pVertex = D3DObjectPtr->field_0;
  v11 = (((OutputWidth - dword_3E2E2BC) << 16) + 4 * dword_3E2E28C) / dword_3E2E28C;
  v14 = (dword_3E2E290 + (OutputHeight << 16)) / dword_3E2E290;
  v69 = v14 + a2 + 2;
  if ( v14 + a2 + 5 < g_iMapSize && v69 > 0 )
    v69 += (unsigned __int8)byte_469717B[v69] / 5;
  v97 = -v81 - (dword_3E2E2B4 << 16);
  v33 = -v82 / 2;
  v66 = v82 / 2;
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    v78 = CInterfaceD3D::BeginLandscapeScene(D3DObjectPtr);
    if ( v78 )
    {
      WriteError(v78, "BeginLandscapeScene");
      return 0;
    }
  }
  else
  {
    v48 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    v78 = ((int (__thiscall *)(CSurfaceV7 *, int *, int *, int))v48->Lock)(v48, &v13, &v12, 1);
    if ( v78 )
    {
      WriteError(v78, "LockLandscapeSurfaceForSoftwareRendering");
      return 0;
    }
    j__TRI_set_window(v12, OutputWidth + 1, OutputHeight + 1, v13);
  }
  for ( Number = a2; Number < v69; ++Number )
  {
    if ( Number >= dword_3E2E314 - 2 )
    {
      if ( Number > dword_3E2E318 + 2 )
        break;
      if ( (Number & 1) != 0 )
      {
        v96 = (dword_3E2E2BC - dword_3E2E2B0 - (v82 >> 16)) << 16;
        g_bHalfLine = 1;
      }
      else
      {
        v96 = v33 + ((dword_3E2E2BC - dword_3E2E2B0 - (v82 >> 16)) << 16);
        g_bHalfLine = 0;
      }
      if ( Number < 0 )
      {
        v47 = g_bHalfLine == 0;
        g_bHalfLine = g_bHalfLine == 0;
      }
      g_iUsedFogFadeStep = g_iFogFadeStep;
      v52 = g_iFogFadeStep;
      if ( Number < g_iFadeYBorder )
      {
        g_iUsedFogFadeStep = 0;
        v52 = 0;
      }
      v24 = v11 + a1 + Number / 2 + 1;
      v55 = Number / 2 + a1 + g_iMapSize * Number;
      v111 = (T_GFX_MAP_ELEMENT *)(v46 + 4 * (v55 + (unsigned __int8)g_bHalfLine));
      v63 = a1 + Number / 2;
      v112 = g_bHalfLine ^ (a1 + Number / 2) & 1;
      *(float *)&g_fPatternSuboffsetY = (float)(j__abs(Number) % 8) * 0.125;
      *(float *)&g_fPatternSuboffsetY = *(float *)&g_fPatternSuboffsetY + *(float *)&dword_3E2E708;
      if ( g_bHalfLine )
        *(float *)&g_fPatternSuboffsetX = (float)((float)((v63 - Number / 2) % 8) * 0.125) + 0.0625;
      else
        *(float *)&g_fPatternSuboffsetX = (float)((v63 - Number / 2) % 8) * 0.125;
      if ( *(float *)&g_fPatternSuboffsetX < 0.0 )
        *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + 1.0;
      *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + *(float *)&dword_3E2E708;
      v80 = v63;
      v93 = FastIndexValidation(Number);
      v95 = FastIndexValidation(Number + 1);
      v86 = FastIndexValidation(v80 + (unsigned __int8)g_bHalfLine);
      v94 = FastIndexValidation(v80 + (unsigned __int8)g_bHalfLine + 1);
      g_iUsedFogFadeStep = v52;
      if ( v93 && v86 )
      {
        v79 = CalcFinalHeightOffset(*(unsigned __int8 *)v111);
        v45 = *((char *)v111 + 2) < 0;
        v43 = v45 ? 0 : *((_BYTE *)v111 + 2) & 0xF;
        NewFogging = T_GFX_MAP_ELEMENT::GetNewFogging(v111);
        OldFogging = T_GFX_MAP_ELEMENT::GetOldFogging(v111);
        v44 = NewFogging != OldFogging;
        v105 = v44 | *((_BYTE *)v111 + 3) & 0x40;
        ShadowFog = CHeightAndTypeTable::GetShadowFog(
                      (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                      g_iUsedFogFadeStep,
                      v43,
                      OldFogging,
                      NewFogging);
        LightFog = CHeightAndTypeTable::GetLightFog(
                     (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                     g_iUsedFogFadeStep,
                     v43,
                     OldFogging,
                     NewFogging);
        v110 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v111 + 1)];
        v85 = (*((_BYTE *)v111 + 2) & 0x40) != 0;
        v99 = v85;
        if ( (v110 == 28 || v110 == 29) && CalcCurrentFog(v111) <= 59 )
          v110 = 16;
        *((_BYTE *)v111 + 3) &= ~0x40u;
      }
      else
      {
        v79 = 0;
        v110 = 7;
        ShadowFog = g_cHeightAndTypeTable[1];
        LightFog = dword_46975D0[1];
        v105 = 0;
        v99 = 0;
      }
      if ( Number == g_iFadeYBorder - 1 )
        g_iUsedFogFadeStep = 15;
      v111 = (T_GFX_MAP_ELEMENT *)((char *)v111 + 4 * g_iMapSize);
      if ( v86 && v95 )
      {
        v62 = CalcFinalHeightOffset(*(unsigned __int8 *)v111);
        v42 = *((char *)v111 + 2) < 0;
        v40 = v42 ? 0 : *((_BYTE *)v111 + 2) & 0xF;
        v57 = T_GFX_MAP_ELEMENT::GetNewFogging(v111);
        v56 = T_GFX_MAP_ELEMENT::GetOldFogging(v111);
        v41 = v57 != v56;
        v98 = v41 | *((_BYTE *)v111 + 3) & 0x40;
        v61 = CHeightAndTypeTable::GetShadowFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v40,
                v56,
                v57);
        v60 = CHeightAndTypeTable::GetLightFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v40,
                v56,
                v57);
        v104 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v111 + 1)];
        v84 = (*((_BYTE *)v111 + 2) & 0x40) != 0;
        v91 = v84;
        if ( (v104 == 28 || v104 == 29) && CalcCurrentFog(v111) <= 59 )
          v104 = 16;
        *((_BYTE *)v111 + 3) &= ~0x40u;
      }
      else
      {
        v62 = 0;
        v104 = 7;
        v61 = g_cHeightAndTypeTable[1];
        v60 = dword_46975D0[1];
        v98 = 0;
        v91 = 0;
      }
      v80 = v63;
      while ( v80 < v24 )
      {
        v93 = FastIndexValidation(Number);
        v95 = FastIndexValidation(Number + 1);
        v94 = FastIndexValidation(v80 + (unsigned __int8)g_bHalfLine + 1);
        if ( Number == g_iFadeYBorder - 1 )
          g_iUsedFogFadeStep = 15;
        v111 = (T_GFX_MAP_ELEMENT *)((char *)v111 + 4);
        if ( v94 && v95 )
        {
          v71 = CalcFinalHeightOffset(*(unsigned __int8 *)v111);
          v39 = *((char *)v111 + 2) < 0;
          v37 = v39 ? 0 : *((_BYTE *)v111 + 2) & 0xF;
          v54 = T_GFX_MAP_ELEMENT::GetNewFogging(v111);
          v53 = T_GFX_MAP_ELEMENT::GetOldFogging(v111);
          v38 = v54 != v53;
          v106 = v38 | *((_BYTE *)v111 + 3) & 0x40;
          v73 = CHeightAndTypeTable::GetShadowFog(
                  (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                  g_iUsedFogFadeStep,
                  v37,
                  v53,
                  v54);
          v72 = CHeightAndTypeTable::GetLightFog(
                  (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                  g_iUsedFogFadeStep,
                  v37,
                  v53,
                  v54);
          v109 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v111 + 1)];
          v83 = (*((_BYTE *)v111 + 2) & 0x40) != 0;
          v100 = v83;
          if ( (v109 == 28 || v109 == 29) && CalcCurrentFog(v111) <= 59 )
            v109 = 16;
          *((_BYTE *)v111 + 3) &= ~0x40u;
        }
        else
        {
          v71 = 0;
          v109 = 7;
          v73 = g_cHeightAndTypeTable[1];
          v72 = dword_46975D0[1];
          v106 = 0;
          v100 = 0;
        }
        v9 = v71;
        v7 = v109;
        v5 = v73;
        v3 = v72;
        v76 = v100;
        v77 = v106;
        g_iUsedFogFadeStep = v52;
        v111 = (T_GFX_MAP_ELEMENT *)((char *)v111 - 4 * g_iMapSize);
        if ( v94 && v93 )
        {
          v70 = CalcFinalHeightOffset(*(unsigned __int8 *)v111);
          v36 = *((char *)v111 + 2) < 0;
          v34 = v36 ? 0 : *((_BYTE *)v111 + 2) & 0xF;
          v51 = T_GFX_MAP_ELEMENT::GetNewFogging(v111);
          v50 = T_GFX_MAP_ELEMENT::GetOldFogging(v111);
          v35 = v51 != v50;
          v101 = v35 | *((_BYTE *)v111 + 3) & 0x40;
          v68 = CHeightAndTypeTable::GetShadowFog(
                  (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                  g_iUsedFogFadeStep,
                  v34,
                  v50,
                  v51);
          v67 = CHeightAndTypeTable::GetLightFog(
                  (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                  g_iUsedFogFadeStep,
                  v34,
                  v50,
                  v51);
          v102 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v111 + 1)];
          v88 = (*((_BYTE *)v111 + 2) & 0x40) != 0;
          v92 = v88;
          if ( (v102 == 28 || v102 == 29) && CalcCurrentFog(v111) <= 59 )
            v102 = 16;
          *((_BYTE *)v111 + 3) &= ~0x40u;
        }
        else
        {
          v70 = 0;
          v102 = 7;
          v68 = g_cHeightAndTypeTable[1];
          v67 = dword_46975D0[1];
          v101 = 0;
          v92 = 0;
        }
        v10 = v70;
        v8 = v102;
        v6 = v68;
        v4 = v67;
        v74 = v92;
        v75 = v101;
        if ( (v96 != v33 || g_bHalfLine) && (v97 >> 16) - v79 <= OutputHeight && v106 | v98 | v105 )
        {
          s_iDarkTribeElement = 22 * (v100 || v91 || v99);
          if ( v110 == v104 && v104 == v109 && byte_3ACD240[v110] >= 0 )
          {
            CInterfaceD3D::CalcTilingVerticesType1(D3DObjectPtr, v110);
          }
          else
          {
            v32 = v110 == 28;
            v31 = v104 == 28;
            v30 = v109 == 28;
            v26 = v30 + v31 + v32;
            v29 = v110 == 29;
            v28 = v104 == 29;
            v27 = v109 == 29;
            v25 = v27 + v28 + v29;
            if ( v25 + v26 == 3 )
            {
              CInterfaceD3D::CalcTilingVerticesType1(D3DObjectPtr, 29);
            }
            else
            {
              if ( v26 > 0 && v25 > 0 )
              {
                if ( v110 == 28 )
                  v110 = 29;
                if ( v104 == 28 )
                  v104 = 29;
                if ( v109 == 28 )
                  v109 = 29;
              }
              if ( v104 == v109 )
              {
                v107 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v104] + 4 * (unsigned __int8)byte_3ACD510[v110]];
                v90 = &PatternTripleVertices[144 * *v107 + 36 * v107[1] + 36 * (unsigned __int8)(v112 & v107[3])];
              }
              else if ( v104 == v110 )
              {
                v107 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v104] + 4 * (unsigned __int8)byte_3ACD510[v109]];
                v90 = &PatternTripleVertices[144 * *v107 + 12 + 36 * v107[1] + 36 * (unsigned __int8)(v112 & v107[3])];
              }
              else if ( v110 == v109 )
              {
                v107 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v110] + 4 * (unsigned __int8)byte_3ACD510[v104]];
                v90 = &PatternTripleVertices[144 * *v107 + 24 + 36 * v107[1] + 36 * (unsigned __int8)(v112 & v107[3])];
              }
              else
              {
                sub_2F7C100(&v110, &v104, &v109, &g_bRiverMouth, 0, (int *)&v90);
                if ( !g_bRiverMouth )
                {
                  if ( v104 == v109 )
                  {
                    v107 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v104]
                                       + 4 * (unsigned __int8)byte_3ACD510[v110]];
                    v90 = &PatternTripleVertices[144 * *v107 + 36 * v107[1] + 36 * (unsigned __int8)(v112 & v107[3])];
                  }
                  else if ( v104 == v110 )
                  {
                    v107 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v104]
                                       + 4 * (unsigned __int8)byte_3ACD510[v109]];
                    v90 = &PatternTripleVertices[144 * *v107
                                               + 12
                                               + 36 * v107[1]
                                               + 36 * (unsigned __int8)(v112 & v107[3])];
                  }
                  else
                  {
                    v107 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v110]
                                       + 4 * (unsigned __int8)byte_3ACD510[v104]];
                    v90 = &PatternTripleVertices[144 * *v107
                                               + 24
                                               + 36 * v107[1]
                                               + 36 * (unsigned __int8)(v112 & v107[3])];
                  }
                }
              }
              if ( g_bRiverMouth )
              {
                g_bRiverMouth = 0;
                CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + 5);
              }
              else
              {
                CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + v107[2]);
              }
              *(float *)(g_pVertex + 24) = *v90;
              *(float *)(g_pVertex + 28) = v90[1];
              g_pVertex += 32;
              *(float *)(g_pVertex + 24) = v90[2];
              *(float *)(g_pVertex + 28) = v90[3];
              g_pVertex += 32;
              *(float *)(g_pVertex + 24) = v90[4];
              *(float *)(g_pVertex + 28) = v90[5];
              g_pVertex -= 64;
            }
          }
          *(_DWORD *)(g_pVertex + 16) = v73;
          *(_DWORD *)(g_pVertex + 20) = v72;
          *(float *)g_pVertex = (float)((v66 + v96) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v81 + v97 - v71) >> 16);
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 16) = v61;
          *(_DWORD *)(g_pVertex + 20) = v60;
          *(float *)g_pVertex = (float)((v96 - v66) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v81 + v97 - v62) >> 16);
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 16) = ShadowFog;
          *(_DWORD *)(g_pVertex + 20) = LightFog;
          *(float *)g_pVertex = (float)(v96 >> 16);
          *(float *)(g_pVertex + 4) = (float)((v97 - v79) >> 16);
          if ( g_bSplitTriangle )
          {
            g_bSplitTriangle = 0;
            g_pVertex -= 64;
            *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                            (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                            v73,
                                            v61);
            *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                            (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                            v72,
                                            v60);
            *(float *)g_pVertex = (float)(v96 >> 16);
            *(float *)(g_pVertex + 4) = (float)((v81 + v97 - (v62 + v71) / 2) >> 16);
            qmemcpy((void *)(g_pVertex + 96), (const void *)g_pVertex, 0x20u);
            qmemcpy((void *)(g_pVertex + 128), (const void *)(g_pVertex + 32), 0x20u);
            qmemcpy((void *)(g_pVertex + 160), (const void *)(g_pVertex + 64), 0x20u);
            *(_DWORD *)(g_pVertex + 16) = v73;
            *(_DWORD *)(g_pVertex + 20) = v72;
            *(float *)g_pVertex = (float)((v66 + v96) >> 16);
            *(float *)(g_pVertex + 4) = (float)((v81 + v97 - v71) >> 16);
            g_pVertex += 32;
            *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                            (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                            v73,
                                            v61);
            *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                            (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                            v72,
                                            v60);
            *(float *)g_pVertex = (float)(v96 >> 16);
            *(float *)(g_pVertex + 4) = (float)((v81 + v97 - (v71 + v62) / 2) >> 16);
            g_pVertex -= 32;
            *(float *)(g_pVertex + 24) = FLOAT_0_0625;
            g_pVertex += 32;
            *(_DWORD *)(g_pVertex + 24) = 0;
            g_pVertex += 32;
            *(_DWORD *)(g_pVertex + 24) = 0;
            g_pVertex += 128;
          }
          else
          {
            g_pVertex += 32;
          }
        }
        if ( (v80 != v24 - 1 || !g_bHalfLine)
          && ((v97 >> 16) - v79 <= OutputHeight || (v97 >> 16) - v70 <= OutputHeight)
          && v106 | v101 | v105 )
        {
          s_iDarkTribeElement = 22 * (v100 || v92 || v99);
          if ( v110 == v102 && v102 == v109 && byte_3ACD240[v110] >= 0 )
          {
            CInterfaceD3D::CalcTilingVerticesType2(D3DObjectPtr, v110);
          }
          else
          {
            v23 = v110 == 28;
            v22 = v102 == 28;
            v21 = v109 == 28;
            v17 = v21 + v22 + v23;
            v20 = v110 == 29;
            v19 = v102 == 29;
            v18 = v109 == 29;
            v16 = v18 + v19 + v20;
            if ( v16 + v17 == 3 )
            {
              CInterfaceD3D::CalcTilingVerticesType2(D3DObjectPtr, 29);
            }
            else
            {
              if ( v17 > 0 && v16 > 0 )
              {
                if ( v110 == 28 )
                  v110 = 29;
                if ( v102 == 28 )
                  v102 = 29;
                if ( v109 == 28 )
                  v109 = 29;
              }
              if ( v110 == v102 )
              {
                v108 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v110] + 4 * (unsigned __int8)byte_3ACD510[v109]];
                v89 = &PatternTripleVertices[144 * *v108 + 18 + 36 * v108[1] + 36 * (unsigned __int8)(v112 & v108[3])];
              }
              else if ( v102 == v109 )
              {
                v108 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v102] + 4 * (unsigned __int8)byte_3ACD510[v110]];
                v89 = &PatternTripleVertices[144 * *v108 + 30 + 36 * v108[1] + 36 * (unsigned __int8)(v112 & v108[3])];
              }
              else if ( v110 == v109 )
              {
                v108 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v110] + 4 * (unsigned __int8)byte_3ACD510[v102]];
                v89 = &PatternTripleVertices[144 * *v108 + 6 + 36 * v108[1] + 36 * (unsigned __int8)(v112 & v108[3])];
              }
              else
              {
                sub_2F7C100(&v110, &v109, &v102, &g_bRiverMouth, 1u, (int *)&v89);
                if ( !g_bRiverMouth )
                {
                  if ( v110 == v102 )
                  {
                    v108 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v110]
                                       + 4 * (unsigned __int8)byte_3ACD510[v109]];
                    v89 = &PatternTripleVertices[144 * *v108
                                               + 18
                                               + 36 * v108[1]
                                               + 36 * (unsigned __int8)(v112 & v108[3])];
                  }
                  else if ( v102 == v109 )
                  {
                    v108 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v102]
                                       + 4 * (unsigned __int8)byte_3ACD510[v110]];
                    v89 = &PatternTripleVertices[144 * *v108
                                               + 30
                                               + 36 * v108[1]
                                               + 36 * (unsigned __int8)(v112 & v108[3])];
                  }
                  else
                  {
                    v108 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v110]
                                       + 4 * (unsigned __int8)byte_3ACD510[v102]];
                    v89 = &PatternTripleVertices[144 * *v108 + 6 + 36 * v108[1] + 36 * (unsigned __int8)(v112 & v108[3])];
                  }
                }
              }
              if ( g_bRiverMouth )
              {
                g_bRiverMouth = 0;
                CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + 5);
              }
              else
              {
                CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + v108[2]);
              }
              *(float *)(g_pVertex + 24) = *v89;
              *(float *)(g_pVertex + 28) = v89[1];
              g_pVertex += 32;
              *(float *)(g_pVertex + 24) = v89[2];
              *(float *)(g_pVertex + 28) = v89[3];
              g_pVertex += 32;
              *(float *)(g_pVertex + 24) = v89[4];
              *(float *)(g_pVertex + 28) = v89[5];
              g_pVertex -= 64;
            }
          }
          *(_DWORD *)(g_pVertex + 16) = v68;
          *(_DWORD *)(g_pVertex + 20) = v67;
          *(float *)g_pVertex = (float)((v82 + v96) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v97 - v70) >> 16);
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 16) = v73;
          *(_DWORD *)(g_pVertex + 20) = v72;
          *(float *)g_pVertex = (float)((v66 + v96) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v81 + v97 - v71) >> 16);
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 16) = ShadowFog;
          *(_DWORD *)(g_pVertex + 20) = LightFog;
          *(float *)g_pVertex = (float)(v96 >> 16);
          *(float *)(g_pVertex + 4) = (float)((v97 - v79) >> 16);
          if ( g_bSplitTriangle )
          {
            g_bSplitTriangle = 0;
            g_pVertex -= 64;
            *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                            (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                            v68,
                                            ShadowFog);
            *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                            (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                            v67,
                                            LightFog);
            *(float *)g_pVertex = (float)((v66 + v96) >> 16);
            *(float *)(g_pVertex + 4) = (float)((v97 - (v79 + v70) / 2) >> 16);
            qmemcpy((void *)(g_pVertex + 96), (const void *)g_pVertex, 0x20u);
            qmemcpy((void *)(g_pVertex + 128), (const void *)(g_pVertex + 32), 0x20u);
            qmemcpy((void *)(g_pVertex + 160), (const void *)(g_pVertex + 64), 0x20u);
            g_pVertex += 96;
            *(_DWORD *)(g_pVertex + 16) = v68;
            *(_DWORD *)(g_pVertex + 20) = v67;
            *(float *)g_pVertex = (float)((v82 + v96) >> 16);
            *(float *)(g_pVertex + 4) = (float)((v97 - v70) >> 16);
            g_pVertex += 64;
            *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                            (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                            v68,
                                            ShadowFog);
            *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                            (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                            v67,
                                            LightFog);
            *(float *)g_pVertex = (float)((v66 + v96) >> 16);
            *(float *)(g_pVertex + 4) = (float)((v97 - (v79 + v70) / 2) >> 16);
            *(_DWORD *)(g_pVertex + 24) = 0;
            g_pVertex -= 32;
            *(_DWORD *)(g_pVertex + 24) = 0;
            g_pVertex -= 32;
            *(float *)(g_pVertex + 24) = FLOAT_0_0625;
            g_pVertex += 96;
          }
          else
          {
            g_pVertex += 32;
          }
        }
        if ( g_pVertex > (unsigned int)g_pVertexMax )
          CInterfaceD3D::RenderScene(D3DObjectPtr, 0);
        v96 += v82;
        v87 = v112 == 0;
        v112 = v112 == 0;
        *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + 0.125;
        if ( *(float *)&g_fPatternSuboffsetX >= 1.0 )
          *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX - 1.0;
        v111 = (T_GFX_MAP_ELEMENT *)((char *)v111 + 4 * g_iMapSize);
        v79 = v10;
        v62 = v9;
        v110 = v8;
        v104 = v7;
        ShadowFog = v6;
        v61 = v5;
        LightFog = v4;
        v60 = v3;
        v99 = v74;
        v91 = v76;
        v105 = v75;
        v98 = v77;
        ++v80;
        ++v55;
      }
      v97 += v81;
    }
    else
    {
      v97 += v81;
    }
  }
  CInterfaceD3D::RenderScene(D3DObjectPtr, 0);
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    CInterfaceD3D::EndLandscapeScene(D3DObjectPtr);
  }
  else
  {
    v15 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    v78 = ((int (__thiscall *)(CSurfaceV7 *))v15->Unlock)(v15);
    if ( v78 )
    {
      WriteError(v78, "UnlockLandscapeSurfaceForSoftwareRendering");
      return 0;
    }
  }
  return g_bRenderSuccess;
}


// address=[0x2f77130]
// Decompiled from char __cdecl DrawTexturedLandscape(int a1, int a2)
bool __cdecl DrawTexturedLandscape(int a1, int a2) {
  
  CSurfaceV7 *v3; // eax
  int v4; // [esp+8h] [ebp-1CCh]
  int v5; // [esp+10h] [ebp-1C4h]
  int v6; // [esp+14h] [ebp-1C0h]
  int v7; // [esp+18h] [ebp-1BCh]
  int v8; // [esp+1Ch] [ebp-1B8h]
  int v9; // [esp+20h] [ebp-1B4h] BYREF
  int v10; // [esp+24h] [ebp-1B0h]
  int v11; // [esp+28h] [ebp-1ACh]
  int v12; // [esp+2Ch] [ebp-1A8h]
  int v13; // [esp+30h] [ebp-1A4h]
  int v14; // [esp+34h] [ebp-1A0h] BYREF
  int v15; // [esp+38h] [ebp-19Ch]
  CSurfaceV7 *v16; // [esp+3Ch] [ebp-198h]
  BOOL v17; // [esp+40h] [ebp-194h]
  int v18; // [esp+44h] [ebp-190h]
  int v19; // [esp+48h] [ebp-18Ch]
  BOOL v20; // [esp+4Ch] [ebp-188h]
  BOOL v21; // [esp+50h] [ebp-184h]
  BOOL v22; // [esp+54h] [ebp-180h]
  BOOL v23; // [esp+58h] [ebp-17Ch]
  BOOL v24; // [esp+5Ch] [ebp-178h]
  BOOL v25; // [esp+60h] [ebp-174h]
  int v26; // [esp+64h] [ebp-170h]
  int v27; // [esp+68h] [ebp-16Ch]
  BOOL v28; // [esp+6Ch] [ebp-168h]
  BOOL v29; // [esp+70h] [ebp-164h]
  BOOL v30; // [esp+74h] [ebp-160h]
  CSurfaceV7 *LandscapeRenderTargetSurface; // [esp+78h] [ebp-15Ch]
  BOOL v32; // [esp+7Ch] [ebp-158h]
  BOOL v33; // [esp+80h] [ebp-154h]
  int v34; // [esp+84h] [ebp-150h]
  int v35; // [esp+88h] [ebp-14Ch]
  int v36; // [esp+8Ch] [ebp-148h]
  int v37; // [esp+90h] [ebp-144h]
  BOOL v38; // [esp+94h] [ebp-140h]
  int v39; // [esp+98h] [ebp-13Ch]
  int v40; // [esp+9Ch] [ebp-138h]
  int v41; // [esp+A0h] [ebp-134h]
  BOOL v42; // [esp+A4h] [ebp-130h]
  int v43; // [esp+A8h] [ebp-12Ch]
  int v44; // [esp+ACh] [ebp-128h]
  int v45; // [esp+B0h] [ebp-124h]
  BOOL v46; // [esp+B4h] [ebp-120h]
  int v47; // [esp+B8h] [ebp-11Ch]
  int OldFogging; // [esp+BCh] [ebp-118h]
  int NewFogging; // [esp+C0h] [ebp-114h]
  BOOL v50; // [esp+C4h] [ebp-110h]
  int v51; // [esp+C8h] [ebp-10Ch]
  BOOL v52; // [esp+CCh] [ebp-108h]
  CSurfaceV7 *v53; // [esp+D0h] [ebp-104h]
  CSurfaceV7 *v54; // [esp+D4h] [ebp-100h]
  BOOL v55; // [esp+D8h] [ebp-FCh]
  BOOL v56; // [esp+DCh] [ebp-F8h]
  int v57; // [esp+E0h] [ebp-F4h]
  int v58; // [esp+E4h] [ebp-F0h]
  int v59; // [esp+E8h] [ebp-ECh]
  int v60; // [esp+ECh] [ebp-E8h]
  int v61; // [esp+F0h] [ebp-E4h]
  int v62; // [esp+F4h] [ebp-E0h]
  int v63; // [esp+F8h] [ebp-DCh]
  int v64; // [esp+FCh] [ebp-D8h]
  int v65; // [esp+100h] [ebp-D4h]
  int v66; // [esp+104h] [ebp-D0h]
  int v67; // [esp+108h] [ebp-CCh]
  int v68; // [esp+10Ch] [ebp-C8h]
  int v69; // [esp+110h] [ebp-C4h]
  int ShadowFog; // [esp+114h] [ebp-C0h]
  int LightFog; // [esp+118h] [ebp-BCh]
  int v72; // [esp+11Ch] [ebp-B8h]
  int v73; // [esp+120h] [ebp-B4h]
  int v74; // [esp+124h] [ebp-B0h]
  int v75; // [esp+128h] [ebp-ACh]
  int v76; // [esp+12Ch] [ebp-A8h]
  int v77; // [esp+130h] [ebp-A4h]
  int v78; // [esp+134h] [ebp-A0h]
  bool v79; // [esp+13Bh] [ebp-99h]
  int v80; // [esp+13Ch] [ebp-98h]
  bool v81; // [esp+143h] [ebp-91h]
  int v82; // [esp+144h] [ebp-90h]
  int v83; // [esp+148h] [ebp-8Ch]
  int v84; // [esp+14Ch] [ebp-88h]
  int v85; // [esp+150h] [ebp-84h]
  bool v86; // [esp+155h] [ebp-7Fh]
  bool v87; // [esp+156h] [ebp-7Eh]
  bool v88; // [esp+157h] [ebp-7Dh]
  bool v89; // [esp+158h] [ebp-7Ch]
  bool v90; // [esp+159h] [ebp-7Bh]
  bool v91; // [esp+15Ah] [ebp-7Ah]
  bool v92; // [esp+15Bh] [ebp-79h]
  int v93; // [esp+15Ch] [ebp-78h]
  int v94; // [esp+160h] [ebp-74h]
  _DWORD *v95; // [esp+164h] [ebp-70h] BYREF
  _DWORD *v96; // [esp+168h] [ebp-6Ch] BYREF
  int v97; // [esp+16Ch] [ebp-68h]
  int Number; // [esp+170h] [ebp-64h]
  int v99; // [esp+174h] [ebp-60h]
  bool v100; // [esp+17Bh] [ebp-59h]
  bool v101; // [esp+17Ch] [ebp-58h]
  bool v102; // [esp+17Dh] [ebp-57h]
  bool v103; // [esp+17Eh] [ebp-56h]
  bool v104; // [esp+17Fh] [ebp-55h]
  int v105; // [esp+180h] [ebp-54h]
  bool v106; // [esp+184h] [ebp-50h]
  bool v107; // [esp+185h] [ebp-4Fh]
  char v108; // [esp+186h] [ebp-4Eh]
  bool v109; // [esp+187h] [ebp-4Dh]
  int v110; // [esp+188h] [ebp-4Ch] BYREF
  int v111; // [esp+18Ch] [ebp-48h] BYREF
  int v112; // [esp+190h] [ebp-44h]
  unsigned __int8 *v113; // [esp+194h] [ebp-40h]
  unsigned __int8 *v114; // [esp+198h] [ebp-3Ch]
  int v115; // [esp+19Ch] [ebp-38h] BYREF
  int i; // [esp+1A0h] [ebp-34h]
  int v117; // [esp+1A4h] [ebp-30h] BYREF
  T_GFX_MAP_ELEMENT *v118; // [esp+1A8h] [ebp-2Ch]
  char v119; // [esp+1AFh] [ebp-25h]
  int v120; // [esp+1B0h] [ebp-24h] BYREF
  int v121; // [esp+1B4h] [ebp-20h]
  int v122; // [esp+1B8h] [ebp-1Ch]
  int v123; // [esp+1BCh] [ebp-18h]
  int v124; // [esp+1C0h] [ebp-14h] BYREF
  int v125; // [esp+1C4h] [ebp-10h]
  int v126; // [esp+1C8h] [ebp-Ch]
  int v127; // [esp+1CCh] [ebp-8h]

  g_bRenderSuccess = 1;
  g_iMapSize = Size;
  v51 = dword_3E2E2A0;
  if ( !dword_3E2E2A0 )
    return 1;
  dword_3E2E708 = LODWORD(FLOAT_0_001953125);
  if ( !SGfxRenderConfiguration::IsHQTextureSet((SGfxRenderConfiguration *)&GfxEngineSetup) )
    dword_3E2E708 = LODWORD(FLOAT_0_00390625);
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    if ( !D3DObjectPtr )
      return 0;
    if ( !D3DObjectPtr->field_71D )
      return 0;
    LandscapeRenderTargetSurface = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    if ( ((int (__thiscall *)(CSurfaceV7 *))LandscapeRenderTargetSurface->j_?IsLost@CSurfaceV7@@UAEJXZ)(LandscapeRenderTargetSurface) == -2005532222 )
      return 0;
  }
  else
  {
    dword_3E2E708 = 0;
    if ( !D3DObjectPtr )
      return 0;
    if ( !D3DObjectPtr->field_71C )
      return 0;
  }
  g_pVertex = D3DObjectPtr->field_0;
  v99 = dword_3E2E28C;
  v85 = dword_3E2E290;
  v13 = (((OutputWidth - dword_3E2E2BC) << 16) + 4 * dword_3E2E28C) / dword_3E2E28C;
  v74 = (dword_3E2E290 + (OutputHeight << 16)) / dword_3E2E290 + a2 + 2;
  v112 = -dword_3E2E290 - (dword_3E2E2B4 << 16);
  v34 = -dword_3E2E28C / 2;
  v94 = dword_3E2E28C / 2;
  if ( (dword_3E2E290 + (OutputHeight << 16)) / dword_3E2E290 + a2 + 5 < g_iMapSize && v74 > 0 )
    v74 += (unsigned __int8)byte_469717B[v74] / 5;
  v124 = -1;
  v125 = -1;
  v126 = -1;
  v127 = -1;
  v109 = 0;
  v92 = 0;
  if ( byte_3E2E2FF )
  {
    dword_46C1654 = dword_3E2E2A8;
    dword_46C1658 = dword_3E2E2B0;
    dword_46C165C = dword_3E2E2AC;
    dword_46C1660 = dword_3E2E2B4;
    dword_46C1664 = 0;
    dword_46C1668 = 0;
  }
  else
  {
    Number = ((v99 * (dword_3E2E2A8 - dword_46C1644)) >> 16) - (dword_46C1648 - dword_3E2E2B0);
    v97 = ((v94 * (dword_3E2E2AC - dword_46C164C)) >> 16) - (dword_46C1650 - dword_3E2E2B4);
    v59 = dword_3E2E2A8 - dword_46C1654;
    v65 = dword_3E2E2AC - dword_46C165C;
    v58 = dword_46C1658 - dword_3E2E2B0;
    v64 = dword_46C1660 - dword_3E2E2B4;
    v15 = ((v99 * (dword_3E2E2A8 - dword_46C1654)) >> 16) - (dword_46C1658 - dword_3E2E2B0);
    v57 = ((v94 * (dword_3E2E2AC - dword_46C165C)) >> 16) - (dword_46C1660 - dword_3E2E2B4);
    if ( Number + dword_46C1664 != v15 )
      Number = v15 - dword_46C1664;
    if ( v97 + dword_46C1668 != v57 )
      v97 = v57 - dword_46C1668;
    dword_46C1664 += Number;
    dword_46C1668 += v97;
    if ( j__abs(Number) >= OutputWidth - dword_3E2E2BC )
      byte_3E2E2FF = 1;
    if ( j__abs(v97) >= OutputWidth )
      byte_3E2E2FF = 1;
    if ( Number >= 0 )
    {
      if ( Number <= 0 )
      {
        v120 = 0;
        v122 = OutputWidth;
        v124 = 0;
        v126 = OutputWidth;
      }
      else
      {
        v120 = j__abs(Number);
        v122 = OutputWidth;
        v124 = 0;
        v126 = OutputWidth - Number;
      }
    }
    else
    {
      v120 = 0;
      v122 = Number + OutputWidth;
      v124 = j__abs(Number);
      v126 = OutputWidth;
    }
    if ( v97 >= 0 )
    {
      if ( v97 <= 0 )
      {
        v121 = 0;
        v123 = OutputHeight;
        v125 = 0;
        v127 = OutputHeight;
      }
      else
      {
        v121 = j__abs(v97);
        v123 = OutputHeight;
        v125 = 0;
        v127 = OutputHeight - v97;
      }
    }
    else
    {
      v121 = 0;
      v123 = v97 + OutputHeight;
      v125 = j__abs(v97);
      v127 = OutputHeight;
    }
    v56 = !v124 && v126 == OutputWidth;
    v109 = v56;
    v55 = !v125 && v127 == OutputHeight;
    v92 = v55;
    if ( v109 && v92 )
      return 1;
    if ( !byte_3E2E2FF )
    {
      v54 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
      v3 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
      v93 = ((int (__thiscall *)(CSurfaceV7 *, int *, CSurfaceV7 *, int *, _DWORD, _DWORD))v54->Blt)(
              v54,
              &v124,
              v3,
              &v120,
              0,
              0);
      if ( v93 )
      {
        WriteError(v93, "DeltaScrollBlitError");
        v126 = -1;
        v124 = -1;
        v127 = -1;
        v125 = -1;
      }
    }
  }
  dword_46C1644 = dword_3E2E2A8;
  dword_46C1648 = dword_3E2E2B0;
  dword_46C164C = dword_3E2E2AC;
  dword_46C1650 = dword_3E2E2B4;
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    v93 = CInterfaceD3D::BeginLandscapeScene(D3DObjectPtr);
    if ( v93 )
    {
      WriteError(v93, "BeginLandscapeScene");
      return 0;
    }
  }
  else
  {
    v53 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    v93 = ((int (__thiscall *)(CSurfaceV7 *, int *, int *, int))v53->Lock)(v53, &v9, &v14, 1);
    if ( v93 )
    {
      WriteError(v93, "LockLandscapeSurfaceForSoftwareRendering");
      return 0;
    }
    j__TRI_set_window(v14, OutputWidth + 1, OutputHeight + 1, v9);
  }
  v60 = (dword_3E2E2BC - dword_3E2E2B0 - (v99 >> 16)) << 16;
  v84 = -1;
  for ( i = a2; i < v74; ++i )
  {
    v108 = 1;
    if ( v124 != -1 )
    {
      if ( v109 && !v125 && (v94 + v112) >> 16 < v127 )
      {
        v112 += v85;
        continue;
      }
      if ( v109 && v127 == OutputHeight && (v112 - 2 * v94) >> 16 > v125 )
      {
        if ( v84 == -1 )
        {
          if ( i < 0 || i >= (int)Size )
          {
            v84 = 0;
            break;
          }
          v84 = i + (unsigned __int8)g_uMaxYTable[i] / 5;
        }
        else if ( i > v84 )
        {
          break;
        }
      }
      if ( v125 || (v94 + v112) >> 16 >= v127 )
      {
        if ( v127 == OutputHeight && (v112 - 2 * v94) >> 16 > v125 )
        {
          if ( v84 == -1 )
          {
            if ( i < 0 || i >= (int)Size )
            {
              v84 = 0;
              v108 = 0;
            }
            else
            {
              v84 = i + (unsigned __int8)g_uMaxYTable[i] / 5;
            }
          }
          else if ( i > v84 )
          {
            v108 = 0;
          }
        }
      }
      else
      {
        v108 = 0;
      }
    }
    if ( (i & 1) != 0 )
    {
      v105 = v60;
      g_bHalfLine = 1;
    }
    else
    {
      v105 = v60 + v34;
      g_bHalfLine = 0;
    }
    if ( i < 0 )
    {
      v52 = g_bHalfLine == 0;
      g_bHalfLine = g_bHalfLine == 0;
    }
    g_iUsedFogFadeStep = g_iFogFadeStep;
    v61 = g_iFogFadeStep;
    if ( i < g_iFadeYBorder )
    {
      g_iUsedFogFadeStep = 0;
      v61 = 0;
    }
    v66 = v13 + a1 + i / 2 + 1;
    v62 = i / 2 + a1 + g_iMapSize * i;
    v118 = (T_GFX_MAP_ELEMENT *)(v51 + 4 * (v62 + (unsigned __int8)g_bHalfLine));
    v80 = a1 + i / 2;
    if ( !v108 )
    {
      if ( v126 == OutputWidth )
      {
        v66 -= ((v126 - v124 - dword_3E2E2BC) << 16) / v99 + 1;
      }
      else
      {
        v63 = ((v126 - v124 - dword_3E2E2BC) << 16) / v99;
        v80 += v63;
        v118 = (T_GFX_MAP_ELEMENT *)((char *)v118 + 4 * v63);
        v105 += v99 * v63;
      }
    }
    v119 = g_bHalfLine ^ v80 & 1;
    *(float *)&g_fPatternSuboffsetY = (float)(j__abs(i) % 8) * 0.125;
    *(float *)&g_fPatternSuboffsetY = *(float *)&g_fPatternSuboffsetY + *(float *)&dword_3E2E708;
    if ( g_bHalfLine )
      *(float *)&g_fPatternSuboffsetX = (float)((float)((v80 - i / 2) % 8) * 0.125) + 0.0625;
    else
      *(float *)&g_fPatternSuboffsetX = (float)((v80 - i / 2) % 8) * 0.125;
    if ( *(float *)&g_fPatternSuboffsetX < 0.0 )
      *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + 1.0;
    *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + *(float *)&dword_3E2E708;
    v83 = v80;
    v100 = FastIndexValidation(i);
    v104 = FastIndexValidation(i + 1);
    v90 = FastIndexValidation(v83 + (unsigned __int8)g_bHalfLine);
    v103 = FastIndexValidation(v83 + (unsigned __int8)g_bHalfLine + 1);
    g_iUsedFogFadeStep = v61;
    if ( v100 && v90 )
    {
      v82 = CalcFinalHeightOffset(*(unsigned __int8 *)v118);
      v50 = *((char *)v118 + 2) < 0;
      v47 = v50 ? 0 : *((_BYTE *)v118 + 2) & 0xF;
      NewFogging = T_GFX_MAP_ELEMENT::GetNewFogging(v118);
      OldFogging = T_GFX_MAP_ELEMENT::GetOldFogging(v118);
      ShadowFog = CHeightAndTypeTable::GetShadowFog(
                    (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                    g_iUsedFogFadeStep,
                    v47,
                    OldFogging,
                    NewFogging);
      LightFog = CHeightAndTypeTable::GetLightFog(
                   (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                   g_iUsedFogFadeStep,
                   v47,
                   OldFogging,
                   NewFogging);
      v117 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v118 + 1)];
      v91 = (*((_BYTE *)v118 + 2) & 0x40) != 0;
      v106 = v91;
      if ( (v117 == 28 || v117 == 29) && (int)CalcCurrentFog(v118) <= 59 )
        v117 = 16;
    }
    else
    {
      v82 = 0;
      v117 = 7;
      ShadowFog = g_cHeightAndTypeTable[1];
      LightFog = dword_46975D0[1];
      v106 = 0;
    }
    if ( i == g_iFadeYBorder - 1 )
      g_iUsedFogFadeStep = 15;
    v118 = (T_GFX_MAP_ELEMENT *)((char *)v118 + 4 * g_iMapSize);
    if ( v90 && v104 )
    {
      v69 = CalcFinalHeightOffset(*(unsigned __int8 *)v118);
      v46 = *((char *)v118 + 2) < 0;
      v43 = v46 ? 0 : *((_BYTE *)v118 + 2) & 0xF;
      v45 = T_GFX_MAP_ELEMENT::GetNewFogging(v118);
      v44 = T_GFX_MAP_ELEMENT::GetOldFogging(v118);
      v68 = CHeightAndTypeTable::GetShadowFog(
              (CHeightAndTypeTable *)g_cHeightAndTypeTable,
              g_iUsedFogFadeStep,
              v43,
              v44,
              v45);
      v67 = CHeightAndTypeTable::GetLightFog(
              (CHeightAndTypeTable *)g_cHeightAndTypeTable,
              g_iUsedFogFadeStep,
              v43,
              v44,
              v45);
      v111 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v118 + 1)];
      v89 = (*((_BYTE *)v118 + 2) & 0x40) != 0;
      v101 = v89;
      if ( (v111 == 28 || v111 == 29) && (int)CalcCurrentFog(v118) <= 59 )
        v111 = 16;
    }
    else
    {
      v69 = 0;
      v111 = 7;
      v68 = g_cHeightAndTypeTable[1];
      v67 = dword_46975D0[1];
      v101 = 0;
    }
    v83 = v80;
    while ( v83 < v66 )
    {
      v100 = FastIndexValidation(i);
      v104 = FastIndexValidation(i + 1);
      v103 = FastIndexValidation(v83 + (unsigned __int8)g_bHalfLine + 1);
      if ( i == g_iFadeYBorder - 1 )
        g_iUsedFogFadeStep = 15;
      v118 = (T_GFX_MAP_ELEMENT *)((char *)v118 + 4);
      if ( v103 && v104 )
      {
        v77 = CalcFinalHeightOffset(*(unsigned __int8 *)v118);
        v42 = *((char *)v118 + 2) < 0;
        v39 = v42 ? 0 : *((_BYTE *)v118 + 2) & 0xF;
        v41 = T_GFX_MAP_ELEMENT::GetNewFogging(v118);
        v40 = T_GFX_MAP_ELEMENT::GetOldFogging(v118);
        v75 = CHeightAndTypeTable::GetShadowFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v39,
                v40,
                v41);
        v78 = CHeightAndTypeTable::GetLightFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v39,
                v40,
                v41);
        v115 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v118 + 1)];
        v87 = (*((_BYTE *)v118 + 2) & 0x40) != 0;
        v107 = v87;
        if ( (v115 == 28 || v115 == 29) && (int)CalcCurrentFog(v118) <= 59 )
          v115 = 16;
      }
      else
      {
        v77 = 0;
        v115 = 7;
        v75 = g_cHeightAndTypeTable[1];
        v78 = dword_46975D0[1];
        v107 = 0;
      }
      v11 = v77;
      v4 = v115;
      v7 = v75;
      v5 = v78;
      v81 = v107;
      g_iUsedFogFadeStep = v61;
      v118 = (T_GFX_MAP_ELEMENT *)((char *)v118 - 4 * g_iMapSize);
      if ( v103 && v100 )
      {
        v76 = CalcFinalHeightOffset(*(unsigned __int8 *)v118);
        v38 = *((char *)v118 + 2) < 0;
        v35 = v38 ? 0 : *((_BYTE *)v118 + 2) & 0xF;
        v37 = T_GFX_MAP_ELEMENT::GetNewFogging(v118);
        v36 = T_GFX_MAP_ELEMENT::GetOldFogging(v118);
        v73 = CHeightAndTypeTable::GetShadowFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v35,
                v36,
                v37);
        v72 = CHeightAndTypeTable::GetLightFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v35,
                v36,
                v37);
        v110 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v118 + 1)];
        v88 = (*((_BYTE *)v118 + 2) & 0x40) != 0;
        v102 = v88;
        if ( (v110 == 28 || v110 == 29) && (int)CalcCurrentFog(v118) <= 59 )
          v110 = 16;
      }
      else
      {
        v76 = 0;
        v110 = 7;
        v73 = g_cHeightAndTypeTable[1];
        v72 = dword_46975D0[1];
        v102 = 0;
      }
      v12 = v76;
      v10 = v110;
      v8 = v73;
      v6 = v72;
      v79 = v102;
      if ( (v105 != v60 + v34 || g_bHalfLine) && (v112 >> 16) - v82 <= OutputHeight )
      {
        s_iDarkTribeElement = 22 * (v107 || v101 || v106);
        if ( v117 == v111 && v111 == v115 && byte_3ACD240[v117] >= 0 )
        {
          CInterfaceD3D::CalcTilingVerticesType1(D3DObjectPtr, v117);
        }
        else
        {
          v33 = v117 == 28;
          v32 = v111 == 28;
          v17 = v115 == 28;
          v27 = v17 + v32 + v33;
          v30 = v117 == 29;
          v29 = v111 == 29;
          v28 = v115 == 29;
          v26 = v28 + v29 + v30;
          if ( v26 + v27 == 3 )
          {
            CInterfaceD3D::CalcTilingVerticesType1(D3DObjectPtr, 29);
          }
          else
          {
            if ( v27 > 0 && v26 > 0 )
            {
              if ( v117 == 28 )
                v117 = 29;
              if ( v111 == 28 )
                v111 = 29;
              if ( v115 == 28 )
                v115 = 29;
            }
            if ( v111 == v115 )
            {
              v114 = (unsigned __int8 *)&byte_4697610
                   + 156 * (unsigned __int8)byte_3ACD510[v111]
                   + 4 * (unsigned __int8)byte_3ACD510[v117];
              v96 = (_DWORD *)((char *)&PatternTripleVertices
                             + 576 * *v114
                             + 144 * v114[1]
                             + 144 * (unsigned __int8)(v119 & v114[3]));
            }
            else if ( v111 == v117 )
            {
              v114 = (unsigned __int8 *)&byte_4697610
                   + 156 * (unsigned __int8)byte_3ACD510[v111]
                   + 4 * (unsigned __int8)byte_3ACD510[v115];
              v96 = (_DWORD *)((char *)&PatternTripleVertices
                             + 576 * *v114
                             + 144 * v114[1]
                             + 144 * (unsigned __int8)(v119 & v114[3])
                             + 48);
            }
            else if ( v117 == v115 )
            {
              v114 = (unsigned __int8 *)&byte_4697610
                   + 156 * (unsigned __int8)byte_3ACD510[v117]
                   + 4 * (unsigned __int8)byte_3ACD510[v111];
              v96 = (_DWORD *)((char *)&PatternTripleVertices
                             + 576 * *v114
                             + 144 * v114[1]
                             + 144 * (unsigned __int8)(v119 & v114[3])
                             + 96);
            }
            else
            {
              sub_2F7C100(&v117, &v111, &v115, &g_bRiverMouth, 0, &v96);
              if ( !g_bRiverMouth )
              {
                if ( v111 == v115 )
                {
                  v114 = (unsigned __int8 *)&byte_4697610
                       + 156 * (unsigned __int8)byte_3ACD510[v111]
                       + 4 * (unsigned __int8)byte_3ACD510[v117];
                  v96 = (_DWORD *)((char *)&PatternTripleVertices
                                 + 576 * *v114
                                 + 144 * v114[1]
                                 + 144 * (unsigned __int8)(v119 & v114[3]));
                }
                else if ( v111 == v117 )
                {
                  v114 = (unsigned __int8 *)&byte_4697610
                       + 156 * (unsigned __int8)byte_3ACD510[v111]
                       + 4 * (unsigned __int8)byte_3ACD510[v115];
                  v96 = (_DWORD *)((char *)&PatternTripleVertices
                                 + 576 * *v114
                                 + 144 * v114[1]
                                 + 144 * (unsigned __int8)(v119 & v114[3])
                                 + 48);
                }
                else
                {
                  v114 = (unsigned __int8 *)&byte_4697610
                       + 156 * (unsigned __int8)byte_3ACD510[v117]
                       + 4 * (unsigned __int8)byte_3ACD510[v111];
                  v96 = (_DWORD *)((char *)&PatternTripleVertices
                                 + 576 * *v114
                                 + 144 * v114[1]
                                 + 144 * (unsigned __int8)(v119 & v114[3])
                                 + 96);
                }
              }
            }
            if ( g_bRiverMouth )
            {
              g_bRiverMouth = 0;
              CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + 5);
            }
            else
            {
              CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + v114[2]);
            }
            *(_DWORD *)(g_pVertex + 24) = *v96;
            *(_DWORD *)(g_pVertex + 28) = v96[1];
            g_pVertex += 32;
            *(_DWORD *)(g_pVertex + 24) = v96[2];
            *(_DWORD *)(g_pVertex + 28) = v96[3];
            g_pVertex += 32;
            *(_DWORD *)(g_pVertex + 24) = v96[4];
            *(_DWORD *)(g_pVertex + 28) = v96[5];
            g_pVertex -= 64;
          }
        }
        *(_DWORD *)(g_pVertex + 16) = v75;
        *(_DWORD *)(g_pVertex + 20) = v78;
        *(float *)g_pVertex = (float)((v94 + v105) >> 16);
        *(float *)(g_pVertex + 4) = (float)((v85 + v112 - v77) >> 16);
        g_pVertex += 32;
        *(_DWORD *)(g_pVertex + 16) = v68;
        *(_DWORD *)(g_pVertex + 20) = v67;
        *(float *)g_pVertex = (float)((v105 - v94) >> 16);
        *(float *)(g_pVertex + 4) = (float)((v85 + v112 - v69) >> 16);
        g_pVertex += 32;
        *(_DWORD *)(g_pVertex + 16) = ShadowFog;
        *(_DWORD *)(g_pVertex + 20) = LightFog;
        *(float *)g_pVertex = (float)(v105 >> 16);
        *(float *)(g_pVertex + 4) = (float)((v112 - v82) >> 16);
        if ( g_bSplitTriangle )
        {
          g_bSplitTriangle = 0;
          g_pVertex -= 64;
          *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v75,
                                          v68);
          *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v78,
                                          v67);
          *(float *)g_pVertex = (float)(v105 >> 16);
          *(float *)(g_pVertex + 4) = (float)((v85 + v112 - (v69 + v77) / 2) >> 16);
          qmemcpy((void *)(g_pVertex + 96), (const void *)g_pVertex, 0x20u);
          qmemcpy((void *)(g_pVertex + 128), (const void *)(g_pVertex + 32), 0x20u);
          qmemcpy((void *)(g_pVertex + 160), (const void *)(g_pVertex + 64), 0x20u);
          *(_DWORD *)(g_pVertex + 16) = v75;
          *(_DWORD *)(g_pVertex + 20) = v78;
          *(float *)g_pVertex = (float)((v94 + v105) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v85 + v112 - v77) >> 16);
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v75,
                                          v68);
          *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v78,
                                          v67);
          *(float *)g_pVertex = (float)(v105 >> 16);
          *(float *)(g_pVertex + 4) = (float)((v85 + v112 - (v77 + v69) / 2) >> 16);
          g_pVertex -= 32;
          *(float *)(g_pVertex + 24) = FLOAT_0_0625;
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 24) = 0;
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 24) = 0;
          g_pVertex += 128;
        }
        else
        {
          g_pVertex += 32;
        }
      }
      if ( (v83 != v66 - 1 || !g_bHalfLine)
        && ((v112 >> 16) - v82 <= OutputHeight || (v112 >> 16) - v76 <= OutputHeight) )
      {
        s_iDarkTribeElement = 22 * (v107 || v102 || v106);
        if ( v117 == v110 && v110 == v115 && byte_3ACD240[v117] >= 0 )
        {
          CInterfaceD3D::CalcTilingVerticesType2(D3DObjectPtr, v117);
        }
        else
        {
          v25 = v117 == 28;
          v24 = v110 == 28;
          v23 = v115 == 28;
          v19 = v23 + v24 + v25;
          v22 = v117 == 29;
          v21 = v110 == 29;
          v20 = v115 == 29;
          v18 = v20 + v21 + v22;
          if ( v18 + v19 == 3 )
          {
            CInterfaceD3D::CalcTilingVerticesType2(D3DObjectPtr, 29);
          }
          else
          {
            if ( v19 > 0 && v18 > 0 )
            {
              if ( v117 == 28 )
                v117 = 29;
              if ( v110 == 28 )
                v110 = 29;
              if ( v115 == 28 )
                v115 = 29;
            }
            if ( v117 == v110 )
            {
              v113 = (unsigned __int8 *)&byte_4697610
                   + 156 * (unsigned __int8)byte_3ACD510[v117]
                   + 4 * (unsigned __int8)byte_3ACD510[v115];
              v95 = (_DWORD *)((char *)&PatternTripleVertices
                             + 576 * *v113
                             + 144 * v113[1]
                             + 144 * (unsigned __int8)(v119 & v113[3])
                             + 72);
            }
            else if ( v110 == v115 )
            {
              v113 = (unsigned __int8 *)&byte_4697610
                   + 156 * (unsigned __int8)byte_3ACD510[v110]
                   + 4 * (unsigned __int8)byte_3ACD510[v117];
              v95 = (_DWORD *)((char *)&PatternTripleVertices
                             + 576 * *v113
                             + 144 * v113[1]
                             + 144 * (unsigned __int8)(v119 & v113[3])
                             + 120);
            }
            else if ( v117 == v115 )
            {
              v113 = (unsigned __int8 *)&byte_4697610
                   + 156 * (unsigned __int8)byte_3ACD510[v117]
                   + 4 * (unsigned __int8)byte_3ACD510[v110];
              v95 = (_DWORD *)((char *)&PatternTripleVertices
                             + 576 * *v113
                             + 144 * v113[1]
                             + 144 * (unsigned __int8)(v119 & v113[3])
                             + 24);
            }
            else
            {
              sub_2F7C100(&v117, &v115, &v110, &g_bRiverMouth, 1, &v95);
              if ( !g_bRiverMouth )
              {
                if ( v117 == v110 )
                {
                  v113 = (unsigned __int8 *)&byte_4697610
                       + 156 * (unsigned __int8)byte_3ACD510[v117]
                       + 4 * (unsigned __int8)byte_3ACD510[v115];
                  v95 = (_DWORD *)((char *)&PatternTripleVertices
                                 + 576 * *v113
                                 + 144 * v113[1]
                                 + 144 * (unsigned __int8)(v119 & v113[3])
                                 + 72);
                }
                else if ( v110 == v115 )
                {
                  v113 = (unsigned __int8 *)&byte_4697610
                       + 156 * (unsigned __int8)byte_3ACD510[v110]
                       + 4 * (unsigned __int8)byte_3ACD510[v117];
                  v95 = (_DWORD *)((char *)&PatternTripleVertices
                                 + 576 * *v113
                                 + 144 * v113[1]
                                 + 144 * (unsigned __int8)(v119 & v113[3])
                                 + 120);
                }
                else
                {
                  v113 = (unsigned __int8 *)&byte_4697610
                       + 156 * (unsigned __int8)byte_3ACD510[v117]
                       + 4 * (unsigned __int8)byte_3ACD510[v110];
                  v95 = (_DWORD *)((char *)&PatternTripleVertices
                                 + 576 * *v113
                                 + 144 * v113[1]
                                 + 144 * (unsigned __int8)(v119 & v113[3])
                                 + 24);
                }
              }
            }
            if ( g_bRiverMouth )
            {
              g_bRiverMouth = 0;
              CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + 5);
            }
            else
            {
              CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + v113[2]);
            }
            *(_DWORD *)(g_pVertex + 24) = *v95;
            *(_DWORD *)(g_pVertex + 28) = v95[1];
            g_pVertex += 32;
            *(_DWORD *)(g_pVertex + 24) = v95[2];
            *(_DWORD *)(g_pVertex + 28) = v95[3];
            g_pVertex += 32;
            *(_DWORD *)(g_pVertex + 24) = v95[4];
            *(_DWORD *)(g_pVertex + 28) = v95[5];
            g_pVertex -= 64;
          }
        }
        *(_DWORD *)(g_pVertex + 16) = v73;
        *(_DWORD *)(g_pVertex + 20) = v72;
        *(float *)g_pVertex = (float)((v99 + v105) >> 16);
        *(float *)(g_pVertex + 4) = (float)((v112 - v76) >> 16);
        g_pVertex += 32;
        *(_DWORD *)(g_pVertex + 16) = v75;
        *(_DWORD *)(g_pVertex + 20) = v78;
        *(float *)g_pVertex = (float)((v94 + v105) >> 16);
        *(float *)(g_pVertex + 4) = (float)((v85 + v112 - v77) >> 16);
        g_pVertex += 32;
        *(_DWORD *)(g_pVertex + 16) = ShadowFog;
        *(_DWORD *)(g_pVertex + 20) = LightFog;
        *(float *)g_pVertex = (float)(v105 >> 16);
        *(float *)(g_pVertex + 4) = (float)((v112 - v82) >> 16);
        if ( g_bSplitTriangle )
        {
          g_bSplitTriangle = 0;
          g_pVertex -= 64;
          *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v73,
                                          ShadowFog);
          *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v72,
                                          LightFog);
          *(float *)g_pVertex = (float)((v94 + v105) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v112 - (v82 + v76) / 2) >> 16);
          qmemcpy((void *)(g_pVertex + 96), (const void *)g_pVertex, 0x20u);
          qmemcpy((void *)(g_pVertex + 128), (const void *)(g_pVertex + 32), 0x20u);
          qmemcpy((void *)(g_pVertex + 160), (const void *)(g_pVertex + 64), 0x20u);
          g_pVertex += 96;
          *(_DWORD *)(g_pVertex + 16) = v73;
          *(_DWORD *)(g_pVertex + 20) = v72;
          *(float *)g_pVertex = (float)((v99 + v105) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v112 - v76) >> 16);
          g_pVertex += 64;
          *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v73,
                                          ShadowFog);
          *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v72,
                                          LightFog);
          *(float *)g_pVertex = (float)((v94 + v105) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v112 - (v82 + v76) / 2) >> 16);
          *(_DWORD *)(g_pVertex + 24) = 0;
          g_pVertex -= 32;
          *(_DWORD *)(g_pVertex + 24) = 0;
          g_pVertex -= 32;
          *(float *)(g_pVertex + 24) = FLOAT_0_0625;
          g_pVertex += 96;
        }
        else
        {
          g_pVertex += 32;
        }
      }
      if ( g_pVertex >= (unsigned int)g_pVertexMax )
        CInterfaceD3D::RenderScene(D3DObjectPtr, 0);
      v105 += v99;
      v86 = v119 == 0;
      v119 = v119 == 0;
      *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + 0.125;
      if ( *(float *)&g_fPatternSuboffsetX >= 1.0 )
        *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX - 1.0;
      v118 = (T_GFX_MAP_ELEMENT *)((char *)v118 + 4 * g_iMapSize);
      v82 = v12;
      v69 = v11;
      v117 = v10;
      v111 = v4;
      ShadowFog = v8;
      v68 = v7;
      LightFog = v6;
      v67 = v5;
      v106 = v79;
      v101 = v81;
      ++v83;
      ++v62;
    }
    v112 += v85;
  }
  CInterfaceD3D::RenderScene(D3DObjectPtr, 0);
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    CInterfaceD3D::EndLandscapeScene(D3DObjectPtr);
  }
  else
  {
    v16 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    v93 = ((int (__thiscall *)(CSurfaceV7 *))v16->Unlock)(v16);
    if ( v93 )
    {
      WriteError(v93, "UnlockLandscapeSurfaceForSoftwareRendering");
      return 0;
    }
  }
  return g_bRenderSuccess;
}


// address=[0x2f796a0]
// Decompiled from char __cdecl DrawCameraLandscape(int a1, int a2)
bool __cdecl DrawCameraLandscape(int a1, int a2) {
  
  CSurfaceV7 *v3; // eax
  int v4; // [esp+8h] [ebp-1CCh]
  int v5; // [esp+Ch] [ebp-1C8h] BYREF
  int v6; // [esp+10h] [ebp-1C4h]
  int v7; // [esp+14h] [ebp-1C0h]
  int v8; // [esp+18h] [ebp-1BCh]
  int v9; // [esp+1Ch] [ebp-1B8h]
  int v10; // [esp+20h] [ebp-1B4h]
  int v11; // [esp+24h] [ebp-1B0h]
  int v12; // [esp+28h] [ebp-1ACh]
  int v13; // [esp+2Ch] [ebp-1A8h]
  int v14; // [esp+30h] [ebp-1A4h]
  int v15; // [esp+34h] [ebp-1A0h]
  int v16; // [esp+38h] [ebp-19Ch]
  CSurfaceV7 *v17; // [esp+3Ch] [ebp-198h]
  BOOL v18; // [esp+40h] [ebp-194h]
  int v19; // [esp+44h] [ebp-190h]
  BOOL v20; // [esp+48h] [ebp-18Ch]
  BOOL v21; // [esp+4Ch] [ebp-188h]
  BOOL v22; // [esp+50h] [ebp-184h]
  BOOL v23; // [esp+54h] [ebp-180h]
  BOOL v24; // [esp+58h] [ebp-17Ch]
  BOOL v25; // [esp+5Ch] [ebp-178h]
  int v26; // [esp+60h] [ebp-174h]
  int v27; // [esp+64h] [ebp-170h]
  BOOL v28; // [esp+68h] [ebp-16Ch]
  BOOL v29; // [esp+6Ch] [ebp-168h]
  BOOL v30; // [esp+70h] [ebp-164h]
  BOOL v31; // [esp+74h] [ebp-160h]
  CSurfaceV7 *LandscapeRenderTargetSurface; // [esp+78h] [ebp-15Ch]
  BOOL v33; // [esp+7Ch] [ebp-158h]
  int v34; // [esp+80h] [ebp-154h]
  int v35; // [esp+84h] [ebp-150h]
  int v36; // [esp+88h] [ebp-14Ch]
  int v37; // [esp+8Ch] [ebp-148h]
  BOOL v38; // [esp+90h] [ebp-144h]
  int v39; // [esp+94h] [ebp-140h]
  int v40; // [esp+98h] [ebp-13Ch]
  int v41; // [esp+9Ch] [ebp-138h]
  BOOL v42; // [esp+A0h] [ebp-134h]
  int v43; // [esp+A4h] [ebp-130h]
  int v44; // [esp+A8h] [ebp-12Ch]
  int v45; // [esp+ACh] [ebp-128h]
  BOOL v46; // [esp+B0h] [ebp-124h]
  int v47; // [esp+B4h] [ebp-120h]
  int OldFogging; // [esp+B8h] [ebp-11Ch]
  int NewFogging; // [esp+BCh] [ebp-118h]
  BOOL v50; // [esp+C0h] [ebp-114h]
  int v51; // [esp+C4h] [ebp-110h]
  BOOL v52; // [esp+C8h] [ebp-10Ch]
  int v53; // [esp+CCh] [ebp-108h] BYREF
  CSurfaceV7 *v54; // [esp+D0h] [ebp-104h]
  CSurfaceV7 *v55; // [esp+D4h] [ebp-100h]
  BOOL v56; // [esp+D8h] [ebp-FCh]
  BOOL v57; // [esp+DCh] [ebp-F8h]
  int v58; // [esp+E0h] [ebp-F4h]
  int v59; // [esp+E4h] [ebp-F0h]
  int v60; // [esp+E8h] [ebp-ECh]
  int v61; // [esp+ECh] [ebp-E8h]
  int v62; // [esp+F0h] [ebp-E4h]
  int v63; // [esp+F4h] [ebp-E0h]
  int v64; // [esp+F8h] [ebp-DCh]
  int v65; // [esp+FCh] [ebp-D8h]
  int v66; // [esp+100h] [ebp-D4h]
  int v67; // [esp+104h] [ebp-D0h]
  int v68; // [esp+108h] [ebp-CCh]
  int v69; // [esp+10Ch] [ebp-C8h]
  int v70; // [esp+110h] [ebp-C4h]
  int ShadowFog; // [esp+114h] [ebp-C0h]
  int LightFog; // [esp+118h] [ebp-BCh]
  int v73; // [esp+11Ch] [ebp-B8h]
  int v74; // [esp+120h] [ebp-B4h]
  int v75; // [esp+124h] [ebp-B0h]
  int v76; // [esp+128h] [ebp-ACh]
  int v77; // [esp+12Ch] [ebp-A8h]
  int v78; // [esp+130h] [ebp-A4h]
  int v79; // [esp+134h] [ebp-A0h]
  bool v80; // [esp+13Bh] [ebp-99h]
  int v81; // [esp+13Ch] [ebp-98h]
  bool v82; // [esp+143h] [ebp-91h]
  int v83; // [esp+144h] [ebp-90h]
  int v84; // [esp+148h] [ebp-8Ch]
  int v85; // [esp+14Ch] [ebp-88h]
  int v86; // [esp+150h] [ebp-84h]
  bool v87; // [esp+155h] [ebp-7Fh]
  bool v88; // [esp+156h] [ebp-7Eh]
  bool v89; // [esp+157h] [ebp-7Dh]
  bool v90; // [esp+158h] [ebp-7Ch]
  bool v91; // [esp+159h] [ebp-7Bh]
  bool v92; // [esp+15Ah] [ebp-7Ah]
  bool v93; // [esp+15Bh] [ebp-79h]
  int v94; // [esp+15Ch] [ebp-78h]
  int v95; // [esp+160h] [ebp-74h]
  float *v96; // [esp+164h] [ebp-70h] BYREF
  float *v97; // [esp+168h] [ebp-6Ch] BYREF
  int v98; // [esp+16Ch] [ebp-68h]
  int Number; // [esp+170h] [ebp-64h]
  int v100; // [esp+174h] [ebp-60h]
  bool v101; // [esp+17Bh] [ebp-59h]
  bool v102; // [esp+17Ch] [ebp-58h]
  bool v103; // [esp+17Dh] [ebp-57h]
  bool v104; // [esp+17Eh] [ebp-56h]
  bool v105; // [esp+17Fh] [ebp-55h]
  int v106; // [esp+180h] [ebp-54h]
  bool v107; // [esp+184h] [ebp-50h]
  bool v108; // [esp+185h] [ebp-4Fh]
  char v109; // [esp+186h] [ebp-4Eh]
  bool v110; // [esp+187h] [ebp-4Dh]
  int v111; // [esp+188h] [ebp-4Ch] BYREF
  int v112; // [esp+18Ch] [ebp-48h] BYREF
  int v113; // [esp+190h] [ebp-44h]
  unsigned __int8 *v114; // [esp+194h] [ebp-40h]
  unsigned __int8 *v115; // [esp+198h] [ebp-3Ch]
  int v116; // [esp+19Ch] [ebp-38h] BYREF
  int i; // [esp+1A0h] [ebp-34h]
  int v118; // [esp+1A4h] [ebp-30h] BYREF
  T_GFX_MAP_ELEMENT *v119; // [esp+1A8h] [ebp-2Ch]
  char v120; // [esp+1AFh] [ebp-25h]
  int v121; // [esp+1B0h] [ebp-24h] BYREF
  int v122; // [esp+1B4h] [ebp-20h]
  int v123; // [esp+1B8h] [ebp-1Ch]
  int v124; // [esp+1BCh] [ebp-18h]
  int v125; // [esp+1C0h] [ebp-14h] BYREF
  int v126; // [esp+1C4h] [ebp-10h]
  int v127; // [esp+1C8h] [ebp-Ch]
  int v128; // [esp+1CCh] [ebp-8h]

  g_bRenderSuccess = 1;
  g_iMapSize = Size;
  v51 = dword_3E2E2A0;
  if ( !dword_3E2E2A0 )
    return 1;
  dword_3E2E708 = LODWORD(FLOAT_0_001953125);
  if ( !SGfxRenderConfiguration::IsHQTextureSet((SGfxRenderConfiguration *)&GfxEngineSetup) )
    dword_3E2E708 = LODWORD(FLOAT_0_00390625);
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    if ( !D3DObjectPtr )
      return 0;
    if ( !D3DObjectPtr->field_71D )
      return 0;
    LandscapeRenderTargetSurface = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    if ( ((int (__thiscall *)(CSurfaceV7 *))LandscapeRenderTargetSurface->j_?IsLost@CSurfaceV7@@UAEJXZ)(LandscapeRenderTargetSurface) == -2005532222 )
      return 0;
  }
  else
  {
    dword_3E2E708 = 0;
    if ( !D3DObjectPtr )
      return 0;
    if ( !D3DObjectPtr->field_71C )
      return 0;
  }
  g_pVertex = D3DObjectPtr->field_0;
  v100 = dword_3E2E294;
  v86 = dword_3E2E298;
  v14 = ((dword_3E2E2DC << 16) + 4 * dword_3E2E294) / dword_3E2E294;
  v10 = (dword_3E2E298 + (dword_3E2E2E0 << 16)) / dword_3E2E298;
  v75 = v10 + a2 + 2;
  v113 = -dword_3E2E298 - (dword_3E2E2D0 << 16);
  v34 = -dword_3E2E294 / 2;
  v95 = dword_3E2E294 / 2;
  if ( v10 + a2 + 5 < g_iMapSize && v75 > 0 )
    v75 += (unsigned __int8)byte_469717B[v75] / 5;
  v125 = -1;
  v126 = -1;
  v127 = -1;
  v128 = -1;
  v110 = 0;
  v93 = 0;
  if ( byte_3E2E2FE )
  {
    dword_46C167C = dword_3E2E2C4;
    dword_46C1680 = dword_3E2E2CC;
    dword_46C1684 = dword_3E2E2C8;
    dword_46C1688 = dword_3E2E2D0;
    dword_46C168C = 0;
    dword_46C1690 = 0;
  }
  else
  {
    Number = ((v100 * (dword_3E2E2C4 - dword_46C166C)) >> 16) - (dword_46C1670 - dword_3E2E2CC);
    v98 = ((v95 * (dword_3E2E2C8 - dword_46C1674)) >> 16) - (dword_46C1678 - dword_3E2E2D0);
    v60 = dword_3E2E2C4 - dword_46C167C;
    v66 = dword_3E2E2C8 - dword_46C1684;
    v59 = dword_46C1680 - dword_3E2E2CC;
    v65 = dword_46C1688 - dword_3E2E2D0;
    v15 = ((v100 * (dword_3E2E2C4 - dword_46C167C)) >> 16) - (dword_46C1680 - dword_3E2E2CC);
    v58 = ((v95 * (dword_3E2E2C8 - dword_46C1684)) >> 16) - (dword_46C1688 - dword_3E2E2D0);
    if ( Number + dword_46C168C != v15 )
      Number = v15 - dword_46C168C;
    if ( v98 + dword_46C1690 != v58 )
      v98 = v58 - dword_46C1690;
    dword_46C168C += Number;
    dword_46C1690 += v98;
    if ( j__abs(Number) >= dword_3E2E2DC )
      byte_3E2E2FE = 1;
    if ( j__abs(v98) >= dword_3E2E2DC )
      byte_3E2E2FE = 1;
    if ( Number >= 0 )
    {
      if ( Number <= 0 )
      {
        v121 = 0;
        v123 = dword_3E2E2DC;
        v125 = 0;
        v127 = dword_3E2E2DC;
      }
      else
      {
        v121 = j__abs(Number);
        v123 = dword_3E2E2DC;
        v125 = 0;
        v127 = dword_3E2E2DC - Number;
      }
    }
    else
    {
      v121 = 0;
      v123 = Number + dword_3E2E2DC;
      v125 = j__abs(Number);
      v127 = dword_3E2E2DC;
    }
    if ( v98 >= 0 )
    {
      if ( v98 <= 0 )
      {
        v122 = 0;
        v124 = dword_3E2E2E0;
        v126 = 0;
        v128 = dword_3E2E2E0;
      }
      else
      {
        v122 = j__abs(v98);
        v124 = dword_3E2E2E0;
        v126 = 0;
        v128 = dword_3E2E2E0 - v98;
      }
    }
    else
    {
      v122 = 0;
      v124 = v98 + dword_3E2E2E0;
      v126 = j__abs(v98);
      v128 = dword_3E2E2E0;
    }
    v57 = !v125 && v127 == dword_3E2E2DC;
    v110 = v57;
    v56 = !v126 && v128 == dword_3E2E2E0;
    v93 = v56;
    if ( v110 && v93 )
      return 1;
    if ( !byte_3E2E2FE )
    {
      v55 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
      v3 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
      v94 = ((int (__thiscall *)(CSurfaceV7 *, int *, CSurfaceV7 *, int *, _DWORD, _DWORD))v55->Blt)(
              v55,
              &v125,
              v3,
              &v121,
              0,
              0);
      if ( v94 )
      {
        WriteError(v94, "CamDeltaScrollBlitError");
        v127 = -1;
        v125 = -1;
        v128 = -1;
        v126 = -1;
      }
    }
  }
  dword_46C166C = dword_3E2E2C4;
  dword_46C1670 = dword_3E2E2CC;
  dword_46C1674 = dword_3E2E2C8;
  dword_46C1678 = dword_3E2E2D0;
  byte_4696877 = 1;
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    v94 = CInterfaceD3D::BeginLandscapeScene(D3DObjectPtr);
    if ( v94 )
    {
      WriteError(v94, "CamBeginLandscapeScene");
      byte_4696877 = 0;
      return 0;
    }
  }
  else
  {
    v54 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    v94 = ((int (__thiscall *)(CSurfaceV7 *, int *, int *, int))v54->Lock)(v54, &v53, &v5, 1);
    if ( v94 )
    {
      WriteError(v94, "CamLockLandscapeSurfaceForSoftwareRendering");
      byte_4696877 = 0;
      return 0;
    }
    j__TRI_set_window(
      v5 + 2 * dword_3E2E2D4 + 2 * ((unsigned int)(v53 * dword_3E2E2D8) >> 1),
      dword_3E2E2DC + 1,
      dword_3E2E2E0 + 1,
      v53);
  }
  v61 = (-dword_3E2E2CC - (v100 >> 16)) << 16;
  v85 = -1;
  for ( i = a2; i < v75; ++i )
  {
    v109 = 1;
    if ( v125 != -1 )
    {
      if ( v110 && !v126 && (v95 + v113) >> 16 < v128 )
      {
        v113 += v86;
        continue;
      }
      if ( v110 && v128 == dword_3E2E2E0 && (v113 - 2 * v95) >> 16 > v126 )
      {
        if ( v85 == -1 )
        {
          if ( i < 0 || i >= (int)Size )
          {
            v85 = 0;
            break;
          }
          v85 = i + (unsigned __int8)g_uMaxYTable[i] / 5;
        }
        else if ( i > v85 )
        {
          break;
        }
      }
      if ( v126 || (v95 + v113) >> 16 >= v128 )
      {
        if ( v128 == dword_3E2E2E0 && (v113 - 2 * v95) >> 16 > v126 )
        {
          if ( v85 == -1 )
          {
            if ( i < 0 || i >= (int)Size )
            {
              v85 = 0;
              v109 = 0;
            }
            else
            {
              v85 = i + (unsigned __int8)g_uMaxYTable[i] / 5;
            }
          }
          else if ( i > v85 )
          {
            v109 = 0;
          }
        }
      }
      else
      {
        v109 = 0;
      }
    }
    if ( (i & 1) != 0 )
    {
      v106 = v61;
      g_bHalfLine = 1;
    }
    else
    {
      v106 = v61 + v34;
      g_bHalfLine = 0;
    }
    if ( i < 0 )
    {
      v52 = g_bHalfLine == 0;
      g_bHalfLine = g_bHalfLine == 0;
    }
    g_iUsedFogFadeStep = g_iFogFadeStep;
    v62 = g_iFogFadeStep;
    if ( i < g_iFadeYBorder )
    {
      g_iUsedFogFadeStep = 0;
      v62 = 0;
    }
    v67 = v14 + a1 + i / 2 + 1;
    v63 = i / 2 + a1 + g_iMapSize * i;
    v119 = (T_GFX_MAP_ELEMENT *)(v51 + 4 * (v63 + (unsigned __int8)g_bHalfLine));
    v81 = a1 + i / 2;
    if ( !v109 )
    {
      if ( v127 == dword_3E2E2DC )
      {
        v67 -= ((v127 - v125) << 16) / v100 + 1;
      }
      else
      {
        v64 = ((v127 - v125) << 16) / v100;
        v81 += v64;
        v119 = (T_GFX_MAP_ELEMENT *)((char *)v119 + 4 * v64);
        v106 += v100 * v64;
      }
    }
    v120 = g_bHalfLine ^ v81 & 1;
    *(float *)&g_fPatternSuboffsetY = (float)(j__abs(i) % 8) * 0.125;
    *(float *)&g_fPatternSuboffsetY = *(float *)&g_fPatternSuboffsetY + *(float *)&dword_3E2E708;
    if ( g_bHalfLine )
      *(float *)&g_fPatternSuboffsetX = (float)((float)((v81 - i / 2) % 8) * 0.125) + 0.0625;
    else
      *(float *)&g_fPatternSuboffsetX = (float)((v81 - i / 2) % 8) * 0.125;
    if ( *(float *)&g_fPatternSuboffsetX < 0.0 )
      *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + 1.0;
    *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + *(float *)&dword_3E2E708;
    v84 = v81;
    v101 = FastIndexValidation(i);
    v105 = FastIndexValidation(i + 1);
    v91 = FastIndexValidation(v84 + (unsigned __int8)g_bHalfLine);
    v104 = FastIndexValidation(v84 + (unsigned __int8)g_bHalfLine + 1);
    g_iUsedFogFadeStep = v62;
    if ( v101 && v91 )
    {
      v83 = CalcFinalHeightOffset(*(unsigned __int8 *)v119);
      v50 = *((char *)v119 + 2) < 0;
      v47 = v50 ? 0 : *((_BYTE *)v119 + 2) & 0xF;
      NewFogging = T_GFX_MAP_ELEMENT::GetNewFogging(v119);
      OldFogging = T_GFX_MAP_ELEMENT::GetOldFogging(v119);
      ShadowFog = CHeightAndTypeTable::GetShadowFog(
                    (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                    g_iUsedFogFadeStep,
                    v47,
                    OldFogging,
                    NewFogging);
      LightFog = CHeightAndTypeTable::GetLightFog(
                   (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                   g_iUsedFogFadeStep,
                   v47,
                   OldFogging,
                   NewFogging);
      v118 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v119 + 1)];
      v92 = (*((_BYTE *)v119 + 2) & 0x40) != 0;
      v107 = v92;
      if ( (v118 == 28 || v118 == 29) && CalcCurrentFog(v119) <= 59 )
        v118 = 16;
    }
    else
    {
      v83 = 0;
      v118 = 7;
      ShadowFog = g_cHeightAndTypeTable[1];
      LightFog = dword_46975D0[1];
      v107 = 0;
    }
    if ( i == g_iFadeYBorder - 1 )
      g_iUsedFogFadeStep = 15;
    v119 = (T_GFX_MAP_ELEMENT *)((char *)v119 + 4 * g_iMapSize);
    if ( v91 && v105 )
    {
      v70 = CalcFinalHeightOffset(*(unsigned __int8 *)v119);
      v46 = *((char *)v119 + 2) < 0;
      v43 = v46 ? 0 : *((_BYTE *)v119 + 2) & 0xF;
      v45 = T_GFX_MAP_ELEMENT::GetNewFogging(v119);
      v44 = T_GFX_MAP_ELEMENT::GetOldFogging(v119);
      v69 = CHeightAndTypeTable::GetShadowFog(
              (CHeightAndTypeTable *)g_cHeightAndTypeTable,
              g_iUsedFogFadeStep,
              v43,
              v44,
              v45);
      v68 = CHeightAndTypeTable::GetLightFog(
              (CHeightAndTypeTable *)g_cHeightAndTypeTable,
              g_iUsedFogFadeStep,
              v43,
              v44,
              v45);
      v112 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v119 + 1)];
      v90 = (*((_BYTE *)v119 + 2) & 0x40) != 0;
      v102 = v90;
      if ( (v112 == 28 || v112 == 29) && CalcCurrentFog(v119) <= 59 )
        v112 = 16;
    }
    else
    {
      v70 = 0;
      v112 = 7;
      v69 = g_cHeightAndTypeTable[1];
      v68 = dword_46975D0[1];
      v102 = 0;
    }
    v84 = v81;
    while ( v84 < v67 )
    {
      v101 = FastIndexValidation(i);
      v105 = FastIndexValidation(i + 1);
      v104 = FastIndexValidation(v84 + (unsigned __int8)g_bHalfLine + 1);
      if ( i == g_iFadeYBorder - 1 )
        g_iUsedFogFadeStep = 15;
      v119 = (T_GFX_MAP_ELEMENT *)((char *)v119 + 4);
      if ( v104 && v105 )
      {
        v78 = CalcFinalHeightOffset(*(unsigned __int8 *)v119);
        v42 = *((char *)v119 + 2) < 0;
        v39 = v42 ? 0 : *((_BYTE *)v119 + 2) & 0xF;
        v41 = T_GFX_MAP_ELEMENT::GetNewFogging(v119);
        v40 = T_GFX_MAP_ELEMENT::GetOldFogging(v119);
        v76 = CHeightAndTypeTable::GetShadowFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v39,
                v40,
                v41);
        v79 = CHeightAndTypeTable::GetLightFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v39,
                v40,
                v41);
        v116 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v119 + 1)];
        v88 = (*((_BYTE *)v119 + 2) & 0x40) != 0;
        v108 = v88;
        if ( (v116 == 28 || v116 == 29) && CalcCurrentFog(v119) <= 59 )
          v116 = 16;
      }
      else
      {
        v78 = 0;
        v116 = 7;
        v76 = g_cHeightAndTypeTable[1];
        v79 = dword_46975D0[1];
        v108 = 0;
      }
      v12 = v78;
      v4 = v116;
      v8 = v76;
      v6 = v79;
      v82 = v108;
      g_iUsedFogFadeStep = v62;
      v119 = (T_GFX_MAP_ELEMENT *)((char *)v119 - 4 * g_iMapSize);
      if ( v104 && v101 )
      {
        v77 = CalcFinalHeightOffset(*(unsigned __int8 *)v119);
        v38 = *((char *)v119 + 2) < 0;
        v35 = v38 ? 0 : *((_BYTE *)v119 + 2) & 0xF;
        v37 = T_GFX_MAP_ELEMENT::GetNewFogging(v119);
        v36 = T_GFX_MAP_ELEMENT::GetOldFogging(v119);
        v74 = CHeightAndTypeTable::GetShadowFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v35,
                v36,
                v37);
        v73 = CHeightAndTypeTable::GetLightFog(
                (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                g_iUsedFogFadeStep,
                v35,
                v36,
                v37);
        v111 = (unsigned __int8)byte_3ACD340[*((unsigned __int8 *)v119 + 1)];
        v89 = (*((_BYTE *)v119 + 2) & 0x40) != 0;
        v103 = v89;
        if ( (v111 == 28 || v111 == 29) && CalcCurrentFog(v119) <= 59 )
          v111 = 16;
      }
      else
      {
        v77 = 0;
        v111 = 7;
        v74 = g_cHeightAndTypeTable[1];
        v73 = dword_46975D0[1];
        v103 = 0;
      }
      v13 = v77;
      v11 = v111;
      v9 = v74;
      v7 = v73;
      v80 = v103;
      if ( (v106 != v61 + v34 || g_bHalfLine) && (v113 >> 16) - v83 <= dword_3E2E2E0 )
      {
        s_iDarkTribeElement = 22 * (v108 || v102 || v107);
        if ( v118 == v112 && v112 == v116 && byte_3ACD240[v118] >= 0 )
        {
          CInterfaceD3D::CalcTilingVerticesType1(D3DObjectPtr, v118);
        }
        else
        {
          v33 = v118 == 28;
          v18 = v112 == 28;
          v31 = v116 == 28;
          v27 = v31 + v18 + v33;
          v30 = v118 == 29;
          v29 = v112 == 29;
          v28 = v116 == 29;
          v26 = v28 + v29 + v30;
          if ( v26 + v27 == 3 )
          {
            CInterfaceD3D::CalcTilingVerticesType1(D3DObjectPtr, 29);
          }
          else
          {
            if ( v27 > 0 && v26 > 0 )
            {
              if ( v118 == 28 )
                v118 = 29;
              if ( v112 == 28 )
                v112 = 29;
              if ( v116 == 28 )
                v116 = 29;
            }
            if ( v112 == v116 )
            {
              v115 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v112] + 4 * (unsigned __int8)byte_3ACD510[v118]];
              v97 = &PatternTripleVertices[144 * *v115 + 36 * v115[1] + 36 * (unsigned __int8)(v120 & v115[3])];
            }
            else if ( v112 == v118 )
            {
              v115 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v112] + 4 * (unsigned __int8)byte_3ACD510[v116]];
              v97 = &PatternTripleVertices[144 * *v115 + 12 + 36 * v115[1] + 36 * (unsigned __int8)(v120 & v115[3])];
            }
            else if ( v118 == v116 )
            {
              v115 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v118] + 4 * (unsigned __int8)byte_3ACD510[v112]];
              v97 = &PatternTripleVertices[144 * *v115 + 24 + 36 * v115[1] + 36 * (unsigned __int8)(v120 & v115[3])];
            }
            else
            {
              sub_2F7C100(&v118, &v112, &v116, &g_bRiverMouth, 0, (int *)&v97);
              if ( !g_bRiverMouth )
              {
                if ( v112 == v116 )
                {
                  v115 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v112]
                                     + 4 * (unsigned __int8)byte_3ACD510[v118]];
                  v97 = &PatternTripleVertices[144 * *v115 + 36 * v115[1] + 36 * (unsigned __int8)(v120 & v115[3])];
                }
                else if ( v112 == v118 )
                {
                  v115 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v112]
                                     + 4 * (unsigned __int8)byte_3ACD510[v116]];
                  v97 = &PatternTripleVertices[144 * *v115 + 12 + 36 * v115[1] + 36 * (unsigned __int8)(v120 & v115[3])];
                }
                else
                {
                  v115 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v118]
                                     + 4 * (unsigned __int8)byte_3ACD510[v112]];
                  v97 = &PatternTripleVertices[144 * *v115 + 24 + 36 * v115[1] + 36 * (unsigned __int8)(v120 & v115[3])];
                }
              }
            }
            if ( g_bRiverMouth )
            {
              g_bRiverMouth = 0;
              CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + 5);
            }
            else
            {
              CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + v115[2]);
            }
            *(float *)(g_pVertex + 24) = *v97;
            *(float *)(g_pVertex + 28) = v97[1];
            g_pVertex += 32;
            *(float *)(g_pVertex + 24) = v97[2];
            *(float *)(g_pVertex + 28) = v97[3];
            g_pVertex += 32;
            *(float *)(g_pVertex + 24) = v97[4];
            *(float *)(g_pVertex + 28) = v97[5];
            g_pVertex -= 64;
          }
        }
        *(_DWORD *)(g_pVertex + 16) = v76;
        *(_DWORD *)(g_pVertex + 20) = v79;
        *(float *)g_pVertex = (float)((v95 + v106) >> 16);
        *(float *)(g_pVertex + 4) = (float)((v86 + v113 - v78) >> 16);
        g_pVertex += 32;
        *(_DWORD *)(g_pVertex + 16) = v69;
        *(_DWORD *)(g_pVertex + 20) = v68;
        *(float *)g_pVertex = (float)((v106 - v95) >> 16);
        *(float *)(g_pVertex + 4) = (float)((v86 + v113 - v70) >> 16);
        g_pVertex += 32;
        *(_DWORD *)(g_pVertex + 16) = ShadowFog;
        *(_DWORD *)(g_pVertex + 20) = LightFog;
        *(float *)g_pVertex = (float)(v106 >> 16);
        *(float *)(g_pVertex + 4) = (float)((v113 - v83) >> 16);
        if ( g_bSplitTriangle )
        {
          g_bSplitTriangle = 0;
          g_pVertex -= 64;
          *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v76,
                                          v69);
          *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v79,
                                          v68);
          *(float *)g_pVertex = (float)(v106 >> 16);
          *(float *)(g_pVertex + 4) = (float)((v86 + v113 - (v70 + v78) / 2) >> 16);
          qmemcpy((void *)(g_pVertex + 96), (const void *)g_pVertex, 0x20u);
          qmemcpy((void *)(g_pVertex + 128), (const void *)(g_pVertex + 32), 0x20u);
          qmemcpy((void *)(g_pVertex + 160), (const void *)(g_pVertex + 64), 0x20u);
          *(_DWORD *)(g_pVertex + 16) = v76;
          *(_DWORD *)(g_pVertex + 20) = v79;
          *(float *)g_pVertex = (float)((v95 + v106) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v86 + v113 - v78) >> 16);
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v76,
                                          v69);
          *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v79,
                                          v68);
          *(float *)g_pVertex = (float)(v106 >> 16);
          *(float *)(g_pVertex + 4) = (float)((v86 + v113 - (v78 + v70) / 2) >> 16);
          g_pVertex -= 32;
          *(float *)(g_pVertex + 24) = FLOAT_0_0625;
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 24) = 0;
          g_pVertex += 32;
          *(_DWORD *)(g_pVertex + 24) = 0;
          g_pVertex += 128;
        }
        else
        {
          g_pVertex += 32;
        }
      }
      if ( (v84 != v67 - 1 || !g_bHalfLine)
        && ((v113 >> 16) - v83 <= dword_3E2E2E0 || (v113 >> 16) - v77 <= dword_3E2E2E0) )
      {
        s_iDarkTribeElement = 22 * (v108 || v103 || v107);
        if ( v118 == v111 && v111 == v116 && byte_3ACD240[v118] >= 0 )
        {
          CInterfaceD3D::CalcTilingVerticesType2(D3DObjectPtr, v118);
        }
        else
        {
          v25 = v118 == 28;
          v24 = v111 == 28;
          v23 = v116 == 28;
          v19 = v23 + v24 + v25;
          v22 = v118 == 29;
          v21 = v111 == 29;
          v20 = v116 == 29;
          v16 = v20 + v21 + v22;
          if ( v16 + v19 == 3 )
          {
            CInterfaceD3D::CalcTilingVerticesType2(D3DObjectPtr, 29);
          }
          else
          {
            if ( v19 > 0 && v16 > 0 )
            {
              if ( v118 == 28 )
                v118 = 29;
              if ( v111 == 28 )
                v111 = 29;
              if ( v116 == 28 )
                v116 = 29;
            }
            if ( v118 == v111 )
            {
              v114 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v118] + 4 * (unsigned __int8)byte_3ACD510[v116]];
              v96 = &PatternTripleVertices[144 * *v114 + 18 + 36 * v114[1] + 36 * (unsigned __int8)(v120 & v114[3])];
            }
            else if ( v111 == v116 )
            {
              v114 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v111] + 4 * (unsigned __int8)byte_3ACD510[v118]];
              v96 = &PatternTripleVertices[144 * *v114 + 30 + 36 * v114[1] + 36 * (unsigned __int8)(v120 & v114[3])];
            }
            else if ( v118 == v116 )
            {
              v114 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v118] + 4 * (unsigned __int8)byte_3ACD510[v111]];
              v96 = &PatternTripleVertices[144 * *v114 + 6 + 36 * v114[1] + 36 * (unsigned __int8)(v120 & v114[3])];
            }
            else
            {
              sub_2F7C100(&v118, &v116, &v111, &g_bRiverMouth, 1u, (int *)&v96);
              if ( !g_bRiverMouth )
              {
                if ( v118 == v111 )
                {
                  v114 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v118]
                                     + 4 * (unsigned __int8)byte_3ACD510[v116]];
                  v96 = &PatternTripleVertices[144 * *v114 + 18 + 36 * v114[1] + 36 * (unsigned __int8)(v120 & v114[3])];
                }
                else if ( v111 == v116 )
                {
                  v114 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v111]
                                     + 4 * (unsigned __int8)byte_3ACD510[v118]];
                  v96 = &PatternTripleVertices[144 * *v114 + 30 + 36 * v114[1] + 36 * (unsigned __int8)(v120 & v114[3])];
                }
                else
                {
                  v114 = &byte_4697610[156 * (unsigned __int8)byte_3ACD510[v118]
                                     + 4 * (unsigned __int8)byte_3ACD510[v111]];
                  v96 = &PatternTripleVertices[144 * *v114 + 6 + 36 * v114[1] + 36 * (unsigned __int8)(v120 & v114[3])];
                }
              }
            }
            if ( g_bRiverMouth )
            {
              g_bRiverMouth = 0;
              CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + 5);
            }
            else
            {
              CInterfaceD3D::ChangeCurrentTexturePage(D3DObjectPtr, s_iDarkTribeElement + v114[2]);
            }
            *(float *)(g_pVertex + 24) = *v96;
            *(float *)(g_pVertex + 28) = v96[1];
            g_pVertex += 32;
            *(float *)(g_pVertex + 24) = v96[2];
            *(float *)(g_pVertex + 28) = v96[3];
            g_pVertex += 32;
            *(float *)(g_pVertex + 24) = v96[4];
            *(float *)(g_pVertex + 28) = v96[5];
            g_pVertex -= 64;
          }
        }
        *(_DWORD *)(g_pVertex + 16) = v74;
        *(_DWORD *)(g_pVertex + 20) = v73;
        *(float *)g_pVertex = (float)((v100 + v106) >> 16);
        *(float *)(g_pVertex + 4) = (float)((v113 - v77) >> 16);
        g_pVertex += 32;
        *(_DWORD *)(g_pVertex + 16) = v76;
        *(_DWORD *)(g_pVertex + 20) = v79;
        *(float *)g_pVertex = (float)((v95 + v106) >> 16);
        *(float *)(g_pVertex + 4) = (float)((v86 + v113 - v78) >> 16);
        g_pVertex += 32;
        *(_DWORD *)(g_pVertex + 16) = ShadowFog;
        *(_DWORD *)(g_pVertex + 20) = LightFog;
        *(float *)g_pVertex = (float)(v106 >> 16);
        *(float *)(g_pVertex + 4) = (float)((v113 - v83) >> 16);
        if ( g_bSplitTriangle )
        {
          g_bSplitTriangle = 0;
          g_pVertex -= 64;
          *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v74,
                                          ShadowFog);
          *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v73,
                                          LightFog);
          *(float *)g_pVertex = (float)((v95 + v106) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v113 - (v83 + v77) / 2) >> 16);
          qmemcpy((void *)(g_pVertex + 96), (const void *)g_pVertex, 0x20u);
          qmemcpy((void *)(g_pVertex + 128), (const void *)(g_pVertex + 32), 0x20u);
          qmemcpy((void *)(g_pVertex + 160), (const void *)(g_pVertex + 64), 0x20u);
          g_pVertex += 96;
          *(_DWORD *)(g_pVertex + 16) = v74;
          *(_DWORD *)(g_pVertex + 20) = v73;
          *(float *)g_pVertex = (float)((v100 + v106) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v113 - v77) >> 16);
          g_pVertex += 64;
          *(_DWORD *)(g_pVertex + 16) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v74,
                                          ShadowFog);
          *(_DWORD *)(g_pVertex + 20) = CHeightAndTypeTable::GetAverageShadingValue(
                                          (CHeightAndTypeTable *)g_cHeightAndTypeTable,
                                          v73,
                                          LightFog);
          *(float *)g_pVertex = (float)((v95 + v106) >> 16);
          *(float *)(g_pVertex + 4) = (float)((v113 - (v83 + v77) / 2) >> 16);
          *(_DWORD *)(g_pVertex + 24) = 0;
          g_pVertex -= 32;
          *(_DWORD *)(g_pVertex + 24) = 0;
          g_pVertex -= 32;
          *(float *)(g_pVertex + 24) = FLOAT_0_0625;
          g_pVertex += 96;
        }
        else
        {
          g_pVertex += 32;
        }
      }
      if ( g_pVertex >= (unsigned int)g_pVertexMax )
        CInterfaceD3D::RenderScene(D3DObjectPtr, 1);
      v106 += v100;
      v87 = v120 == 0;
      v120 = v120 == 0;
      *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX + 0.125;
      if ( *(float *)&g_fPatternSuboffsetX >= 1.0 )
        *(float *)&g_fPatternSuboffsetX = *(float *)&g_fPatternSuboffsetX - 1.0;
      v119 = (T_GFX_MAP_ELEMENT *)((char *)v119 + 4 * g_iMapSize);
      v83 = v13;
      v70 = v12;
      v118 = v11;
      v112 = v4;
      ShadowFog = v9;
      v69 = v8;
      LightFog = v7;
      v68 = v6;
      v107 = v80;
      v102 = v82;
      ++v84;
      ++v63;
    }
    v113 += v86;
  }
  CInterfaceD3D::RenderScene(D3DObjectPtr, 1);
  byte_4696877 = 0;
  if ( SGfxRenderConfiguration::IsHardwareLandscapeEngine((SGfxRenderConfiguration *)&GfxEngineSetup) )
  {
    CInterfaceD3D::EndLandscapeScene(D3DObjectPtr);
  }
  else
  {
    v17 = CInterfaceD3D::GetLandscapeRenderTargetSurface(D3DObjectPtr);
    v94 = ((int (__thiscall *)(CSurfaceV7 *))v17->Unlock)(v17);
    if ( v94 )
    {
      WriteError(v94, "CamUnlockLandscapeSurfaceForSoftwareRendering");
      return 0;
    }
  }
  return g_bRenderSuccess;
}


// address=[0x2f81f50]
// Decompiled from int __cdecl CalcMaxHeights(struct T_GFX_MAP_ELEMENT *a1, int a2)
void __cdecl CalcMaxHeights(struct T_GFX_MAP_ELEMENT * a1, int a2) {
  
  int result; // eax
  int v3; // [esp+0h] [ebp-14h]
  char *v4; // [esp+4h] [ebp-10h]
  int v5; // [esp+8h] [ebp-Ch]
  int i; // [esp+Ch] [ebp-8h]
  int j; // [esp+10h] [ebp-4h]

  for ( i = 0; i < a2; ++i )
  {
    v5 = 0;
    v4 = (char *)a1 + 4 * a2 * i;
    for ( j = 0; j < a2; ++j )
    {
      if ( v5 <= (unsigned __int8)v4[4 * j] )
        v3 = (unsigned __int8)v4[4 * j];
      else
        v3 = v5;
      v5 = v3;
    }
    g_uMaxYTable[i] = v5;
    result = i + 1;
  }
  return result;
}


// address=[0x2f89640]
// Decompiled from int __cdecl SetObjectMovement(int a1, int a2)
void __cdecl SetObjectMovement(int a1, int a2) {
  
  int result; // eax

  result = a1;
  s_iObjectOffsetX = a1;
  s_iObjectOffsetY = a2;
  return result;
}


// address=[0x2f8be20]
// [Decompilation failed for struct tagDDDEVICEIDENTIFIER2 * __cdecl GetDeviceInfoPtr(void *)]

// address=[0x2f8be90]
// Decompiled from int __stdcall D3DEnumPixelFormatsCallback(struct _DDPIXELFORMAT *a1, _BYTE *a2)
long __stdcall D3DEnumPixelFormatsCallback(struct _DDPIXELFORMAT * a1, void * a2) {
  
  if ( (a1->dwFlags & 0xE0000) != 0 )
    return 1;
  if ( a1->dwFourCC )
    return 1;
  if ( a1->dwRGBBitCount != 16 )
    return 1;
  if ( (a1->dwFlags & 1) != 0 )
  {
    if ( a1->dwRBitMask == 3840 && a1->dwGBitMask == 240 && a1->dwBBitMask == 15 && a1->dwRGBAlphaBitMask == 61440 )
      a2[2] = 1;
    if ( a1->dwRBitMask == 31744 && a1->dwGBitMask == 992 && a1->dwBBitMask == 31 && a1->dwRGBAlphaBitMask == 0x8000 )
      a2[3] = 1;
  }
  else
  {
    if ( a1->dwRBitMask == 31744 && a1->dwGBitMask == 992 && a1->dwBBitMask == 31 && !a1->dwRGBAlphaBitMask )
      *a2 = 1;
    if ( a1->dwRBitMask == 63488 && a1->dwGBitMask == 2016 && a1->dwBBitMask == 31 && !a1->dwRGBAlphaBitMask )
      a2[1] = 1;
  }
  return 1;
}


// address=[0x2f8c570]
// Decompiled from char DrawMiniMapLandscapeLayer()
bool __cdecl DrawMiniMapLandscapeLayer(void) {
  
  char *v1; // eax
  __int16 v2; // cx
  unsigned int NewValue; // [esp+0h] [ebp-48h]
  int v4; // [esp+8h] [ebp-40h]
  int v5; // [esp+Ch] [ebp-3Ch]
  int v6; // [esp+10h] [ebp-38h] BYREF
  int NewFogging; // [esp+14h] [ebp-34h]
  unsigned int v8; // [esp+18h] [ebp-30h] BYREF
  int v9; // [esp+1Ch] [ebp-2Ch]
  float v10; // [esp+20h] [ebp-28h]
  T_GFX_MAP_ELEMENT *v11; // [esp+24h] [ebp-24h]
  int v12; // [esp+28h] [ebp-20h]
  int v13; // [esp+2Ch] [ebp-1Ch]
  int i; // [esp+30h] [ebp-18h]
  _WORD *v15; // [esp+34h] [ebp-14h]
  int v16; // [esp+38h] [ebp-10h]
  int v17; // [esp+3Ch] [ebp-Ch]
  int v18; // [esp+40h] [ebp-8h]
  __int16 v19; // [esp+44h] [ebp-4h]
  unsigned __int8 v20; // [esp+46h] [ebp-2h]

  if ( !dword_3E2E2A0 )
    return 0;
  v13 = ((int (__thiscall *)(CSurfaceV7 *, unsigned int *, int *, int))D3DObjectPtr->MiniMapSurface->Lock)(
          D3DObjectPtr->MiniMapSurface,
          &v8,
          &v6,
          1);
  if ( v13 )
  {
    WriteError(v13, "LockMiniMapSurface");
    return 0;
  }
  else
  {
    NewValue = j___controlfp(0x300u, 0x300u);
    v15 = (_WORD *)(v6 + 2 * ((v8 * dword_46C7E4C) >> 1));
    v15 += dword_46C7E48 + 80 - dword_46C7E4C % 8 / 2;
    v4 = 8 * (v8 >> 1) - 160;
    for ( i = dword_46C7E4C; i < 160; i += 8 )
    {
      v10 = (float)(int)(Size * (int)(float)((float)((float)i * *(float *)&dword_3E2E71C) + 0.5))
          + (float)((float)dword_46C7E48 * *(float *)&dword_3E2E71C);
      v12 = dword_46C7E48;
      while ( v12 < 160 )
      {
        if ( !byte_46C8358[162 * v12 + i] )
        {
          v11 = (T_GFX_MAP_ELEMENT *)(dword_3E2E2A0 + 4 * (int)(float)(v10 + 0.5));
          v5 = *((unsigned __int8 *)v11 + 1);
          v9 = 8 * T_GFX_MAP_ELEMENT::GetGradient(v11) - 64;
          v1 = CLandscapeColorProperties::ColorEntry((CLandscapeColorProperties *)&g_cLandscapeColorProperties, v5);
          v19 = *(_WORD *)v1;
          v20 = v1[2];
          v16 = v9 + (unsigned __int8)v19;
          v17 = v9 + HIBYTE(v19);
          v18 = v9 + v20;
          if ( (*((_BYTE *)v11 + 2) & 0x40) != 0 )
          {
            v18 = (v18 + v18 + v17 + v16) / 4;
            v17 = v18;
            v16 = v18;
          }
          NewFogging = T_GFX_MAP_ELEMENT::GetNewFogging(v11);
          if ( NewFogging )
          {
            if ( NewFogging == 7 )
            {
              v18 = 9;
              v17 = 9;
              v16 = 9;
            }
            else
            {
              v16 /= 2;
              v17 /= 2;
              v18 /= 2;
            }
          }
          if ( v16 < 9 )
            v16 = 9;
          if ( v18 < 9 )
            v18 = 9;
          if ( v17 < 9 )
            v17 = 9;
          if ( v16 > 255 )
            v16 = 255;
          if ( v18 > 255 )
            v18 = 255;
          if ( v17 > 255 )
            v17 = 255;
          if ( dword_3E2E2B8 == 1 )
            v2 = 32 * (int)(float)((float)v17 * 0.12156863)
               + ((unsigned __int16)(int)(float)((float)v16 * 0.12156863) << 10);
          else
            v2 = 32 * (int)(float)((float)v17 * 0.24705882)
               + ((unsigned __int16)(int)(float)((float)v16 * 0.12156863) << 11);
          *v15 = (int)(float)((float)v18 * 0.12156863) + v2;
        }
        v12 += 8;
        v10 = v10 + *(float *)&dword_3E2E720;
        v15 += 8;
      }
      v15 += v4 - 4;
    }
    j___controlfp(NewValue, 0x300u);
    v13 = ((int (__thiscall *)(CSurfaceV7 *))D3DObjectPtr->MiniMapSurface->Unlock)(D3DObjectPtr->MiniMapSurface);
    if ( v13 )
    {
      WriteError(v13, "UnlockMiniMapSurface");
      return 0;
    }
    else
    {
      return 1;
    }
  }
}


// address=[0x2f8c950]
// Decompiled from char DrawMiniMapObjectLayer()
bool __cdecl DrawMiniMapObjectLayer(void) {
  
  __int16 v1; // ax
  __int16 v2; // ax
  unsigned int NewValue; // [esp+4h] [ebp-3Ch]
  unsigned int v4; // [esp+8h] [ebp-38h]
  unsigned int v5; // [esp+Ch] [ebp-34h] BYREF
  int v6; // [esp+10h] [ebp-30h] BYREF
  int v7; // [esp+14h] [ebp-2Ch]
  int OwnerID; // [esp+18h] [ebp-28h]
  int v9; // [esp+1Ch] [ebp-24h]
  int *GfxMiniMapColor; // [esp+20h] [ebp-20h]
  int v11; // [esp+24h] [ebp-1Ch]
  int v12; // [esp+28h] [ebp-18h]
  int i; // [esp+2Ch] [ebp-14h]
  int v14; // [esp+30h] [ebp-10h]
  size_t v15; // [esp+34h] [ebp-Ch]
  int v16; // [esp+38h] [ebp-8h]
  int v17; // [esp+3Ch] [ebp-4h]

  if ( !g_pfGetGfxMiniMapColor || !g_pfGetOwnerID )
    return 0;
  if ( !dword_3E2E2A0 )
    return 0;
  v12 = ((int (__thiscall *)(CSurfaceV7 *, unsigned int *, int *, int))D3DObjectPtr->MiniMapSurface->Lock)(
          D3DObjectPtr->MiniMapSurface,
          &v5,
          &v6,
          1);
  if ( v12 )
  {
    WriteError(v12, "LockMiniMapSurface");
    return 0;
  }
  else
  {
    v9 = v6;
    NewValue = j___controlfp(0x300u, 0x300u);
    v9 += 160;
    v4 = v5 >> 1;
    for ( i = dword_46C7E4C; i < (int)Size; i += 8 )
    {
      v17 = (int)(float)((float)((float)i * *(float *)&dword_3E2E718) + 0.5);
      v7 = v9 + 2 * (v4 * v17 - v17 / 2);
      v15 = dword_46C7E48 + Size * i;
      v11 = dword_46C7E48;
      while ( v11 < (int)Size )
      {
        v16 = (int)(float)((float)((float)v11 * *(float *)&dword_3E2E718) + 0.5);
        v14 = (unsigned __int8)byte_46C8358[162 * v16 + v17];
        if ( v14 )
          byte_46C8358[162 * v16 + v17] = --v14;
        if ( !v14 || v14 == 254 )
        {
          GfxMiniMapColor = (int *)g_pfGetGfxMiniMapColor(v15);
          if ( GfxMiniMapColor )
          {
            if ( T_GFX_MAP_ELEMENT::GetNewFogging((T_GFX_MAP_ELEMENT *)(dword_3E2E2A0 + 4 * v15)) < 3 )
            {
              byte_46C8358[162 * v16 + v17] = byte_46CE9E0[162 * v16 + v17];
              v1 = IGfxEngine::ConvertRgbToHicol(*GfxMiniMapColor, GfxMiniMapColor[1], GfxMiniMapColor[2]);
              *(_WORD *)(v7 + 2 * v16) = v1;
            }
          }
          else if ( (*(_BYTE *)(dword_3E2E2A0 + 4 * v15 + 3) & 0x80) != 0
                 && T_GFX_MAP_ELEMENT::GetNewFogging((T_GFX_MAP_ELEMENT *)(dword_3E2E2A0 + 4 * v15)) < 3 )
          {
            OwnerID = g_pfGetOwnerID(v15);
            byte_46C8358[162 * v16 + v17] = byte_46CE9E0[162 * v16 + v17];
            v2 = IGfxEngine::ConvertRgbToHicol(
                   dword_468D2C8[3 * OwnerID],
                   dword_468D2CC[3 * OwnerID],
                   dword_468D2D0[3 * OwnerID]);
            *(_WORD *)(v7 + 2 * v16) = v2;
          }
        }
        v11 += 8;
        v15 += 8;
      }
    }
    j___controlfp(NewValue, 0x300u);
    v12 = ((int (__thiscall *)(CSurfaceV7 *))D3DObjectPtr->MiniMapSurface->Unlock)(D3DObjectPtr->MiniMapSurface);
    if ( v12 )
    {
      WriteError(v12, "UnlockMiniMapSurface");
      return 0;
    }
    else
    {
      return 1;
    }
  }
}


// address=[0x2f8cc60]
// Decompiled from char MarkCurrentArea()
bool __cdecl MarkCurrentArea(void) {
  
  unsigned int NewValue; // [esp+0h] [ebp-34h]
  unsigned int v2; // [esp+4h] [ebp-30h] BYREF
  unsigned int v3; // [esp+8h] [ebp-2Ch] BYREF
  int v4; // [esp+Ch] [ebp-28h]
  unsigned int v5; // [esp+10h] [ebp-24h]
  unsigned int v6; // [esp+14h] [ebp-20h]
  unsigned int v7; // [esp+18h] [ebp-1Ch]
  int v8; // [esp+1Ch] [ebp-18h]
  int v9; // [esp+20h] [ebp-14h]
  int v10; // [esp+24h] [ebp-10h]
  int i; // [esp+28h] [ebp-Ch]
  int v12; // [esp+2Ch] [ebp-8h]
  _WORD *v13; // [esp+30h] [ebp-4h]

  if ( !D3DObjectPtr )
    return 0;
  if ( !D3DObjectPtr->field_71D && !D3DObjectPtr->field_71C )
    return 0;
  v8 = ((int (__thiscall *)(CSurfaceV7 *, _DWORD))D3DObjectPtr->MiniMapAreaSurface->ClearSurface)(
         D3DObjectPtr->MiniMapAreaSurface,
         0);
  if ( v8 )
  {
    WriteError(v8, "Clear mini map surface");
    return 0;
  }
  else
  {
    v8 = ((int (__thiscall *)(CSurfaceV7 *, unsigned int *, unsigned int *, int))D3DObjectPtr->MiniMapAreaSurface->Lock)(
           D3DObjectPtr->MiniMapAreaSurface,
           &v2,
           &v3,
           1);
    if ( v8 )
    {
      WriteError(v8, "LockMiniMapAreaSurface");
      return 0;
    }
    else
    {
      NewValue = j___controlfp(0x300u, 0x300u);
      v7 = v2 >> 1;
      v4 = (int)(float)((float)dword_3E2E2AC * *(float *)&dword_3E2E718);
      v12 = (int)(float)((float)dword_3E2E2A8 * *(float *)&dword_3E2E718);
      v6 = v3;
      v5 = v3 + 318 * (v2 >> 1) + 320;
      v10 = -v4 / 2;
      v9 = v10 + 160;
      v13 = (_WORD *)(v3 + 2 * (v12 + (v2 >> 1) * v4) + 160);
      if ( (unsigned int)v13 <= v3 || (unsigned int)v13 >= v5 )
      {
        v13 += dword_3E2E724;
        v12 += dword_3E2E724;
      }
      else
      {
        for ( i = 0; i < dword_3E2E724; ++i )
        {
          if ( v12 <= v9 && v12 > v10 )
            *v13 = -1;
          ++v13;
          ++v12;
        }
      }
      --v13;
      --v12;
      for ( i = 0; i < dword_3E2E728; ++i )
      {
        if ( (unsigned int)v13 > v6 && (unsigned int)v13 < v5 && v12 <= v9 && v12 > v10 )
          *v13 = -1;
        v13 += v7;
        if ( (i & 1) != 0 )
        {
          --v9;
          --v10;
        }
      }
      v13 -= v7;
      if ( (unsigned int)v13 <= v6 || (unsigned int)v13 >= v5 )
      {
        v13 -= dword_3E2E724;
        v12 -= dword_3E2E724;
      }
      else
      {
        for ( i = 0; i < dword_3E2E724; ++i )
        {
          if ( v12 <= v9 && v12 > v10 )
            *v13 = -1;
          --v13;
          --v12;
        }
      }
      ++v13;
      ++v12;
      for ( i = 0; i < dword_3E2E728; ++i )
      {
        if ( (unsigned int)v13 > v6 && (unsigned int)v13 < v5 && v12 <= v9 && v12 > v10 )
          *v13 = -1;
        v13 -= v7;
        if ( (i & 1) != 0 )
        {
          ++v9;
          ++v10;
        }
      }
      j___controlfp(NewValue, 0x300u);
      v8 = ((int (__thiscall *)(CSurfaceV7 *))D3DObjectPtr->MiniMapAreaSurface->Unlock)(D3DObjectPtr->MiniMapAreaSurface);
      if ( v8 )
      {
        WriteError(v8, "UnlockMiniMapAreaSurface");
        return 0;
      }
      else
      {
        return 1;
      }
    }
  }
}


// address=[0x2f8d020]
// Decompiled from char DrawCompleteMiniMap()
bool __cdecl DrawCompleteMiniMap(void) {
  
  char *v1; // eax
  __int16 v2; // ax
  __int16 v3; // ax
  unsigned int NewValue; // [esp+4h] [ebp-64h]
  unsigned int v5; // [esp+8h] [ebp-60h]
  int v6; // [esp+Ch] [ebp-5Ch]
  int v7; // [esp+10h] [ebp-58h]
  _WORD *v8; // [esp+14h] [ebp-54h]
  unsigned int v9; // [esp+18h] [ebp-50h] BYREF
  int v10; // [esp+1Ch] [ebp-4Ch] BYREF
  int NewFogging; // [esp+20h] [ebp-48h]
  int OwnerID; // [esp+24h] [ebp-44h]
  float v13; // [esp+28h] [ebp-40h]
  int v14; // [esp+2Ch] [ebp-3Ch]
  int j; // [esp+30h] [ebp-38h]
  int *GfxMiniMapColor; // [esp+34h] [ebp-34h]
  int v17; // [esp+38h] [ebp-30h]
  T_GFX_MAP_ELEMENT *v18; // [esp+3Ch] [ebp-2Ch]
  int v19; // [esp+40h] [ebp-28h]
  int v20; // [esp+44h] [ebp-24h]
  int v21; // [esp+48h] [ebp-20h]
  size_t v22; // [esp+4Ch] [ebp-1Ch]
  int i; // [esp+50h] [ebp-18h]
  int v24; // [esp+54h] [ebp-14h]
  int v25; // [esp+58h] [ebp-10h]
  _WORD *v26; // [esp+5Ch] [ebp-Ch]
  int v27; // [esp+60h] [ebp-8h]
  __int16 v28; // [esp+64h] [ebp-4h]
  unsigned __int8 v29; // [esp+66h] [ebp-2h]

  if ( !dword_3E2E2A0 || !g_pfGetOwnerID )
    return 0;
  v19 = ((int (__thiscall *)(CSurfaceV7 *, unsigned int *, int *, int))D3DObjectPtr->MiniMapSurface->Lock)(
          D3DObjectPtr->MiniMapSurface,
          &v9,
          &v10,
          1);
  if ( v19 )
  {
    WriteError(v19, "UnlockMiniMapSurface");
    return 0;
  }
  else
  {
    NewValue = j___controlfp(0x300u, 0x300u);
    v26 = (_WORD *)(v10 + 160);
    v6 = (v9 >> 1) - 160;
    for ( i = 0; i < 160; ++i )
    {
      v13 = (float)(int)(Size * (int)(float)((float)((float)i * *(float *)&dword_3E2E71C) + 0.5));
      for ( j = 0; j < 160; ++j )
      {
        v18 = (T_GFX_MAP_ELEMENT *)(dword_3E2E2A0 + 4 * (int)(float)(v13 + 0.5));
        v7 = *((unsigned __int8 *)v18 + 1);
        v14 = 8 * T_GFX_MAP_ELEMENT::GetGradient(v18) - 64;
        v1 = CLandscapeColorProperties::ColorEntry((CLandscapeColorProperties *)&g_cLandscapeColorProperties, v7);
        v28 = *(_WORD *)v1;
        v29 = v1[2];
        v24 = v14 + (unsigned __int8)v28;
        v25 = v14 + HIBYTE(v28);
        v27 = v14 + v29;
        if ( (*((_BYTE *)v18 + 2) & 0x40) != 0 )
        {
          v27 = (v27 + v27 + v25 + v24) / 4;
          v25 = v27;
          v24 = v27;
        }
        NewFogging = T_GFX_MAP_ELEMENT::GetNewFogging(v18);
        if ( NewFogging )
        {
          if ( NewFogging == 7 )
          {
            v27 = 9;
            v25 = 9;
            v24 = 9;
          }
          else
          {
            v24 /= 2;
            v25 /= 2;
            v27 /= 2;
          }
        }
        if ( v24 < 9 )
          v24 = 9;
        if ( v27 < 9 )
          v27 = 9;
        if ( v25 < 9 )
          v25 = 9;
        if ( v24 > 255 )
          v24 = 255;
        if ( v27 > 255 )
          v27 = 255;
        if ( v25 > 255 )
          v25 = 255;
        if ( dword_3E2E2B8 == 1 )
          *v26 = (int)(float)((float)v27 * 0.12156863)
               + 32 * (int)(float)((float)v25 * 0.12156863)
               + ((unsigned __int16)(int)(float)((float)v24 * 0.12156863) << 10);
        else
          *v26 = (int)(float)((float)v27 * 0.12156863)
               + 32 * (int)(float)((float)v25 * 0.24705882)
               + ((unsigned __int16)(int)(float)((float)v24 * 0.12156863) << 11);
        ++v26;
        v13 = v13 + *(float *)&dword_3E2E71C;
      }
      v26 += v6 - j__abs(i & 1);
    }
    memset(byte_46C8358, 0, 0x6684u);
    if ( g_pfGetGfxMiniMapColor )
    {
      memset(byte_46C8358, 0, 0x6684u);
      v26 = (_WORD *)(v10 + 160);
      v5 = v9 >> 1;
      for ( i = 0; i < (int)Size; ++i )
      {
        v21 = (int)(float)((float)((float)i * *(float *)&dword_3E2E718) + 0.5);
        v8 = &v26[v5 * v21 - v21 / 2];
        v22 = Size * i;
        v17 = 0;
        while ( v17 < (int)Size )
        {
          GfxMiniMapColor = (int *)g_pfGetGfxMiniMapColor(v22);
          v20 = (int)(float)((float)((float)v17 * *(float *)&dword_3E2E718) + 0.5);
          if ( GfxMiniMapColor )
          {
            if ( T_GFX_MAP_ELEMENT::GetNewFogging((T_GFX_MAP_ELEMENT *)(dword_3E2E2A0 + 4 * v22)) < 3 )
            {
              byte_46C8358[162 * v20 + v21] = -1;
              v2 = IGfxEngine::ConvertRgbToHicol(*GfxMiniMapColor, GfxMiniMapColor[1], GfxMiniMapColor[2]);
              v8[v20] = v2;
            }
          }
          else if ( (*(_BYTE *)(dword_3E2E2A0 + 4 * v22 + 3) & 0x80) != 0
                 && T_GFX_MAP_ELEMENT::GetNewFogging((T_GFX_MAP_ELEMENT *)(dword_3E2E2A0 + 4 * v22)) < 3 )
          {
            OwnerID = g_pfGetOwnerID(v22);
            byte_46C8358[162 * v20 + v21] = byte_46CE9E0[162 * v20 + v21];
            v3 = IGfxEngine::ConvertRgbToHicol(
                   dword_468D2C8[3 * OwnerID],
                   dword_468D2CC[3 * OwnerID],
                   dword_468D2D0[3 * OwnerID]);
            v8[v20] = v3;
          }
          ++v17;
          ++v22;
        }
      }
    }
    j___controlfp(NewValue, 0x300u);
    v19 = ((int (__thiscall *)(CSurfaceV7 *))D3DObjectPtr->MiniMapSurface->Unlock)(D3DObjectPtr->MiniMapSurface);
    if ( v19 )
    {
      WriteError(v19, "UnlockMiniMapSurface");
      return 0;
    }
    else
    {
      return 1;
    }
  }
}


// address=[0x2f8d5b0]
// Decompiled from void SetMiniMapGradient()
void __cdecl SetMiniMapGradient(void) {
  
  *(float *)&dword_3E2E71C = (float)(int)Size / 160.0;
  *(float *)&dword_3E2E720 = *(float *)&dword_3E2E71C * 8.0;
  *(float *)&dword_3E2E718 = 160.0 / (float)(int)Size;
}


// address=[0x2f8d610]
// Decompiled from int SetMiniMapAreaSize()
void __cdecl SetMiniMapAreaSize(void) {
  
  int result; // eax

  dword_3E2E728 = (int)(float)((float)(OutputHeight / (dword_3E2E290 >> 16)) * *(float *)&dword_3E2E718);
  result = OutputWidth / (dword_3E2E28C >> 16);
  dword_3E2E724 = (int)(float)((float)result * *(float *)&dword_3E2E718);
  return result;
}


// address=[0x2f8d670]
// Decompiled from void *CalcMaxTimeStamps()
void __cdecl CalcMaxTimeStamps(void) {
  
  void *result; // eax
  int v1; // [esp+0h] [ebp-14h]
  int i; // [esp+4h] [ebp-10h]
  int j; // [esp+8h] [ebp-Ch]
  int v4; // [esp+Ch] [ebp-8h]
  int v5; // [esp+10h] [ebp-4h]

  result = memset(byte_46CE9E0, 0, 0x6684u);
  v5 = 0;
  v4 = 0;
  if ( dword_3E2E2A0 )
  {
    do
    {
      for ( i = v4; i < (int)Size; i += 8 )
      {
        v1 = (int)(float)((float)((float)i * *(float *)&dword_3E2E718) + 0.5);
        for ( j = v5; j < (int)Size; j += 8 )
          ++byte_46CE9E0[162 * (int)(float)((float)((float)j * *(float *)&dword_3E2E718) + 0.5) + v1];
      }
      result = (void *)++v5;
      while ( v5 >= 8 )
      {
        v5 -= 8;
        if ( ++v4 >= 8 )
          v4 = 0;
      }
    }
    while ( v5 || v4 );
  }
  return result;
}


// address=[0x2f8d7b0]
// Decompiled from int GetNextLayer()
void __cdecl GetNextLayer(void) {
  
  int result; // eax

  result = dword_46C7E48 + 11;
  dword_46C7E48 += 11;
  while ( dword_46C7E48 >= 8 )
  {
    dword_46C7E48 -= 8;
    if ( ++dword_46C7E4C >= 8 )
      dword_46C7E4C = 0;
  }
  return result;
}


// address=[0x2f8eae0]
// Decompiled from int __cdecl SetCrossingSystemMapAccess(int a1, struct T_GFX_MAP_ELEMENT *a2)
void __cdecl SetCrossingSystemMapAccess(int a1, struct T_GFX_MAP_ELEMENT * a2) {
  
  int result; // eax

  result = a1;
  dword_46D7A74 = a1;
  dword_46D7A70 = (int)a2;
  dword_46D7A78 = a1 * a1;
  return result;
}


// address=[0x2f8eb10]
// Decompiled from void __cdecl RefreshShading(int a1, bool a2)
void __cdecl RefreshShading(int a1, bool a2) {
  
  int v2; // [esp+0h] [ebp-18h]
  int v3; // [esp+4h] [ebp-14h]
  int v4; // [esp+Ch] [ebp-Ch]
  int v5; // [esp+10h] [ebp-8h]
  int v6; // [esp+14h] [ebp-4h]

  v6 = dword_46D7A70 + 4 * a1;
  if ( a1 >= dword_46D7A74 )
    v2 = *(unsigned __int8 *)(v6 - 4 * dword_46D7A74);
  else
    v2 = *(unsigned __int8 *)(dword_46D7A70 + 4 * a1);
  if ( a1 < dword_46D7A78 - dword_46D7A74 )
    v3 = *(unsigned __int8 *)(v6 + 4 * dword_46D7A74);
  else
    v3 = *(unsigned __int8 *)(dword_46D7A70 + 4 * a1);
  v5 = v2 - v3;
  LOBYTE(v4) = 8;
  if ( v2 - v3 <= 0 )
  {
    if ( v5 < 0 )
      v4 = (v5 >> 1) + 8;
  }
  else
  {
    v4 = (v5 >> 1) + 8;
  }
  *(_BYTE *)(v6 + 2) = v4 & 0xF | *(_BYTE *)(v6 + 2) & 0xF0;
  *(_BYTE *)(v6 + 3) |= 0x40u;
  if ( !a2 )
  {
    if ( a1 >= dword_46D7A74 )
      RefreshShading(a1 - dword_46D7A74, 1);
    if ( a1 < dword_46D7A78 - dword_46D7A74 )
      RefreshShading(dword_46D7A74 + a1, 1);
  }
}


// address=[0x2f8ec40]
// Decompiled from bool __cdecl CheckField(int a1, int a2, int a3, int a4)
bool __cdecl CheckField(int a1, int a2, int a3, int a4) {
  
  int v5; // [esp+0h] [ebp-1Ch]
  int v6; // [esp+4h] [ebp-18h]
  int v7; // [esp+8h] [ebp-14h]
  int v8; // [esp+Ch] [ebp-10h]
  int v9; // [esp+10h] [ebp-Ch]
  int v10; // [esp+14h] [ebp-8h]

  v5 = -1;
  v6 = -1;
  v7 = -1;
  v8 = -1;
  v9 = -1;
  v10 = -1;
  if ( (unsigned __int8)sub_2F8F730(a2 - 1) )
  {
    if ( (unsigned __int8)sub_2F8F710(a1 - 1) )
    {
      v5 = *(unsigned __int8 *)(dword_46D7A70 + 4 * (a3 - 1 - dword_46D7A74) + 1);
      *(_BYTE *)(dword_46D7A70 + 4 * (a3 - 1 - dword_46D7A74) + 3) |= 0x40u;
    }
    if ( (unsigned __int8)sub_2F8F710(a1) )
    {
      v6 = *(unsigned __int8 *)(dword_46D7A70 + 4 * (a3 - dword_46D7A74) + 1);
      *(_BYTE *)(dword_46D7A70 + 4 * (a3 - dword_46D7A74) + 3) |= 0x40u;
    }
  }
  if ( (unsigned __int8)sub_2F8F730(a2 + 1) )
  {
    if ( (unsigned __int8)sub_2F8F710(a1) )
    {
      v9 = *(unsigned __int8 *)(dword_46D7A70 + 4 * (dword_46D7A74 + a3) + 1);
      *(_BYTE *)(dword_46D7A70 + 4 * (dword_46D7A74 + a3) + 3) |= 0x40u;
    }
    if ( (unsigned __int8)sub_2F8F710(a1 + 1) )
    {
      v10 = *(unsigned __int8 *)(dword_46D7A70 + 4 * (dword_46D7A74 + a3) + 5);
      *(_BYTE *)(dword_46D7A70 + 4 * (dword_46D7A74 + a3) + 7) |= 0x40u;
    }
  }
  if ( !(unsigned __int8)sub_2F8F730(a2) )
    return (unsigned __int8)sub_2F8F660(a4, v5)
        && (unsigned __int8)sub_2F8F660(a4, v6)
        && (unsigned __int8)sub_2F8F660(a4, v7)
        && (unsigned __int8)sub_2F8F660(a4, v8)
        && (unsigned __int8)sub_2F8F660(a4, v9)
        && (unsigned __int8)sub_2F8F660(a4, v10);
  if ( (unsigned __int8)sub_2F8F710(a1 - 1) )
  {
    v7 = *(unsigned __int8 *)(dword_46D7A70 + 4 * a3 - 3);
    *(_BYTE *)(dword_46D7A70 + 4 * a3 - 1) |= 0x40u;
  }
  if ( !(unsigned __int8)sub_2F8F710(a1 + 1) )
    return (unsigned __int8)sub_2F8F660(a4, v5)
        && (unsigned __int8)sub_2F8F660(a4, v6)
        && (unsigned __int8)sub_2F8F660(a4, v7)
        && (unsigned __int8)sub_2F8F660(a4, v8)
        && (unsigned __int8)sub_2F8F660(a4, v9)
        && (unsigned __int8)sub_2F8F660(a4, v10);
  v8 = *(unsigned __int8 *)(dword_46D7A70 + 4 * a3 + 5);
  *(_BYTE *)(dword_46D7A70 + 4 * a3 + 7) |= 0x40u;
  return (unsigned __int8)sub_2F8F660(a4, v5)
      && (unsigned __int8)sub_2F8F660(a4, v6)
      && (unsigned __int8)sub_2F8F660(a4, v7)
      && (unsigned __int8)sub_2F8F660(a4, v8)
      && (unsigned __int8)sub_2F8F660(a4, v9)
      && (unsigned __int8)sub_2F8F660(a4, v10);
}


// address=[0x2f8efc0]
// Decompiled from int *__cdecl SetDarkLandFlag(int a1, int a2, bool a3, int *a4, int *a5)
void __cdecl SetDarkLandFlag(int a1, int a2, bool a3, int & a4, int & a5) {
  
  int *result; // eax
  int v6; // [esp+0h] [ebp-4h]

  v6 = a1 + a2 * dword_46D7A74;
  if ( a3 && *(unsigned __int8 *)(dword_46D7A70 + 4 * v6 + 1) > 7u )
    *(_BYTE *)(dword_46D7A70 + 4 * v6 + 2) |= 0x40u;
  else
    *(_BYTE *)(dword_46D7A70 + 4 * v6 + 2) &= ~0x40u;
  *(_BYTE *)(dword_46D7A70 + 4 * v6 + 3) |= 0x40u;
  dword_46D7D90 = a2;
  dword_46D7A7C = a2;
  EnsureDarkCrossingBit(v6, a1, a2, 0);
  *a4 = dword_46D7A7C;
  result = a5;
  *a5 = dword_46D7D90;
  return result;
}


// address=[0x2f8f090]
// [Decompilation failed for bool __cdecl EnsureFogging(int,int)]

// address=[0x2f8f230]
// Decompiled from void __cdecl EnsureDarkCrossingBit(int a1, int a2, int a3, bool a4)
void __cdecl EnsureDarkCrossingBit(int a1, int a2, int a3, bool a4) {
  
  int v4; // [esp+1Ch] [ebp-4h]

  if ( (unsigned __int8)sub_2F8F6D0(a2, a3) )
  {
    if ( a3 < dword_46D7A7C )
      dword_46D7A7C = a3;
    if ( a3 > dword_46D7D90 )
      dword_46D7D90 = a3;
    v4 = (*(_BYTE *)(dword_46D7A70 + 4 * a1 + 2) & 0x40) != 0;
    if ( (unsigned __int8)sub_2F8F730(a3 - 1) )
    {
      if ( (unsigned __int8)sub_2F8F710(a2 - 1) )
      {
        v4 += (*(_BYTE *)(dword_46D7A70 + 4 * (a1 - dword_46D7A74) - 2) & 0x40) != 0;
        *(_BYTE *)(dword_46D7A70 + 4 * (a1 - dword_46D7A74) - 1) |= 0x40u;
      }
      v4 += (*(_BYTE *)(dword_46D7A70 + 4 * (a1 - dword_46D7A74) + 2) & 0x40) != 0;
      *(_BYTE *)(dword_46D7A70 + 4 * (a1 - dword_46D7A74) + 3) |= 0x40u;
    }
    if ( (unsigned __int8)sub_2F8F710(a2 + 1) )
    {
      v4 += (*(_BYTE *)(dword_46D7A70 + 4 * a1 + 6) & 0x40) != 0;
      *(_BYTE *)(dword_46D7A70 + 4 * a1 + 7) |= 0x40u;
    }
    if ( (unsigned __int8)sub_2F8F730(a3 + 1) )
    {
      if ( (unsigned __int8)sub_2F8F710(a2 + 1) )
      {
        v4 += (*(_BYTE *)(dword_46D7A70 + 4 * (dword_46D7A74 + a1) + 6) & 0x40) != 0;
        *(_BYTE *)(dword_46D7A70 + 4 * (dword_46D7A74 + a1) + 7) |= 0x40u;
      }
      v4 += (*(_BYTE *)(dword_46D7A70 + 4 * (dword_46D7A74 + a1) + 2) & 0x40) != 0;
      *(_BYTE *)(dword_46D7A70 + 4 * (dword_46D7A74 + a1) + 3) |= 0x40u;
    }
    if ( (unsigned __int8)sub_2F8F710(a2 - 1) )
    {
      v4 += (*(_BYTE *)(dword_46D7A70 + 4 * a1 - 2) & 0x40) != 0;
      *(_BYTE *)(dword_46D7A70 + 4 * a1 - 1) |= 0x40u;
    }
    if ( !v4 || v4 == 7 || (*(_BYTE *)(dword_46D7A70 + 4 * a1 + 2) & 0x40) != 0 )
      *(_BYTE *)(dword_46D7A70 + 4 * a1 + 2) &= ~0x80u;
    else
      *(_BYTE *)(dword_46D7A70 + 4 * a1 + 2) |= 0x80u;
    if ( !a4 )
    {
      EnsureDarkCrossingBit(a1 + 1, a2 + 1, a3, 1);
      EnsureDarkCrossingBit(a1 - 1, a2 - 1, a3, 1);
      EnsureDarkCrossingBit(a1 + dword_46D7A74 + 1, a2 + 1, a3 + 1, 1);
      EnsureDarkCrossingBit(dword_46D7A74 + a1, a2, a3 + 1, 1);
      EnsureDarkCrossingBit(a1 - 1 - dword_46D7A74, a2 - 1, a3 - 1, 1);
      EnsureDarkCrossingBit(a1 - dword_46D7A74, a2, a3 - 1, 1);
    }
  }
}


// address=[0x2f92aa0]
// Decompiled from void InitRenderStates()
void __cdecl InitRenderStates(void) {
  
  byte_46F32C9 = 0;
  dword_47132D4 = 0;
}


// address=[0x2f92ac0]
// Decompiled from char __cdecl BlitSettlerHardware(int a1, int a2, int a3, struct SGfxObjectInfo *a4)
bool __cdecl BlitSettlerHardware(int a1, int a2, int a3, struct SGfxObjectInfo * a4) {
  
  int v5; // [esp+18h] [ebp-2Ch]
  char v6; // [esp+1Ch] [ebp-28h]
  int v7; // [esp+24h] [ebp-20h]
  int v8; // [esp+24h] [ebp-20h]
  int v9; // [esp+24h] [ebp-20h]
  int v10; // [esp+24h] [ebp-20h]
  int v11; // [esp+28h] [ebp-1Ch]
  int v12; // [esp+28h] [ebp-1Ch]
  int v13; // [esp+28h] [ebp-1Ch]
  int v14; // [esp+28h] [ebp-1Ch]
  unsigned __int16 *v15; // [esp+2Ch] [ebp-18h]
  unsigned __int16 *v16; // [esp+30h] [ebp-14h]
  unsigned __int16 *v17; // [esp+30h] [ebp-14h]
  unsigned __int16 *v18; // [esp+34h] [ebp-10h]
  unsigned __int16 *v19; // [esp+34h] [ebp-10h]
  unsigned __int8 *v20; // [esp+38h] [ebp-Ch]
  unsigned __int8 *v21; // [esp+38h] [ebp-Ch]
  unsigned __int8 *v22; // [esp+38h] [ebp-Ch]
  float v23; // [esp+3Ch] [ebp-8h]
  float v24; // [esp+3Ch] [ebp-8h]
  float v25; // [esp+3Ch] [ebp-8h]
  float v26; // [esp+3Ch] [ebp-8h]
  float v27; // [esp+40h] [ebp-4h]
  float v28; // [esp+40h] [ebp-4h]
  float v29; // [esp+40h] [ebp-4h]
  float v30; // [esp+40h] [ebp-4h]
  int v31; // [esp+50h] [ebp+Ch]
  int v32; // [esp+54h] [ebp+10h]

  if ( !*((_DWORD *)a4 + 1) )
    return 0;
  byte_46F32C8 = *((_BYTE *)a4 + 23) != 0;
  *((_BYTE *)a4 + 23) = 0;
  v31 = a2 >> 16;
  v32 = a3 >> 16;
  v20 = *(unsigned __int8 **)a4;
  *(_DWORD *)a4 = 0;
  if ( v20 )
  {
    j__memcpy(&g_uColorPalette, *((const void **)a4 + 1), 0x180u);
    j__memcpy(&unk_468A760, (char *)&g_cColorGradient + 64 * *((unsigned __int8 *)a4 + 715), 0x40u);
    j__memcpy(&unk_468A7A0, (const void *)(*((_DWORD *)a4 + 1) + (*((unsigned __int8 *)a4 + 715) << 6) + 512), 0x40u);
    v11 = *v20;
    v21 = v20 + 1;
    v7 = *v21++;
    v27 = (float)v31 - (float)((float)*v21 * *(float *)&dword_3E2E2F4);
    v22 = v21 + 1;
    v23 = (float)v32 - (float)((float)*v22 * *(float *)&dword_3E2E2F4);
    if ( (float)OutputWidth >= v27
      && (float)OutputHeight >= v23
      && (float)((float)*(int *)(g_pDestSizeTable + 4 * v11) + v27) >= (float)dword_3E2E2BC
      && (float)((float)*(int *)(g_pDestSizeTable + 4 * v7) + v23) >= 0.0 )
    {
      if ( *(float *)&dword_3E2E2F4 >= 1.0 )
        v6 = 0;
      else
        v6 = 64;
      RenderGfx(
        *(_DWORD *)(v22 + 1) + 1000000 * *((unsigned __int8 *)a4 + 715),
        &g_uColorPalette,
        v22 + 5,
        v11,
        v7,
        v27,
        v23,
        65793 * a1,
        0,
        v6,
        0);
    }
  }
  if ( !g_pIconPalette )
    return 1;
  if ( *((_BYTE *)a4 + 22) )
  {
    v15 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 22)];
    v5 = *((unsigned __int8 *)a4 + 22);
    *((_BYTE *)a4 + 22) = 0;
    v12 = *v15++;
    v8 = *v15++;
    v28 = (float)v31 - (float)((float)*v15 * *(float *)&dword_3E2E2F4);
    v24 = (float)v32 - (float)((float)v15[1] * *(float *)&dword_3E2E2F4);
    if ( (float)OutputWidth >= v28
      && (float)OutputHeight >= v24
      && (float)((float)*(int *)(g_pDestSizeTable + 4 * v12) + v28) >= (float)dword_3E2E2BC
      && (float)((float)*(int *)(g_pDestSizeTable + 4 * v8) + v24) >= 0.0 )
    {
      g_iSettlerSelections[3 * g_iSettlerSelectionCounter] = (int)v28;
      g_iSettlerSelections[3 * g_iSettlerSelectionCounter + 1] = (int)v24;
      g_iSettlerSelections[3 * g_iSettlerSelectionCounter++ + 2] = v5;
    }
  }
  if ( *((_BYTE *)a4 + 20) )
  {
    v18 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 20)];
    *((_BYTE *)a4 + 20) = 0;
    v13 = *v18++;
    v9 = *v18++;
    v29 = (float)v31 - (float)((float)*v18 * *(float *)&dword_3E2E2F4);
    v19 = v18 + 1;
    v25 = (float)v32 - (float)((float)*v19 * *(float *)&dword_3E2E2F4);
    if ( (float)OutputWidth >= v29
      && (float)OutputHeight >= v25
      && (float)((float)*(int *)(g_pDestSizeTable + 4 * v13) + v29) >= (float)dword_3E2E2BC
      && (float)((float)*(int *)(g_pDestSizeTable + 4 * v9) + v25) >= 0.0 )
    {
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter] = (int)v29;
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter + 1] = (int)v25;
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter + 2] = v13;
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter + 3] = v9;
      g_iSettlerFitness[5 * g_iSettlerFitnessCounter++ + 4] = (int)v19;
    }
  }
  if ( !*((_BYTE *)a4 + 21) )
    return 1;
  v16 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 21)];
  *((_BYTE *)a4 + 21) = 0;
  v14 = *v16++;
  v10 = *v16++;
  v30 = (float)v31 - (float)((float)*v16 * *(float *)&dword_3E2E2F4);
  v17 = v16 + 1;
  v26 = (float)v32 - (float)((float)*v17 * *(float *)&dword_3E2E2F4);
  if ( (float)OutputWidth < v30
    || (float)OutputHeight < v26
    || (float)((float)*(int *)(g_pDestSizeTable + 4 * v14) + v30) < (float)dword_3E2E2BC
    || (float)((float)*(int *)(g_pDestSizeTable + 4 * v10) + v26) < 0.0 )
  {
    return 1;
  }
  g_iSettlerMagic[5 * g_iSettlerMagicCounter] = (int)v30;
  g_iSettlerMagic[5 * g_iSettlerMagicCounter + 1] = (int)v26;
  g_iSettlerMagic[5 * g_iSettlerMagicCounter + 2] = v14;
  g_iSettlerMagic[5 * g_iSettlerMagicCounter + 3] = v10;
  g_iSettlerMagic[5 * g_iSettlerMagicCounter++ + 4] = (int)v17;
  return 1;
}


// address=[0x2f93180]
// Decompiled from char __cdecl BlitWaveHardware(int a1, int a2, int a3, int a4, int a5)
bool __cdecl BlitWaveHardware(int a1, int a2, int a3, int a4, int a5) {
  
  int v6; // [esp+18h] [ebp-14h]
  int v7; // [esp+1Ch] [ebp-10h]
  int v8; // [esp+20h] [ebp-Ch]
  int v9; // [esp+24h] [ebp-8h]
  unsigned __int16 *v10; // [esp+28h] [ebp-4h]
  unsigned __int16 *v11; // [esp+28h] [ebp-4h]
  unsigned __int16 *v12; // [esp+28h] [ebp-4h]

  if ( !g_pWavePalettes[a4] )
    return 0;
  v10 = (unsigned __int16 *)g_pWaveGfx[20 * a4 + a5];
  if ( !v10 )
    return 1;
  v6 = *v10;
  v11 = v10 + 1;
  v7 = *v11++;
  v8 = (a2 - (int)(float)((float)*v11 * *(float *)&dword_3E2E2F4)) >> 16;
  v12 = v11 + 1;
  v9 = (a3 - (int)(float)((float)*v12 * *(float *)&dword_3E2E2F4)) >> 16;
  if ( v8 <= OutputWidth
    && v9 <= OutputHeight
    && v8 + (*(int *)(g_pDestSizeTable + 4 * v6) >> 1) >= dword_3E2E2BC
    && v9 + (*(int *)(g_pDestSizeTable + 4 * v7) >> 1) >= 0 )
  {
    CacheRenderingStandard(
      (void *)g_pWavePalettes[a4],
      v12 + 3,
      v12[2],
      32,
      v6,
      v7,
      (float)v8,
      (float)v9,
      0,
      65793 * a1,
      0,
      8);
  }
  return 1;
}


// address=[0x2f932d0]
// Decompiled from char __cdecl BlitBuildingHardware(int a1, int a2, int a3, struct SGfxObjectInfo *a4, int *a5, int *a6)
bool __cdecl BlitBuildingHardware(int a1, int a2, int a3, struct SGfxObjectInfo * a4, int * a5, int & a6) {
  
  int v7; // [esp+58h] [ebp-1CCh]
  int v8; // [esp+5Ch] [ebp-1C8h]
  int v9; // [esp+60h] [ebp-1C4h]
  int v10; // [esp+68h] [ebp-1BCh]
  int v11; // [esp+6Ch] [ebp-1B8h]
  int v12; // [esp+70h] [ebp-1B4h]
  int v13; // [esp+74h] [ebp-1B0h]
  int v14; // [esp+84h] [ebp-1A0h]
  int v15; // [esp+88h] [ebp-19Ch]
  int v16; // [esp+8Ch] [ebp-198h]
  int v17; // [esp+98h] [ebp-18Ch]
  int v18; // [esp+9Ch] [ebp-188h]
  int v19; // [esp+A0h] [ebp-184h]
  int v20; // [esp+A4h] [ebp-180h]
  __int16 *v21; // [esp+A8h] [ebp-17Ch]
  int v22; // [esp+B0h] [ebp-174h]
  int v23; // [esp+B4h] [ebp-170h]
  int v24; // [esp+B8h] [ebp-16Ch]
  int v25; // [esp+BCh] [ebp-168h]
  int v26; // [esp+C0h] [ebp-164h]
  int v27; // [esp+C4h] [ebp-160h]
  int v28; // [esp+C8h] [ebp-15Ch]
  int v29; // [esp+CCh] [ebp-158h]
  int v30; // [esp+D0h] [ebp-154h]
  int v31; // [esp+D4h] [ebp-150h]
  int v32; // [esp+D8h] [ebp-14Ch]
  int v33; // [esp+DCh] [ebp-148h]
  float v34; // [esp+E0h] [ebp-144h]
  float v35; // [esp+E4h] [ebp-140h]
  int v36; // [esp+E8h] [ebp-13Ch]
  int v37; // [esp+E8h] [ebp-13Ch]
  int v38; // [esp+ECh] [ebp-138h]
  int v39; // [esp+ECh] [ebp-138h]
  int v40; // [esp+F8h] [ebp-12Ch]
  int v41; // [esp+FCh] [ebp-128h]
  unsigned int jj; // [esp+100h] [ebp-124h]
  int v43; // [esp+104h] [ebp-120h]
  int v44; // [esp+108h] [ebp-11Ch]
  __int16 *v45; // [esp+10Ch] [ebp-118h]
  __int16 *v46; // [esp+10Ch] [ebp-118h]
  unsigned __int8 *v47; // [esp+110h] [ebp-114h]
  unsigned __int8 *v48; // [esp+110h] [ebp-114h]
  unsigned __int8 *v49; // [esp+110h] [ebp-114h]
  unsigned __int16 *v50; // [esp+114h] [ebp-110h]
  unsigned __int16 *v51; // [esp+114h] [ebp-110h]
  unsigned __int16 *v52; // [esp+114h] [ebp-110h]
  unsigned __int8 *v53; // [esp+118h] [ebp-10Ch]
  unsigned __int8 *v54; // [esp+118h] [ebp-10Ch]
  unsigned __int8 *v55; // [esp+118h] [ebp-10Ch]
  unsigned __int8 *v56; // [esp+118h] [ebp-10Ch]
  int v57; // [esp+11Ch] [ebp-108h]
  int v58; // [esp+11Ch] [ebp-108h]
  int v59; // [esp+120h] [ebp-104h]
  int v60; // [esp+120h] [ebp-104h]
  unsigned int i; // [esp+124h] [ebp-100h]
  unsigned int j; // [esp+124h] [ebp-100h]
  int v63; // [esp+128h] [ebp-FCh]
  int v64; // [esp+128h] [ebp-FCh]
  int v65; // [esp+12Ch] [ebp-F8h]
  int v66; // [esp+130h] [ebp-F4h]
  int v67; // [esp+134h] [ebp-F0h]
  int v68; // [esp+134h] [ebp-F0h]
  int v69; // [esp+134h] [ebp-F0h]
  int v70; // [esp+134h] [ebp-F0h]
  int v71; // [esp+138h] [ebp-ECh]
  int v72; // [esp+138h] [ebp-ECh]
  int v73; // [esp+138h] [ebp-ECh]
  int v74; // [esp+138h] [ebp-ECh]
  float v75; // [esp+13Ch] [ebp-E8h]
  float v76; // [esp+13Ch] [ebp-E8h]
  float v77; // [esp+13Ch] [ebp-E8h]
  float v78; // [esp+13Ch] [ebp-E8h]
  float v79; // [esp+13Ch] [ebp-E8h]
  float v80; // [esp+140h] [ebp-E4h]
  float v81; // [esp+140h] [ebp-E4h]
  float v82; // [esp+140h] [ebp-E4h]
  float v83; // [esp+140h] [ebp-E4h]
  float v84; // [esp+140h] [ebp-E4h]
  __int16 *v85; // [esp+144h] [ebp-E0h]
  __int16 *v86; // [esp+144h] [ebp-E0h]
  __int16 *v87; // [esp+144h] [ebp-E0h]
  unsigned int k; // [esp+148h] [ebp-DCh]
  unsigned int m; // [esp+148h] [ebp-DCh]
  unsigned int n; // [esp+148h] [ebp-DCh]
  unsigned int ii; // [esp+148h] [ebp-DCh]
  __int16 *v92; // [esp+14Ch] [ebp-D8h]
  __int16 *v93; // [esp+14Ch] [ebp-D8h]
  __int16 *v94; // [esp+14Ch] [ebp-D8h]
  __int16 *v95; // [esp+14Ch] [ebp-D8h]
  __int16 *v96; // [esp+14Ch] [ebp-D8h]
  __int16 *v97; // [esp+14Ch] [ebp-D8h]
  __int16 *v98; // [esp+14Ch] [ebp-D8h]
  __int16 *v99; // [esp+14Ch] [ebp-D8h]
  __int16 *v100; // [esp+14Ch] [ebp-D8h]
  __int16 *v101; // [esp+14Ch] [ebp-D8h]
  __int16 *v102; // [esp+14Ch] [ebp-D8h]
  __int16 *v103; // [esp+14Ch] [ebp-D8h]
  __int16 *v104; // [esp+14Ch] [ebp-D8h]
  __int16 *v105; // [esp+14Ch] [ebp-D8h]
  __int16 *v106; // [esp+14Ch] [ebp-D8h]
  __int16 *v107; // [esp+14Ch] [ebp-D8h]
  int v108; // [esp+150h] [ebp-D4h]
  int v109; // [esp+150h] [ebp-D4h]
  int v110; // [esp+154h] [ebp-D0h]
  int v111; // [esp+154h] [ebp-D0h]
  int v112; // [esp+158h] [ebp-CCh]
  int v113; // [esp+158h] [ebp-CCh]
  int v114; // [esp+15Ch] [ebp-C8h]
  int v115; // [esp+15Ch] [ebp-C8h]
  _DWORD v116[48]; // [esp+160h] [ebp-C4h] BYREF
  int v117; // [esp+230h] [ebp+Ch]
  int v118; // [esp+234h] [ebp+10h]

  if ( !*((_DWORD *)a4 + 1) )
    return 0;
  byte_46F32C8 = *((_BYTE *)a4 + 23) != 0;
  *((_BYTE *)a4 + 23) = 0;
  v117 = a2 >> 16;
  v118 = a3 >> 16;
  v65 = 0;
  v66 = 0;
  v43 = 0;
  v44 = 0;
  if ( *(_DWORD *)a4 <= *((_DWORD *)a4 + 22) )
    v21 = (__int16 *)*((_DWORD *)a4 + 22);
  else
    v21 = *(__int16 **)a4;
  v67 = *v21;
  v71 = v21[1];
  v40 = v21[2];
  v41 = v21[3];
  if ( v67 < 512 && v71 < 512 )
  {
    v108 = 0;
    v110 = 0;
    v112 = *v21;
    v114 = v21[1];
    for ( i = 0; i < 0xA; ++i )
    {
      v85 = (__int16 *)*((_DWORD *)a4 + 4 * i + 134);
      if ( v85 )
      {
        v20 = *v85;
        v86 = v85 + 1;
        v17 = *v86;
        v87 = v86 + 1;
        v19 = v87[1];
        v18 = *((_DWORD *)a4 + 4 * i + 137);
        v63 = *((_DWORD *)a4 + 4 * i + 136) + v40 - *v87;
        if ( v63 >= v108 )
        {
          v64 = v20 + v63;
          if ( v64 > v112 )
            v112 = v64;
        }
        else
        {
          v108 = *((_DWORD *)a4 + 4 * i + 136) + v40 - *v87;
        }
        if ( v18 + v41 - v19 >= 0 )
        {
          if ( v17 + v18 + v41 - v19 > v114 )
            v114 = v17 + v18 + v41 - v19;
        }
        else
        {
          v110 = v18 + v41 - v19;
        }
      }
    }
    for ( j = 0; j < 0x15; ++j )
    {
      v47 = (unsigned __int8 *)*((_DWORD *)a4 + 4 * j + 50);
      if ( v47 )
      {
        v16 = *v47;
        v48 = v47 + 1;
        v9 = *v48;
        v49 = v48 + 1;
        v15 = v49[1];
        v14 = *((_DWORD *)a4 + 4 * j + 53);
        v59 = *((_DWORD *)a4 + 4 * j + 52) + v40 - *v49;
        if ( v59 >= v108 )
        {
          v60 = v16 + v59;
          if ( v60 > v112 )
            v112 = v60;
        }
        else
        {
          v108 = *((_DWORD *)a4 + 4 * j + 52) + v40 - *v49;
        }
        if ( v14 + v41 - v15 >= 0 )
        {
          if ( v9 + v14 + v41 - v15 > v114 )
            v114 = v9 + v14 + v41 - v15;
        }
        else
        {
          v110 = v14 + v41 - v15;
        }
      }
    }
    if ( *((_DWORD *)a4 + 20) )
    {
      v45 = (__int16 *)*((_DWORD *)a4 + 20);
      v13 = *v45++;
      v10 = *v45;
      v46 = v45 + 1;
      v12 = v46[1];
      v11 = *((_DWORD *)a4 + 7);
      v57 = *((_DWORD *)a4 + 6) + v40 - *v46;
      if ( v57 >= v108 )
      {
        v58 = v13 + v57;
        if ( v58 > v112 )
          v112 = v58;
      }
      else
      {
        v108 = *((_DWORD *)a4 + 6) + v40 - *v46;
      }
      if ( v11 + v41 - v12 >= 0 )
      {
        if ( v10 + v11 + v41 - v12 > v114 )
          v114 = v10 + v11 + v41 - v12;
      }
      else
      {
        v110 = v11 + v41 - v12;
      }
    }
    if ( v112 > v67 )
      v43 = v112 - v67;
    if ( v114 > v71 )
      v44 = v114 - v71;
    if ( v108 < 0 )
      v65 = -v108;
    if ( v110 < 0 )
      v66 = -v110;
    v109 = v65 + v108;
    v113 = v65 + v112;
    v111 = v66 + v110;
    v115 = v66 + v114;
    if ( v109 >= 0 && v111 >= 0 && v115 < 512 && v113 < 512 )
    {
      v75 = (float)v117 - (float)((float)(v65 + v40) * *(float *)&dword_3E2E2F4);
      v80 = (float)v118 - (float)((float)(v66 + v41) * *(float *)&dword_3E2E2F4);
      if ( (float)OutputWidth >= v75
        && (float)OutputHeight >= v80
        && (float)((float)*(int *)(g_pDestSizeTable + 4 * (v113 - v109)) + v75) >= (float)dword_3E2E2BC
        && (float)((float)*(int *)(g_pDestSizeTable + 4 * (v115 - v111)) + v80) >= 0.0 )
      {
        if ( byte_3E2E324 )
        {
          v35 = (float)(v113 - v109) * *(float *)&dword_3E2E2F4;
          v34 = (float)(v115 - v111) * *(float *)&dword_3E2E2F4;
          _vec_ctor_no(v116, 0x20u, 6u, (void *(__thiscall *)(void *))_D3DTLVERTEX::_D3DTLVERTEX);
          v116[4] = &dword_420320[234316];
          v116[5] = -1;
          v116[6] = 0;
          v116[7] = 0;
          *(float *)&v116[3] = FLOAT_0_5;
          *(float *)v116 = v75;
          *(float *)&v116[1] = v80;
          v116[12] = &dword_420320[234316];
          v116[13] = -1;
          v116[14] = 0;
          v116[15] = 0;
          *(float *)&v116[11] = FLOAT_0_5;
          *(float *)&v116[8] = v75 + v35;
          *(float *)&v116[9] = v80;
          v116[20] = &dword_420320[234316];
          v116[21] = -1;
          v116[22] = 0;
          v116[23] = 0;
          *(float *)&v116[19] = FLOAT_0_5;
          *(float *)&v116[16] = v75;
          *(float *)&v116[17] = v80 + v34;
          v116[28] = &dword_420320[234316];
          v116[29] = -1;
          v116[30] = 0;
          v116[31] = 0;
          *(float *)&v116[27] = FLOAT_0_5;
          *(float *)&v116[24] = v75;
          *(float *)&v116[25] = v80 + v34;
          v116[36] = &dword_420320[234316];
          v116[37] = -1;
          v116[38] = 0;
          v116[39] = 0;
          *(float *)&v116[35] = FLOAT_0_5;
          *(float *)&v116[32] = v75 + v35;
          *(float *)&v116[33] = v80;
          v116[44] = &dword_420320[234316];
          v116[45] = -1;
          v116[46] = 0;
          v116[47] = 0;
          *(float *)&v116[43] = FLOAT_0_5;
          *(float *)&v116[40] = v75 + v35;
          *(float *)&v116[41] = v80 + v34;
          (*(void (__stdcall **)(int, int, int, _DWORD *, int, _DWORD))(*(_DWORD *)D3DObjectPtr->field_38 + 100))(
            D3DObjectPtr->field_38,
            4,
            452,
            v116,
            6,
            0);
        }
        v92 = *(__int16 **)a4;
        if ( *((_DWORD *)a4 + 22) )
        {
          v92 = (__int16 *)*((_DWORD *)a4 + 22);
          if ( *(_DWORD *)a4 )
          {
            v68 = *v92;
            v93 = v92 + 1;
            v72 = *v93++;
            v76 = (float)v117 - (float)((float)(v65 + *v93) * *(float *)&dword_3E2E2F4);
            v94 = v93 + 1;
            v81 = (float)v118 - (float)((float)(v66 + *v94) * *(float *)&dword_3E2E2F4);
            if ( (float)OutputWidth >= v76
              && (float)OutputHeight >= v81
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v68) + v76) >= (float)dword_3E2E2BC
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v72) + v81) >= 0.0 )
            {
              sub_2F96D80(
                v94[2],
                *((_DWORD *)a4 + 1),
                v94 + 3,
                v68,
                v72,
                LODWORD(v76),
                LODWORD(v81),
                0,
                65793 * a1,
                v65,
                v43,
                v66,
                v44,
                1);
            }
            v92 = *(__int16 **)a4;
          }
        }
        if ( v92 )
        {
          v69 = *v92;
          v95 = v92 + 1;
          v73 = *v95++;
          v31 = *v95++;
          v30 = *v95;
          v77 = (float)v117 - (float)((float)(v65 + v31) * *(float *)&dword_3E2E2F4);
          v82 = (float)v118 - (float)((float)(v66 + v30) * *(float *)&dword_3E2E2F4);
          v96 = v95 + 3;
          if ( *((_DWORD *)a4 + 23) )
          {
            sub_2F96D80(
              *(v96 - 1),
              *((_DWORD *)a4 + 1),
              v96,
              v69,
              v73,
              LODWORD(v77),
              LODWORD(v82),
              BYTE1(*((_DWORD *)a4 + 23)),
              65793 * a1,
              v65,
              v43,
              v66,
              v44,
              1);
          }
          else if ( *((_DWORD *)a4 + 23) != 0xFFFF )
          {
            sub_2F96D80(
              *(v96 - 1),
              *((_DWORD *)a4 + 1),
              v96,
              v69,
              v73,
              LODWORD(v77),
              LODWORD(v82),
              0,
              65793 * a1,
              v65,
              v43,
              v66,
              v44,
              1);
            for ( k = 0; k < 4; ++k )
            {
              if ( *((_DWORD *)a4 + k + 8) )
                sub_2F96D80(
                  *(unsigned __int16 *)(*((_DWORD *)a4 + k + 8) + 8),
                  *((_DWORD *)a4 + 1),
                  *((_DWORD *)a4 + k + 8) + 12,
                  v69,
                  v73,
                  0,
                  0,
                  0,
                  65793 * a1,
                  v65,
                  v43,
                  v66,
                  v44,
                  0);
            }
            if ( *((_DWORD *)a4 + 12) && *a6 < 511 )
            {
              *a5 = -1;
              a5[1] = (int)(float)((float)v117 - (float)((float)v31 * *(float *)&dword_3E2E2F4));
              a5[2] = (int)(float)((float)v118 - (float)((float)v30 * *(float *)&dword_3E2E2F4));
              a5[3] = *((_DWORD *)a4 + 12);
              a5[4] = *((_DWORD *)a4 + 1);
              a5[5] = a1;
              ++*a6;
            }
            for ( m = 0; m < 0xA; ++m )
            {
              v97 = (__int16 *)*((_DWORD *)a4 + 4 * m + 134);
              if ( v97 )
              {
                v28 = *v97;
                v98 = v97 + 1;
                v29 = *v98;
                v99 = v98 + 1;
                if ( *((_DWORD *)a4 + 4 * m + 135) )
                {
                  if ( v28 > 512 || v29 > 512 )
                    BBSupportTracePrintF(
                      0,
                      "GFX ENGINE: DATA ERROR: Size of building object is too big! Object will be ignored!");
                  ((void (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char))sub_2F96D80)(
                    v99[3],
                    *((_DWORD *)a4 + 4 * m + 135),
                    v99 + 4,
                    v28,
                    v29,
                    (float)(*((_DWORD *)a4 + 4 * m + 136) + v40 - *v99),
                    (float)(*((_DWORD *)a4 + 4 * m + 137) + v41 - v99[1]),
                    0,
                    65793 * a1,
                    v65,
                    v43,
                    v66,
                    v44,
                    0);
                }
                else
                {
                  BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: No building pile palette!");
                }
              }
            }
            for ( n = 0; n < 0x15; ++n )
            {
              v53 = (unsigned __int8 *)*((_DWORD *)a4 + 4 * n + 50);
              if ( v53 )
              {
                v24 = *v53;
                v54 = v53 + 1;
                v25 = *v54;
                v55 = v54 + 1;
                if ( *((_DWORD *)a4 + 4 * n + 51) )
                {
                  v26 = *v55;
                  v56 = v55 + 1;
                  v27 = *v56;
                  v8 = (int)(float)((float)v117
                                  - (float)((float)(v26 - *((_DWORD *)a4 + 4 * n + 52)) * *(float *)&dword_3E2E2F4));
                  v7 = (int)(float)((float)v118
                                  - (float)((float)(v27 - *((_DWORD *)a4 + 4 * n + 53)) * *(float *)&dword_3E2E2F4));
                  j__memcpy(&g_uColorPalette, *((const void **)a4 + 4 * n + 51), 0x180u);
                  j__memcpy(&unk_468A760, (char *)&g_cColorGradient + 64 * *((unsigned __int8 *)a4 + 715), 0x40u);
                  j__memcpy(
                    &unk_468A7A0,
                    (const void *)(*((_DWORD *)a4 + 4 * n + 51) + (*((unsigned __int8 *)a4 + 715) << 6) + 512),
                    0x40u);
                  if ( n == 20 && *a6 < 511 )
                  {
                    a5[6] = -2;
                    a5[7] = v8;
                    a5[8] = v7;
                    a5[9] = *((_DWORD *)a4 + 130);
                    a5[10] = *((_DWORD *)a4 + 131);
                    a5[11] = a1 + (*((unsigned __int8 *)a4 + 715) << 16);
                    ++*a6;
                  }
                  else
                  {
                    ((void (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char))sub_2F96D80)(
                      *(_DWORD *)(v56 + 1),
                      &g_uColorPalette,
                      v56 + 5,
                      v24,
                      v25,
                      (float)(*((_DWORD *)a4 + 4 * n + 52) + v40 - v26),
                      (float)(*((_DWORD *)a4 + 4 * n + 53) + v41 - v27),
                      0,
                      65793 * a1,
                      v65,
                      v43,
                      v66,
                      v44,
                      0);
                  }
                }
                else
                {
                  BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: No settler patch palette!");
                }
              }
            }
            for ( ii = 5; ii < 0xA; ++ii )
            {
              if ( *((_DWORD *)a4 + ii + 8) )
                sub_2F96D80(
                  *(unsigned __int16 *)(*((_DWORD *)a4 + ii + 8) + 8),
                  *((_DWORD *)a4 + 1),
                  *((_DWORD *)a4 + ii + 8) + 12,
                  v69,
                  v73,
                  0,
                  0,
                  0,
                  65793 * a1,
                  v65,
                  v43,
                  v66,
                  v44,
                  0);
            }
            if ( *((_DWORD *)a4 + 20) && *((_DWORD *)a4 + 21) )
            {
              v100 = (__int16 *)*((_DWORD *)a4 + 20);
              v36 = *v100;
              v38 = v100[1];
              v101 = v100 + 2;
              if ( v36 > 512 || v38 > 512 )
                BBSupportTracePrintF(
                  0,
                  "GFX ENGINE: DATA ERROR: Size of building flag is too big! Object will be ignored!");
              v22 = *v101;
              v102 = v101 + 1;
              v23 = *v102;
              ((void (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char))sub_2F96D80)(
                v102[2],
                *((_DWORD *)a4 + 21),
                v102 + 3,
                v36,
                v38,
                (float)(*((_DWORD *)a4 + 6) + v40 - v22),
                (float)(*((_DWORD *)a4 + 7) + v41 - v23),
                0,
                65793 * a1,
                v65,
                v43,
                v66,
                v44,
                0);
              if ( *((_DWORD *)a4 + 18) && *((_DWORD *)a4 + 19) )
              {
                v103 = (__int16 *)*((_DWORD *)a4 + 18);
                v37 = *v103;
                v39 = v103[1];
                v104 = v103 + 2;
                if ( v37 > 512 || v39 > 512 )
                  BBSupportTracePrintF(
                    0,
                    "GFX ENGINE: DATA ERROR: Size of heraldic figure is too big! Object will be ignored!");
                ((void (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char))sub_2F96D80)(
                  v104[3],
                  *((_DWORD *)a4 + 19),
                  v104 + 4,
                  v37,
                  v39,
                  (float)(*((_DWORD *)a4 + 6) + v40 - v22 - *v104),
                  (float)(*((_DWORD *)a4 + 7) + v41 - v23 - v104[1]),
                  0,
                  65793 * a1,
                  v65,
                  v43,
                  v66,
                  v44,
                  0);
              }
            }
          }
        }
        for ( jj = 0; jj < 6; ++jj )
        {
          if ( *((_DWORD *)a4 + 4 * jj + 26) && *((_DWORD *)a4 + 4 * jj + 27) )
          {
            v105 = (__int16 *)*((_DWORD *)a4 + 4 * jj + 26);
            *((_DWORD *)a4 + 4 * jj + 26) = 0;
            v32 = *v105;
            v33 = v105[1];
            v106 = v105 + 2;
            if ( v32 > 512 || v33 > 512 )
              BBSupportTracePrintF(
                0,
                "GFX ENGINE: DATA ERROR: Size of building-effect is too big! Object will be ignored!");
            v78 = (float)v117 - (float)((float)(*v106 - *((_DWORD *)a4 + 4 * jj + 28)) * *(float *)&dword_3E2E2F4);
            v107 = v106 + 1;
            v83 = (float)v118 - (float)((float)(*v107 - *((_DWORD *)a4 + 4 * jj + 29)) * *(float *)&dword_3E2E2F4);
            if ( (float)OutputWidth >= v78
              && (float)OutputHeight >= v83
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v32) + v78) >= (float)dword_3E2E2BC
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v33) + v83) >= 0.0 )
            {
              RenderGfx(v107[2], *((void **)a4 + 4 * jj + 27), v107 + 3, v32, v33, v78, v83, 65793 * a1, 0, 0, 0);
            }
          }
        }
        if ( !*((_BYTE *)a4 + 22) || !g_pIconPalette )
          return 1;
        v50 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 22)];
        v70 = *v50;
        v74 = v50[1];
        v51 = v50 + 2;
        if ( v70 > 512 || v74 > 512 )
          BBSupportTracePrintF(
            0,
            "GFX ENGINE: DATA ERROR: Size of accessory object is too big! Object will be ignored!");
        v79 = (float)v117 - (float)((float)*v51 * *(float *)&dword_3E2E2F4);
        v52 = v51 + 1;
        v84 = (float)v118 - (float)((float)*v52 * *(float *)&dword_3E2E2F4);
        if ( (float)OutputWidth >= v79
          && (float)OutputHeight >= v84
          && (float)((float)*(int *)(g_pDestSizeTable + 4 * v70) + v79) >= (float)dword_3E2E2BC
          && (float)((float)*(int *)(g_pDestSizeTable + 4 * v74) + v84) >= 0.0 )
        {
          CacheRenderingStandard((void *)g_pIconPalette, v52 + 3, v52[2], 64, v70, v74, v79, v84, 0, -1, 0, 0);
        }
        return 1;
      }
      else
      {
        return 1;
      }
    }
    else
    {
      BBSupportTracePrintF(0, "GFX ENGINE: The building patches exceeds the allowed max size of 512 x 512!");
      BBSupportTracePrintF(0, "GFX ENGINE: Building won't be rendered!");
      return 0;
    }
  }
  else
  {
    BBSupportTracePrintF(0, "GFX ENGINE: A building is too big! No rendering!");
    return 0;
  }
}


// address=[0x2f951e0]
// Decompiled from char __cdecl BlitObjectHardware(int a1, int a2, int a3, struct SGfxObjectInfo *a4)
bool __cdecl BlitObjectHardware(int a1, int a2, int a3, struct SGfxObjectInfo * a4) {
  
  int v5; // [esp+18h] [ebp-28h]
  int v6; // [esp+1Ch] [ebp-24h]
  int v7; // [esp+28h] [ebp-18h]
  int v8; // [esp+28h] [ebp-18h]
  int v9; // [esp+2Ch] [ebp-14h]
  int v10; // [esp+2Ch] [ebp-14h]
  float v11; // [esp+30h] [ebp-10h]
  float v12; // [esp+30h] [ebp-10h]
  float v13; // [esp+30h] [ebp-10h]
  float v14; // [esp+34h] [ebp-Ch]
  float v15; // [esp+34h] [ebp-Ch]
  float v16; // [esp+34h] [ebp-Ch]
  unsigned __int16 *v17; // [esp+38h] [ebp-8h]
  unsigned __int16 *v18; // [esp+38h] [ebp-8h]
  unsigned __int16 *v19; // [esp+3Ch] [ebp-4h]
  unsigned __int16 *v20; // [esp+3Ch] [ebp-4h]
  unsigned __int16 *v21; // [esp+3Ch] [ebp-4h]
  unsigned __int16 *v22; // [esp+3Ch] [ebp-4h]
  unsigned __int16 *v23; // [esp+3Ch] [ebp-4h]
  int v24; // [esp+4Ch] [ebp+Ch]
  int v25; // [esp+50h] [ebp+10h]

  if ( !*((_DWORD *)a4 + 1) )
    return 0;
  byte_46F32C8 = *((_BYTE *)a4 + 23) != 0;
  *((_BYTE *)a4 + 23) = 0;
  v24 = a2 >> 16;
  v25 = a3 >> 16;
  v19 = *(unsigned __int16 **)a4;
  *(_DWORD *)a4 = 0;
  if ( v19 )
  {
    v7 = *v19;
    v20 = v19 + 1;
    v9 = *v20;
    v21 = v20 + 1;
    v6 = dword_3E2E2F4;
    v5 = *(_DWORD *)g_pZoomGradient;
    if ( (v21[2] & 0x10) != 0 )
    {
      *(int *)g_pZoomGradient >>= 1;
      *(float *)&dword_3E2E2F4 = *(float *)&dword_3E2E2F4 * 0.5;
      v11 = (float)v24 - (float)((float)*v21 * *(float *)&dword_3E2E2F4);
      v22 = v21 + 1;
      v14 = (float)v25 - (float)((float)*v22 * *(float *)&dword_3E2E2F4);
      if ( (float)OutputWidth >= v11
        && (float)OutputHeight >= v14
        && (float)((float)(*(int *)(g_pDestSizeTable + 4 * v7) >> 1) + v11) >= (float)dword_3E2E2BC
        && (float)((float)(*(int *)(g_pDestSizeTable + 4 * v9) >> 1) + v14) >= 0.0 )
      {
        CacheRenderingStandard(
          *((void **)a4 + 1),
          v22 + 3,
          v22[2],
          *((unsigned __int8 *)a4 + 712),
          v7,
          v9,
          v11,
          v14,
          0,
          65793 * a1,
          1,
          0);
      }
    }
    else
    {
      v12 = (float)v24 - (float)((float)*v21 * *(float *)&dword_3E2E2F4);
      v23 = v21 + 1;
      v15 = (float)v25 - (float)((float)*v23 * *(float *)&dword_3E2E2F4);
      if ( (float)OutputWidth >= v12
        && (float)OutputHeight >= v15
        && (float)((float)*(int *)(g_pDestSizeTable + 4 * v7) + v12) >= (float)dword_3E2E2BC
        && (float)((float)*(int *)(g_pDestSizeTable + 4 * v9) + v15) >= 0.0 )
      {
        CacheRenderingStandard(
          *((void **)a4 + 1),
          v23 + 3,
          v23[2],
          *((unsigned __int8 *)a4 + 712),
          v7,
          v9,
          v12,
          v15,
          0,
          65793 * a1,
          0,
          0);
      }
    }
    dword_3E2E2F4 = v6;
    *(_DWORD *)g_pZoomGradient = v5;
  }
  if ( !*((_BYTE *)a4 + 22) )
    return 1;
  if ( !g_pIconPalette )
    return 1;
  v17 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 22)];
  *((_BYTE *)a4 + 22) = 0;
  v8 = *v17++;
  v10 = *v17++;
  v13 = (float)v24 - (float)((float)*v17 * *(float *)&dword_3E2E2F4);
  v18 = v17 + 1;
  v16 = (float)v25 - (float)((float)*v18 * *(float *)&dword_3E2E2F4);
  if ( (float)OutputWidth >= v13
    && (float)OutputHeight >= v16
    && (float)((float)*(int *)(g_pDestSizeTable + 4 * v8) + v13) >= (float)dword_3E2E2BC
    && (float)((float)*(int *)(g_pDestSizeTable + 4 * v10) + v16) >= 0.0 )
  {
    CacheRenderingStandard(
      (void *)g_pIconPalette,
      v18 + 3,
      v18[2],
      *((unsigned __int8 *)a4 + 712),
      v8,
      v10,
      v13,
      v16,
      0,
      65793 * a1,
      0,
      0);
  }
  return 1;
}


// address=[0x2f95660]
// Decompiled from char __cdecl BlitBorderstoneHardware(int a1, int a2, int a3, int a4)
bool __cdecl BlitBorderstoneHardware(int a1, int a2, int a3, int a4) {
  
  int v5; // [esp+1Ch] [ebp-14h]
  int v6; // [esp+20h] [ebp-10h]
  float v7; // [esp+24h] [ebp-Ch]
  float v8; // [esp+28h] [ebp-8h]
  unsigned __int16 *v9; // [esp+2Ch] [ebp-4h]
  unsigned __int16 *v10; // [esp+2Ch] [ebp-4h]
  unsigned __int16 *v11; // [esp+2Ch] [ebp-4h]
  int v12; // [esp+3Ch] [ebp+Ch]
  int v13; // [esp+40h] [ebp+10h]

  if ( !g_pBorderstonePalette )
    return 0;
  v12 = a2 >> 16;
  v13 = a3 >> 16;
  if ( a4 < 1 || a4 > 8 )
    BBSupportTracePrintF(0, "GFX ENGINE: Illegal value of owner id.");
  v9 = (unsigned __int16 *)g_pBorderstoneGfx[a4];
  if ( !v9 )
    return 1;
  v5 = *v9;
  v10 = v9 + 1;
  v6 = *v10;
  v7 = (float)v12 - (float)((float)v10[1] * *(float *)&dword_3E2E2F4);
  v11 = v10 + 2;
  v8 = (float)v13 - (float)((float)*v11 * *(float *)&dword_3E2E2F4);
  if ( (float)OutputWidth >= v7
    && (float)OutputHeight >= v8
    && (float)((float)*(int *)(g_pDestSizeTable + 4 * v5) + v7) >= (float)dword_3E2E2BC
    && (float)((float)*(int *)(g_pDestSizeTable + 4 * v6) + v8) >= 0.0 )
  {
    CacheRenderingStandard((void *)g_pBorderstonePalette, v11 + 3, v11[2], 32, v5, v6, v7, v8, 0, 65793 * a1, 0, 0);
  }
  return 1;
}


// address=[0x2f957f0]
// Decompiled from char __cdecl BlitVehicleHardware(int a1, int a2, int a3, struct SGfxObjectInfo *a4)
bool __cdecl BlitVehicleHardware(int a1, int a2, int a3, struct SGfxObjectInfo * a4) {
  
  int v5; // [esp+44h] [ebp-150h]
  int v6; // [esp+4Ch] [ebp-148h]
  int v7; // [esp+50h] [ebp-144h]
  int v8; // [esp+54h] [ebp-140h]
  int v9; // [esp+58h] [ebp-13Ch]
  __int16 *v10; // [esp+64h] [ebp-130h]
  int v11; // [esp+6Ch] [ebp-128h]
  float v12; // [esp+70h] [ebp-124h]
  int v13; // [esp+74h] [ebp-120h]
  int v14; // [esp+78h] [ebp-11Ch]
  int v15; // [esp+7Ch] [ebp-118h]
  float v16; // [esp+80h] [ebp-114h]
  int v17; // [esp+84h] [ebp-110h]
  int v18; // [esp+88h] [ebp-10Ch]
  __int16 *v19; // [esp+94h] [ebp-100h]
  __int16 *v20; // [esp+94h] [ebp-100h]
  unsigned __int16 *v21; // [esp+9Ch] [ebp-F8h]
  unsigned __int16 *v22; // [esp+9Ch] [ebp-F8h]
  unsigned __int16 *v23; // [esp+A0h] [ebp-F4h]
  unsigned __int16 *v24; // [esp+A0h] [ebp-F4h]
  unsigned __int16 *v25; // [esp+A4h] [ebp-F0h]
  unsigned __int16 *v26; // [esp+A4h] [ebp-F0h]
  int v27; // [esp+A8h] [ebp-ECh]
  int v28; // [esp+A8h] [ebp-ECh]
  int v29; // [esp+ACh] [ebp-E8h]
  unsigned __int16 *v30; // [esp+ACh] [ebp-E8h]
  unsigned __int16 *v31; // [esp+ACh] [ebp-E8h]
  int v32; // [esp+B0h] [ebp-E4h]
  int v33; // [esp+B0h] [ebp-E4h]
  int v34; // [esp+B0h] [ebp-E4h]
  int v35; // [esp+B0h] [ebp-E4h]
  int v36; // [esp+B0h] [ebp-E4h]
  int v37; // [esp+B4h] [ebp-E0h]
  int v38; // [esp+B4h] [ebp-E0h]
  int v39; // [esp+B4h] [ebp-E0h]
  int v40; // [esp+B4h] [ebp-E0h]
  int v41; // [esp+B4h] [ebp-E0h]
  float v42; // [esp+B8h] [ebp-DCh]
  float v43; // [esp+B8h] [ebp-DCh]
  float v44; // [esp+B8h] [ebp-DCh]
  float v45; // [esp+B8h] [ebp-DCh]
  float v46; // [esp+BCh] [ebp-D8h]
  float v47; // [esp+BCh] [ebp-D8h]
  float v48; // [esp+BCh] [ebp-D8h]
  float v49; // [esp+BCh] [ebp-D8h]
  int v50; // [esp+C0h] [ebp-D4h]
  int v51; // [esp+C0h] [ebp-D4h]
  int v52; // [esp+C4h] [ebp-D0h]
  int v53; // [esp+C4h] [ebp-D0h]
  int v54; // [esp+C8h] [ebp-CCh]
  int v55; // [esp+C8h] [ebp-CCh]
  int v56; // [esp+CCh] [ebp-C8h]
  int v57; // [esp+CCh] [ebp-C8h]
  _DWORD v58[48]; // [esp+D0h] [ebp-C4h] BYREF
  int v59; // [esp+1A0h] [ebp+Ch]
  int v60; // [esp+1A4h] [ebp+10h]

  if ( !*((_DWORD *)a4 + 1) )
    return 0;
  byte_46F32C8 = *((_BYTE *)a4 + 23) != 0;
  *((_BYTE *)a4 + 23) = 0;
  v59 = a2 >> 16;
  v60 = a3 >> 16;
  v17 = 0;
  v18 = 0;
  v15 = 0;
  v11 = 0;
  if ( *(_DWORD *)a4 <= *((_DWORD *)a4 + 22) )
    v10 = (__int16 *)*((_DWORD *)a4 + 22);
  else
    v10 = *(__int16 **)a4;
  v32 = *v10;
  v37 = v10[1];
  v13 = v10[2];
  v14 = v10[3];
  if ( v32 < 512 && v37 < 512 )
  {
    v50 = 0;
    v52 = 0;
    v54 = *v10;
    v56 = v10[1];
    if ( *((_DWORD *)a4 + 3) )
    {
      v19 = (__int16 *)*((_DWORD *)a4 + 3);
      v9 = *v19++;
      v6 = *v19;
      v20 = v19 + 1;
      v8 = v20[1];
      v7 = *((_DWORD *)a4 + 29);
      v27 = *((_DWORD *)a4 + 28) + v13 - *v20;
      if ( v27 >= 0 )
      {
        v28 = v9 + v27;
        if ( v28 > v32 )
          v54 = v28;
      }
      else
      {
        v50 = *((_DWORD *)a4 + 28) + v13 - *v20;
      }
      if ( v7 + v14 - v8 >= 0 )
      {
        if ( v6 + v7 + v14 - v8 > v37 )
          v56 = v6 + v7 + v14 - v8;
      }
      else
      {
        v52 = v7 + v14 - v8;
      }
    }
    if ( v54 > v32 )
      v15 = v54 - v32;
    if ( v56 > v37 )
      v11 = v56 - v37;
    if ( v50 < 0 )
      v17 = -v50;
    if ( v52 < 0 )
      v18 = -v52;
    v51 = v17 + v50;
    v55 = v17 + v54;
    v53 = v18 + v52;
    v57 = v18 + v56;
    if ( v51 >= 0 && v53 >= 0 && v57 < 512 && v55 < 512 )
    {
      v46 = (float)v59 - (float)((float)(v17 + v13) * *(float *)&dword_3E2E2F4);
      v42 = (float)v60 - (float)((float)(v18 + v14) * *(float *)&dword_3E2E2F4);
      if ( (float)OutputWidth >= v46
        && (float)OutputHeight >= v42
        && (float)((float)*(int *)(g_pDestSizeTable + 4 * (v55 - v51)) + v46) >= (float)dword_3E2E2BC
        && (float)((float)*(int *)(g_pDestSizeTable + 4 * (v57 - v53)) + v42) >= 0.0 )
      {
        if ( byte_3E2E324 )
        {
          v16 = (float)(v55 - v51) * *(float *)&dword_3E2E2F4;
          v12 = (float)(v57 - v53) * *(float *)&dword_3E2E2F4;
          _vec_ctor_no(v58, 0x20u, 6u, (void *(__thiscall *)(void *))_D3DTLVERTEX::_D3DTLVERTEX);
          v58[4] = &dword_420320[234316];
          v58[5] = -1;
          v58[6] = 0;
          v58[7] = 0;
          *(float *)&v58[3] = FLOAT_0_5;
          *(float *)v58 = v46;
          *(float *)&v58[1] = v42;
          v58[12] = &dword_420320[234316];
          v58[13] = -1;
          v58[14] = 0;
          v58[15] = 0;
          *(float *)&v58[11] = FLOAT_0_5;
          *(float *)&v58[8] = v46 + v16;
          *(float *)&v58[9] = v42;
          v58[20] = &dword_420320[234316];
          v58[21] = -1;
          v58[22] = 0;
          v58[23] = 0;
          *(float *)&v58[19] = FLOAT_0_5;
          *(float *)&v58[16] = v46;
          *(float *)&v58[17] = v42 + v12;
          v58[28] = &dword_420320[234316];
          v58[29] = -1;
          v58[30] = 0;
          v58[31] = 0;
          *(float *)&v58[27] = FLOAT_0_5;
          *(float *)&v58[24] = v46;
          *(float *)&v58[25] = v42 + v12;
          v58[36] = &dword_420320[234316];
          v58[37] = -1;
          v58[38] = 0;
          v58[39] = 0;
          *(float *)&v58[35] = FLOAT_0_5;
          *(float *)&v58[32] = v46 + v16;
          *(float *)&v58[33] = v42;
          v58[44] = &dword_420320[234316];
          v58[45] = -1;
          v58[46] = 0;
          v58[47] = 0;
          *(float *)&v58[43] = FLOAT_0_5;
          *(float *)&v58[40] = v46 + v16;
          *(float *)&v58[41] = v42 + v12;
          (*(void (__stdcall **)(int, int, int, _DWORD *, int, _DWORD))(*(_DWORD *)D3DObjectPtr->field_38 + 100))(
            D3DObjectPtr->field_38,
            4,
            452,
            v58,
            6,
            0);
        }
        v29 = *(_DWORD *)a4;
        *(_DWORD *)a4 = 0;
        if ( v29 )
        {
          j__memcpy(&g_uColorPalette, *((const void **)a4 + 1), 0x180u);
          j__memcpy(&unk_468A760, (char *)&g_cColorGradient + 64 * *((unsigned __int8 *)a4 + 715), 0x40u);
          j__memcpy(
            &unk_468A7A0,
            (const void *)(*((_DWORD *)a4 + 1) + (*((unsigned __int8 *)a4 + 715) << 6) + 512),
            0x40u);
          if ( (float)OutputWidth >= v46
            && (float)OutputHeight >= v42
            && (float)((float)*(int *)(g_pDestSizeTable + 4 * v32) + v46) >= (float)dword_3E2E2BC
            && (float)((float)*(int *)(g_pDestSizeTable + 4 * v37) + v42) >= 0.0 )
          {
            sub_2F96D80(
              *(unsigned __int16 *)(v29 + 8),
              &g_uColorPalette,
              v29 + 12,
              v32,
              v37,
              LODWORD(v46),
              LODWORD(v42),
              BYTE1(*((_DWORD *)a4 + 23)),
              65793 * a1,
              v17,
              v15,
              v18,
              v11,
              1);
          }
          if ( *((_DWORD *)a4 + 3) )
          {
            v30 = (unsigned __int16 *)*((_DWORD *)a4 + 3);
            *((_DWORD *)a4 + 3) = 0;
            v33 = *v30++;
            v38 = *v30++;
            v5 = *v30;
            v31 = v30 + 1;
            if ( (float)OutputWidth >= v46
              && (float)OutputHeight >= v42
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v33) + v46) >= (float)dword_3E2E2BC
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v38) + v42) >= 0.0 )
            {
              ((void (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char))sub_2F96D80)(
                v31[1],
                *((_DWORD *)a4 + 4),
                v31 + 3,
                v33,
                v38,
                (float)(v13 - v5),
                (float)(v14 - *v31),
                0,
                65793 * a1,
                v17,
                v15,
                v18,
                v11,
                0);
            }
          }
        }
        if ( g_pIconPalette )
        {
          *((_DWORD *)a4 + 23) = 0;
          if ( *((_BYTE *)a4 + 22) )
          {
            v25 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 22)];
            *((_BYTE *)a4 + 22) = 0;
            v34 = *v25++;
            v39 = *v25++;
            v47 = (float)v59 - (float)((float)*v25 * *(float *)&dword_3E2E2F4);
            v26 = v25 + 1;
            v43 = (float)v60 - (float)((float)*v26 * *(float *)&dword_3E2E2F4);
            if ( (float)OutputWidth >= v47
              && (float)OutputHeight >= v43
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v34) + v47) >= (float)dword_3E2E2BC
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v39) + v43) >= 0.0 )
            {
              CacheRenderingStandard(
                (void *)g_pIconPalette,
                v26 + 3,
                v26[2],
                64,
                v34,
                v39,
                v47,
                v43,
                0,
                (char *)&dword_F29144[220078] + 3,
                0,
                0);
            }
          }
          if ( *((_BYTE *)a4 + 21) )
          {
            v23 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 21)];
            *((_BYTE *)a4 + 21) = 0;
            v35 = *v23++;
            v40 = *v23++;
            v48 = (float)v59 - (float)((float)*v23 * *(float *)&dword_3E2E2F4);
            v24 = v23 + 1;
            v44 = (float)v60 - (float)((float)*v24 * *(float *)&dword_3E2E2F4);
            if ( (float)OutputWidth >= v48
              && (float)OutputHeight >= v44
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v35) + v48) >= (float)dword_3E2E2BC
              && (float)((float)*(int *)(g_pDestSizeTable + 4 * v40) + v44) >= 0.0 )
            {
              CacheRenderingStandard(
                (void *)g_pIconPalette,
                v24 + 3,
                v24[2],
                64,
                v35,
                v40,
                v48,
                v44,
                0,
                (char *)&dword_F29144[220078] + 3,
                0,
                0);
            }
          }
          if ( !*((_BYTE *)a4 + 20) )
            return 1;
          v21 = (unsigned __int16 *)g_pIconGfx[*((unsigned __int8 *)a4 + 20)];
          *((_BYTE *)a4 + 20) = 0;
          v36 = *v21++;
          v41 = *v21++;
          v49 = (float)v59 - (float)((float)*v21 * *(float *)&dword_3E2E2F4);
          v22 = v21 + 1;
          v45 = (float)v60 - (float)((float)*v22 * *(float *)&dword_3E2E2F4);
          if ( (float)OutputWidth >= v49
            && (float)OutputHeight >= v45
            && (float)((float)*(int *)(g_pDestSizeTable + 4 * v36) + v49) >= (float)dword_3E2E2BC
            && (float)((float)*(int *)(g_pDestSizeTable + 4 * v41) + v45) >= 0.0 )
          {
            CacheRenderingStandard(
              (void *)g_pIconPalette,
              v22 + 3,
              v22[2],
              64,
              v36,
              v41,
              v49,
              v45,
              0,
              (char *)&dword_F29144[220078] + 3,
              0,
              0);
          }
          return 1;
        }
        else
        {
          return 1;
        }
      }
      else
      {
        return 1;
      }
    }
    else
    {
      BBSupportTracePrintF(0, "GFX ENGINE: The building patches exceeds the allowed max size of 512 x 512!");
      BBSupportTracePrintF(0, "GFX ENGINE: Building won't be rendered!");
      return 0;
    }
  }
  else
  {
    BBSupportTracePrintF(0, "GFX ENGINE: A vehicle is too big! No rendering!");
    return 0;
  }
}


// address=[0x2f96960]
// Decompiled from char __cdecl BlitAccessoryIconHardware(int a1, int a2, int a3, int a4)
bool __cdecl BlitAccessoryIconHardware(int a1, int a2, int a3, int a4) {
  
  int v5; // [esp+18h] [ebp-14h]
  int v6; // [esp+1Ch] [ebp-10h]
  float v7; // [esp+20h] [ebp-Ch]
  float v8; // [esp+24h] [ebp-8h]
  unsigned __int16 *v9; // [esp+28h] [ebp-4h]
  unsigned __int16 *v10; // [esp+28h] [ebp-4h]
  unsigned __int16 *v11; // [esp+28h] [ebp-4h]
  int v12; // [esp+38h] [ebp+Ch]
  int v13; // [esp+3Ch] [ebp+10h]

  if ( !g_pIconPalette )
    return 0;
  v12 = a2 >> 16;
  v13 = a3 >> 16;
  v9 = (unsigned __int16 *)g_pIconGfx[a4];
  if ( !v9 )
    return 1;
  v5 = *v9;
  v10 = v9 + 1;
  v6 = *v10++;
  v7 = (float)v12 - (float)((float)*v10 * *(float *)&dword_3E2E2F4);
  v11 = v10 + 1;
  v8 = (float)v13 - (float)((float)*v11 * *(float *)&dword_3E2E2F4);
  if ( (float)OutputWidth >= v7
    && (float)OutputHeight >= v8
    && (float)((float)*(int *)(g_pDestSizeTable + 4 * v5) + v7) >= (float)dword_3E2E2BC
    && (float)((float)*(int *)(g_pDestSizeTable + 4 * v6) + v8) >= 0.0 )
  {
    CacheRenderingStandard(
      (void *)g_pIconPalette,
      v11 + 3,
      v11[2],
      64,
      v5,
      v6,
      v7,
      v8,
      0,
      (char *)&dword_F29144[220078] + 3,
      0,
      0);
  }
  return 1;
}


// address=[0x2f96ac0]
// Decompiled from int __cdecl RenderGfx(int a1, void *a2, __int64 a3, int a4, __int64 a5, int a6, char a7, char a8, char a9)
void __cdecl RenderGfx(int a1, void * a2, void * a3, int a4, int a5, float a6, float a7, int a8, int a9, unsigned char a10, unsigned char a11) {
  
  int v10; // [esp+20h] [ebp-1Ch] BYREF
  int v11; // [esp+24h] [ebp-18h] BYREF
  int v12; // [esp+28h] [ebp-14h] BYREF
  int v13; // [esp+2Ch] [ebp-10h]
  int v14; // [esp+30h] [ebp-Ch]
  unsigned __int16 *v15; // [esp+34h] [ebp-8h] BYREF
  int IsAlreadyStored; // [esp+38h] [ebp-4h]

  if ( SHIDWORD(a3) > 512 || a4 > 512 )
    return BBSupportTracePrintF(0, "GFX ENGINE: DATA ERROR: Size of object is too big! Object will be ignored!");
  IsAlreadyStored = CUploadCachePageManager::IsAlreadyStored(
                      (CUploadCachePageManager *)D3DObjectPtr->CCachePageManager[0],
                      a1);
  if ( IsAlreadyStored >= 0 )
    return sub_2F976F0(a6, a5, HIDWORD(a5), 0, IsAlreadyStored, a7, a8 | 0x10, a9);
  v13 = HIDWORD(a3);
  v14 = a4;
  if ( *(float *)&dword_3E2E2F4 < 1.0 && (a8 & 0x40) != 0 )
  {
    v13 = (int)(float)((float)SHIDWORD(a3) * *(float *)&dword_3E2E2F4) + 1;
    v14 = (int)(float)((float)a4 * *(float *)&dword_3E2E2F4) + 1;
  }
  if ( !CCachePageManager::GetPictureArea(
          (CCachePageManager *)D3DObjectPtr->CCachePageManager[0],
          *(float *)&a5,
          *((float *)&a5 + 1),
          v13,
          v14,
          a6,
          a7,
          &v10,
          &v11) )
  {
    FlushCacheList();
    CCachePageManager::GetPictureArea(
      (CCachePageManager *)D3DObjectPtr->CCachePageManager[0],
      *(float *)&a5,
      *((float *)&a5 + 1),
      v13,
      v14,
      a6,
      a7,
      &v10,
      &v11);
  }
  CCachePageManager::LockSourceSurface((CCachePageManager *)D3DObjectPtr->CCachePageManager[0], &v12, &v15);
  v15 += v10 + v11 * v12 / 2;
  if ( *(float *)&dword_3E2E2F4 < 1.0 && (a8 & 0x40) != 0 )
    sub_2F97D20(a2, a3, HIDWORD(a3), a4, v15, v12, 0, 0);
  else
    sub_2F977E0(a2, a3, v15, v12, HIDWORD(a3), a4);
  CCachePageManager::UnlockSourceSurface((CCachePageManager *)D3DObjectPtr->CCachePageManager[0]);
  IsAlreadyStored = CCachePageManager::GetLastCacheObjectNr((CCachePageManager *)D3DObjectPtr->CCachePageManager[0]);
  CUploadCachePageManager::StoreGfxId(
    (CUploadCachePageManager *)D3DObjectPtr->CCachePageManager[0],
    IsAlreadyStored,
    a1);
  return sub_2F976F0(a6, a5, HIDWORD(a5), 0, IsAlreadyStored, a7, a8 | 0x10, a9);
}


// address=[0x2f97030]
// Decompiled from char __cdecl CacheRenderingStandard(  __int64 a1,  int a2,  int a3,  __int64 a4,  __int64 a5,  char a6,  int a7,  int a8,  char a9)
bool __cdecl CacheRenderingStandard(void * a1, void * a2, int a3, int a4, int a5, int a6, float a7, float a8, unsigned int a9, int a10, int a11, unsigned char a12) {
  
  char SurfaceIdx; // al
  char LastCacheObjectNr; // al
  int UsedCacheTextures; // eax
  int v13; // eax
  char v14; // al
  int CacheRetrys; // eax
  char EntryIdx; // [esp+10h] [ebp-30h]
  char v17; // [esp+10h] [ebp-30h]
  int v18; // [esp+20h] [ebp-20h] BYREF
  int v19; // [esp+24h] [ebp-1Ch] BYREF
  int v20; // [esp+28h] [ebp-18h] BYREF
  int v21; // [esp+2Ch] [ebp-14h]
  unsigned __int16 *v22; // [esp+30h] [ebp-10h] BYREF
  int v23; // [esp+34h] [ebp-Ch]
  int i; // [esp+38h] [ebp-8h]
  char v25; // [esp+3Fh] [ebp-1h]

  v25 = 0;
  if ( (int)a4 <= 512 && SHIDWORD(a4) <= 512 )
  {
    v23 = a3;
    if ( a3 == 16 || v23 == 32 || v23 == 64 )
    {
      if ( CCacheManager::IsGfxCached((CCacheManager *)&g_cCacheManager, a2) )
      {
        EntryIdx = CCacheManager::GetEntryIdx((CCacheManager *)&g_cCacheManager, a2);
        SurfaceIdx = CCacheManager::GetSurfaceIdx((CCacheManager *)&g_cCacheManager, a2);
        sub_2F976F0(a7, a5, HIDWORD(a5), SurfaceIdx, EntryIdx, a8, a9, a6);
        v25 = 1;
      }
      else if ( CInterfaceD3D::GetCacheRetrys(D3DObjectPtr) > 0 )
      {
        for ( i = 1; i < D3DObjectPtr->field_448 && D3DObjectPtr->field_44C[i]; ++i )
        {
          if ( CCachePageManager::GetPictureArea(
                 (CCachePageManager *)D3DObjectPtr->field_44C[i],
                 0.0,
                 0.0,
                 a4,
                 SHIDWORD(a4),
                 a7,
                 a8,
                 &v18,
                 &v19) )
          {
            CCachePageManager::LockVideoSurface((CCachePageManager *)D3DObjectPtr->field_44C[i], &v20, &v22);
            v22 += v18 + v19 * v20 / 2;
            sub_2F977E0(a1, HIDWORD(a1), v22, v20, a4, HIDWORD(a4));
            CCachePageManager::UnlockVideoSurface((CCachePageManager *)D3DObjectPtr->field_44C[i]);
            LastCacheObjectNr = CCachePageManager::GetLastCacheObjectNr((CCachePageManager *)D3DObjectPtr->field_44C[i]);
            CCacheManager::SetCacheInfos((CCacheManager *)&g_cCacheManager, a2, i, LastCacheObjectNr);
            UsedCacheTextures = CCacheManager::GetUsedCacheTextures((CCacheManager *)&g_cCacheManager);
            if ( i > UsedCacheTextures )
            {
              CCacheManager::SetUsedCacheTextures((CCacheManager *)&g_cCacheManager, i);
              v13 = CCacheManager::GetUsedCacheTextures((CCacheManager *)&g_cCacheManager);
              BBSupportTracePrintF(0, "GFX ENGINE: Used cache textures: %d", v13);
            }
            v17 = CCacheManager::GetEntryIdx((CCacheManager *)&g_cCacheManager, a2);
            v14 = CCacheManager::GetSurfaceIdx((CCacheManager *)&g_cCacheManager, a2);
            sub_2F976F0(a7, a5, HIDWORD(a5), v14, v17, a8, a9, a6);
            v25 = 1;
            break;
          }
        }
        if ( !v25 )
        {
          CacheRetrys = CInterfaceD3D::GetCacheRetrys(D3DObjectPtr);
          BBSupportTracePrintF(0, "GFX ENGINE: Remaining cache retry: %d", CacheRetrys);
          CInterfaceD3D::DecreaseCacheRetrys(D3DObjectPtr);
        }
      }
      if ( !v25 )
        RenderGfx(
          a2,
          (void *)a1,
          (void *)HIDWORD(a1),
          a4,
          HIDWORD(a4),
          *(float *)&a5,
          *((float *)&a5 + 1),
          a7,
          a8,
          0,
          a6);
      return 1;
    }
    else
    {
      if ( *(float *)&dword_3E2E2F4 >= 1.0 )
        v21 = 0;
      else
        v21 = 64;
      RenderGfx(
        a2,
        (void *)a1,
        (void *)HIDWORD(a1),
        a4,
        HIDWORD(a4),
        *(float *)&a5,
        *((float *)&a5 + 1),
        a7,
        0,
        v21,
        a6);
      return 1;
    }
  }
  else
  {
    BBSupportTracePrintF(
      0,
      "GFX ENGINE: The following object exceed the size limits: Object of type: %d Object ID: %d Width: %d Height: %d",
      a3,
      a2,
      (_DWORD)a4,
      HIDWORD(a4));
    BBSupportTracePrintF(0, "GFX ENGINE: This object will be ignored!");
    return 0;
  }
}


// address=[0x2f973b0]
// Decompiled from CCachePageManager *FlushCacheList()
void __cdecl FlushCacheList(void) {
  
  CCachePageManager *result; // eax
  int v1; // [esp+58h] [ebp-14h] BYREF
  int v2; // [esp+5Ch] [ebp-10h]
  int v3; // [esp+60h] [ebp-Ch]
  int i; // [esp+64h] [ebp-8h]
  bool v5; // [esp+69h] [ebp-3h]
  char v6; // [esp+6Ah] [ebp-2h]
  bool IsFiltering; // [esp+6Bh] [ebp-1h]

  CCachePageManager::UploadData((CCachePageManager *)D3DObjectPtr->CCachePageManager[0], &v1);
  CCachePageManager::UploadData((CCachePageManager *)D3DObjectPtr->CCachePageManager[1], &v1);
  v6 = 0;
  IsFiltering = SGfxRenderConfiguration::IsFiltering((SGfxRenderConfiguration *)&GfxEngineSetup);
  if ( IsFiltering )
    v3 = 2;
  else
    v3 = 1;
  (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)D3DObjectPtr->field_38 + 148))(
    D3DObjectPtr->field_38,
    0,
    16,
    v3);
  if ( IsFiltering )
    v2 = 2;
  else
    v2 = 1;
  (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)D3DObjectPtr->field_38 + 148))(
    D3DObjectPtr->field_38,
    0,
    17,
    v2);
  for ( i = 0; i < dword_47132D4; ++i )
  {
    if ( v6 != (byte_47132E7[16 * i] & 8) )
    {
      if ( (byte_47132E7[16 * i] & 8) != 0 )
      {
        (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)D3DObjectPtr->field_38 + 148))(
          D3DObjectPtr->field_38,
          0,
          16,
          1);
        (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)D3DObjectPtr->field_38 + 148))(
          D3DObjectPtr->field_38,
          0,
          17,
          1);
        v6 = 1;
      }
      else if ( IsFiltering )
      {
        (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)D3DObjectPtr->field_38 + 148))(
          D3DObjectPtr->field_38,
          0,
          16,
          2);
        (*(void (__stdcall **)(int, _DWORD, int, int))(*(_DWORD *)D3DObjectPtr->field_38 + 148))(
          D3DObjectPtr->field_38,
          0,
          17,
          2);
        v6 = 0;
      }
    }
    if ( (byte_47132E7[16 * i] & 0x10) != 0 )
    {
      v5 = *(float *)&dword_3E2E2F4 < 1.0 && (byte_47132E7[16 * i] & 0x40) != 0;
      CCachePageManager::RenderCacheObject(
        (CCachePageManager *)D3DObjectPtr->CCachePageManager[(unsigned __int8)byte_47132E4[16 * i]],
        (unsigned __int8)byte_47132E5[16 * i],
        *(float *)&dword_47132DC[4 * i],
        *(float *)&dword_47132E0[4 * i],
        dword_47132D8[4 * i],
        byte_47132E7[16 * i],
        (unsigned __int8)byte_47132E6[16 * i],
        v5);
    }
    else
    {
      CCachePageManager::RenderCacheObject(
        (CCachePageManager *)D3DObjectPtr->field_44C[(unsigned __int8)byte_47132E4[16 * i]],
        (unsigned __int8)byte_47132E5[16 * i],
        *(float *)&dword_47132DC[4 * i],
        *(float *)&dword_47132E0[4 * i],
        dword_47132D8[4 * i],
        byte_47132E7[16 * i],
        0,
        0);
    }
  }
  CCachePageManager::ReleaseData((CCachePageManager *)D3DObjectPtr->CCachePageManager[0]);
  result = CCachePageManager::ReleaseData((CCachePageManager *)D3DObjectPtr->CCachePageManager[1]);
  byte_46F32C9 = 0;
  dword_47132D4 = 0;
  return result;
}


// address=[0x2f99880]
// Decompiled from char __cdecl GuiEngine2_EventProc(struct SEventStruct *a1)
bool __cdecl GuiEngine2_EventProc(struct SEventStruct & a1) {
  
  char result; // al
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v6; // eax
  size_t v7; // esi
  int v8; // eax
  size_t v9; // esi
  size_t v10; // esi
  int v11; // eax
  int v12; // eax
  int SurfaceID; // eax
  int v14; // eax
  char v15; // bl
  char v16; // bl
  char v17; // bl
  int v18; // eax
  char v19; // bl
  int v20; // eax
  int v21; // eax
  int v22; // esi
  int v23; // eax
  int v24; // eax
  int v25; // eax
  char v26; // bl
  char v27; // bl
  char v28; // bl
  char v29; // bl
  char v30; // bl
  int v31; // eax
  int v32; // eax
  int v33; // eax
  int v34; // eax
  int v35; // [esp-8h] [ebp-108h]
  int v36; // [esp-8h] [ebp-108h]
  int v37; // [esp-8h] [ebp-108h]
  int v38; // [esp-8h] [ebp-108h]
  int v39; // [esp-8h] [ebp-108h]
  int v40; // [esp-8h] [ebp-108h]
  int v41; // [esp-8h] [ebp-108h]
  int v42; // [esp-8h] [ebp-108h]
  int v43; // [esp-8h] [ebp-108h]
  int v44; // [esp-8h] [ebp-108h]
  int v45; // [esp-8h] [ebp-108h]
  int v46; // [esp-8h] [ebp-108h]
  int v47; // [esp-8h] [ebp-108h]
  int v48; // [esp-8h] [ebp-108h]
  int v49; // [esp-8h] [ebp-108h]
  int v50; // [esp-8h] [ebp-108h]
  int v51; // [esp-8h] [ebp-108h]
  int v52; // [esp-4h] [ebp-104h]
  int v53; // [esp-4h] [ebp-104h]
  int v54; // [esp-4h] [ebp-104h]
  int v55; // [esp-4h] [ebp-104h]
  int v56; // [esp-4h] [ebp-104h]
  int v57; // [esp-4h] [ebp-104h]
  int v58; // [esp-4h] [ebp-104h]
  int v59; // [esp-4h] [ebp-104h]
  int v60; // [esp-4h] [ebp-104h]
  int v61; // [esp-4h] [ebp-104h]
  int v62; // [esp-4h] [ebp-104h]
  int v63; // [esp-4h] [ebp-104h]
  __int64 v64; // [esp+28h] [ebp-D8h]
  __int64 v65; // [esp+48h] [ebp-B8h]
  __int64 v66; // [esp+68h] [ebp-98h]
  __int64 v67; // [esp+70h] [ebp-90h]
  __int64 v68; // [esp+78h] [ebp-88h]
  __int64 v69; // [esp+80h] [ebp-80h]
  int v70; // [esp+8Ch] [ebp-74h] BYREF
  int v71; // [esp+90h] [ebp-70h] BYREF
  int v72; // [esp+94h] [ebp-6Ch]
  int v73; // [esp+98h] [ebp-68h]
  int v74; // [esp+9Ch] [ebp-64h]
  int v75; // [esp+A0h] [ebp-60h]
  size_t v76; // [esp+A4h] [ebp-5Ch]
  __int64 v77; // [esp+A8h] [ebp-58h]
  int v78; // [esp+B0h] [ebp-50h]
  int v79; // [esp+B4h] [ebp-4Ch]
  int v80; // [esp+B8h] [ebp-48h]
  int v81; // [esp+BCh] [ebp-44h]
  int v82; // [esp+C0h] [ebp-40h]
  int v83; // [esp+C4h] [ebp-3Ch]
  struct GUI_MENU_DIALOG_HEADER *v84; // [esp+C8h] [ebp-38h] BYREF
  int v85; // [esp+CCh] [ebp-34h]
  int v86; // [esp+D0h] [ebp-30h]
  unsigned __int16 *v87; // [esp+D4h] [ebp-2Ch]
  unsigned __int16 *v88; // [esp+D8h] [ebp-28h]
  WORD *p_width; // [esp+DCh] [ebp-24h]
  int v90; // [esp+E0h] [ebp-20h]
  int v91; // [esp+E4h] [ebp-1Ch]
  int showTexture; // [esp+E8h] [ebp-18h]
  int v93; // [esp+ECh] [ebp-14h]
  int v94; // [esp+F0h] [ebp-10h]
  bool v95; // [esp+F5h] [ebp-Bh]
  bool ControlUnderCursor; // [esp+F6h] [ebp-Ah]
  bool v97; // [esp+F7h] [ebp-9h]
  struct SGuiControl *v98; // [esp+F8h] [ebp-8h] BYREF
  char v99; // [esp+FEh] [ebp-2h]
  char v100; // [esp+FFh] [ebp-1h]

  if ( !g_pGUIEngine || !g_pFileHeader || !g_pGfxEngine )
    return 0;
  if ( IGfxEngine::IsGfxEngineRebuilded((IGfxEngine *)g_pGfxEngine) )
  {
    BBSupportTracePrintF(0, "GUI ENGINE: Refreshing surfaces!");
    IGuiEngine::RefreshAllSurfaces(g_pGUIEngine);
  }
  if ( g_bDisableEvents && *(_DWORD *)a1 != 21 )
    return 0;
  v100 = 0;
  v99 = 0;
  v91 = *(_DWORD *)a1 - 5;
  switch ( v91 )
  {
    case 0:
      goto GuiEngine2_EventProc___def_339AC41;
    case 2:
      v77 = sub_2F9E860(*((_DWORD *)a1 + 2));
      if ( !IsNonTransparentGuiArea(v77, HIDWORD(v77)) )
        goto GuiEngine2_EventProc___def_3399920;
      v99 = 1;
      currentTickCount = GetTickCount();
      if ( CToolTip::IsOpen((CToolTip *)&g_cToolTip) )
      {
        CToolTip::CloseTooltip((CToolTip *)&g_cToolTip);
        CToolTip::Lock((CToolTip *)&g_cToolTip);
      }
      ControlUnderCursor = FindControlUnderCursor(v77, HIDWORD(v77), &v98, &v70, &v71);
      if ( !ControlUnderCursor || v98->controlType != 16 )
        goto LABEL_95;
      v98 = (struct SGuiControl *)((char *)v98 + 36);
      if ( v98->controlType == 7 || v98->controlType == 8 )
      {
        v94 = v77;
        v81 = sub_2F9E930(v98->unknownId);
        p_width = &v98[-1].width;
        if ( LOBYTE(v98[-1].unknown4) == 16 )
        {
          v82 = *p_width + *(unsigned __int16 *)(v81 + 2);
          v83 = p_width[2] + *p_width + *(unsigned __int16 *)(v81 + 2) - v98->width;
          if ( v94 < v82 )
            v94 = v82;
          if ( v94 > v83 )
            v94 = v83;
          if ( v98->x != v94 )
          {
            showTexture = CalcPercentageValue(v82, v83, v94, 0);
            v98->x = v94 - *(_WORD *)(v81 + 2);
            v98->showTexture = showTexture;
            if ( v98->controlType == 8 )
            {
              RestoreMultisliderSettings(v98);
              ChangeMultisliders(v98, HIBYTE(v98->unknownData[0]) - showTexture);
              EnsureMultisliders(v98);
              showTexture = (char)v98->showTexture;
            }
            HIBYTE(v98[-1].unknownData[3]) = 1;
            HIBYTE(v98->unknownData[1]) = 1;
            v100 = 1;
            v54 = showTexture;
            v42 = (v98->effects << 16) + v98->valueLink;
            SurfaceID = GetSurfaceID(v98);
            ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[SurfaceID])(2, v42, v54);
            v55 = showTexture;
            v43 = (v98->effects << 16) + v98->valueLink;
            v14 = GetSurfaceID(v98);
            ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v14])(3, v43, v55);
          }
LABEL_95:
          if ( g_pCurrentSelectedControl )
          {
            v75 = *(unsigned __int8 *)(g_pCurrentSelectedControl + 24);
            switch ( v75 )
            {
              case 0:
              case 13:
              case 19:
                if ( (*(_BYTE *)(g_pCurrentSelectedControl + 27) & 1) == 0 )
                {
                  v15 = v100;
                  v100 = SetControlState((struct SGuiControl *)g_pCurrentSelectedControl, 1, 1) | v15;
                  g_pCurrentDragControl = g_pCurrentSelectedControl;
                }
                break;
              case 1:
                v17 = v100;
                if ( (*(_BYTE *)(g_pCurrentSelectedControl + 27) & 1) != 0 )
                  v100 = SetControlState((struct SGuiControl *)g_pCurrentSelectedControl, 1, 0) | v17;
                else
                  v100 = SetControlState((struct SGuiControl *)g_pCurrentSelectedControl, 1, 1) | v17;
                v56 = AddKeyStates(*((_DWORD *)a1 + 1));
                v44 = (*(unsigned __int8 *)(g_pCurrentSelectedControl + 27) << 16)
                    + *(unsigned __int16 *)(g_pCurrentSelectedControl + 10);
                v18 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
                ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v18])(3, v44, v56);
                break;
              case 2:
              case 3:
                v16 = v100;
                v100 = SelectRadioGroup((struct SGuiControl *)g_pCurrentSelectedControl) | v16;
                break;
              case 7:
              case 8:
                if ( g_pCurrentSelectedControl != g_pCurrentDragControl )
                {
                  if ( *(_BYTE *)(g_pCurrentSelectedControl + 24) == 8 )
                  {
                    StoreMultisliderSettings((struct SGuiControl *)g_pCurrentSelectedControl);
                    SetControlState((struct SGuiControl *)g_pCurrentSelectedControl, 1, 0);
                    *(_BYTE *)(g_pCurrentSelectedControl + 35) = 1;
                    *(_BYTE *)(g_pCurrentSelectedControl - 1) = 1;
                    v100 = 1;
                  }
                  g_pCurrentDragControl = g_pCurrentSelectedControl;
                }
                break;
              case 17:
              case 18:
                if ( (*(_BYTE *)(g_pCurrentSelectedControl + 27) & 1) == 0 )
                {
                  v19 = v100;
                  v100 = SetControlState((struct SGuiControl *)g_pCurrentSelectedControl, 1, 1) | v19;
                }
                g_pCurrentRepeatControl = g_pCurrentSelectedControl;
                dword_4726EBC = GetTickCount() + 300;
                v57 = AddKeyStates(*((_DWORD *)a1 + 1));
                v45 = (*(unsigned __int8 *)(g_pCurrentSelectedControl + 27) << 16)
                    + *(unsigned __int16 *)(g_pCurrentSelectedControl + 10);
                v20 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
                ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v20])(3, v45, v57);
                break;
              default:
                goto GuiEngine2_EventProc___def_3399920;
            }
          }
        }
        else
        {
          BBSupportTracePrintF(0, "GUI ENGINE: Illegal data. Can't find slider area.");
        }
      }
      goto GuiEngine2_EventProc___def_3399920;
    case 3:
      if ( g_pCurrentRepeatControl )
      {
        v100 |= SetControlState((struct SGuiControl *)g_pCurrentRepeatControl, 1, 0);
        g_pCurrentRepeatControl = 0;
      }
      v67 = sub_2F9E860(*((_DWORD *)a1 + 2));
      if ( !IsNonTransparentGuiArea(v67, HIDWORD(v67)) && !g_pCurrentDragControl )
        goto GuiEngine2_EventProc___def_3399920;
      v99 = 1;
      currentTickCount = GetTickCount();
      if ( !g_pCurrentDragControl
        || *(_BYTE *)(g_pCurrentDragControl + 24) != 7 && *(_BYTE *)(g_pCurrentDragControl + 24) != 8 )
      {
        goto LABEL_146;
      }
      v73 = sub_2F9E930(*(unsigned __int8 *)(g_pCurrentDragControl + 31));
      v88 = (unsigned __int16 *)(g_pCurrentDragControl - 36);
      if ( *(_BYTE *)(g_pCurrentDragControl - 36 + 24) != 16 )
      {
        BBSupportTracePrintF(0, "GUI ENGINE: Illegal data. Can't find slider area.");
        goto GuiEngine2_EventProc___def_3399920;
      }
      v22 = CalcPercentageValue(
              *v88 + *(unsigned __int16 *)(v73 + 2),
              v88[2] + *v88 + *(unsigned __int16 *)(v73 + 2) - *(unsigned __int16 *)(g_pCurrentDragControl + 4),
              *(unsigned __int16 *)g_pCurrentDragControl,
              0);
      v59 = AddKeyStates(*((_DWORD *)a1 + 1)) + v22;
      v47 = (*(unsigned __int8 *)(g_pCurrentDragControl + 27) << 16) + *(unsigned __int16 *)(g_pCurrentDragControl + 10);
      v23 = GetSurfaceID((struct SGuiControl *)g_pCurrentDragControl);
      ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v23])(3, v47, v59);
LABEL_146:
      g_pCurrentDragControl = 0;
      if ( g_pCurrentEditControl && g_pCurrentEditControl != g_pCurrentSelectedControl )
      {
        v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 64, 0);
        g_pCurrentEditControl = 0;
      }
      if ( g_pCurrentSelectedControl )
      {
        v72 = *(unsigned __int8 *)(g_pCurrentSelectedControl + 24);
        switch ( v72 )
        {
          case 0:
          case 13:
          case 19:
            if ( (*(_BYTE *)(g_pCurrentSelectedControl + 27) & 1) != 0 )
            {
              v100 |= SetControlState((struct SGuiControl *)g_pCurrentSelectedControl, 1, 0);
              v60 = AddKeyStates(*((_DWORD *)a1 + 1));
              v48 = (*(unsigned __int8 *)(g_pCurrentSelectedControl + 27) << 16)
                  + *(unsigned __int16 *)(g_pCurrentSelectedControl + 10);
              v24 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
              ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v24])(3, v48, v60);
            }
            break;
          case 5:
          case 20:
            g_pCurrentEditControl = g_pCurrentSelectedControl;
            v100 |= SelectEditControl((struct SGuiControl *)g_pCurrentSelectedControl, v67);
            break;
          default:
            break;
        }
      }
GuiEngine2_EventProc___def_339AC41:
      v66 = sub_2F9E860(*((_DWORD *)a1 + 2));
      qword_471F794 = sub_2F9E830(*((_DWORD *)a1 + 2));
      currentTickCount = GetTickCount();
      v97 = FindControlUnderCursor(v66, HIDWORD(v66), &v98, &v70, &v71);
      if ( g_pCurrentDragControl
        && (*(_BYTE *)(g_pCurrentDragControl + 24) == 7 || *(_BYTE *)(g_pCurrentDragControl + 24) == 8) )
      {
        v93 = v66;
        v78 = sub_2F9E930(*(unsigned __int8 *)(g_pCurrentDragControl + 31));
        v87 = (unsigned __int16 *)(g_pCurrentDragControl - 36);
        if ( *(_BYTE *)(g_pCurrentDragControl - 36 + 24) != 16 )
        {
          BBSupportTracePrintF(0, "GUI ENGINE: Illegal data. Can't find slider area.");
          goto GuiEngine2_EventProc___def_3399920;
        }
        v79 = *v87 + *(unsigned __int16 *)(v78 + 2);
        v80 = v87[2] + *v87 + *(unsigned __int16 *)(v78 + 2) - *(unsigned __int16 *)(g_pCurrentDragControl + 4);
        if ( v93 < v79 )
          v93 = v79;
        if ( v93 > v80 )
          v93 = v80;
        if ( *(unsigned __int16 *)g_pCurrentDragControl != v93 )
        {
          v86 = CalcPercentageValue(v79, v80, v93, 0);
          *(_WORD *)g_pCurrentDragControl = v93 - *(_WORD *)(v78 + 2);
          *(_BYTE *)(g_pCurrentDragControl + 30) = v86;
          if ( *(_BYTE *)(g_pCurrentDragControl + 24) == 8 )
          {
            RestoreMultisliderSettings((struct SGuiControl *)g_pCurrentDragControl);
            ChangeMultisliders(
              (struct SGuiControl *)g_pCurrentDragControl,
              *(unsigned __int8 *)(g_pCurrentDragControl + 33) - v86);
            EnsureMultisliders((struct SGuiControl *)g_pCurrentDragControl);
            v86 = *(char *)(g_pCurrentDragControl + 30);
          }
          *(_BYTE *)(g_pCurrentDragControl - 1) = 1;
          *(_BYTE *)(g_pCurrentDragControl + 35) = 1;
          v100 = 1;
          v61 = v86;
          v49 = (*(unsigned __int8 *)(g_pCurrentDragControl + 27) << 16)
              + *(unsigned __int16 *)(g_pCurrentDragControl + 10);
          v25 = GetSurfaceID((struct SGuiControl *)g_pCurrentDragControl);
          ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v25])(2, v49, v61);
        }
      }
      else
      {
        if ( g_pCurrentDragControl
          && ((struct SGuiControl *)g_pCurrentDragControl != v98 || !v97)
          && (*(_BYTE *)(g_pCurrentDragControl + 27) & 1) != 0 )
        {
          v26 = v100;
          v100 = SetControlState((struct SGuiControl *)g_pCurrentDragControl, 1, 0) | v26;
        }
        if ( (struct SGuiControl *)g_pCurrentDragControl == v98
          && v97
          && (*(_BYTE *)(g_pCurrentDragControl + 27) & 1) == 0 )
        {
          v27 = v100;
          v100 = SetControlState((struct SGuiControl *)g_pCurrentDragControl, 1, 1) | v27;
        }
      }
      if ( g_pCurrentSelectedControl && ((struct SGuiControl *)g_pCurrentSelectedControl != v98 || !v97) )
      {
        v28 = v100;
        v100 = SetControlState((struct SGuiControl *)g_pCurrentSelectedControl, 2, 0) | v28;
        g_pCurrentSelectedControl = 0;
        if ( g_pCurrentRepeatControl )
        {
          v29 = v100;
          v100 = SetControlState((struct SGuiControl *)g_pCurrentRepeatControl, 1, 0) | v29;
          g_pCurrentRepeatControl = 0;
        }
        if ( CToolTip::IsOpen((CToolTip *)&g_cToolTipExt) )
        {
          CToolTipExt::ResetActiveText((CToolTipExt *)&g_cToolTipExt);
          CToolTip::SetSourceDialogSurfaceID((CToolTip *)&g_cToolTipExt, -1);
          CToolTipExt::UpdateText((CToolTipExt *)&g_cToolTipExt);
          dword_3E2F12C = GetTickCount() + 700;
        }
        if ( CToolTip::IsOpen((CToolTip *)&g_cToolTip) )
          dword_3E2F128 = GetTickCount();
        CToolTip::CloseTooltip((CToolTip *)&g_cToolTip);
        CToolTip::Unlock((CToolTip *)&g_cToolTip);
      }
      if ( v97 && v98 != (struct SGuiControl *)g_pCurrentSelectedControl )
      {
        if ( !g_pCurrentDragControl || v98 == (struct SGuiControl *)g_pCurrentDragControl )
        {
          v30 = v100;
          v100 = SetControlState(v98, 2, 1) | v30;
          g_pCurrentSelectedControl = (int)v98;
        }
        if ( g_pCurrentSelectedControl )
        {
          if ( CToolTip::IsOpen((CToolTip *)&g_cToolTipExt) )
          {
            v62 = *(__int16 *)(g_pCurrentSelectedControl + 22);
            v50 = (*(unsigned __int8 *)(g_pCurrentSelectedControl + 27) << 16)
                + *(unsigned __int16 *)(g_pCurrentSelectedControl + 10);
            v31 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
            ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v31])(9, v50, v62);
            if ( CToolTip::GetCurrentLengthOfTooltip((CToolTip *)&g_cToolTipExt) )
            {
              v32 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
              CToolTip::SetSourceDialogSurfaceID((CToolTip *)&g_cToolTipExt, v32);
              CToolTipExt::UpdateText((CToolTipExt *)&g_cToolTipExt);
              dword_3E2F12C = -1;
            }
            else
            {
              CToolTip::SetSourceDialogSurfaceID((CToolTip *)&g_cToolTipExt, -1);
              CToolTipExt::ResetActiveText((CToolTipExt *)&g_cToolTipExt);
              dword_3E2F12C = GetTickCount() + 700;
            }
          }
          else
          {
            v63 = *(__int16 *)(g_pCurrentSelectedControl + 22);
            v51 = (*(unsigned __int8 *)(g_pCurrentSelectedControl + 27) << 16)
                + *(unsigned __int16 *)(g_pCurrentSelectedControl + 10);
            v33 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
            ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v33])(9, v51, v63);
            v34 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
            CToolTip::SetSourceDialogSurfaceID((CToolTip *)&g_cToolTipExt, v34);
            CToolTipExt::OpenTooltip((CToolTipExt *)&g_cToolTipExt);
            dword_3E2F12C = -1;
          }
        }
      }
GuiEngine2_EventProc___def_3399920:
      if ( v100 )
      {
        g_bGuiIsDirty = 1;
        UpdateGui(-1);
      }
      result = v99;
      break;
    case 4:
      v68 = sub_2F9E860(*((_DWORD *)a1 + 2));
      if ( !IsNonTransparentGuiArea(v68, HIDWORD(v68)) )
        goto GuiEngine2_EventProc___def_3399920;
      v95 = FindControlUnderCursor(v68, HIDWORD(v68), &v98, &v70, &v71);
      if ( (struct SGuiControl *)g_pCurrentSelectedControl != v98 || (struct SGuiControl *)g_pCurrentDragControl == v98 )
        goto LABEL_127;
      if ( !v95
        || v98->controlType != 16
        || (v98 = (struct SGuiControl *)((char *)v98 + 36), v98->controlType == 7)
        || v98->controlType == 8 )
      {
        if ( v98 && v98->controlType == 8 )
        {
          if ( (v98->effects & 1) != 0 )
          {
            SetControlState(v98, 1, 0);
            HIBYTE(v98[-1].unknownData[3]) = 1;
            v100 = 1;
          }
          else if ( CanLockMultislider(v98) )
          {
            SetControlState(v98, 1, 1);
            HIBYTE(v98[-1].unknownData[3]) = 1;
            v100 = 1;
          }
        }
LABEL_127:
        v99 = 1;
        currentTickCount = GetTickCount();
        if ( CToolTip::IsOpen((CToolTip *)&g_cToolTip) )
        {
          CToolTip::CloseTooltip((CToolTip *)&g_cToolTip);
          CToolTip::Lock((CToolTip *)&g_cToolTip);
        }
      }
      goto GuiEngine2_EventProc___def_3399920;
    case 5:
      v64 = sub_2F9E860(*((_DWORD *)a1 + 2));
      if ( IsNonTransparentGuiArea(v64, HIDWORD(v64)) || g_pCurrentDragControl )
      {
        v99 = 1;
        currentTickCount = GetTickCount();
        if ( g_pCurrentSelectedControl )
        {
          v74 = *(unsigned __int8 *)(g_pCurrentSelectedControl + 24);
          switch ( v74 )
          {
            case 0:
            case 1:
            case 2:
            case 3:
            case 5:
            case 6:
            case 7:
            case 8:
            case 10:
            case 13:
            case 19:
            case 20:
              v58 = AddKeyStates(*((_DWORD *)a1 + 1));
              v46 = (*(unsigned __int8 *)(g_pCurrentSelectedControl + 27) << 16)
                  + *(unsigned __int16 *)(g_pCurrentSelectedControl + 10);
              v21 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
              ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v21])(7, v46, v58);
              break;
            default:
              goto GuiEngine2_EventProc___def_3399920;
          }
        }
      }
      goto GuiEngine2_EventProc___def_3399920;
    case 6:
      if ( g_pCurrentEditControl )
      {
        v99 = 1;
        v90 = *((_DWORD *)a1 + 1) - 35;
        switch ( v90 )
        {
          case 0:
            v99 = 1;
            if ( *(char *)(g_pCurrentEditControl + 25) >= 0 )
            {
              v9 = *(unsigned __int8 *)(g_pCurrentEditControl + 33);
              if ( v9 < j___mbstrlen((const char *)&g_mbstrTextTable[75 * *(char *)(g_pCurrentEditControl + 25)]) )
              {
                dword_3E2F124 = 3;
                v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 1);
                v76 = j___mbstrlen((const char *)&g_mbstrTextTable[75 * *(char *)(g_pCurrentEditControl + 25)]);
                *(_BYTE *)(g_pCurrentEditControl + 33) = v76;
                *(_BYTE *)(g_pCurrentEditControl + 33) = v76;
                v100 = 1;
                *(_BYTE *)(g_pCurrentEditControl + 35) = 1;
                DoScrolling((struct SGuiControl *)g_pCurrentEditControl, 2);
              }
            }
            break;
          case 1:
            v99 = 1;
            if ( *(_BYTE *)(g_pCurrentEditControl + 33) )
            {
              dword_3E2F124 = 3;
              SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 1);
              *(_BYTE *)(g_pCurrentEditControl + 34) = 0;
              *(_BYTE *)(g_pCurrentEditControl + 33) = 0;
              v100 = 1;
              *(_BYTE *)(g_pCurrentEditControl + 35) = 1;
            }
            break;
          case 2:
            v99 = 1;
            if ( *(_BYTE *)(g_pCurrentEditControl + 33) )
            {
              dword_3E2F124 = 3;
              v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 1);
              --*(_BYTE *)(g_pCurrentEditControl + 33);
              v100 = 1;
              *(_BYTE *)(g_pCurrentEditControl + 35) = 1;
              DoScrolling((struct SGuiControl *)g_pCurrentEditControl, 0);
            }
            break;
          case 4:
            v99 = 1;
            if ( *(char *)(g_pCurrentEditControl + 25) >= 0 )
            {
              v10 = *(unsigned __int8 *)(g_pCurrentEditControl + 33);
              if ( v10 < j___mbstrlen((const char *)&g_mbstrTextTable[75 * *(char *)(g_pCurrentEditControl + 25)]) )
              {
                dword_3E2F124 = 3;
                v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 1);
                ++*(_BYTE *)(g_pCurrentEditControl + 33);
                v100 = 1;
                *(_BYTE *)(g_pCurrentEditControl + 35) = 1;
                DoScrolling((struct SGuiControl *)g_pCurrentEditControl, 1);
              }
            }
            break;
          case 11:
            v99 = 1;
            v7 = *(unsigned __int8 *)(g_pCurrentEditControl + 33);
            if ( v7 < j___mbstrlen((const char *)&g_mbstrTextTable[75 * *(char *)(g_pCurrentEditControl + 25)])
              && (unsigned __int8)DeleteCharacter(
                                    (char *)&g_mbstrTextTable[75 * *(char *)(g_pCurrentEditControl + 25)],
                                    *(unsigned __int8 *)(g_pCurrentEditControl + 33)) )
            {
              dword_3E2F124 = 3;
              SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 1);
              CalcCharWidths((struct SGuiControl *)g_pCurrentEditControl);
              v100 = 1;
              *(_BYTE *)(g_pCurrentEditControl + 35) = 1;
              v39 = (*(unsigned __int8 *)(g_pCurrentEditControl + 27) << 16)
                  + *(unsigned __int16 *)(g_pCurrentEditControl + 10);
              v8 = GetSurfaceID((struct SGuiControl *)g_pCurrentEditControl);
              ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[v8])(2, v39, 0);
            }
            break;
          default:
            goto GuiEngine2_EventProc___def_3399920;
        }
      }
      goto GuiEngine2_EventProc___def_3399920;
    case 8:
      if ( g_pCurrentEditControl )
      {
        v99 = 1;
        v85 = *((_DWORD *)a1 + 1);
        switch ( v85 )
        {
          case 8:
            v99 = 1;
            if ( *(_BYTE *)(g_pCurrentEditControl + 33)
              && (unsigned __int8)DeleteCharacter(
                                    (char *)&g_mbstrTextTable[75 * *(char *)(g_pCurrentEditControl + 25)],
                                    *(unsigned __int8 *)(g_pCurrentEditControl + 33) - 1) )
            {
              dword_3E2F124 = 3;
              v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 1);
              --*(_BYTE *)(g_pCurrentEditControl + 33);
              CalcCharWidths((struct SGuiControl *)g_pCurrentEditControl);
              v100 = 1;
              *(_BYTE *)(g_pCurrentEditControl + 35) = 1;
              DoScrolling((struct SGuiControl *)g_pCurrentEditControl, 0);
              v35 = (*(unsigned __int8 *)(g_pCurrentEditControl + 27) << 16)
                  + *(unsigned __int16 *)(g_pCurrentEditControl + 10);
              v2 = GetSurfaceID((struct SGuiControl *)g_pCurrentEditControl);
              ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[v2])(2, v35, 0);
            }
            break;
          case 13:
            v99 = 1;
            v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 64, 0);
            v36 = (*(unsigned __int8 *)(g_pCurrentEditControl + 27) << 16)
                + *(unsigned __int16 *)(g_pCurrentEditControl + 10);
            v3 = GetSurfaceID((struct SGuiControl *)g_pCurrentEditControl);
            ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[v3])(3, v36, 0);
            if ( (*(_BYTE *)(g_pCurrentEditControl + 27) & 0x40) == 0 )
              g_pCurrentEditControl = 0;
            break;
          case 27:
            v99 = 1;
            v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 64, 0);
            v37 = (*(unsigned __int8 *)(g_pCurrentEditControl + 27) << 16)
                + *(unsigned __int16 *)(g_pCurrentEditControl + 10);
            v4 = GetSurfaceID((struct SGuiControl *)g_pCurrentEditControl);
            ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[v4])(4, v37, 0);
            if ( (*(_BYTE *)(g_pCurrentEditControl + 27) & 0x40) == 0 )
              g_pCurrentEditControl = 0;
            break;
          default:
            if ( IsValidInput(*((_DWORD *)a1 + 1), *(unsigned __int8 *)(g_pCurrentEditControl + 13)) )
            {
              v99 = 1;
              if ( *(unsigned __int8 *)(g_pCurrentEditControl + 12) >= 0x7Du
                 ? InsertCharacter(
                     (char *)&g_mbstrTextTable[75 * *(char *)(g_pCurrentEditControl + 25)],
                     125,
                     *(unsigned __int8 *)(g_pCurrentEditControl + 33),
                     *((_DWORD *)a1 + 1))
                 : (unsigned __int8)InsertCharacter(
                                      (char *)&g_mbstrTextTable[75 * *(char *)(g_pCurrentEditControl + 25)],
                                      *(unsigned __int8 *)(g_pCurrentEditControl + 12),
                                      *(unsigned __int8 *)(g_pCurrentEditControl + 33),
                                      *((_DWORD *)a1 + 1)) )
              {
                dword_3E2F124 = 3;
                v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 1);
                ++*(_BYTE *)(g_pCurrentEditControl + 33);
                CalcCharWidths((struct SGuiControl *)g_pCurrentEditControl);
                v100 = 1;
                *(_BYTE *)(g_pCurrentEditControl + 35) = 1;
                DoScrolling((struct SGuiControl *)g_pCurrentEditControl, 1);
                v38 = (*(unsigned __int8 *)(g_pCurrentEditControl + 27) << 16)
                    + *(unsigned __int16 *)(g_pCurrentEditControl + 10);
                v6 = GetSurfaceID((struct SGuiControl *)g_pCurrentEditControl);
                ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[v6])(2, v38, 0);
              }
            }
            break;
        }
      }
      goto GuiEngine2_EventProc___def_3399920;
    case 9:
      v69 = sub_2F9E860(*((_DWORD *)a1 + 2));
      if ( IsNonTransparentGuiArea(v69, HIDWORD(v69)) )
      {
        v84 = 0;
        FindDialogUnderCursor(v69, HIDWORD(v69), &v84);
        if ( v84 )
        {
          v99 = 1;
          ((void (__cdecl *)(int, _DWORD, _DWORD))g_pfDialogCallbacks[*(unsigned __int16 *)v84])(
            10,
            *((_DWORD *)a1 + 1),
            *((_DWORD *)a1 + 2));
        }
      }
      goto GuiEngine2_EventProc___def_3399920;
    case 16:
      if ( g_pCurrentRepeatControl && GetTickCount() > dword_4726EBC )
      {
        v52 = AddKeyStates(*((_DWORD *)a1 + 1));
        v40 = (*(unsigned __int8 *)(g_pCurrentRepeatControl + 27) << 16)
            + *(unsigned __int16 *)(g_pCurrentRepeatControl + 10);
        v11 = GetSurfaceID((struct SGuiControl *)g_pCurrentRepeatControl);
        ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v11])(3, v40, v52);
      }
      if ( GetTickCount() > dword_3E2F12C && CToolTip::IsOpen((CToolTip *)&g_cToolTipExt) )
      {
        CToolTip::CloseTooltip((CToolTip *)&g_cToolTipExt);
        dword_3E2F12C = -1;
      }
      if ( --dword_3E2F124 < 0 )
      {
        dword_3E2F124 = 3;
        if ( g_pCurrentEditControl )
        {
          if ( (*(_BYTE *)(g_pCurrentEditControl + 27) & 0x80) != 0 )
            v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 0);
          else
            v100 |= SetControlState((struct SGuiControl *)g_pCurrentEditControl, 128, 1);
        }
      }
      if ( g_pCurrentSelectedControl )
      {
        if ( GetTickCount() <= currentTickCount + 700 && GetTickCount() >= dword_3E2F128 + 400
          || CToolTip::IsOpen((CToolTip *)&g_cToolTip)
          || CToolTip::IsLocked((CToolTip *)&g_cToolTip) )
        {
          if ( CToolTip::IsOpen((CToolTip *)&g_cToolTip) && GetTickCount() > dword_4726EC4 + 8000 )
          {
            CToolTip::CloseTooltip((CToolTip *)&g_cToolTip);
            CToolTip::Lock((CToolTip *)&g_cToolTip);
          }
        }
        else
        {
          v53 = *(__int16 *)(g_pCurrentSelectedControl + 20);
          v41 = (*(unsigned __int8 *)(g_pCurrentSelectedControl + 27) << 16)
              + *(unsigned __int16 *)(g_pCurrentSelectedControl + 10);
          v12 = GetSurfaceID((struct SGuiControl *)g_pCurrentSelectedControl);
          ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[v12])(8, v41, v53);
          v65 = sub_2F9E830(*((_DWORD *)a1 + 2));
          CToolTip::OpenTooltip((CToolTip *)&g_cToolTip, v65, HIDWORD(v65));
          dword_4726EC4 = GetTickCount();
        }
      }
      goto GuiEngine2_EventProc___def_3399920;
    default:
      goto GuiEngine2_EventProc___def_3399920;
  }
  return result;
}


// address=[0x2f9b750]
// Decompiled from char __cdecl IsTextControl(int a1)
bool __cdecl IsTextControl(int a1) {
  
  char result; // al

  switch ( a1 )
  {
    case 4:
    case 5:
    case 13:
    case 18:
    case 19:
    case 20:
    case 21:
      result = 1;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}


// address=[0x2f9b7a0]
// Decompiled from char __cdecl CanHilightControl(int a1)
bool __cdecl CanHilightControl(int a1) {
  
  char result; // al

  switch ( a1 )
  {
    case 0:
    case 1:
    case 2:
    case 3:
    case 5:
    case 7:
    case 8:
    case 9:
    case 10:
    case 11:
    case 12:
    case 13:
    case 17:
    case 18:
    case 19:
      result = 1;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}


// address=[0x2f9b7f0]
// Decompiled from char __cdecl HasImage(int a1)
bool __cdecl HasImage(int a1) {
  
  char result; // al

  switch ( a1 )
  {
    case 0:
    case 1:
    case 2:
    case 3:
    case 5:
    case 6:
    case 7:
    case 8:
    case 9:
    case 10:
    case 11:
    case 12:
    case 13:
    case 16:
    case 17:
    case 18:
      result = 1;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}


// address=[0x2f9b840]
// Decompiled from int __cdecl GetSurfaceID(struct SGuiControl *a1)
int __cdecl GetSurfaceID(struct SGuiControl * a1) {
  
  return *(unsigned __int16 *)sub_2F9E930(a1->unknownId);
}


// address=[0x2f9b870]
// Decompiled from struct SGuiControl *__cdecl GetControlPtr(int container, int valueLink)
struct SGuiControl * __cdecl GetControlPtr(int container, int valueLink) {
  
  int v3; // [esp+0h] [ebp-Ch]
  int i; // [esp+4h] [ebp-8h]
  struct SGuiControl *v5; // [esp+8h] [ebp-4h]

  if ( !sub_2F9E8B0(container) )
    return 0;
  v3 = sub_2F9E930(container);
  v5 = (struct SGuiControl *)(v3 + 16);
  for ( i = 0; i < *(unsigned __int16 *)(v3 + 12); ++i )
  {
    if ( valueLink == v5->valueLink )
      return v5;
    v5 = (struct SGuiControl *)((char *)v5 + 36);
  }
  return 0;
}


// address=[0x2f9b8f0]
// Decompiled from int __cdecl CalcSliderPosition(int a1, int a2, int a3, bool a4)
int __cdecl CalcSliderPosition(int a1, int a2, int a3, bool a4) {
  
  int v5; // [esp+4h] [ebp-4h]

  v5 = (int)(float)((float)((float)a3 * (float)((float)(a2 - a1) * 0.0099999998)) + 0.5);
  if ( a4 )
    return a2 - v5;
  else
    return v5 + a1;
}


// address=[0x2f9b950]
// Decompiled from int __cdecl CalcPercentageValue(int a1, int a2, int a3, bool a4)
int __cdecl CalcPercentageValue(int a1, int a2, int a3, bool a4) {
  
  if ( a2 == a1 )
    return 0;
  if ( a4 )
    return 100 - (int)(float)((float)((float)(a3 - a1) * (float)(100.0 / (float)(a2 - a1))) + 0.5);
  return (int)(float)((float)((float)(a3 - a1) * (float)(100.0 / (float)(a2 - a1))) + 0.5);
}


// address=[0x2f9b9c0]
// Decompiled from int __cdecl AddKeyStates(char a1)
int __cdecl AddKeyStates(int a1) {
  
  int v2; // [esp+0h] [ebp-4h]

  v2 = 0;
  if ( (a1 & 8) != 0 )
    v2 = 65537;
  if ( (a1 & 4) != 0 )
    return v2 | 0x10004;
  return v2;
}


// address=[0x2f9ba00]
// Decompiled from bool __cdecl IsNonTransparentGuiArea(int a1, int a2)
bool __cdecl IsNonTransparentGuiArea(int a1, int a2) {
  
  unsigned int i; // [esp+8h] [ebp-2E0h]
  unsigned __int16 *v4; // [esp+10h] [ebp-2D8h]
  _DWORD v5[180]; // [esp+14h] [ebp-2D4h] BYREF

  if ( !g_pFileHeader )
    return 0;
  for ( i = 0; ; ++i )
  {
    if ( i >= 0xE )
      return 0;
    if ( g_iOpenDialogs[i] )
    {
      v4 = (unsigned __int16 *)sub_2F9E930(g_iOpenDialogs[i] - 1);
      if ( a1 >= v4[1] && a2 >= v4[2] && a1 <= v4[3] + v4[1] && a2 <= v4[4] + v4[2] )
        break;
    }
  }
  if ( (v4[7] & 2) != 0 )
    return 1;
  (**(void (__thiscall ***)(int, _DWORD *, _DWORD))g_pGfxManager)(g_pGfxManager, v5, v4[5]);
  if ( v5[0] )
    return *(_BYTE *)(a1 - v4[1] + v5[0] + 12 + (a2 - v4[2]) * v4[3]) != 0;
  BBSupportTracePrintF(0, "GUI ENGINE: Can't get source data from gfx manager for mask test.");
  IGfxEngine::EndWriteToSurface((IGfxEngine *)g_pGfxEngine, *v4);
  return 0;
}


// address=[0x2f9bc00]
// Decompiled from char __cdecl DeleteCharacter(char *String, int Count)
bool __cdecl DeleteCharacter(unsigned char * String, int Count) {
  
  signed int v3; // [esp+0h] [ebp-13Ch]
  char *v4; // [esp+4h] [ebp-138h]
  char *Source; // [esp+8h] [ebp-134h]
  char Destination[300]; // [esp+Ch] [ebp-130h] BYREF

  if ( Count < 0 || Count >= j___mbstrlen(String) )
    return 0;
  v4 = Destination;
  v3 = j___mbstrlen(String);
  if ( !v3 )
    return 0;
  if ( Count <= 0 )
  {
    j__strcpy(Destination, &byte_3AD1733);
    Source = (char *)j___mbsninc((const unsigned __int8 *)String, 1u);
  }
  else
  {
    j___mbsncpy((unsigned __int8 *)Destination, (const unsigned __int8 *)String, Count);
    Source = (char *)j___mbsninc((const unsigned __int8 *)String, Count + 1);
    v4 = (char *)j___mbsninc((const unsigned __int8 *)Destination, Count);
  }
  if ( v3 <= Count + 1 )
    j__strcpy(v4, &byte_3AD176D);
  else
    j__strcpy(v4, Source);
  j__strcpy(String, Destination);
  return 1;
}


// address=[0x2f9bd50]
// Decompiled from char __cdecl InsertCharacter(char *Str, int a2, signed int Count, char a4)
bool __cdecl InsertCharacter(unsigned char * Str, int a2, int Count, int a4) {
  
  signed int v5; // [esp+0h] [ebp-144h]
  char *v6; // [esp+8h] [ebp-13Ch]
  char *v7; // [esp+Ch] [ebp-138h]
  char *v8; // [esp+Ch] [ebp-138h]
  char Source[4]; // [esp+10h] [ebp-134h] BYREF
  char Destination[300]; // [esp+14h] [ebp-130h] BYREF

  if ( (int)j__strlen(Str) >= a2 )
    return 0;
  if ( Count < 0 || Count >= j___mbstrlen(Str) + 1 )
    return 0;
  v6 = Str;
  v7 = Destination;
  v5 = j___mbstrlen(Str);
  if ( Count <= 0 )
  {
    j__strcpy(Destination, &byte_3AD176E);
  }
  else
  {
    j___mbsncpy((unsigned __int8 *)Destination, (const unsigned __int8 *)Str, Count);
    v6 = (char *)j___mbsninc((const unsigned __int8 *)Str, Count);
    v7 = (char *)j___mbsninc((const unsigned __int8 *)Destination, Count);
  }
  Source[1] = 0;
  Source[0] = a4;
  j__strcpy(v7, Source);
  v8 = (char *)j___mbsninc((const unsigned __int8 *)v7, 1u);
  if ( v5 <= Count )
    j__strcpy(v8, &byte_3AD176F);
  else
    j__strcpy(v8, v6);
  j__strcpy(Str, Destination);
  return 1;
}


// address=[0x2f9bee0]
// Decompiled from struct SGuiControl *__cdecl DoScrolling(struct SGuiControl *a1, int a2)
void __cdecl DoScrolling(struct SGuiControl * a1, int a2) {
  
  struct SGuiControl *result; // eax
  char v3; // al
  struct tagSIZE psizl; // [esp+0h] [ebp-20h] BYREF
  LONG v5; // [esp+8h] [ebp-18h]
  LONG v6; // [esp+Ch] [ebp-14h]
  int i; // [esp+10h] [ebp-10h]
  int v8; // [esp+14h] [ebp-Ch]
  int v9; // [esp+18h] [ebp-8h]
  int v10; // [esp+1Ch] [ebp-4h]

  CalcTextSize(
    a1->textStyle,
    (const unsigned __int8 *)&g_mbstrTextTable[75 * (char)a1->id],
    &psizl,
    LOBYTE(a1->unknownData[1]),
    HIBYTE(a1->unknownData[0]) - LOBYTE(a1->unknownData[1]));
  result = a1;
  if ( psizl.cx > a1->width - 30 && a2 == 1 )
  {
    v9 = 0;
    v6 = 30;
    while ( psizl.cx > v6 && HIBYTE(a1->unknownData[0]) - v9 > 0 )
    {
      ++v9;
      psizl.cx -= g_iEditWidthTable[HIBYTE(a1->unknownData[0]) - v9];
    }
    result = a1;
    LOBYTE(a1->unknownData[1]) += v9;
  }
  else if ( psizl.cx >= 30 || a2 )
  {
    if ( a2 == 2 )
    {
      v8 = 0;
      for ( i = a1->width - 30;
            i > 0 && HIBYTE(a1->unknownData[0]) - v8 > 0;
            i -= g_iEditWidthTable[HIBYTE(a1->unknownData[0]) - v8] )
      {
        ++v8;
      }
      v3 = j___mbstrlen((const char *)&g_mbstrTextTable[75 * (char)a1->id]);
      LOBYTE(a1->unknownData[1]) = v3 - v8;
      return (struct SGuiControl *)LOBYTE(a1->unknownData[1]);
    }
  }
  else
  {
    v10 = 0;
    v5 = a1->width - 30;
    while ( psizl.cx < v5 && LOBYTE(a1->unknownData[1]) - v10 > 0 && HIBYTE(a1->unknownData[0]) - v10 > 0 )
    {
      ++v10;
      psizl.cx += g_iEditWidthTable[HIBYTE(a1->unknownData[0]) - v10];
    }
    result = (struct SGuiControl *)(LOBYTE(a1->unknownData[1]) - v10);
    LOBYTE(a1->unknownData[1]) = (_BYTE)result;
  }
  return result;
}


// address=[0x2f9c0c0]
// Decompiled from char __cdecl DrawControl(char *a1, unsigned int a2, int a3, int a4, struct SGuiControl *a5)
bool __cdecl DrawControl(void * a1, unsigned int a2, int a3, int a4, struct SGuiControl * a5) {
  
  float v6; // [esp+8h] [ebp-510h]
  int v7; // [esp+Ch] [ebp-50Ch]
  int v8; // [esp+14h] [ebp-504h]
  int v9; // [esp+18h] [ebp-500h]
  int k; // [esp+24h] [ebp-4F4h]
  int j; // [esp+28h] [ebp-4F0h]
  int i; // [esp+2Ch] [ebp-4ECh]
  int m; // [esp+30h] [ebp-4E8h]
  unsigned __int16 *v14; // [esp+34h] [ebp-4E4h]
  float v15; // [esp+38h] [ebp-4E0h]
  float v16; // [esp+38h] [ebp-4E0h]
  bool v17; // [esp+3Eh] [ebp-4DAh]
  bool v18; // [esp+3Fh] [ebp-4D9h]
  unsigned __int16 *v19; // [esp+40h] [ebp-4D8h]
  unsigned __int16 *v20; // [esp+44h] [ebp-4D4h] BYREF
  void *v21; // [esp+48h] [ebp-4D0h]
  _WORD v22[256]; // [esp+314h] [ebp-204h] BYREF

  if ( a5->controlType == 9 )
    return 0;
  v14 = (unsigned __int16 *)sub_2F9E930(a5->unknownId);
  (**(void (__thiscall ***)(int, unsigned __int16 **, _DWORD))g_pGfxManager)(g_pGfxManager, &v20, v14[5]);
  if ( !v20 || !v21 )
  {
    BBSupportTracePrintF(0, "GUI ENGINE: Background gfx not accessible!");
    return 0;
  }
  if ( a5->controlType != 7 && a5->controlType != 8 )
  {
    if ( (v14[7] & 1) != 0 )
    {
      if ( (v14[7] & 2) != 0 )
      {
        FastRasterSolid(a1, a2, a5->x, a5->y, a5->width, a5->height, 0, 31);
      }
      else
      {
        j__memcpy(v22, v21, sizeof(v22));
        v22[1] = 31;
        v22[0] = 31;
        FastBlit8Bit(v20 + 6, v14[3], a5->x, a5->y, a5->width, a5->height, a1, a2, a5->x, a5->y, v22);
      }
    }
    else
    {
      FastBlit8Bit(v20 + 6, v14[3], a5->x, a5->y, a5->width, a5->height, a1, a2, a5->x, a5->y, v21);
    }
  }
  v17 = (a5->effects & 8) != 0;
  if ( HasImage(a5->controlType) && !v17 )
  {
    if ( a5->controlType == 10 )
    {
      v7 = CalcSliderPosition(a5->y + 1, a5->y + a5->height - 1, (char)a5->showTexture, 1);
      v15 = 0.0;
      v6 = 16.0 / (float)(a5->width - 2);
      if ( (char)a5->showTexture > 0 )
      {
        for ( i = a5->x + 1; i < a5->x + a5->width - 1; ++i )
        {
          FastVLine((unsigned __int16 *)a1, a2, i, v7, a5->y + a5->height - 1, g_uShadeTable2[v15]);
          v15 = v15 + v6;
        }
      }
      v16 = 0.0;
      if ( (char)a5->showTexture < 100 )
      {
        for ( j = a5->x + 1; j < a5->x + a5->width - 1; ++j )
        {
          FastVLine((unsigned __int16 *)a1, a2, j, a5->y + 1, v7, g_uShadeTable1[v16]);
          v16 = v16 + v6;
        }
      }
      FastVLine((unsigned __int16 *)a1, a2, a5->x, a5->y, a5->y + a5->height - 1, g_iRightShadeColor);
      FastVLine((unsigned __int16 *)a1, a2, a5->x + a5->width - 1, a5->y, a5->y + a5->height - 1, g_iLeftShadeColor);
      FastHLine((unsigned __int16 *)a1, a2, a5->x, a5->y, a5->x + a5->width - 1, g_iRightShadeColor);
      FastHLine((unsigned __int16 *)a1, a2, a5->x, a5->y + a5->height - 1, a5->x + a5->width - 1, g_iLeftShadeColor);
      return 1;
    }
    else
    {
      if ( (char)a5->showTexture == -10 )
      {
        if ( a5->mainTexture >= 8u )
        {
          v20 = 0;
          BBSupportTracePrintF(0, "GUI ENGINE: Wrong gfx index for user logo!");
        }
        else
        {
          (*(void (__thiscall **)(int, unsigned __int16 **, int, _DWORD))(*(_DWORD *)g_pGfxManager + 4))(
            g_pGfxManager,
            &v20,
            a5->mainTexture + 1,
            0);
        }
      }
      else if ( (a5->effects & 1) != 0 )
      {
        (**(void (__thiscall ***)(int, unsigned __int16 **, _DWORD))g_pGfxManager)(
          g_pGfxManager,
          &v20,
          a5->buttonPressedTexture);
      }
      else
      {
        (**(void (__thiscall ***)(int, unsigned __int16 **, _DWORD))g_pGfxManager)(g_pGfxManager, &v20, a5->mainTexture);
      }
      v19 = v20;
      if ( !v20 )
      {
        BBSupportTracePrintF(0, "GUI ENGINE: No gfx for gui control available!");
        return 0;
      }
      if ( a5->height + a5->y > a4 || a5->width + a5->x > a3 )
      {
        BBSupportTracePrintF(0, "GUI ENGINE: Control exceeds container surface!");
        return 0;
      }
      if ( (v20[4] & 0x20) == 0 )
      {
        if ( !v21 )
        {
          BBSupportTracePrintF(0, "GUI ENGINE: No palette for gui control available!");
          return 0;
        }
        v18 = IGfxEngine::GetGfxMode((IGfxEngine *)g_pGfxEngine) == 1;
        if ( *v19 != a5->width || v19[1] != a5->height )
        {
          BBSupportTracePrintF(0, "GUI ENGINE: Control size mismatch or illegal gfx data! ID: %d ", a5->valueLink);
          return 0;
        }
        if ( (a5->effects & 2) != 0 )
        {
          if ( v18 )
            UnpackGfxTransparentHiLight555(v21, v19 + 6, &a1[2 * a5->x + a2 * a5->y], a2, *v19, v19[1]);
          else
            UnpackGfxTransparentHiLight565(v21, v19 + 6, &a1[2 * a5->x + a2 * a5->y], a2, *v19, v19[1]);
        }
        else if ( (a5->effects & 4) != 0 )
        {
          if ( v18 )
            UnpackGfxTransparentGrayed555(v21, v19 + 6, &a1[2 * a5->x + a2 * a5->y], a2, *v19, v19[1]);
          else
            UnpackGfxTransparentGrayed565(v21, v19 + 6, &a1[2 * a5->x + a2 * a5->y], a2, *v19, v19[1]);
        }
        else
        {
          UnpackGfxTransparent(v21, v19 + 6, &a1[2 * a5->x + a2 * a5->y], a2, *v19, v19[1]);
        }
      }
      if ( (a5->effects & 0xC0) != 0xC0 )
        return 1;
      v8 = 0;
      for ( k = LOBYTE(a5->unknownData[1]); k < HIBYTE(a5->unknownData[0]); ++k )
        v8 += g_iEditWidthTable[k];
      FastVLine((unsigned __int16 *)&a1[2 * a5->x + a2 * a5->y], a2, v8 + 2, 0, a5->height - 1, 0xFFFFu);
      return 1;
    }
  }
  else
  {
    if ( (a5->effects & 0xC0) != 0xC0 )
      return 1;
    v9 = 0;
    for ( m = LOBYTE(a5->unknownData[1]); m < HIBYTE(a5->unknownData[0]); ++m )
      v9 += g_iEditWidthTable[m];
    FastVLine((unsigned __int16 *)&a1[2 * a5->x + a2 * a5->y], a2, v9 + 2, 0, a5->height - 1, 0xFFFFu);
    return 1;
  }
}


// address=[0x2f9cb10]
// Decompiled from char __cdecl DrawControlText(HDC hdc, unsigned __int16 *a2)
bool __cdecl DrawControlText(struct HDC__ * hdc, struct SGuiControl * a2) {
  
  size_t v3; // eax
  HGDIOBJ h; // [esp+0h] [ebp-B4h]
  size_t cchText; // [esp+10h] [ebp-A4h]
  LPCSTR lpchText; // [esp+18h] [ebp-9Ch]
  unsigned int v7; // [esp+1Ch] [ebp-98h]
  struct tagRECT rc; // [esp+20h] [ebp-94h] BYREF
  char Destination[128]; // [esp+30h] [ebp-84h] BYREF

  if ( (*((_BYTE *)a2 + 27) & 8) != 0 )
    return 0;
  lpchText = (LPCSTR)&g_mbstrTextTable[75 * *((char *)a2 + 25)];
  switch ( *((_BYTE *)a2 + 24) )
  {
    case 0xE:
      lpchText = CToolTip::GetTooltipStringPtr((CToolTip *)&g_cToolTip);
      break;
    case 0xF:
      lpchText = CToolTip::GetTooltipStringPtr((CToolTip *)&g_cToolTipExt);
      break;
    case 0x15:
      if ( !*((_DWORD *)a2 + 4) )
        return 0;
      lpchText = (LPCSTR)*((_DWORD *)a2 + 4);
      break;
    case 5:
    case 0x14:
      lpchText = (LPCSTR)j___mbsninc((const unsigned __int8 *)lpchText, *((unsigned __int8 *)a2 + 34));
      if ( (*((_BYTE *)a2 + 13) & 0x80) != 0 )
      {
        j__strcpy(Destination, lpchText);
        v3 = j___mbstrlen(Destination);
        lpchText = (LPCSTR)j___mbsnset((unsigned __int8 *)Destination, 0x2Au, v3);
      }
      break;
    default:
      if ( *((char *)a2 + 25) < 0 )
        return 0;
      if ( !LOBYTE(g_mbstrTextTable[75 * *((char *)a2 + 25)]) || !g_bUsedTexts[*((char *)a2 + 25)] )
        return 0;
      break;
  }
  cchText = j___mbstrlen(lpchText);
  v7 = *((unsigned __int8 *)a2 + 26);
  if ( v7 >= 0x13 )
    v7 = 0;
  h = SelectObject(hdc, g_hFonts[v7]);
  rc.left = *a2;
  rc.top = *((char *)a2 + 30) + a2[1];
  rc.right = a2[2] + *a2;
  rc.bottom = *((char *)a2 + 30) + a2[3] + a2[1];
  if ( *((_BYTE *)a2 + 24) != 14 )
  {
    rc.left += 2;
    rc.right -= 2;
  }
  if ( (*((_BYTE *)a2 + 27) & 1) != 0 )
  {
    rc.left += dword_3AD1A20[21 * v7];
    rc.top += dword_3AD1A24[21 * v7];
    rc.right += dword_3AD1A20[21 * v7];
    rc.bottom += dword_3AD1A24[21 * v7];
  }
  if ( byte_3AD1A29[84 * v7] )
  {
    rc.left += dword_3AD1A18[21 * v7];
    rc.top += dword_3AD1A1C[21 * v7];
    rc.right += dword_3AD1A18[21 * v7];
    rc.bottom += dword_3AD1A1C[21 * v7];
    SetTextColor(hdc, 0);
    DrawTextA(hdc, lpchText, cchText, &rc, dword_3AD19C8[2 * *((unsigned __int8 *)a2 + 32) + g_iAlignMode]);
    rc.left -= dword_3AD1A18[21 * v7];
    rc.top -= dword_3AD1A1C[21 * v7];
    rc.right -= dword_3AD1A18[21 * v7];
    rc.bottom -= dword_3AD1A1C[21 * v7];
  }
  if ( (*((_BYTE *)a2 + 27) & 4) != 0 )
    SetTextColor(
      hdc,
      (int)(float)((float)(unsigned __int8)*(&off_3AD1A14 + 21 * v7) * 0.60000002)
    + ((int)(float)((float)((int)((unsigned int)&dword_F29144[203695] & (unsigned int)*(&off_3AD1A14 + 21 * v7)) >> 16)
                  * 0.60000002) << 16)
    + ((int)(float)((float)((int)((unsigned int)*(&off_3AD1A14 + 21 * v7) & 0xFF00) >> 8) * 0.60000002) << 8));
  else
    SetTextColor(hdc, (COLORREF)*(&off_3AD1A14 + 21 * v7));
  DrawTextA(hdc, lpchText, cchText, &rc, dword_3AD19C8[2 * *((unsigned __int8 *)a2 + 32) + g_iAlignMode]);
  SelectObject(hdc, h);
  return 1;
}


// address=[0x2f9d020]
// Decompiled from char __cdecl SetControlState(struct SGuiControl *a1, int a2, bool a3)
bool __cdecl SetControlState(struct SGuiControl * a1, int a2, bool a3) {
  
  int SurfaceID; // eax
  int v5; // eax
  int v6; // [esp-8h] [ebp-10h]
  int v7; // [esp-8h] [ebp-10h]

  if ( ((unsigned __int8)a2 & a1->effects) != 0 && a3 || ((unsigned __int8)a2 & a1->effects) == 0 && !a3 )
    return 0;
  if ( a2 == 2 && !CanHilightControl(a1->controlType) )
    return 0;
  if ( a3 )
    a1->effects |= a2;
  else
    a1->effects &= ~(_BYTE)a2;
  g_bGuiIsDirty = 1;
  HIBYTE(a1->unknownData[1]) = 1;
  if ( a2 == 64 && LOBYTE(a1->unknownData[1]) )
    LOBYTE(a1->unknownData[1]) = 0;
  if ( a2 == 2 )
  {
    v6 = (a1->effects << 16) + a1->valueLink;
    SurfaceID = GetSurfaceID(a1);
    if ( a3 )
      ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[SurfaceID])(5, v6, 0);
    else
      ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[SurfaceID])(6, v6, 0);
  }
  else if ( a2 != 128 && a2 != 4 )
  {
    v7 = (a1->effects << 16) + a1->valueLink;
    v5 = GetSurfaceID(a1);
    ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[v5])(1, v7, 0);
  }
  return 1;
}


// address=[0x2f9d1b0]
// Decompiled from int __cdecl ChangeMultisliders(struct SGuiControl *a1, int a2)
void __cdecl ChangeMultisliders(struct SGuiControl * a1, int a2) {
  
  int result; // eax
  int SurfaceID; // eax
  int v4; // [esp-8h] [ebp-28h]
  int v5; // [esp-4h] [ebp-24h]
  int unknown4_low; // [esp+4h] [ebp-1Ch]
  int i; // [esp+8h] [ebp-18h]
  int v8; // [esp+Ch] [ebp-14h]
  unsigned __int16 *v9; // [esp+10h] [ebp-10h]
  int v10; // [esp+14h] [ebp-Ch]
  int v11; // [esp+18h] [ebp-8h]
  char v12; // [esp+1Fh] [ebp-1h]

  v8 = sub_2F9E930(a1->unknownId);
  unknown4_low = LOBYTE(a1->unknown4);
  v10 = 1;
  if ( a2 < 0 )
    v10 = -1;
  v12 = 1;
  result = *(unsigned __int16 *)(v8 + 12);
LABEL_4:
  while ( a2 && v12 )
  {
    v12 = 0;
    v11 = v8 + 16;
    for ( i = 0; i < *(unsigned __int16 *)(v8 + 12); ++i )
    {
      if ( *(_BYTE *)(v11 + 24) == 8 )
      {
        if ( *(unsigned __int8 *)(v11 + 28) == unknown4_low )
        {
          if ( (struct SGuiControl *)v11 == a1 )
          {
            v11 += 36;
          }
          else
          {
            result = *(_BYTE *)(v11 + 27) & 0xD;
            if ( (*(_BYTE *)(v11 + 27) & 0xD) != 0 )
            {
              v11 += 36;
            }
            else
            {
              if ( !a2 )
                goto LABEL_4;
              if ( (unsigned int)(v10 + *(char *)(v11 + 30)) <= 0x64 )
              {
                *(_BYTE *)(v11 + 30) += v10;
                a2 -= v10;
                v12 = 1;
                *(_BYTE *)(v11 + 35) = 1;
                v9 = (unsigned __int16 *)(v11 - 36);
                if ( *(_BYTE *)(v11 - 36 + 24) != 16 )
                  return BBSupportTracePrintF(
                           0,
                           "GUI ENGINE: No previous control GUI_CNTRL_SLIDERAREA of GUI_CNTRL_SLIDER!");
                *(_WORD *)v11 = CalcSliderPosition(
                                  *v9,
                                  v9[2] + *v9 - *(unsigned __int16 *)(v11 + 4),
                                  *(char *)(v11 + 30),
                                  0);
                if ( g_pfDialogCallbacks[GetSurfaceID((struct SGuiControl *)v11)] )
                {
                  v5 = *(char *)(v11 + 30);
                  v4 = (*(unsigned __int8 *)(v11 + 27) << 16) + *(unsigned __int16 *)(v11 + 10);
                  SurfaceID = GetSurfaceID((struct SGuiControl *)v11);
                  ((void (__cdecl *)(int, int, int))g_pfDialogCallbacks[SurfaceID])(2, v4, v5);
                }
                *((_BYTE *)v9 + 35) = 1;
              }
              v11 += 36;
            }
          }
        }
        else
        {
          v11 += 36;
        }
      }
      else
      {
        v11 += 36;
      }
      result = i + 1;
    }
  }
  return result;
}


// address=[0x2f9d3c0]
// Decompiled from int __cdecl EnsureMultisliders(struct SGuiControl *a1)
void __cdecl EnsureMultisliders(struct SGuiControl * a1) {
  
  int result; // eax
  int v2; // ecx
  int SurfaceID; // eax
  int v4; // [esp-8h] [ebp-28h]
  int showTexture; // [esp-4h] [ebp-24h]
  int v6; // [esp+Ch] [ebp-14h]
  int i; // [esp+10h] [ebp-10h]
  int v8; // [esp+14h] [ebp-Ch]
  int v9; // [esp+18h] [ebp-8h]

  v8 = sub_2F9E930(a1->unknownId);
  v9 = v8 + 16;
  v6 = 0;
  for ( i = 0; i < *(unsigned __int16 *)(v8 + 12); ++i )
  {
    if ( *(_BYTE *)(v9 + 24) == 8 )
    {
      if ( *(unsigned __int8 *)(v9 + 28) == LOBYTE(a1->unknown4) )
      {
        if ( (struct SGuiControl *)v9 == a1 )
        {
          v9 += 36;
        }
        else
        {
          if ( (*(_BYTE *)(v9 + 27) & 0xC) == 0 )
            v6 += *(char *)(v9 + 30);
          v9 += 36;
        }
      }
      else
      {
        v9 += 36;
      }
    }
    else
    {
      v9 += 36;
    }
  }
  result = (int)a1;
  v2 = v6 + (char)a1->showTexture;
  if ( v2 == 100 )
    return result;
  a1->showTexture += 100 - v2;
  if ( (a1->showTexture & 0x80u) != 0 )
    a1->showTexture = 0;
  if ( (char)a1->showTexture > 100 )
    a1->showTexture = 100;
  a1->x = CalcSliderPosition(a1[-1].width, a1[-1].mainTexture + a1[-1].width - a1->width, (char)a1->showTexture, 0);
  result = GetSurfaceID(a1);
  if ( !g_pfDialogCallbacks[result] )
    return result;
  showTexture = (char)a1->showTexture;
  v4 = (a1->effects << 16) + a1->valueLink;
  SurfaceID = GetSurfaceID(a1);
  return ((int (__cdecl *)(int, int, int))g_pfDialogCallbacks[SurfaceID])(2, v4, showTexture);
}


// address=[0x2f9d580]
// Decompiled from bool __cdecl CanLockMultislider(struct SGuiControl *a1)
bool __cdecl CanLockMultislider(struct SGuiControl *) {
  
  int v2; // [esp+Ch] [ebp-14h]
  int v3; // [esp+10h] [ebp-10h]
  int i; // [esp+14h] [ebp-Ch]
  int v5; // [esp+18h] [ebp-8h]
  _BYTE *v6; // [esp+1Ch] [ebp-4h]

  v5 = sub_2F9E930(a1->unknownId);
  if ( (a1->effects & 1) != 0 )
    return 0;
  v6 = (_BYTE *)(v5 + 16);
  v3 = 0;
  v2 = 0;
  for ( i = 0; i < *(unsigned __int16 *)(v5 + 12); ++i )
  {
    if ( v6[24] == 8 )
    {
      if ( v6[28] == LOBYTE(a1->unknown4) )
      {
        if ( (v6[27] & 0xD) != 0 )
          ++v2;
        ++v3;
        v6 += 36;
      }
      else
      {
        v6 += 36;
      }
    }
    else
    {
      v6 += 36;
    }
  }
  return v3 - v2 > 2;
}


// address=[0x2f9d670]
// Decompiled from int __cdecl StoreMultisliderSettings(struct SGuiControl *a1)
void __cdecl StoreMultisliderSettings(struct SGuiControl * a1) {
  
  int result; // eax
  int unknown4_low; // [esp+0h] [ebp-10h]
  int v3; // [esp+4h] [ebp-Ch]
  int i; // [esp+8h] [ebp-8h]
  _BYTE *v5; // [esp+Ch] [ebp-4h]

  v3 = sub_2F9E930(a1->unknownId);
  v5 = (_BYTE *)(v3 + 16);
  unknown4_low = LOBYTE(a1->unknown4);
  for ( i = 0; ; ++i )
  {
    result = v3;
    if ( i >= *(unsigned __int16 *)(v3 + 12) )
      break;
    if ( v5[24] == 8 )
    {
      if ( (unsigned __int8)v5[28] == unknown4_low )
      {
        if ( (v5[27] & 0xC) == 0 )
          v5[33] = v5[30];
        v5 += 36;
      }
      else
      {
        v5 += 36;
      }
    }
    else
    {
      v5 += 36;
    }
  }
  return result;
}


// address=[0x2f9d720]
// Decompiled from int __cdecl RestoreMultisliderSettings(struct SGuiControl *a1)
void __cdecl RestoreMultisliderSettings(struct SGuiControl * a1) {
  
  int result; // eax
  int unknown4_low; // [esp+0h] [ebp-14h]
  int v3; // [esp+4h] [ebp-10h]
  int i; // [esp+8h] [ebp-Ch]
  unsigned __int16 *v5; // [esp+Ch] [ebp-8h]
  int v6; // [esp+10h] [ebp-4h]

  v3 = sub_2F9E930(a1->unknownId);
  v6 = v3 + 16;
  unknown4_low = LOBYTE(a1->unknown4);
  for ( i = 0; ; ++i )
  {
    result = v3;
    if ( i >= *(unsigned __int16 *)(v3 + 12) )
      break;
    if ( *(_BYTE *)(v6 + 24) == 8 )
    {
      if ( *(unsigned __int8 *)(v6 + 28) == unknown4_low )
      {
        if ( a1 == (struct SGuiControl *)v6 )
        {
          v6 += 36;
        }
        else if ( (*(_BYTE *)(v6 + 27) & 0xD) != 0 )
        {
          v6 += 36;
        }
        else
        {
          *(_BYTE *)(v6 + 30) = *(_BYTE *)(v6 + 33);
          *(_BYTE *)(v6 + 35) = 1;
          v5 = (unsigned __int16 *)(v6 - 36);
          if ( *(_BYTE *)(v6 - 36 + 24) != 16 )
            return BBSupportTracePrintF(0, "GUI ENGINE: No previous control GUI_CNTRL_SLIDERAREA of GUI_CNTRL_SLIDER!");
          *(_WORD *)v6 = CalcSliderPosition(*v5, v5[2] + *v5 - *(unsigned __int16 *)(v6 + 4), *(char *)(v6 + 30), 0);
          *((_BYTE *)v5 + 35) = 1;
          v6 += 36;
        }
      }
      else
      {
        v6 += 36;
      }
    }
    else
    {
      v6 += 36;
    }
  }
  return result;
}


// address=[0x2f9d850]
// Decompiled from char __cdecl SelectRadioGroup(struct SGuiControl *a1)
bool __cdecl SelectRadioGroup(struct SGuiControl * a1) {
  
  int SurfaceID; // eax
  int v3; // eax
  int v4; // [esp-8h] [ebp-18h]
  int v5; // [esp-8h] [ebp-18h]
  int v6; // [esp+0h] [ebp-10h]
  int i; // [esp+4h] [ebp-Ch]
  int v8; // [esp+8h] [ebp-8h]
  char v9; // [esp+Fh] [ebp-1h]

  if ( (a1->effects & 1) != 0 )
  {
    if ( a1->controlType == 2 )
    {
      return 0;
    }
    else
    {
      v4 = ((a1->effects & 0xFE) << 16) + a1->valueLink;
      SurfaceID = GetSurfaceID(a1);
      ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[SurfaceID])(3, v4, 0);
      return SetControlState(a1, 1, 0);
    }
  }
  else
  {
    v6 = sub_2F9E930(a1->unknownId);
    v8 = v6 + 16;
    for ( i = 0; i < *(unsigned __int16 *)(v6 + 12); ++i )
    {
      if ( *(_BYTE *)(v8 + 24) == 3 || *(_BYTE *)(v8 + 24) == 2 )
      {
        if ( (*(_BYTE *)(v8 + 27) & 1) != 0
          && *(unsigned __int8 *)(v8 + 28) == LOBYTE(a1->unknown4)
          && a1 != (struct SGuiControl *)v8 )
        {
          SetControlState((struct SGuiControl *)v8, 1, 0);
        }
        v8 += 36;
      }
      else
      {
        v8 += 36;
      }
    }
    v9 = SetControlState(a1, 1, 1);
    v5 = ((a1->effects | 1) << 16) + a1->valueLink;
    v3 = GetSurfaceID(a1);
    ((void (__cdecl *)(int, int, _DWORD))g_pfDialogCallbacks[v3])(3, v5, 0);
    return v9;
  }
}


// address=[0x2f9d9b0]
// Decompiled from char __cdecl FindControlUnderCursor(int a1, int a2, struct SGuiControl **a3, int *a4, int *a5)
bool __cdecl FindControlUnderCursor(int a1, int a2, struct SGuiControl * & a3, int & a4, int & a5) {
  
  int j; // [esp+0h] [ebp-10h]
  int i; // [esp+4h] [ebp-Ch]
  unsigned __int16 *v8; // [esp+8h] [ebp-8h]
  unsigned __int16 *v9; // [esp+Ch] [ebp-4h]

  *a3 = 0;
  *a5 = 0;
  *a4 = 0;
  if ( !g_pFileHeader )
    return 0;
  for ( i = 13; i >= 0; --i )
  {
    if ( g_iOpenDialogs[i] )
    {
      v8 = (unsigned __int16 *)sub_2F9E930(g_iOpenDialogs[i] - 1);
      if ( a1 >= v8[1] && a2 >= v8[2] && a1 <= v8[3] + v8[1] && a2 <= v8[4] + v8[2] )
      {
        v9 = v8 + 8;
        for ( j = 0; j < v8[6]; ++j )
        {
          if ( (*((_BYTE *)v9 + 27) & 0xC) != 0 )
          {
            v9 += 18;
          }
          else if ( a1 < v8[1] + *v9 || a2 < v8[2] + v9[1] || a1 > v9[2] + v8[1] + *v9 || a2 > v9[3] + v8[2] + v9[1] )
          {
            v9 += 18;
          }
          else
          {
            if ( *((_BYTE *)v9 + 24) != 16 )
              goto LABEL_30;
            if ( *((_BYTE *)v9 + 60) == 7 || *((_BYTE *)v9 + 60) == 8 )
            {
              if ( a1 >= v8[1] + v9[18]
                && a2 >= v8[2] + v9[19]
                && a1 <= v9[20] + v8[1] + v9[18]
                && a2 <= v9[21] + v8[2] + v9[19] )
              {
                *a3 = (struct SGuiControl *)(v9 + 18);
                *a4 = i;
                *a5 = j;
                return 1;
              }
LABEL_30:
              *a3 = (struct SGuiControl *)v9;
              *a4 = i;
              *a5 = j;
              return 1;
            }
            v9 += 18;
          }
        }
        return 0;
      }
    }
  }
  return 0;
}


// address=[0x2f9dc20]
// Decompiled from char __cdecl FindDialogUnderCursor(int a1, int a2, struct GUI_MENU_DIALOG_HEADER **a3)
bool __cdecl FindDialogUnderCursor(int a1, int a2, struct GUI_MENU_DIALOG_HEADER * & a3) {
  
  int i; // [esp+0h] [ebp-8h]
  int v5; // [esp+4h] [ebp-4h]

  *a3 = 0;
  if ( !g_pFileHeader )
    return 0;
  for ( i = 13; i >= 0; --i )
  {
    if ( g_iOpenDialogs[i] )
    {
      v5 = sub_2F9E930(g_iOpenDialogs[i] - 1);
      if ( a1 >= *(unsigned __int16 *)(v5 + 2)
        && a2 >= *(unsigned __int16 *)(v5 + 4)
        && a1 <= *(unsigned __int16 *)(v5 + 6) + *(unsigned __int16 *)(v5 + 2)
        && a2 <= *(unsigned __int16 *)(v5 + 8) + *(unsigned __int16 *)(v5 + 4) )
      {
        *a3 = (struct GUI_MENU_DIALOG_HEADER *)v5;
        return 1;
      }
    }
  }
  return 0;
}


// address=[0x2f9dce0]
// Decompiled from char __cdecl UpdateGui(int surfaceToDraw)
void __cdecl UpdateGui(int surfaceToDraw) {
  
  unsigned __int16 *v1; // eax
  struct SGuiControl *v3; // [esp+0h] [ebp-4FCh]
  HDC hdc; // [esp+4h] [ebp-4F8h] BYREF
  unsigned int v5; // [esp+8h] [ebp-4F4h] BYREF
  int j; // [esp+Ch] [ebp-4F0h]
  unsigned int i; // [esp+10h] [ebp-4ECh]
  unsigned __int16 *v8; // [esp+14h] [ebp-4E8h]
  unsigned __int16 *v9; // [esp+18h] [ebp-4E4h]
  struct SGuiControl *v10; // [esp+1Ch] [ebp-4E0h]
  unsigned __int16 *v11; // [esp+20h] [ebp-4DCh]
  char v12; // [esp+27h] [ebp-4D5h]
  unsigned __int16 *v13; // [esp+28h] [ebp-4D4h] BYREF
  void *Src; // [esp+2Ch] [ebp-4D0h]
  _WORD v15[256]; // [esp+2F8h] [ebp-204h] BYREF

  g_bGuiIsDirty = 1;
  if ( surfaceToDraw == -1 && (LOBYTE(v1) = g_bGuiIsDirty) == 0 )
    return (char)v1;
  LOBYTE(v1) = sub_2F9E8F0();
  if ( (_BYTE)v1 )
  {
    for ( i = 0; ; ++i )
    {
      if ( i >= 0xE )
      {
        g_bGuiIsDirty = 0;
        return (char)v1;
      }
      LOBYTE(v1) = i;
      if ( !g_iOpenDialogs[i] )
        continue;
      v11 = (unsigned __int16 *)sub_2F9E930(g_iOpenDialogs[i] - 1);
      v10 = (struct SGuiControl *)(v11 + 8);
      v3 = (struct SGuiControl *)(v11 + 8);
      v12 = 0;
      if ( surfaceToDraw == i )
      {
        IGfxEngine::SolidColorFillGuiSurface((IGfxEngine *)g_pGfxEngine, *v11, 0, 0, 0xFFu);
        if ( (v11[7] & 2) != 0 )
        {
          v1 = IGfxEngine::BeginWriteToSurface((IGfxEngine *)g_pGfxEngine, *v11, &v5);
          v8 = v1;
          if ( !v1 )
            return (char)v1;
          v12 = 1;
          FastRaster(v8, v5, 0, 0, v11[3], v11[4], 0);
        }
        else
        {
          (**(void (__thiscall ***)(int, unsigned __int16 **, _DWORD))g_pGfxManager)(g_pGfxManager, &v13, v11[5]);
          v9 = v13;
          if ( !v13 )
          {
            LOBYTE(v1) = BBSupportTracePrintF(0, "GUI ENGINE: Can't get source data from gfx manager.");
            return (char)v1;
          }
          if ( v11[3] > (int)*v9 || v11[4] > (int)v9[1] )
          {
            LOBYTE(v1) = BBSupportTracePrintF(0, "GUI ENGINE: Background gfx is greater than the dialog!");
            return (char)v1;
          }
          if ( (v9[4] & 0x20) == 0 )
          {
            LOBYTE(v1) = BBSupportTracePrintF(0, "GUI ENGINE: Dialog is packed. Illegal data!");
            return (char)v1;
          }
          v1 = IGfxEngine::BeginWriteToSurface((IGfxEngine *)g_pGfxEngine, *v11, &v5);
          v8 = v1;
          if ( !v1 )
            return (char)v1;
          v12 = 1;
          if ( (v11[7] & 1) != 0 )
          {
            j__memcpy(v15, Src, sizeof(v15));
            v15[1] = 31;
            v15[0] = 31;
            FastBlit8Bit(v13 + 6, *v9, 0, 0, *v9, v9[1], v8, v5, 0, 0, v15);
          }
          else
          {
            FastBlit8Bit(v13 + 6, *v9, 0, 0, *v9, v9[1], v8, v5, 0, 0, Src);
          }
        }
      }
      for ( j = 0; j < v11[6]; ++j )
      {
        if ( surfaceToDraw == i )
        {
          v10->effects &= ~2u;
          HIBYTE(v10->unknownData[1]) = 1;
        }
        if ( HIBYTE(v10->unknownData[1]) )
        {
          if ( !v12 )
          {
            v1 = IGfxEngine::BeginWriteToSurface((IGfxEngine *)g_pGfxEngine, *v11, &v5);
            v8 = v1;
            if ( !v1 )
              return (char)v1;
            v12 = 1;
          }
          DrawControl((char *)v8, v5, v11[3], v11[4], v10);
          if ( !IsTextControl(v10->controlType) )
            HIBYTE(v10->unknownData[1]) = 0;
        }
        v10 = (struct SGuiControl *)((char *)v10 + 36);
      }
      if ( v12 )
      {
        IGfxEngine::EndWriteToSurface((IGfxEngine *)g_pGfxEngine, *v11);
        v12 = 0;
      }
      v10 = v3;
      hdc = 0;
      for ( j = 0; ; ++j )
      {
        LOBYTE(v1) = (_BYTE)v11;
        if ( j >= v11[6] )
          break;
        if ( HIBYTE(v10->unknownData[1]) && IsTextControl(v10->controlType) )
        {
          if ( !v12 )
          {
            if ( !IGfxEngine::GetGuiSurfaceDC((IGfxEngine *)g_pGfxEngine, *v11, &hdc) )
            {
              BBSupportTracePrintF(0, "GUI ENGINE: Can't get text DC.");
              continue;
            }
            SetBkMode(hdc, 1);
            v12 = 1;
          }
          DrawControlText(hdc, (int)v10);
          HIBYTE(v10->unknownData[1]) = 0;
        }
        v10 = (struct SGuiControl *)((char *)v10 + 36);
      }
      if ( v12 )
      {
        LOBYTE(v1) = IGfxEngine::ReleaseGuiSurfaceDC((IGfxEngine *)g_pGfxEngine, *v11, hdc);
        v12 = 0;
      }
    }
  }
  return (char)v1;
}


// address=[0x2f9e2c0]
// Decompiled from signed int __cdecl CalcCharWidths(signed int a1)
void __cdecl CalcCharWidths(struct SGuiControl * a1) {
  
  signed int result; // eax
  tagSIZE psizl; // [esp+4h] [ebp-48h] BYREF
  HGDIOBJ h; // [esp+Ch] [ebp-40h]
  signed int v4; // [esp+10h] [ebp-3Ch]
  signed int i; // [esp+14h] [ebp-38h]
  unsigned __int8 *Source; // [esp+18h] [ebp-34h]
  HDC hdc; // [esp+1Ch] [ebp-30h]
  CHAR String[40]; // [esp+20h] [ebp-2Ch] BYREF

  result = a1;
  if ( *(char *)(a1 + 25) < 0 )
    return result;
  result = j___mbstrlen((const char *)&g_mbstrTextTable[75 * *(char *)(a1 + 25)]);
  v4 = result;
  if ( result < 1 )
    return result;
  hdc = CreateCompatibleDC(0);
  if ( hdc )
  {
    h = SelectObject(hdc, g_hFonts[*(unsigned __int8 *)(a1 + 26)]);
    Source = (unsigned __int8 *)&g_mbstrTextTable[75 * *(char *)(a1 + 25)];
    for ( i = 0; i < v4; ++i )
    {
      j___mbsncpy((unsigned __int8 *)String, Source, 1u);
      Source = j___mbsninc(Source, 1u);
      if ( (*(_BYTE *)(a1 + 13) & 0x80) != 0 )
        GetTextExtentPoint32A(hdc, "*", 1, &psizl);
      else
        GetTextExtentPoint32A(hdc, String, 1, &psizl);
      g_iEditWidthTable[i] = psizl.cx;
    }
    SelectObject(hdc, h);
    return DeleteDC(hdc);
  }
  else
  {
    return BBSupportTracePrintF(0, "GUI ENGINE: No DC available!");
  }
  return result;
}


// address=[0x2f9e430]
// Decompiled from char __cdecl SelectEditControl(struct SGuiControl *a1, int a2)
bool __cdecl SelectEditControl(struct SGuiControl * a1, int a2) {
  
  int v3; // [esp+0h] [ebp-1Ch]
  int v4; // [esp+4h] [ebp-18h]
  int i; // [esp+8h] [ebp-14h]
  char *String; // [esp+Ch] [ebp-10h]
  size_t v7; // [esp+10h] [ebp-Ch]
  int v8; // [esp+14h] [ebp-8h]
  int v9; // [esp+14h] [ebp-8h]

  CalcCharWidths((signed int)a1);
  v4 = sub_2F9E930(a1->unknownId);
  v8 = a1->x + *(unsigned __int16 *)(v4 + 2) + 2;
  String = (char *)j___mbsninc(
                     (const unsigned __int8 *)&g_mbstrTextTable[75 * (char)a1->id],
                     LOBYTE(a1->unknownData[1]));
  v7 = j___mbstrlen(String);
  HIBYTE(a1->unknownData[0]) = a1->unknownData[1];
  for ( i = HIBYTE(a1->unknownData[0]); ; ++i )
  {
    v3 = v7--;
    if ( v3 <= 0 || a2 <= v8 )
      break;
    ++HIBYTE(a1->unknownData[0]);
    v8 += g_iEditWidthTable[i];
  }
  if ( HIBYTE(a1->unknownData[0]) && a2 < v8 - dword_471F81C[HIBYTE(a1->unknownData[0])] / 2 )
    --HIBYTE(a1->unknownData[0]);
  SetControlState(a1, 64, 1);
  dword_3E2F124 = 3;
  SetControlState(a1, 128, 1);
  HIBYTE(a1->unknownData[1]) = 1;
  v9 = a1->x + *(unsigned __int16 *)(v4 + 2) + 2;
  if ( a2 < a1->x + *(unsigned __int16 *)(v4 + 2) + 32 )
    DoScrolling(a1, 0);
  if ( a2 > v9 + a1->width - 32 )
    DoScrolling(a1, 1);
  return 1;
}


// address=[0x2f9e5e0]
// Decompiled from char __cdecl IsValidInput(int a1, char a2)
bool __cdecl IsValidInput(int a1, int a2) {
  
  char result; // al

  if ( a1 >= 48 && a1 <= 57 && (a2 & 5) != 0 )
    return 1;
  if ( (a1 >= 65 && a1 <= 90 || a1 >= 97 && a1 <= 122) && (a2 & 6) != 0 )
    return 1;
  if ( (a1 == 43 || a1 == 95 || a1 == 45 || a1 == 32) && (a2 & 4) != 0 )
    return 1;
  switch ( a1 )
  {
    case '!':
    case '"':
    case '#':
    case '(':
    case ')':
    case '*':
    case '+':
    case ',':
    case '-':
    case '.':
    case '/':
    case ':':
    case ';':
    case '=':
    case '?':
    case '_':
      if ( (a2 & 8) == 0 )
        goto IsValidInput___def_339E66B;
      result = 1;
      break;
    default:
IsValidInput___def_339E66B:
      if ( a1 == 32 && (a2 & 0x10) != 0 )
      {
        result = 1;
      }
      else
      {
        switch ( a1 )
        {
          case 196:
          case 214:
          case 220:
          case 223:
          case 228:
          case 246:
          case 252:
            if ( (a2 & 0x20) == 0 )
              goto IsValidInput___def_339E6B2;
            result = 1;
            break;
          default:
IsValidInput___def_339E6B2:
            result = 0;
            break;
        }
      }
      break;
  }
  return result;
}


// address=[0x2f9fe90]
// Decompiled from int GetGuiInterfaceVersion()
unsigned int __cdecl GetGuiInterfaceVersion(void) {
  
  return 120;
}


// address=[0x2fa2f90]
// Decompiled from char __cdecl CalcTextSize(int a1, const unsigned __int8 *a2, LPSIZE psizl, size_t Count, int a5)
bool __cdecl CalcTextSize(int a1, char * a2, struct tagSIZE & psizl, int Count, int a5) {
  
  HGDIOBJ h; // [esp+0h] [ebp-14h]
  unsigned __int8 *c; // [esp+4h] [ebp-10h]
  int v8; // [esp+8h] [ebp-Ch]
  HDC hdc; // [esp+Ch] [ebp-8h]
  const char *lpString; // [esp+10h] [ebp-4h]

  hdc = CreateCompatibleDC(0);
  if ( hdc )
  {
    lpString = (const char *)a2;
    if ( Count )
      lpString = (const char *)j___mbsninc(a2, Count);
    v8 = j___mbstrlen(lpString);
    if ( a5 >= 0 && a5 < v8 )
      v8 = a5;
    c = (unsigned __int8 *)(j___mbsninc((const unsigned __int8 *)lpString, v8) - (unsigned __int8 *)lpString);
    h = SelectObject(hdc, g_hFonts[a1]);
    GetTextExtentPoint32A(hdc, lpString, (int)c, psizl);
    SelectObject(hdc, h);
    DeleteDC(hdc);
    return 1;
  }
  else
  {
    BBSupportTracePrintF(0, "GUI ENGINE: No DC available!");
    return 0;
  }
}


// address=[0x2fa4040]
// Decompiled from int InitTables()
void __cdecl InitTables(void) {
  
  int result; // eax
  int i; // [esp+0h] [ebp-4h]
  int j; // [esp+0h] [ebp-4h]
  int k; // [esp+0h] [ebp-4h]

  for ( i = 0; i < 32; ++i )
  {
    byte_47272D0[i] = i;
    if ( i + 4 * i / 10 <= 31 )
      byte_47272D0[i] += 4 * i / 10;
    else
      byte_47272D0[i] = 31;
    result = i + 1;
  }
  for ( j = 0; j < 64; ++j )
  {
    byte_47272F0[j] = j;
    if ( j + 4 * j / 10 <= 63 )
      byte_47272F0[j] += 4 * j / 10;
    else
      byte_47272F0[j] = 63;
    result = j + 1;
  }
  for ( k = 0; k < 96; ++k )
  {
    byte_4727330[k] = k / 3;
    result = k + 1;
  }
  return result;
}


// address=[0x2fa4150]
// [Decompilation failed for void __cdecl FastBlit(void *,int,int,int,int,int,void *,int,int,int)]

// address=[0x2fa4300]
// Decompiled from unsigned __int64 __cdecl FastBlit8Bit(  char *a1,  int a2,  int a3,  int a4,  int a5,  int a6,  char *a7,  int a8,  int a9,  int a10,  _WORD *a11)
void __cdecl FastBlit8Bit(void * a1, int a2, int a3, int a4, int a5, int a6, void * a7, int a8, int a9, int a10, void * a11) {
  
  char *v11; // esi
  char *v12; // edi
  int v13; // eax
  int v14; // edx
  int v15; // ebx
  int v16; // ecx
  int v17; // ecx
  int v18; // ecx
  int v19; // ecx
  int v20; // ecx
  int v21; // ecx
  int v22; // ecx
  int v23; // ecx
  int v24; // ecx
  int v25; // ecx
  int v26; // ecx
  int v27; // ecx
  bool v28; // cc
  int v29; // ebx
  int v30; // ebx
  int v31; // ebx
  int v32; // ebx
  int v33; // ebx
  int v34; // ebx
  int v35; // ebx

  dword_47274C8 = (int)a1;
  dword_47274CC = a2;
  dword_47274D0 = a3;
  dword_47274D4 = a4;
  dword_47274D8 = a5;
  dword_47274DC = a6;
  dword_47274E0 = (int)a7;
  dword_47274E4 = a8;
  dword_47274E8 = a9;
  dword_47274EC = a10;
  dword_47274C4 = (int)a11;
  v11 = &a1[a2 * a4 + a3];
  v12 = &a7[2 * a9 + a8 * a10];
  dword_47274F0 = (int)v11;
  dword_47274F4 = (int)v12;
  v13 = 0;
  v14 = 0;
  do
  {
    v15 = dword_47274D8;
    if ( dword_47274D8 >= 16 )
    {
      do
      {
        LOBYTE(v13) = v11[1];
        LOBYTE(v14) = *v11;
        v16 = *(_DWORD *)&a11[v13 - 1];
        LOWORD(v16) = a11[v14];
        *(_DWORD *)v12 = v16;
        LOBYTE(v13) = v11[3];
        LOBYTE(v14) = v11[2];
        v17 = *(_DWORD *)&a11[v13 - 1];
        LOWORD(v17) = a11[v14];
        *((_DWORD *)v12 + 1) = v17;
        LOBYTE(v13) = v11[5];
        LOBYTE(v14) = v11[4];
        v18 = *(_DWORD *)&a11[v13 - 1];
        LOWORD(v18) = a11[v14];
        *((_DWORD *)v12 + 2) = v18;
        LOBYTE(v13) = v11[7];
        LOBYTE(v14) = v11[6];
        v19 = *(_DWORD *)&a11[v13 - 1];
        LOWORD(v19) = a11[v14];
        *((_DWORD *)v12 + 3) = v19;
        v15 -= 16;
        LOBYTE(v13) = v11[9];
        LOBYTE(v14) = v11[8];
        v20 = *(_DWORD *)&a11[v13 - 1];
        LOWORD(v20) = a11[v14];
        *((_DWORD *)v12 + 4) = v20;
        LOBYTE(v13) = v11[11];
        LOBYTE(v14) = v11[10];
        v21 = *(_DWORD *)&a11[v13 - 1];
        LOWORD(v21) = a11[v14];
        *((_DWORD *)v12 + 5) = v21;
        LOBYTE(v13) = v11[13];
        LOBYTE(v14) = v11[12];
        v22 = *(_DWORD *)&a11[v13 - 1];
        LOWORD(v22) = a11[v14];
        *((_DWORD *)v12 + 6) = v22;
        LOBYTE(v13) = v11[15];
        LOBYTE(v14) = v11[14];
        v23 = *(_DWORD *)&a11[v13 - 1];
        LOWORD(v23) = a11[v14];
        *((_DWORD *)v12 + 7) = v23;
        v11 += 16;
        v12 += 32;
      }
      while ( v15 >= 16 );
      if ( v15 < 8 )
        goto LABEL_8;
    }
    else if ( dword_47274D8 < 8 )
    {
      goto LABEL_8;
    }
    do
    {
      LOBYTE(v13) = v11[1];
      LOBYTE(v14) = *v11;
      v24 = *(_DWORD *)&a11[v13 - 1];
      LOWORD(v24) = a11[v14];
      *(_DWORD *)v12 = v24;
      LOBYTE(v13) = v11[3];
      LOBYTE(v14) = v11[2];
      v25 = *(_DWORD *)&a11[v13 - 1];
      LOWORD(v25) = a11[v14];
      *((_DWORD *)v12 + 1) = v25;
      v15 -= 8;
      LOBYTE(v13) = v11[5];
      LOBYTE(v14) = v11[4];
      v26 = *(_DWORD *)&a11[v13 - 1];
      LOWORD(v26) = a11[v14];
      *((_DWORD *)v12 + 2) = v26;
      LOBYTE(v13) = v11[7];
      LOBYTE(v14) = v11[6];
      v27 = *(_DWORD *)&a11[v13 - 1];
      LOWORD(v27) = a11[v14];
      *((_DWORD *)v12 + 3) = v27;
      v11 += 8;
      v12 += 16;
    }
    while ( v15 >= 8 );
LABEL_8:
    v28 = v15 < 1;
    v29 = v15 - 1;
    if ( !v28 )
    {
      LOBYTE(v13) = *v11;
      *(_WORD *)v12 = a11[v13];
      v28 = v29 < 1;
      v30 = v29 - 1;
      if ( !v28 )
      {
        LOBYTE(v13) = v11[1];
        *((_WORD *)v12 + 1) = a11[v13];
        v28 = v30 < 1;
        v31 = v30 - 1;
        if ( !v28 )
        {
          LOBYTE(v13) = v11[2];
          *((_WORD *)v12 + 2) = a11[v13];
          v28 = v31 < 1;
          v32 = v31 - 1;
          if ( !v28 )
          {
            LOBYTE(v13) = v11[3];
            *((_WORD *)v12 + 3) = a11[v13];
            v28 = v32 < 1;
            v33 = v32 - 1;
            if ( !v28 )
            {
              LOBYTE(v13) = v11[4];
              *((_WORD *)v12 + 4) = a11[v13];
              v28 = v33 < 1;
              v34 = v33 - 1;
              if ( !v28 )
              {
                LOBYTE(v13) = v11[5];
                *((_WORD *)v12 + 5) = a11[v13];
                v28 = v34 < 1;
                v35 = v34 - 1;
                if ( !v28 )
                {
                  LOBYTE(v13) = v11[6];
                  *((_WORD *)v12 + 6) = a11[v13];
                  if ( v35 >= 1 )
                  {
                    LOBYTE(v13) = v11[7];
                    *((_WORD *)v12 + 7) = a11[v13];
                  }
                }
              }
            }
          }
        }
      }
    }
    v11 = (char *)(dword_47274CC + dword_47274F0);
    v12 = (char *)(dword_47274E4 + dword_47274F4);
    dword_47274F0 += dword_47274CC;
    v28 = dword_47274DC <= 1;
    dword_47274F4 += dword_47274E4;
    --dword_47274DC;
  }
  while ( !v28 );
  return __PAIR64__(a9, a10);
}


// address=[0x2fa4580]
// [Decompilation failed for void __cdecl UnpackGfx(void *,void *,void *,int,int,int)]

// address=[0x2fa4990]
// Decompiled from unsigned __int64 __cdecl UnpackGfxTransparent(_WORD *a1, int a2, int a3, int a4, int a5, int a6)
void __cdecl UnpackGfxTransparent(void * a1, void * a2, void * a3, int a4, int a5, int a6) {
  
  _BYTE *v6; // esi
  int v7; // edi
  int v8; // edx
  int v9; // ecx
  int v10; // eax
  unsigned int v11; // ebx
  unsigned int v12; // ebx
  int v13; // edx
  int v14; // edi
  int v16; // [esp-24h] [ebp-30h]

  dword_4727414 = (int)a1;
  dword_4727400 = a3;
  dword_4727404 = a2;
  dword_4727408 = a4;
  dword_472740C = a5;
  dword_4727410 = a6;
  v6 = (_BYTE *)a2;
  v7 = a3;
  v8 = -1;
  v9 = a5;
  v10 = 0;
  while ( 1 )
  {
    while ( 1 )
    {
      LOBYTE(v10) = *v6++;
      if ( (unsigned __int8)v10 <= 1u )
        break;
      ++v8;
      --v9;
      *(_WORD *)(v7 + 2 * v8) = a1[v10];
      if ( !v9 )
        goto LABEL_10;
    }
    if ( (_BYTE)v10 != 1 )
    {
      v11 = (unsigned __int8)*v6++;
      if ( v11 > v9 )
      {
        v11 -= v9;
        v8 = -1;
        v9 = dword_472740C;
        v7 += dword_4727408;
      }
      v8 += v11;
      v9 -= v11;
      goto LABEL_9;
    }
    v12 = (unsigned __int8)*v6;
    if ( !*v6 )
      return __PAIR64__(a6, a4);
    ++v6;
    v13 = v8 + 1;
    v9 -= v12;
    if ( v12 >= 0x10 )
    {
      v16 = v7;
      v14 = v7 + 2 * v13;
      if ( (v14 & 3) != 0 )
      {
        do
        {
          *(_WORD *)v14 = 0;
          *(_DWORD *)(v14 + 2) = 0;
          *(_DWORD *)(v14 + 6) = 0;
          *(_DWORD *)(v14 + 10) = 0;
          *(_DWORD *)(v14 + 14) = 0;
          *(_DWORD *)(v14 + 18) = 0;
          *(_DWORD *)(v14 + 22) = 0;
          *(_DWORD *)(v14 + 26) = 0;
          *(_WORD *)(v14 + 30) = 0;
          v12 -= 16;
          v14 += 32;
          v13 += 16;
        }
        while ( v12 >= 0x10 );
        v7 = v16;
        if ( !v12 )
          goto LABEL_8;
      }
      else
      {
        do
        {
          *(_DWORD *)v14 = 0;
          *(_DWORD *)(v14 + 4) = 0;
          *(_DWORD *)(v14 + 8) = 0;
          *(_DWORD *)(v14 + 12) = 0;
          *(_DWORD *)(v14 + 16) = 0;
          *(_DWORD *)(v14 + 20) = 0;
          *(_DWORD *)(v14 + 24) = 0;
          *(_DWORD *)(v14 + 28) = 0;
          v12 -= 16;
          v14 += 32;
          v13 += 16;
        }
        while ( v12 >= 0x10 );
        v7 = v16;
        if ( !v12 )
          goto LABEL_8;
      }
    }
    do
    {
      *(_WORD *)(v7 + 2 * v13++) = 0;
      --v12;
    }
    while ( v12 );
LABEL_8:
    v8 = v13 - 1;
LABEL_9:
    if ( v9 <= 0 )
    {
LABEL_10:
      v7 += dword_4727408;
      v9 = dword_472740C;
      v8 = -1;
    }
  }
}


// address=[0x2fa4b30]
// Decompiled from unsigned __int64 __cdecl UnpackGfxTransparentHiLight555(_WORD *a1, int a2, int a3, int a4, int a5, int a6)
void __cdecl UnpackGfxTransparentHiLight555(void * a1, void * a2, void * a3, int a4, int a5, int a6) {
  
  _BYTE *v6; // esi
  int v7; // edi
  int v8; // edx
  int v9; // ecx
  int v10; // eax
  __int16 v11; // bx
  int v12; // eax
  int v13; // edx
  int v14; // ebx
  unsigned int v15; // ebx
  unsigned int v16; // ebx
  int v17; // edx
  int v18; // edi
  int v20; // [esp-24h] [ebp-30h]
  int v21; // [esp-24h] [ebp-30h]

  dword_472742C = (int)a1;
  dword_4727418 = a3;
  dword_472741C = a2;
  dword_4727420 = a4;
  dword_4727424 = a5;
  dword_4727428 = a6;
  v6 = (_BYTE *)a2;
  v7 = a3;
  v8 = -1;
  v9 = a5;
  v10 = 0;
  while ( 1 )
  {
    while ( 1 )
    {
      LOBYTE(v10) = *v6++;
      if ( (unsigned __int8)v10 <= 1u )
        break;
      v20 = v8 + 1;
      v11 = a1[v10];
      v12 = (unsigned __int16)(v11 & 0x7C00) >> 10;
      v13 = (unsigned __int16)(v11 & 0x3E0) >> 5;
      v14 = v11 & 0x1F;
      LOBYTE(v12) = byte_47272D0[v12];
      LOBYTE(v13) = byte_47272D0[v13];
      LOBYTE(v14) = byte_47272D0[v14];
      LOWORD(v14) = 32 * v13 + ((_WORD)v12 << 10) + v14;
      v8 = v20;
      v10 = 0;
      --v9;
      *(_WORD *)(v7 + 2 * v20) = v14;
      if ( !v9 )
        goto LABEL_10;
    }
    if ( (_BYTE)v10 != 1 )
    {
      v15 = (unsigned __int8)*v6++;
      if ( v15 > v9 )
      {
        v15 -= v9;
        v8 = -1;
        v9 = dword_4727424;
        v7 += dword_4727420;
      }
      v8 += v15;
      v9 -= v15;
      goto LABEL_9;
    }
    v16 = (unsigned __int8)*v6;
    if ( !*v6 )
      return __PAIR64__(a6, a4);
    ++v6;
    v17 = v8 + 1;
    v9 -= v16;
    if ( v16 >= 0x10 )
    {
      v21 = v7;
      v18 = v7 + 2 * v17;
      if ( (v18 & 3) != 0 )
      {
        do
        {
          *(_WORD *)v18 = 0;
          *(_DWORD *)(v18 + 2) = 0;
          *(_DWORD *)(v18 + 6) = 0;
          *(_DWORD *)(v18 + 10) = 0;
          *(_DWORD *)(v18 + 14) = 0;
          *(_DWORD *)(v18 + 18) = 0;
          *(_DWORD *)(v18 + 22) = 0;
          *(_DWORD *)(v18 + 26) = 0;
          *(_WORD *)(v18 + 30) = 0;
          v16 -= 16;
          v18 += 32;
          v17 += 16;
        }
        while ( v16 >= 0x10 );
        v7 = v21;
        if ( !v16 )
          goto LABEL_8;
      }
      else
      {
        do
        {
          *(_DWORD *)v18 = 0;
          *(_DWORD *)(v18 + 4) = 0;
          *(_DWORD *)(v18 + 8) = 0;
          *(_DWORD *)(v18 + 12) = 0;
          *(_DWORD *)(v18 + 16) = 0;
          *(_DWORD *)(v18 + 20) = 0;
          *(_DWORD *)(v18 + 24) = 0;
          *(_DWORD *)(v18 + 28) = 0;
          v16 -= 16;
          v18 += 32;
          v17 += 16;
        }
        while ( v16 >= 0x10 );
        v7 = v21;
        if ( !v16 )
          goto LABEL_8;
      }
    }
    do
    {
      *(_WORD *)(v7 + 2 * v17++) = 0;
      --v16;
    }
    while ( v16 );
LABEL_8:
    v8 = v17 - 1;
LABEL_9:
    if ( v9 <= 0 )
    {
LABEL_10:
      v7 += dword_4727420;
      v9 = dword_4727424;
      v8 = -1;
    }
  }
}


// address=[0x2fa4d10]
// Decompiled from unsigned __int64 __cdecl UnpackGfxTransparentHiLight565(_WORD *a1, int a2, int a3, int a4, int a5, int a6)
void __cdecl UnpackGfxTransparentHiLight565(void * a1, void * a2, void * a3, int a4, int a5, int a6) {
  
  _BYTE *v6; // esi
  int v7; // edi
  int v8; // edx
  int v9; // ecx
  int v10; // eax
  __int16 v11; // bx
  int v12; // eax
  int v13; // edx
  int v14; // ebx
  unsigned int v15; // ebx
  unsigned int v16; // ebx
  int v17; // edx
  int v18; // edi
  int v20; // [esp-24h] [ebp-30h]
  int v21; // [esp-24h] [ebp-30h]

  dword_4727444 = (int)a1;
  dword_4727430 = a3;
  dword_4727434 = a2;
  dword_4727438 = a4;
  dword_472743C = a5;
  dword_4727440 = a6;
  v6 = (_BYTE *)a2;
  v7 = a3;
  v8 = -1;
  v9 = a5;
  v10 = 0;
  while ( 1 )
  {
    while ( 1 )
    {
      LOBYTE(v10) = *v6++;
      if ( (unsigned __int8)v10 <= 1u )
        break;
      v20 = v8 + 1;
      v11 = a1[v10];
      v12 = (unsigned __int16)(v11 & 0xF800) >> 11;
      v13 = (unsigned __int16)(v11 & 0x7E0) >> 5;
      v14 = v11 & 0x1F;
      LOBYTE(v12) = byte_47272D0[v12];
      LOBYTE(v13) = byte_47272F0[v13];
      LOBYTE(v14) = byte_47272D0[v14];
      LOWORD(v14) = ((_WORD)v12 << 11) + 32 * v13 + v14;
      v8 = v20;
      v10 = 0;
      --v9;
      *(_WORD *)(v7 + 2 * v20) = v14;
      if ( !v9 )
        goto LABEL_10;
    }
    if ( (_BYTE)v10 != 1 )
    {
      v15 = (unsigned __int8)*v6++;
      if ( v15 > v9 )
      {
        v15 -= v9;
        v8 = -1;
        v9 = dword_472743C;
        v7 += dword_4727438;
      }
      v8 += v15;
      v9 -= v15;
      goto LABEL_9;
    }
    v16 = (unsigned __int8)*v6;
    if ( !*v6 )
      return __PAIR64__(a6, a4);
    ++v6;
    v17 = v8 + 1;
    v9 -= v16;
    if ( v16 >= 0x10 )
    {
      v21 = v7;
      v18 = v7 + 2 * v17;
      if ( (v18 & 3) != 0 )
      {
        do
        {
          *(_WORD *)v18 = 0;
          *(_DWORD *)(v18 + 2) = 0;
          *(_DWORD *)(v18 + 6) = 0;
          *(_DWORD *)(v18 + 10) = 0;
          *(_DWORD *)(v18 + 14) = 0;
          *(_DWORD *)(v18 + 18) = 0;
          *(_DWORD *)(v18 + 22) = 0;
          *(_DWORD *)(v18 + 26) = 0;
          *(_WORD *)(v18 + 30) = 0;
          v16 -= 16;
          v18 += 32;
          v17 += 16;
        }
        while ( v16 >= 0x10 );
        v7 = v21;
        if ( !v16 )
          goto LABEL_8;
      }
      else
      {
        do
        {
          *(_DWORD *)v18 = 0;
          *(_DWORD *)(v18 + 4) = 0;
          *(_DWORD *)(v18 + 8) = 0;
          *(_DWORD *)(v18 + 12) = 0;
          *(_DWORD *)(v18 + 16) = 0;
          *(_DWORD *)(v18 + 20) = 0;
          *(_DWORD *)(v18 + 24) = 0;
          *(_DWORD *)(v18 + 28) = 0;
          v16 -= 16;
          v18 += 32;
          v17 += 16;
        }
        while ( v16 >= 0x10 );
        v7 = v21;
        if ( !v16 )
          goto LABEL_8;
      }
    }
    do
    {
      *(_WORD *)(v7 + 2 * v17++) = 0;
      --v16;
    }
    while ( v16 );
LABEL_8:
    v8 = v17 - 1;
LABEL_9:
    if ( v9 <= 0 )
    {
LABEL_10:
      v7 += dword_4727438;
      v9 = dword_472743C;
      v8 = -1;
    }
  }
}


// address=[0x2fa4ef0]
// Decompiled from unsigned __int64 __cdecl UnpackGfxTransparentGrayed555(_WORD *a1, int a2, int a3, int a4, int a5, int a6)
void __cdecl UnpackGfxTransparentGrayed555(void * a1, void * a2, void * a3, int a4, int a5, int a6) {
  
  _BYTE *v6; // esi
  int v7; // edi
  int v8; // edx
  int v9; // ecx
  int v10; // eax
  int v11; // ebx
  unsigned int v12; // ebx
  unsigned int v13; // ebx
  int v14; // edx
  int v15; // edi
  int v17; // [esp-24h] [ebp-30h]

  dword_472745C = (int)a1;
  dword_4727448 = a3;
  dword_472744C = a2;
  dword_4727450 = a4;
  dword_4727454 = a5;
  dword_4727458 = a6;
  v6 = (_BYTE *)a2;
  v7 = a3;
  v8 = -1;
  v9 = a5;
  v10 = 0;
  while ( 1 )
  {
    while ( 1 )
    {
      LOBYTE(v10) = *v6++;
      if ( (unsigned __int8)v10 <= 1u )
        break;
      v11 = ((unsigned __int16)(a1[v10] & 0x3E0) >> 5) + ((unsigned __int16)(a1[v10] & 0x7C00) >> 10) + (a1[v10] & 0x1F);
      LOBYTE(v11) = byte_4727330[v11];
      ++v8;
      v10 = 0;
      --v9;
      *(_WORD *)(v7 + 2 * v8) = 1057 * v11;
      if ( !v9 )
        goto LABEL_10;
    }
    if ( (_BYTE)v10 != 1 )
    {
      v12 = (unsigned __int8)*v6++;
      if ( v12 > v9 )
      {
        v12 -= v9;
        v8 = -1;
        v9 = dword_4727454;
        v7 += dword_4727450;
      }
      v8 += v12;
      v9 -= v12;
      goto LABEL_9;
    }
    v13 = (unsigned __int8)*v6;
    if ( !*v6 )
      return __PAIR64__(a6, a4);
    ++v6;
    v14 = v8 + 1;
    v9 -= v13;
    if ( v13 >= 0x10 )
    {
      v17 = v7;
      v15 = v7 + 2 * v14;
      if ( (v15 & 3) != 0 )
      {
        do
        {
          *(_WORD *)v15 = 0;
          *(_DWORD *)(v15 + 2) = 0;
          *(_DWORD *)(v15 + 6) = 0;
          *(_DWORD *)(v15 + 10) = 0;
          *(_DWORD *)(v15 + 14) = 0;
          *(_DWORD *)(v15 + 18) = 0;
          *(_DWORD *)(v15 + 22) = 0;
          *(_DWORD *)(v15 + 26) = 0;
          *(_WORD *)(v15 + 30) = 0;
          v13 -= 16;
          v15 += 32;
          v14 += 16;
        }
        while ( v13 >= 0x10 );
        v7 = v17;
        if ( !v13 )
          goto LABEL_8;
      }
      else
      {
        do
        {
          *(_DWORD *)v15 = 0;
          *(_DWORD *)(v15 + 4) = 0;
          *(_DWORD *)(v15 + 8) = 0;
          *(_DWORD *)(v15 + 12) = 0;
          *(_DWORD *)(v15 + 16) = 0;
          *(_DWORD *)(v15 + 20) = 0;
          *(_DWORD *)(v15 + 24) = 0;
          *(_DWORD *)(v15 + 28) = 0;
          v13 -= 16;
          v15 += 32;
          v14 += 16;
        }
        while ( v13 >= 0x10 );
        v7 = v17;
        if ( !v13 )
          goto LABEL_8;
      }
    }
    do
    {
      *(_WORD *)(v7 + 2 * v14++) = 0;
      --v13;
    }
    while ( v13 );
LABEL_8:
    v8 = v14 - 1;
LABEL_9:
    if ( v9 <= 0 )
    {
LABEL_10:
      v7 += dword_4727450;
      v9 = dword_4727454;
      v8 = -1;
    }
  }
}


// address=[0x2fa50c0]
// Decompiled from unsigned __int64 __cdecl UnpackGfxTransparentGrayed565(_WORD *a1, int a2, int a3, int a4, int a5, int a6)
void __cdecl UnpackGfxTransparentGrayed565(void * a1, void * a2, void * a3, int a4, int a5, int a6) {
  
  _BYTE *v6; // esi
  int v7; // edi
  int v8; // edx
  int v9; // ecx
  int v10; // eax
  int v11; // ebx
  unsigned int v12; // ebx
  unsigned int v13; // ebx
  int v14; // edx
  int v15; // edi
  int v17; // [esp-24h] [ebp-30h]

  dword_4727474 = (int)a1;
  dword_4727460 = a3;
  dword_4727464 = a2;
  dword_4727468 = a4;
  dword_472746C = a5;
  dword_4727470 = a6;
  v6 = (_BYTE *)a2;
  v7 = a3;
  v8 = -1;
  v9 = a5;
  v10 = 0;
  while ( 1 )
  {
    while ( 1 )
    {
      LOBYTE(v10) = *v6++;
      if ( (unsigned __int8)v10 <= 1u )
        break;
      v11 = ((unsigned __int16)(a1[v10] & 0x7E0) >> 6) + ((unsigned __int16)(a1[v10] & 0xF800) >> 11) + (a1[v10] & 0x1F);
      LOBYTE(v11) = byte_4727330[v11];
      ++v8;
      v10 = 0;
      --v9;
      *(_WORD *)(v7 + 2 * v8) = 2113 * v11;
      if ( !v9 )
        goto LABEL_10;
    }
    if ( (_BYTE)v10 != 1 )
    {
      v12 = (unsigned __int8)*v6++;
      if ( v12 > v9 )
      {
        v12 -= v9;
        v8 = -1;
        v9 = dword_472746C;
        v7 += dword_4727468;
      }
      v8 += v12;
      v9 -= v12;
      goto LABEL_9;
    }
    v13 = (unsigned __int8)*v6;
    if ( !*v6 )
      return __PAIR64__(a6, a4);
    ++v6;
    v14 = v8 + 1;
    v9 -= v13;
    if ( v13 >= 0x10 )
    {
      v17 = v7;
      v15 = v7 + 2 * v14;
      if ( (v15 & 3) != 0 )
      {
        do
        {
          *(_WORD *)v15 = 0;
          *(_DWORD *)(v15 + 2) = 0;
          *(_DWORD *)(v15 + 6) = 0;
          *(_DWORD *)(v15 + 10) = 0;
          *(_DWORD *)(v15 + 14) = 0;
          *(_DWORD *)(v15 + 18) = 0;
          *(_DWORD *)(v15 + 22) = 0;
          *(_DWORD *)(v15 + 26) = 0;
          *(_WORD *)(v15 + 30) = 0;
          v13 -= 16;
          v15 += 32;
          v14 += 16;
        }
        while ( v13 >= 0x10 );
        v7 = v17;
        if ( !v13 )
          goto LABEL_8;
      }
      else
      {
        do
        {
          *(_DWORD *)v15 = 0;
          *(_DWORD *)(v15 + 4) = 0;
          *(_DWORD *)(v15 + 8) = 0;
          *(_DWORD *)(v15 + 12) = 0;
          *(_DWORD *)(v15 + 16) = 0;
          *(_DWORD *)(v15 + 20) = 0;
          *(_DWORD *)(v15 + 24) = 0;
          *(_DWORD *)(v15 + 28) = 0;
          v13 -= 16;
          v15 += 32;
          v14 += 16;
        }
        while ( v13 >= 0x10 );
        v7 = v17;
        if ( !v13 )
          goto LABEL_8;
      }
    }
    do
    {
      *(_WORD *)(v7 + 2 * v14++) = 0;
      --v13;
    }
    while ( v13 );
LABEL_8:
    v8 = v14 - 1;
LABEL_9:
    if ( v9 <= 0 )
    {
LABEL_10:
      v7 += dword_4727468;
      v9 = dword_472746C;
      v8 = -1;
    }
  }
}


// address=[0x2fa5290]
// Decompiled from unsigned __int64 __cdecl FastRectangle(unsigned __int16 *a1, int a2, int a3, int a4, int a5, int a6, __int16 a7)
void __cdecl FastRectangle(unsigned short * a1, int a2, int a3, int a4, int a5, int a6, unsigned short a7) {
  
  unsigned int v7; // edx
  __int16 *v8; // edi
  __int16 *v9; // ebx
  __int16 *v10; // esi
  __int16 *v11; // edi
  int v12; // edx
  unsigned __int64 v15; // [esp-20h] [ebp-2Ch]

  dword_4727484 = a4;
  dword_4727488 = a6;
  HIWORD(v7) = HIWORD(a3);
  dword_472748C = a3;
  dword_4727490 = a5;
  dword_472747C = a2;
  LOWORD(v7) = a7;
  word_4727478 = a7;
  dword_4727480 = (int)a1;
  v15 = __PAIR64__(v7, (unsigned int)a1);
  v8 = (__int16 *)((char *)a1 + a2 * a4 + dword_472748C + dword_472748C);
  v9 = v8;
  v10 = (__int16 *)((char *)a1 + a2 * a4 + a5 + a5);
  do
    *v8++ = a7;
  while ( (int)v8 <= (int)v10 );
  v11 = v9;
  v12 = dword_4727488 - dword_4727484;
  if ( dword_4727488 == dword_4727484 )
    return v15;
  do
  {
    v10 = (__int16 *)((char *)v10 + dword_472747C);
    v11 = (__int16 *)((char *)v11 + dword_472747C);
    *v11 = a7;
    *v10 = a7;
  }
  while ( v12-- > 1 );
  do
    *++v11 = a7;
  while ( (int)v11 < (int)v10 );
  return v15;
}


// address=[0x2fa5350]
// Decompiled from unsigned __int64 __cdecl FastHLine(unsigned __int16 *a1, int a2, int a3, int a4, int a5, __int16 a6)
void __cdecl FastHLine(unsigned short * a1, int a2, int a3, int a4, int a5, unsigned short a6) {
  
  __int16 *v6; // edi
  __int16 *v7; // esi

  dword_47274A0 = a4;
  dword_47274A4 = a3;
  dword_47274A8 = a5;
  dword_4727498 = a2;
  word_4727494 = a6;
  dword_472749C = (int)a1;
  v6 = (__int16 *)((char *)a1 + a2 * a4 + dword_47274A4 + dword_47274A4);
  v7 = &v6[a5 - a3];
  do
    *v6++ = a6;
  while ( (int)v6 <= (int)v7 );
  return __PAIR64__((unsigned int)a1, a2);
}


// address=[0x2fa53e0]
// Decompiled from unsigned __int64 __cdecl FastVLine(unsigned __int16 *a1, int a2, int a3, int a4, int a5, __int16 a6)
void __cdecl FastVLine(unsigned short * a1, int a2, int a3, int a4, int a5, unsigned short a6) {
  
  __int16 *v6; // edi
  int v7; // edx

  dword_47274BC = a4;
  dword_47274C0 = a5;
  dword_47274B8 = a3;
  dword_47274B0 = a2;
  word_47274AC = a6;
  dword_47274B4 = (int)a1;
  v6 = (__int16 *)((char *)a1 + a2 * a4 + dword_47274B8 + dword_47274B8);
  v7 = a5 - a4;
  do
  {
    *v6 = a6;
    v6 = (__int16 *)((char *)v6 + dword_47274B0);
  }
  while ( v7-- > 1 );
  return __PAIR64__((unsigned int)a1, a2);
}


// address=[0x2fa5470]
// Decompiled from unsigned __int64 __cdecl FastRaster(void *a1, int a2, int a3, int a4, int a5, int a6, int a7)
void __cdecl FastRaster(void * a1, int a2, int a3, int a4, int a5, int a6, int a7) {
  
  _WORD *v7; // edi
  int v8; // eax
  int v9; // esi
  int v10; // ebx
  bool v11; // cc
  int v12; // ebx
  int v13; // ebx
  int v14; // ebx
  int v15; // ebx
  int v16; // ebx
  int v17; // ebx
  int v18; // ebx
  unsigned __int64 v20; // [esp-20h] [ebp-2Ch]

  dword_4727508 = a3;
  dword_472750C = a4;
  dword_4727510 = a7;
  dword_47274F8 = a5;
  dword_47274FC = a6;
  dword_4727500 = (int)a1 + 2 * a4 * (a2 / 2) + 2 * a3;
  dword_4727504 = a2;
  v20 = __PAIR64__(dword_4727500, a2);
  v7 = (_WORD *)dword_4727500;
  dword_4727514 = dword_4727500;
  v8 = a6;
  v9 = 0;
  if ( (dword_4727500 & 2) != 0 )
    v9 = -1;
  do
  {
    v10 = dword_47274F8;
    if ( v9 )
    {
      v10 = dword_47274F8 - 1;
      ++v7;
    }
    if ( v10 >= 16 )
    {
      do
      {
        *v7 = a7;
        v7[2] = a7;
        v7[4] = a7;
        v7[6] = a7;
        v10 -= 16;
        v7[8] = a7;
        v7[10] = a7;
        v7[12] = a7;
        v7[14] = a7;
        v7 += 16;
      }
      while ( v10 >= 16 );
      if ( v10 < 8 )
        goto LABEL_11;
    }
    else if ( v10 < 8 )
    {
      goto LABEL_11;
    }
    do
    {
      *v7 = a7;
      v7[2] = a7;
      v10 -= 8;
      v7[4] = a7;
      v7[6] = a7;
      v7 += 8;
    }
    while ( v10 >= 8 );
LABEL_11:
    v11 = v10 < 1;
    v12 = v10 - 1;
    if ( !v11 )
    {
      *v7 = a7;
      v11 = v12 < 2;
      v13 = v12 - 2;
      if ( !v11 )
      {
        v7[2] = a7;
        v11 = v13 < 2;
        v14 = v13 - 2;
        if ( !v11 )
        {
          v7[4] = a7;
          v11 = v14 < 2;
          v15 = v14 - 2;
          if ( !v11 )
          {
            v7[6] = a7;
            v11 = v15 < 2;
            v16 = v15 - 2;
            if ( !v11 )
            {
              v7[4] = a7;
              v11 = v16 < 2;
              v17 = v16 - 2;
              if ( !v11 )
              {
                v7[5] = a7;
                v11 = v17 < 2;
                v18 = v17 - 2;
                if ( !v11 )
                {
                  v7[6] = a7;
                  if ( v18 >= 2 )
                    v7[7] = a7;
                }
              }
            }
          }
        }
      }
    }
    v9 = ~v9;
    v7 = (_WORD *)(dword_4727504 + dword_4727514);
    dword_4727514 += dword_4727504;
    v11 = v8-- <= 1;
  }
  while ( !v11 );
  return v20;
}


// address=[0x2fa55c0]
// Decompiled from unsigned __int64 __cdecl FastRasterSolid(void *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8)
void __cdecl FastRasterSolid(void * a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8) {
  
  _WORD *v8; // edi
  int v9; // eax
  int v10; // esi
  __int16 v11; // cx
  int v12; // ebx
  int v13; // edx
  bool v14; // cc
  int v15; // ebx
  int v16; // ebx
  int v17; // ebx
  int v18; // ebx
  int v19; // ebx
  int v20; // ebx
  int v21; // ebx

  dword_4727528 = a3;
  dword_472752C = a4;
  dword_4727530 = a7;
  dword_4727534 = a8;
  dword_4727518 = a5;
  dword_472751C = a6;
  dword_4727520 = (int)a1 + 2 * a4 * (a2 / 2) + 2 * a3;
  dword_4727524 = a2;
  v8 = (_WORD *)dword_4727520;
  dword_4727538 = dword_4727520;
  v9 = a6;
  v10 = 0;
  if ( (dword_4727520 & 2) != 0 )
    v10 = -1;
  if ( (dword_472752C & 1) == 0 )
    v10 = ~v10;
  dword_4727540 = a7;
  dword_472753C = a8;
  do
  {
    v11 = dword_472753C;
    v12 = dword_4727518 - 1;
    v13 = dword_4727540;
    dword_4727540 = dword_472753C;
    dword_472753C = v13;
    if ( dword_4727518 - 1 >= 16 )
    {
      do
      {
        *v8 = v11;
        v8[1] = v13;
        v8[2] = v11;
        v8[3] = v13;
        v8[4] = v11;
        v8[5] = v13;
        v8[6] = v11;
        v8[7] = v13;
        v12 -= 16;
        v8[8] = v11;
        v8[9] = v13;
        v8[10] = v11;
        v8[11] = v13;
        v8[12] = v11;
        v8[13] = v13;
        v8[14] = v11;
        v8[15] = v13;
        v8 += 16;
      }
      while ( v12 >= 16 );
      if ( v12 < 8 )
        goto LABEL_12;
    }
    else if ( v12 < 8 )
    {
      goto LABEL_12;
    }
    do
    {
      *v8 = v11;
      v8[1] = v13;
      v8[2] = v11;
      v8[3] = v13;
      v12 -= 8;
      v8[4] = v11;
      v8[5] = v13;
      v8[6] = v11;
      v8[7] = v13;
      v8 += 8;
    }
    while ( v12 >= 8 );
LABEL_12:
    v14 = v12 < 1;
    v15 = v12 - 1;
    if ( !v14 )
    {
      *v8 = v11;
      v14 = v15 < 1;
      v16 = v15 - 1;
      if ( !v14 )
      {
        v8[1] = v13;
        v14 = v16 < 1;
        v17 = v16 - 1;
        if ( !v14 )
        {
          v8[2] = v11;
          v14 = v17 < 1;
          v18 = v17 - 1;
          if ( !v14 )
          {
            v8[3] = v13;
            v14 = v18 < 1;
            v19 = v18 - 1;
            if ( !v14 )
            {
              v8[4] = v11;
              v14 = v19 < 1;
              v20 = v19 - 1;
              if ( !v14 )
              {
                v8[5] = v13;
                v14 = v20 < 1;
                v21 = v20 - 1;
                if ( !v14 )
                {
                  v8[6] = v11;
                  if ( v21 >= 1 )
                    v8[7] = v13;
                }
              }
            }
          }
        }
      }
    }
    v10 = ~v10;
    v8 = (_WORD *)(dword_4727524 + dword_4727538);
    dword_4727538 += dword_4727524;
    v14 = v9-- <= 1;
  }
  while ( !v14 );
  return __PAIR64__(a2, a3);
}


// address=[0x2fbbdb0]
// Decompiled from unsigned int __cdecl CalcChecksumOfFile(HANDLE hFile, _DWORD *a2)
unsigned long __cdecl CalcChecksumOfFile(void * hFile, int * a2) {
  
  DWORD NumberOfBytesRead; // [esp+0h] [ebp-18h] BYREF
  unsigned int v4; // [esp+4h] [ebp-14h]
  void *C; // [esp+8h] [ebp-10h]
  void *v6; // [esp+Ch] [ebp-Ch]
  DWORD nNumberOfBytesToRead; // [esp+10h] [ebp-8h]
  LPVOID lpBuffer; // [esp+14h] [ebp-4h]

  *a2 = 0;
  SetFilePointer(hFile, 0, 0, 0);
  nNumberOfBytesToRead = GetFileSize(hFile, 0);
  v6 = operator new[](nNumberOfBytesToRead);
  lpBuffer = v6;
  if ( v6 )
  {
    ReadFile(hFile, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0);
    v4 = Crc((unsigned __int8 *)lpBuffer + 8, nNumberOfBytesToRead - 8);
    C = lpBuffer;
    operator delete[](lpBuffer);
    return v4;
  }
  else
  {
    *a2 = 1;
    return 0;
  }
}


// address=[0x2fbbe50]
// [Decompilation failed for int __cdecl GetMapAccessInterfaceVersion(void)]

// address=[0x2fbbe60]
// Decompiled from _DWORD *__cdecl MA_OpenMapFile(OLECHAR *psz, _DWORD *a2, _DWORD *a3, int a4)
void __cdecl MA_OpenMapFile(wchar_t * psz, int * a2, int * a3, int a4) {
  
  _DWORD *result; // eax
  const CHAR *v5; // eax
  unsigned int v6; // [esp+1CCh] [ebp-A0h]
  int v7[5]; // [esp+1E4h] [ebp-88h] BYREF
  void *v8; // [esp+1F8h] [ebp-74h]
  void *v9; // [esp+1FCh] [ebp-70h]
  void *v10; // [esp+200h] [ebp-6Ch]
  void *v11; // [esp+204h] [ebp-68h]
  void *v12; // [esp+208h] [ebp-64h]
  void *v13; // [esp+20Ch] [ebp-60h]
  void *v14; // [esp+210h] [ebp-5Ch]
  void *v15; // [esp+214h] [ebp-58h]
  void *C; // [esp+218h] [ebp-54h]
  void *v17; // [esp+21Ch] [ebp-50h]
  int v18; // [esp+220h] [ebp-4Ch]
  int v19; // [esp+224h] [ebp-48h] BYREF
  int v20; // [esp+228h] [ebp-44h]
  int Buffer; // [esp+22Ch] [ebp-40h] BYREF
  DWORD NumberOfBytesRead; // [esp+230h] [ebp-3Ch] BYREF
  int TeamData; // [esp+234h] [ebp-38h]
  _BYTE v24[4]; // [esp+238h] [ebp-34h] BYREF
  HANDLE hFile; // [esp+23Ch] [ebp-30h]
  LPVOID lpBuffer; // [esp+240h] [ebp-2Ch]
  int v27; // [esp+244h] [ebp-28h] BYREF
  DWORD nNumberOfBytesToRead; // [esp+248h] [ebp-24h]
  size_t Size; // [esp+24Ch] [ebp-20h]
  int v30; // [esp+250h] [ebp-1Ch]
  int v31; // [esp+254h] [ebp-18h]
  int v32; // [esp+258h] [ebp-14h]
  int v33; // [esp+268h] [ebp-4h]

  ReleaseMemory();
  InitVariables();
  g_bBuildingsAvailable = 0;
  g_bPilesAvailable = 0;
  g_bSettlersAvailable = 0;
  if ( g_bMapIsLoaded )
  {
    result = a3;
    *a3 = 7;
    return result;
  }
  g_bAddOnMap = 0;
  g_bEditorMap = 0;
  g_bCampaign = 0;
  *a2 = 0;
  _bstr_t::_bstr_t(psz);
  v33 = 0;
  lpBuffer = operator new[](0x40018u);
  if ( !lpBuffer )
  {
    *a3 = 2;
    v33 = -1;
    return (_DWORD *)_bstr_t::~_bstr_t(v24);
  }
  v17 = operator new[](0x2001u);
  g_pTextDescription = v17;
  if ( !v17 )
  {
    C = lpBuffer;
    operator delete[](lpBuffer);
    lpBuffer = 0;
    *a3 = 2;
    v33 = -1;
    return (_DWORD *)_bstr_t::~_bstr_t(v24);
  }
  memset(g_pTextDescription, 0, 0x2001u);
  v15 = operator new[](0x2001u);
  g_pTextEnglishDescription = v15;
  if ( !v15 )
  {
    v14 = lpBuffer;
    operator delete[](lpBuffer);
    v13 = g_pTextDescription;
    operator delete[](g_pTextDescription);
    lpBuffer = 0;
    g_pTextDescription = 0;
    *a3 = 2;
    v33 = -1;
    return (_DWORD *)_bstr_t::~_bstr_t(v24);
  }
  memset(g_pTextEnglishDescription, 0, 0x2001u);
  v12 = operator new[](0x2001u);
  g_pTextTandT = v12;
  if ( !v12 )
  {
    v11 = lpBuffer;
    operator delete[](lpBuffer);
    v10 = g_pTextDescription;
    operator delete[](g_pTextDescription);
    v9 = g_pTextEnglishDescription;
    operator delete[](g_pTextEnglishDescription);
    lpBuffer = 0;
    g_pTextDescription = 0;
    g_pTextEnglishDescription = 0;
    *a3 = 2;
    v33 = -1;
    return (_DWORD *)_bstr_t::~_bstr_t(v24);
  }
  memset(g_pTextTandT, 0, 0x2001u);
  v8 = operator new[](0x2001u);
  g_pTextEnglishTandT = v8;
  if ( !v8 )
  {
    v7[4] = (int)lpBuffer;
    operator delete[](lpBuffer);
    v7[3] = (int)g_pTextDescription;
    operator delete[](g_pTextDescription);
    v7[2] = (int)g_pTextEnglishDescription;
    operator delete[](g_pTextEnglishDescription);
    v7[1] = (int)g_pTextTandT;
    operator delete[](g_pTextTandT);
    lpBuffer = 0;
    g_pTextDescription = 0;
    g_pTextEnglishDescription = 0;
    g_pTextTandT = 0;
    *a3 = 2;
    v33 = -1;
    return (_DWORD *)_bstr_t::~_bstr_t(v24);
  }
  memset(g_pTextEnglishTandT, 0, 0x2001u);
  v5 = (const CHAR *)_bstr_t::operator char const *(v24);
  hFile = CreateFileA(v5, 0x80000000, 1u, 0, 3u, 0x80u, 0);
  if ( hFile == (HANDLE)-1 )
  {
    operator delete[](lpBuffer);
    operator delete[](g_pTextDescription);
    operator delete[](g_pTextEnglishDescription);
    operator delete[](g_pTextTandT);
    operator delete[](g_pTextEnglishTandT);
    lpBuffer = 0;
    g_pTextDescription = 0;
    g_pTextEnglishDescription = 0;
    g_pTextTandT = 0;
    g_pTextEnglishTandT = 0;
    *a3 = 5;
    v33 = -1;
    return (_DWORD *)_bstr_t::~_bstr_t(v24);
  }
  else
  {
    ReadFile(hFile, &Buffer, 4u, &NumberOfBytesRead, 0);
    *a2 = Buffer;
    if ( !a4 )
      goto LABEL_19;
    v6 = CalcChecksumOfFile(hFile, v7);
    if ( v7[0] )
    {
LABEL_16:
      CloseHandle(hFile);
      operator delete[](lpBuffer);
      operator delete[](g_pTextDescription);
      operator delete[](g_pTextEnglishDescription);
      operator delete[](g_pTextTandT);
      operator delete[](g_pTextEnglishTandT);
      lpBuffer = 0;
      g_pTextDescription = 0;
      g_pTextEnglishDescription = 0;
      g_pTextTandT = 0;
      g_pTextEnglishTandT = 0;
      *a3 = 2;
      v33 = -1;
      return (_DWORD *)_bstr_t::~_bstr_t(v24);
    }
    if ( v6 == Buffer )
    {
LABEL_19:
      SetFilePointer(hFile, 4, 0, 0);
      ReadFile(hFile, &v19, 4u, &NumberOfBytesRead, 0);
      CPlayerData::Init(&g_cPlayerAndTeamData);
      v20 = v19;
      if ( v19 == 31 || v20 == 40 )
      {
        if ( v19 == 40 )
          g_bAddOnMap = 1;
        while ( 2 )
        {
          TeamData = ReadFile(hFile, &v27, 0x18u, &NumberOfBytesRead, 0);
          Cryption((unsigned __int8 *)&v27, 0x18u);
          if ( TeamData )
          {
            v18 = (unsigned __int16)v27;
            switch ( (__int16)v27 )
            {
              case 0:
                goto LABEL_72;
              case 1:
                TeamData = ReadFile(hFile, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0);
                ReadChunk(lpBuffer, nNumberOfBytesToRead, Size);
                j__memcpy(&g_sGeneralMapData, lpBuffer, 0x18u);
                if ( !TeamData )
                  goto LABEL_46;
                goto LABEL_72;
              case 2:
                TeamData = CPlayerData::Load(lpBuffer, hFile, v27, nNumberOfBytesToRead, Size, v30, v31, v32);
                dword_4727570 = CPlayerData::GetNumberOfPlayers(&g_cPlayerAndTeamData);
                if ( !TeamData )
                  goto LABEL_46;
                goto LABEL_72;
              case 3:
                TeamData = CPlayerData::LoadTeamData(lpBuffer, hFile, v27, nNumberOfBytesToRead, Size, v30, v31, v32);
                if ( !TeamData )
                  goto LABEL_46;
                goto LABEL_72;
              case 4:
                if ( a4 )
                {
                  g_iPreviewSize = v32;
                  if ( v32 < 128 || g_iPreviewSize > 1024 )
                    goto LABEL_46;
                  if ( g_pPreviewGfx )
                    operator delete[](g_pPreviewGfx);
                  g_pPreviewGfx = operator new[](2 * g_iPreviewSize * g_iPreviewSize);
                  if ( !g_pPreviewGfx )
                    goto LABEL_16;
                  TeamData = ReadFile(hFile, g_pPreviewGfx, nNumberOfBytesToRead, &NumberOfBytesRead, 0);
                  ReadChunk(g_pPreviewGfx, nNumberOfBytesToRead, Size);
                  if ( !TeamData )
                    goto LABEL_46;
                }
                else if ( SetFilePointer(hFile, nNumberOfBytesToRead, 0, 1u) == -1 )
                {
                  goto LABEL_59;
                }
LABEL_72:
                if ( (_WORD)v27 )
                  continue;
LABEL_75:
                CloseHandle(hFile);
                operator delete[](lpBuffer);
                g_bMapIsLoaded = 1;
                *a3 = 0;
                v33 = -1;
                result = (_DWORD *)_bstr_t::~_bstr_t(v24);
                break;
              case 5:
                goto LABEL_75;
              case 7:
                g_bSettlersAvailable = 1;
                if ( SetFilePointer(hFile, nNumberOfBytesToRead, 0, 1u) == -1 )
                  goto LABEL_59;
                goto LABEL_72;
              case 8:
                g_bBuildingsAvailable = 1;
                if ( SetFilePointer(hFile, nNumberOfBytesToRead, 0, 1u) == -1 )
                  goto LABEL_59;
                goto LABEL_72;
              case 9:
                g_bPilesAvailable = 1;
                if ( SetFilePointer(hFile, nNumberOfBytesToRead, 0, 1u) == -1 )
                  goto LABEL_59;
                goto LABEL_72;
              case 11:
                TeamData = ReadFile(hFile, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0);
                ReadChunk(lpBuffer, nNumberOfBytesToRead, Size);
                if ( !TeamData )
                  goto LABEL_59;
                j__memcpy(g_pTextDescription, lpBuffer, Size);
                goto LABEL_72;
              case 12:
                TeamData = ReadFile(hFile, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0);
                ReadChunk(lpBuffer, nNumberOfBytesToRead, Size);
                if ( !TeamData )
                  goto LABEL_59;
                j__memcpy(g_pTextTandT, lpBuffer, Size);
                goto LABEL_72;
              case 14:
                TeamData = ReadFile(hFile, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0);
                ReadChunk(lpBuffer, nNumberOfBytesToRead, Size);
                if ( !TeamData )
                  goto LABEL_59;
                j__memcpy(g_pTextEnglishDescription, lpBuffer, Size);
                goto LABEL_72;
              case 15:
                TeamData = ReadFile(hFile, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0);
                ReadChunk(lpBuffer, nNumberOfBytesToRead, Size);
                if ( !TeamData )
                  goto LABEL_59;
                j__memcpy(g_pTextEnglishTandT, lpBuffer, Size);
                goto LABEL_72;
              case 64:
                g_bEditorMap = 1;
                if ( SetFilePointer(hFile, nNumberOfBytesToRead, 0, 1u) == -1 )
                  goto LABEL_59;
                goto LABEL_72;
              case 65:
                g_bCampaign = 1;
                if ( SetFilePointer(hFile, nNumberOfBytesToRead, 0, 1u) == -1 )
                  goto LABEL_59;
                goto LABEL_72;
              case 66:
                TeamData = ReadFile(hFile, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0);
                ReadChunk(lpBuffer, nNumberOfBytesToRead, Size);
                j__memcpy(&g_sEditorInfo, lpBuffer, 0x14u);
                if ( !TeamData )
                  goto LABEL_46;
                goto LABEL_72;
              default:
                if ( SetFilePointer(hFile, nNumberOfBytesToRead, 0, 1u) == -1 )
                  goto LABEL_59;
                goto LABEL_72;
            }
          }
          else
          {
LABEL_46:
            CloseHandle(hFile);
            operator delete[](lpBuffer);
            operator delete[](g_pTextDescription);
            operator delete[](g_pTextEnglishDescription);
            operator delete[](g_pTextTandT);
            operator delete[](g_pTextEnglishTandT);
            lpBuffer = 0;
            g_pTextDescription = 0;
            g_pTextEnglishDescription = 0;
            g_pTextTandT = 0;
            g_pTextEnglishTandT = 0;
            *a3 = 3;
            v33 = -1;
            return (_DWORD *)_bstr_t::~_bstr_t(v24);
          }
          break;
        }
      }
      else
      {
LABEL_59:
        CloseHandle(hFile);
        operator delete[](lpBuffer);
        operator delete[](g_pTextDescription);
        operator delete[](g_pTextEnglishDescription);
        operator delete[](g_pTextTandT);
        operator delete[](g_pTextEnglishTandT);
        lpBuffer = 0;
        g_pTextDescription = 0;
        g_pTextEnglishDescription = 0;
        g_pTextTandT = 0;
        g_pTextEnglishTandT = 0;
        *a3 = 4;
        v33 = -1;
        return (_DWORD *)_bstr_t::~_bstr_t(v24);
      }
    }
    else
    {
      CloseHandle(hFile);
      operator delete[](lpBuffer);
      operator delete[](g_pTextDescription);
      operator delete[](g_pTextEnglishDescription);
      operator delete[](g_pTextTandT);
      operator delete[](g_pTextEnglishTandT);
      lpBuffer = 0;
      g_pTextDescription = 0;
      g_pTextEnglishDescription = 0;
      g_pTextTandT = 0;
      g_pTextEnglishTandT = 0;
      *a3 = 1;
      v33 = -1;
      return (_DWORD *)_bstr_t::~_bstr_t(v24);
    }
  }
  return result;
}


// address=[0x2fbdbf0]
// Decompiled from void MA_CloseMapFile()
void __cdecl MA_CloseMapFile(void) {
  
  ReleaseMemory();
  InitVariables();
}


// address=[0x2fbdc00]
// Decompiled from int *__cdecl MA_IsCampaignMap(int *a1)
void __cdecl MA_IsCampaignMap(int * a1) {
  
  int *result; // eax

  result = a1;
  *a1 = g_bCampaign;
  return result;
}


// address=[0x2fbdc10]
// Decompiled from int *__cdecl MA_IsEditorMap(int *a1)
void __cdecl MA_IsEditorMap(int * a1) {
  
  int *result; // eax

  result = a1;
  *a1 = g_bEditorMap;
  return result;
}


// address=[0x2fbdc20]
// Decompiled from _DWORD *__cdecl sub_33BDC20(_DWORD *a1)
void __cdecl MA_GetNumberOfPlayers(int * a1) {
  
  _DWORD *result; // eax

  result = (_DWORD *)(unsigned __int8)g_bMapIsLoaded;
  if ( g_bMapIsLoaded )
  {
    *a1 = dword_4727570;
  }
  else
  {
    result = a1;
    *a1 = 0;
  }
  return result;
}


// address=[0x2fbdc50]
// Decompiled from int __cdecl MA_GetNumberOfSetups(int *a1)
void __cdecl MA_GetNumberOfSetups(int * a1) {
  
  int result; // eax

  result = (unsigned __int8)g_bMapIsLoaded;
  if ( g_bMapIsLoaded )
  {
    result = CPlayerData::GetNumberOfSetups((CPlayerData *)&g_cPlayerAndTeamData);
    *a1 = result;
  }
  else
  {
    *a1 = 0;
  }
  return result;
}


// address=[0x2fbdc80]
// Decompiled from int __cdecl sub_33BDC80(_DWORD *a1, _DWORD *a2, _DWORD *a3, _DWORD *a4, _DWORD *a5)
void __cdecl MA_GetMapData(int * a1, int * a2, int * a3, int * a4, int * a5) {
  
  int result; // eax

  if ( g_bMapIsLoaded )
  {
    *a1 = dword_4727578;
    *a2 = g_sGeneralMapData;
    result = dword_4727580;
    *a3 = dword_4727580;
    *a4 = dword_4727574;
    if ( g_bSettlersAvailable || g_bBuildingsAvailable )
    {
      result = (int)a5;
      *a5 = 0;
    }
    else
    {
      *a5 = 1;
    }
  }
  else
  {
    *a4 = 0;
    *a3 = 0;
    *a2 = 0;
    *a1 = 0;
    result = (int)a5;
    *a5 = 0;
  }
  return result;
}


// address=[0x2fbdd10]
// Decompiled from wchar_t *__cdecl MA_GetPlayerData(  int a1,  int a2,  int *a3,  int *a4,  int *a5,  wchar_t **a6,  wchar_t **a7,  int *a8,  int *a9,  int *a10)
void __cdecl MA_GetPlayerData(int a1, int a2, int * a3, int * a4, int * a5, wchar_t * * a6, wchar_t * * a7, int * a8, int * a9, int * a10) {
  
  char *NameOfPlayer; // eax
  char *SetupName; // eax
  wchar_t *result; // eax
  WCHAR psz[160]; // [esp+4h] [ebp-284h] BYREF
  WCHAR WideCharStr[160]; // [esp+144h] [ebp-144h] BYREF

  if ( g_bMapIsLoaded
    && a1 > 0
    && a1 <= CPlayerData::GetNumberOfPlayers(&g_cPlayerAndTeamData)
    && a2 >= 0
    && a2 < CPlayerData::GetNumberOfSetups((CPlayerData *)&g_cPlayerAndTeamData) )
  {
    *a3 = CPlayerData::GetRaceOfPlayer((CPlayerData *)&g_cPlayerAndTeamData, a1);
    *a4 = CPlayerData::GetXOfPlayer((CPlayerData *)&g_cPlayerAndTeamData, a1);
    *a5 = CPlayerData::GetYOfPlayer((CPlayerData *)&g_cPlayerAndTeamData, a1);
    *a8 = CPlayerData::GetControlOfPlayer((CPlayerData *)&g_cPlayerAndTeamData, a1, a2);
    *a9 = CPlayerData::GetTeamOfPlayer((CPlayerData *)&g_cPlayerAndTeamData, a1, a2) == 255;
    *a10 = CPlayerData::GetTeamOfPlayer((CPlayerData *)&g_cPlayerAndTeamData, a1, a2);
    NameOfPlayer = CPlayerData::GetNameOfPlayer((CPlayerData *)&g_cPlayerAndTeamData, a1);
    MultiByteToWideChar(0, 1u, NameOfPlayer, -1, WideCharStr, 80);
    SetupName = CPlayerData::GetSetupName((CPlayerData *)&g_cPlayerAndTeamData, a2);
    MultiByteToWideChar(0, 1u, SetupName, -1, psz, 80);
    *a6 = SysAllocString(WideCharStr);
    result = SysAllocString(psz);
    *a7 = result;
  }
  else
  {
    *a9 = *a10;
    *a8 = *a9;
    *a5 = *a8;
    *a4 = *a5;
    *a3 = *a4;
    MultiByteToWideChar(0, 1u, &MultiByteStr, -1, WideCharStr, 80);
    MultiByteToWideChar(0, 1u, &byte_3AD3322, -1, psz, 80);
    *a6 = SysAllocString(WideCharStr);
    result = SysAllocString(psz);
    *a7 = result;
  }
  return result;
}


// address=[0x2fbdf20]
// Decompiled from int *__cdecl MA_GetDataChecksums(int *a1, int *a2)
void __cdecl MA_GetDataChecksums(int * a1, int * a2) {
  
  int *result; // eax

  if ( g_bMapIsLoaded )
  {
    *a1 = (unsigned __int16)word_472755A;
    result = (int *)(unsigned __int16)word_472755C;
    *a2 = (unsigned __int16)word_472755C;
  }
  else
  {
    *a2 = 0;
    result = a1;
    *a1 = 0;
  }
  return result;
}


// address=[0x2fbdf60]
// Decompiled from wchar_t *__cdecl MA_GetDescriptionText(unsigned int a1, wchar_t **a2)
void __cdecl MA_GetDescriptionText(int a1, wchar_t * * a2) {
  
  wchar_t *result; // eax
  const CHAR *lpMultiByteStr; // [esp+4h] [ebp-800Ch]
  WCHAR WideCharStr[16386]; // [esp+8h] [ebp-8008h] BYREF

  lpMultiByteStr = 0;
  if ( g_bMapIsLoaded && a1 < 4 )
  {
    switch ( a1 )
    {
      case 0u:
        lpMultiByteStr = (const CHAR *)g_pTextDescription;
        break;
      case 1u:
        lpMultiByteStr = (const CHAR *)g_pTextTandT;
        break;
      case 2u:
        lpMultiByteStr = (const CHAR *)g_pTextEnglishDescription;
        break;
      case 3u:
        lpMultiByteStr = (const CHAR *)g_pTextEnglishTandT;
        break;
      default:
        break;
    }
  }
  if ( lpMultiByteStr )
    MultiByteToWideChar(0, 1u, lpMultiByteStr, -1, WideCharStr, 0x4000);
  else
    MultiByteToWideChar(0, 1u, byte_3AD3323, -1, WideCharStr, 80);
  result = SysAllocString(WideCharStr);
  *a2 = result;
  return result;
}


// address=[0x2fbe080]
// Decompiled from int *__cdecl MA_GetPreviewMapRawData(int *a1, int *a2, struct tagVARIANT *a3)
void __cdecl MA_GetPreviewMapRawData(int * a1, int * a2, struct tagVARIANT * a3) {
  
  int *result; // eax

  if ( g_pPreviewGfx && g_iPreviewSize )
  {
    *a2 = g_iPreviewSize;
    *a1 = g_iPreviewSize;
    a3->lVal = (LONG)g_pPreviewGfx;
    result = _enc_textbss_begin + 12306;
    a3->vt = 16402;
  }
  else
  {
    a3->lVal = 0;
    a3->vt = 0;
    *a2 = 0;
    result = a1;
    *a1 = 0;
  }
  return result;
}


// address=[0x2fbe0f0]
// Decompiled from int *__cdecl MA_GetMapProperty(int a1, int *a2)
void __cdecl MA_GetMapProperty(int a1, int * a2) {
  
  int *result; // eax
  BOOL v3; // [esp+0h] [ebp-Ch]
  BOOL v4; // [esp+4h] [ebp-8h]

  if ( a1 == 1 )
  {
    v4 = g_bAddOnMap && g_bMapIsLoaded;
    *a2 = v4;
  }
  else if ( a1 == 2 )
  {
    v3 = (dword_4727580 & 0x40) != 0 && g_bMapIsLoaded;
    *a2 = v3;
  }
  else
  {
    *a2 = -1;
  }
  result = a2;
  *a2 = g_bAddOnMap;
  return result;
}


// address=[0x2fbe180]
// Decompiled from void *sub_33BE180()
void __cdecl InitVariables(void) {
  
  g_bMapIsLoaded = 0;
  g_pPreviewGfx = 0;
  g_pTextDescription = 0;
  g_pTextTandT = 0;
  g_pTextEnglishDescription = 0;
  g_pTextEnglishTandT = 0;
  g_iPreviewSize = 256;
  g_bEditorMap = 0;
  g_bAddOnMap = 0;
  g_bCampaign = 0;
  g_bPilesAvailable = 0;
  g_bBuildingsAvailable = 0;
  g_bSettlersAvailable = 0;
  return memset(&g_sEditorInfo, 0, 0x14u);
}


// address=[0x2fbe220]
// Decompiled from int sub_33BE220()
void __cdecl ReleaseMemory(void) {
  
  int result; // eax

  g_bEditorMap = 0;
  result = 0;
  g_bCampaign = 0;
  g_bMapIsLoaded = 0;
  if ( g_pPreviewGfx )
  {
    result = operator delete[](g_pPreviewGfx);
    g_pPreviewGfx = 0;
  }
  if ( g_pTextDescription )
  {
    result = operator delete[](g_pTextDescription);
    g_pTextDescription = 0;
  }
  if ( g_pTextTandT )
  {
    result = operator delete[](g_pTextTandT);
    g_pTextTandT = 0;
  }
  if ( g_pTextEnglishDescription )
  {
    result = operator delete[](g_pTextEnglishDescription);
    g_pTextEnglishDescription = 0;
  }
  if ( !g_pTextEnglishTandT )
    return result;
  result = operator delete[](g_pTextEnglishTandT);
  g_pTextEnglishTandT = 0;
  return result;
}


// address=[0x2fbfeb0]
// Decompiled from unsigned int __cdecl Crc(unsigned __int8 *a1, unsigned int a2)
unsigned int __cdecl Crc(unsigned char *,unsigned long) {
  
  unsigned int NormalCRC; // [esp+0h] [ebp-8h]
  _BYTE v4[4]; // [esp+4h] [ebp-4h] BYREF

  cdm_crc::CRCGenerator<16,32773,0,0,1,1>::CRCGenerator<16,32773,0,0,1,1>(v4);
  cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Process(a1, a2);
  NormalCRC = cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetNormalCRC(v4);
  return NormalCRC >> (32 - cdm_crc::CRCGenerator<16,32773,0,0,1,1>::GetWidth(v4));
}


// address=[0x2fbff00]
// Decompiled from void __cdecl Cryption(unsigned __int8 *a1, unsigned int a2)
void __cdecl Cryption(unsigned char *,unsigned long) {
  
  unsigned int i; // [esp+Ch] [ebp-7Ch]
  _DWORD v3[19]; // [esp+10h] [ebp-78h] BYREF
  _BYTE v4[28]; // [esp+5Ch] [ebp-2Ch] BYREF
  int v5; // [esp+84h] [ebp-4h]

  Cryptor::Cryptor((Cryptor *)v3);
  v5 = 0;
  std::string::string(v4, "01234567890123456789");
  LOBYTE(v5) = 1;
  Cryptor::Set_Key(v3, (int)v4);
  for ( i = 0; i < a2; ++i )
    Cryptor::Transform_Char((Cryptor *)v3, &a1[i]);
  LOBYTE(v5) = 0;
  std::string::~string(v4);
  v5 = -1;
  Cryptor::~Cryptor((Cryptor *)v3);
}


// address=[0x2fbffd0]
// [Decompilation failed for int __cdecl CreateChunk(unsigned short,unsigned short,unsigned int,void *,int)]

// address=[0x2fc0150]
// Decompiled from bool __cdecl ReadChunk(char *Src, int a2, int a3)
bool __cdecl ReadChunk(void * Src, int a2, int a3) {
  
  char *v4; // eax
  char *v5; // [esp+4h] [ebp-24h]
  char *v6; // [esp+8h] [ebp-20h]
  int v7; // [esp+14h] [ebp-14h]
  int v8; // [esp+18h] [ebp-10h]
  char *v9; // [esp+24h] [ebp-4h]

  if ( a3 == -1 )
    return 1;
  if ( a2 <= a3 )
    v4 = (char *)operator new[](a3);
  else
    v4 = (char *)operator new[](a2);
  v9 = v4;
  if ( !v4 )
    return 0;
  if ( a2 <= a3 )
    j__memcpy(v4, Src, a3);
  else
    j__memcpy(v4, Src, a2);
  v8 = j__LZHLCreateDecompressor();
  v5 = &Src[a3];
  v6 = &v9[a2];
  do
    v7 = j__LZHLDecompress(v8, &v5[-a3], &a3, &v6[-a2], &a2);
  while ( a2 && v7 );
  j__LZHLDestroyDecompressor(v8);
  operator delete[](v9);
  return v7 != 0;
}


// address=[0x2fc0340]
// Decompiled from int GetRandomMapGeneratorInterfaceVersion()
int __stdcall GetRandomMapGeneratorInterfaceVersion(void) {
  
  return 5;
}


// address=[0x2fc0350]
// Decompiled from unsigned int __cdecl InitRandomMap(struct IMapGeneratorHost *a1, struct SRandomMapParams *a2)
void __cdecl InitRandomMap(class IMapGeneratorHost * a1, struct SRandomMapParams * a2) {
  
  unsigned int NewValue; // [esp+18h] [ebp-94h]
  int v4; // [esp+50h] [ebp-5Ch]
  int v5; // [esp+54h] [ebp-58h]
  int v6; // [esp+58h] [ebp-54h] BYREF
  int v7; // [esp+5Ch] [ebp-50h] BYREF
  CFeatureGrid *v8; // [esp+60h] [ebp-4Ch]
  void *v9; // [esp+64h] [ebp-48h]
  CMirrorBasicGrid *v10; // [esp+68h] [ebp-44h]
  void *v11; // [esp+6Ch] [ebp-40h]
  CBasicGrid *v12; // [esp+70h] [ebp-3Ch]
  void *v13; // [esp+74h] [ebp-38h]
  CPlayerData *v14; // [esp+78h] [ebp-34h]
  void *v15; // [esp+7Ch] [ebp-30h]
  CRandom16Ex *v16; // [esp+80h] [ebp-2Ch]
  void *v17; // [esp+84h] [ebp-28h]
  __ExceptionPtr *v18; // [esp+88h] [ebp-24h]
  int v19; // [esp+8Ch] [ebp-20h]
  int i; // [esp+90h] [ebp-1Ch]
  int k; // [esp+94h] [ebp-18h]
  int j; // [esp+98h] [ebp-14h]
  int v23; // [esp+9Ch] [ebp-10h]
  int v24; // [esp+A8h] [ebp-4h]

  NewValue = j___controlfp(0xA031Fu, 0x30F031Fu);
  if ( g_pBasicGrid )
  {
    v19 = g_pBasicGrid;
    delete (CBasicGrid *)g_pBasicGrid;
    g_pBasicGrid = 0;
  }
  if ( g_pFeatureGrid )
  {
    v18 = (__ExceptionPtr *)g_pFeatureGrid;
    delete (__ExceptionPtr *)g_pFeatureGrid;
    g_pFeatureGrid = 0;
  }
  if ( g_pPlayerData )
  {
    for ( i = 0; i < (unsigned __int8)g_iNumPlayers; ++i )
    {
      if ( *(_DWORD *)(g_pPlayerData + 4 * i) )
        operator delete(*(void **)(g_pPlayerData + 4 * i));
    }
    operator delete[]((void *)g_pPlayerData);
    g_pPlayerData = 0;
  }
  if ( g_pRand )
  {
    operator delete((void *)g_pRand);
    g_pRand = 0;
  }
  g_pHost = (int)a1;
  (*(void (__thiscall **)(struct IMapGeneratorHost *, int))(*(_DWORD *)a1 + 4))(a1, 512);
  g_pMapElement = (*(int (__thiscall **)(int))(*(_DWORD *)g_pHost + 16))(g_pHost);
  g_iWorldSize = (*(int (__thiscall **)(int))(*(_DWORD *)g_pHost + 12))(g_pHost);
  g_pEditorLayer = (*(int (__thiscall **)(int))(*(_DWORD *)g_pHost + 20))(g_pHost);
  g_iNumPlayers = *((_BYTE *)a2 + 32);
  g_pPlayerData = (int)operator new[](4 * (unsigned __int8)g_iNumPlayers);
  g_iLandMassPercent = *((_DWORD *)a2 + 3) + 9;
  g_uResourceWealth = *((_BYTE *)a2 + 16);
  g_iFlags = *((_DWORD *)a2 + 5);
  g_iRandomSeed = *((_DWORD *)a2 + 1);
  g_bNoObjects = *((_BYTE *)a2 + 37);
  g_uSnowLimit = g_iWorldSize / 15 + 80;
  v17 = operator new(8u);
  v24 = 0;
  if ( v17 )
    v16 = CRandom16Ex::CRandom16Ex((CRandom16Ex *)v17, g_iRandomSeed);
  else
    v16 = 0;
  v24 = -1;
  g_pRand = (int)v16;
  v23 = (int)(sqrt<int>(g_iWorldSize) / 2.0);
  if ( v23 % 4 )
  {
    if ( g_iWorldSize <= 512 )
      v23 -= v23 % 4;
    else
      v23 += 4 - v23 % 4;
  }
  g_iNumRivers = g_iWorldSize / (150 - g_iLandMassPercent) - (unsigned __int8)g_iNumPlayers;
  *(float *)&g_fScaleFactor = (float)(g_iWorldSize - 100) / (float)v23;
  if ( (!g_iNumPlayers || (unsigned __int8)g_iNumPlayers >= 9u)
    && BBSupportDbgReport(2, "MapGen.cpp", 123, "g_iNumPlayers > 0 && g_iNumPlayers < 9") == 1 )
  {
    __debugbreak();
  }
  for ( j = 0; j < (unsigned __int8)g_iNumPlayers; ++j )
  {
    v15 = operator new(0x20u);
    v24 = 1;
    if ( v15 )
      v14 = CPlayerData::CPlayerData((CPlayerData *)v15, *((_DWORD *)a2 + 4 * j + 11), *((_BYTE *)a2 + 16 * j + 48) & 1);
    else
      v14 = 0;
    v24 = -1;
    *(_DWORD *)(g_pPlayerData + 4 * j) = v14;
  }
  if ( (g_iFlags & 1) != 0 || (g_iFlags & 2) != 0 )
  {
    v11 = operator new(0x10u);
    v24 = 3;
    if ( v11 )
      v10 = CMirrorBasicGrid::CMirrorBasicGrid((CMirrorBasicGrid *)v11, v23 / 2, g_iLandMassPercent);
    else
      v10 = 0;
    v24 = -1;
    g_pBasicGrid = (int)v10;
  }
  else
  {
    v13 = operator new(0x10u);
    v24 = 2;
    if ( v13 )
      v12 = CBasicGrid::CBasicGrid((CBasicGrid *)v13, v23 / 2, g_iLandMassPercent);
    else
      v12 = 0;
    v24 = -1;
    g_pBasicGrid = (int)v12;
  }
  (**(void (__thiscall ***)(int))g_pBasicGrid)(g_pBasicGrid);
  v9 = operator new(0x54u);
  v24 = 4;
  if ( v9 )
    v8 = CFeatureGrid::CFeatureGrid((CFeatureGrid *)v9, v23);
  else
    v8 = 0;
  v24 = -1;
  g_pFeatureGrid = (int)v8;
  CFeatureGrid::initGrid(v8);
  for ( k = 0; k < (unsigned __int8)g_iNumPlayers; ++k )
  {
    v7 = 0;
    v6 = 0;
    CPlayerData::getStartPos_Basic(*(CPlayerData **)(g_pPlayerData + 4 * k), &v7, &v6);
    v4 = (int)(float)((float)((float)((float)((float)v7 * *(float *)&g_fScaleFactor) * 2.0) + 50.0)
                    + *(float *)&g_fScaleFactor);
    v5 = (int)(float)((float)((float)((float)((float)v6 * *(float *)&g_fScaleFactor) * 2.0) + 50.0)
                    + *(float *)&g_fScaleFactor);
    CPlayerData::setStartPos_Real(*(CPlayerData **)(g_pPlayerData + 4 * k), v4, v5);
    (*(void (__thiscall **)(int, int, int, int))(*(_DWORD *)g_pHost + 28))(g_pHost, k + 1, v4, v5);
  }
  return j___controlfp(NewValue, 0x30F031Fu);
}


// address=[0x2fc09f0]
// Decompiled from unsigned int __cdecl CreatePreview(struct IMapGeneratorHost *a1, unsigned __int16 *a2, int a3)
void __cdecl CreatePreview(class IMapGeneratorHost * a1, unsigned short * a2, int a3) {
  
  unsigned int v3; // eax
  unsigned int v4; // eax
  unsigned int v5; // eax
  unsigned int v6; // eax
  _BYTE v8[60]; // [esp+8h] [ebp-778h] BYREF
  _BYTE v9[60]; // [esp+44h] [ebp-73Ch] BYREF
  _BYTE v10[60]; // [esp+80h] [ebp-700h] BYREF
  _BYTE v11[60]; // [esp+BCh] [ebp-6C4h] BYREF
  _BYTE v12[60]; // [esp+F8h] [ebp-688h] BYREF
  _BYTE v13[60]; // [esp+134h] [ebp-64Ch] BYREF
  _BYTE v14[60]; // [esp+170h] [ebp-610h] BYREF
  _BYTE v15[60]; // [esp+1ACh] [ebp-5D4h] BYREF
  int Element; // [esp+1E8h] [ebp-598h]
  unsigned int NewValue; // [esp+1ECh] [ebp-594h]
  void *C; // [esp+1F0h] [ebp-590h]
  void *v19; // [esp+1F4h] [ebp-58Ch]
  struct CCheckLayer *v20; // [esp+1F8h] [ebp-588h]
  struct CCheckLayer *v21; // [esp+1FCh] [ebp-584h]
  void *v22; // [esp+200h] [ebp-580h]
  CCheckLayer *v23; // [esp+204h] [ebp-57Ch]
  int v24; // [esp+208h] [ebp-578h]
  struct CCheckLayer *v25; // [esp+20Ch] [ebp-574h]
  void *v26; // [esp+210h] [ebp-570h]
  __int16 v27; // [esp+214h] [ebp-56Ch]
  int v28; // [esp+218h] [ebp-568h]
  int i; // [esp+21Ch] [ebp-564h]
  int ii; // [esp+220h] [ebp-560h]
  int n; // [esp+224h] [ebp-55Ch]
  int v32; // [esp+228h] [ebp-558h]
  int v33; // [esp+22Ch] [ebp-554h]
  unsigned int v34; // [esp+230h] [ebp-550h]
  struct CCheckLayer *v35; // [esp+234h] [ebp-54Ch]
  int v36; // [esp+238h] [ebp-548h]
  int v37; // [esp+23Ch] [ebp-544h]
  int v38; // [esp+240h] [ebp-540h]
  int v39; // [esp+244h] [ebp-53Ch]
  int v40; // [esp+248h] [ebp-538h]
  unsigned __int16 v41; // [esp+24Ch] [ebp-534h]
  unsigned __int16 v42; // [esp+250h] [ebp-530h]
  int Size; // [esp+254h] [ebp-52Ch]
  int m; // [esp+258h] [ebp-528h]
  int j; // [esp+25Ch] [ebp-524h]
  int v46; // [esp+260h] [ebp-520h]
  float v47; // [esp+264h] [ebp-51Ch]
  int v48; // [esp+268h] [ebp-518h]
  int k; // [esp+26Ch] [ebp-514h]
  _BYTE v50[1280]; // [esp+270h] [ebp-510h] BYREF
  int v51; // [esp+77Ch] [ebp-4h]

  NewValue = j___controlfp(0xA031Fu, 0x30F031Fu);
  CRandom16Ex::Init((CRandom16Ex *)g_pRand, g_iRandomSeed, 0);
  g_iPreviewImageSize = a3;
  v48 = 2 * a3;
  CLandscapeColorProperties::CLandscapeColorProperties((CLandscapeColorProperties *)v50);
  v22 = operator new[](2 * v48 * v48);
  g_pPreviewImage = (int)v22;
  v27 = CLandscapeColorProperties::HiColValue((CLandscapeColorProperties *)v50, 7);
  for ( i = 0; i < v48 * v48; ++i )
    *(_WORD *)(g_pPreviewImage + 2 * i) = v27;
  Size = CGrid::getSize((CGrid *)g_pFeatureGrid);
  v47 = (float)(v48 - 40) / (float)Size;
  v34 = (int)(float)(v47 / 8.0);
  v26 = operator new(0xCu);
  v51 = 0;
  if ( v26 )
    v25 = CCheckLayer::CCheckLayer((CCheckLayer *)v26, 256);
  else
    v25 = 0;
  v21 = v25;
  v51 = -1;
  v35 = v25;
  for ( j = 0; j < Size * Size; ++j )
  {
    v39 = (int)(float)((float)((float)(j % Size) * v47) + 20.0);
    v40 = (int)(float)((float)((float)(j / Size) * v47) + 20.0);
    if ( CGrid::getElement((CGrid *)g_pFeatureGrid, j) )
    {
      v41 = CLandscapeColorProperties::HiColValue((CLandscapeColorProperties *)v50, 16);
      Element = CGrid::getElement((CGrid *)g_pFeatureGrid, j);
      v3 = CRandom16::Rand((CRandom16 *)g_pRand);
      v46 = v34 + v3 % v34;
      CPreviewBlob::CPreviewBlob(
        (CPreviewBlob *)v15,
        v39 - v46,
        v40 - v46,
        (int)(float)((float)((float)v39 + v47) + (float)v46),
        (int)(float)((float)((float)v40 + v47) + (float)v46),
        v41,
        20,
        v48,
        v35);
      CBlob::drawBlob((CBlob *)v15);
      v4 = CRandom16::Rand((CRandom16 *)g_pRand);
      v46 = v34 + v4 % v34;
      CPreviewBlob::CPreviewBlob(
        (CPreviewBlob *)v14,
        v39 - v46,
        v46 + v40,
        (int)(float)((float)((float)v39 + v47) + (float)v46),
        (int)(float)((float)((float)v40 + v47) + (float)v46),
        v41,
        20,
        v48,
        v35);
      CBlob::drawBlob((CBlob *)v14);
      v5 = CRandom16::Rand((CRandom16 *)g_pRand);
      v46 = v34 + v5 % v34;
      CPreviewBlob::CPreviewBlob(
        (CPreviewBlob *)v13,
        v46 + v39,
        v40 - v46,
        (int)(float)((float)((float)v39 + v47) + (float)v46),
        (int)(float)((float)((float)v40 + v47) - (float)v46),
        v41,
        20,
        v48,
        v35);
      CBlob::drawBlob((CBlob *)v13);
      v6 = CRandom16::Rand((CRandom16 *)g_pRand);
      v46 = v34 + v6 % v34;
      CPreviewBlob::CPreviewBlob(
        (CPreviewBlob *)v8,
        v46 + v39,
        v46 + v40,
        (int)(float)((float)((float)v39 + v47) + (float)v46),
        (int)(float)((float)((float)v40 + v47) + (float)v46),
        v41,
        20,
        v48,
        v35);
      CBlob::drawBlob((CBlob *)v8);
      CPreviewBlob::CPreviewBlob(
        (CPreviewBlob *)v12,
        v39,
        v40,
        (int)(float)((float)v39 + v47),
        (int)(float)((float)v40 + v47),
        v41,
        20,
        v48,
        v35);
      CBlob::drawBlob((CBlob *)v12);
    }
  }
  for ( j = 0; j < Size * Size; ++j )
  {
    v32 = (int)(float)((float)((float)(j % Size) * v47) + 20.0);
    v33 = (int)(float)((float)((float)(j / Size) * v47) + 20.0);
    if ( CGrid::getElement((CGrid *)g_pFeatureGrid, j) )
    {
      v42 = 0;
      v28 = CGrid::getElement((CGrid *)g_pFeatureGrid, j);
      v24 = v28;
      if ( v28 == 102 )
      {
        v42 = CLandscapeColorProperties::HiColValue((CLandscapeColorProperties *)v50, 32);
      }
      else if ( v24 == 106 )
      {
        v42 = CLandscapeColorProperties::HiColValue((CLandscapeColorProperties *)v50, 64);
      }
      else
      {
        v42 = CLandscapeColorProperties::HiColValue((CLandscapeColorProperties *)v50, 16);
      }
      CPreviewBlob::CPreviewBlob(
        (CPreviewBlob *)v11,
        v32,
        v33,
        (int)(float)((float)v32 + v47),
        (int)(float)((float)v33 + v47),
        v42,
        20,
        v48,
        v35);
      CBlob::drawBlob((CBlob *)v11);
      if ( v28 == 102 && j % Size < Size - 1 && CGrid::getElement((CGrid *)g_pFeatureGrid, j + 1) == 102 )
      {
        CPreviewBlob::CPreviewBlob(
          (CPreviewBlob *)v10,
          (int)(float)((float)v32 + (float)(v47 / 2.0)),
          v33,
          (int)((double)v32 + v47 * 1.5),
          (int)(float)((float)v33 + v47),
          v42,
          20,
          v48,
          v35);
        CBlob::drawBlob((CBlob *)v10);
      }
      if ( v28 == 102 && j < Size * (Size - 1) && CGrid::getElement((CGrid *)g_pFeatureGrid, Size + j) == 102 )
      {
        CPreviewBlob::CPreviewBlob(
          (CPreviewBlob *)v9,
          v32,
          (int)(float)((float)v33 + (float)(v47 / 2.0)),
          (int)(float)((float)v32 + v47),
          (int)((double)v33 + v47 * 1.5),
          v42,
          20,
          v48,
          v35);
        CBlob::drawBlob((CBlob *)v9);
      }
    }
  }
  for ( k = 0; k < g_iPreviewImageSize; ++k )
  {
    for ( m = 0; m < g_iPreviewImageSize; ++m )
    {
      v38 = 0;
      v37 = 0;
      v36 = 0;
      v38 = *(_WORD *)(g_pPreviewImage + 2 * (v48 * 2 * k + 2 * m)) & 0x7C00;
      v37 = *(_WORD *)(g_pPreviewImage + 2 * (v48 * 2 * k + 2 * m)) & 0x3E0;
      v36 = *(_WORD *)(g_pPreviewImage + 2 * (v48 * 2 * k + 2 * m)) & 0x1F;
      v38 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * 2 * k + 2 * m + 1)) & 0x7C00;
      v37 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * 2 * k + 2 * m + 1)) & 0x3E0;
      v36 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * 2 * k + 2 * m + 1)) & 0x1F;
      v38 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * (2 * k + 1) + 2 * m)) & 0x7C00;
      v37 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * (2 * k + 1) + 2 * m)) & 0x3E0;
      v36 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * (2 * k + 1) + 2 * m)) & 0x1F;
      v38 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * (2 * k + 1) + 2 * m + 1)) & 0x7C00;
      v37 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * (2 * k + 1) + 2 * m + 1)) & 0x3E0;
      v36 += *(_WORD *)(g_pPreviewImage + 2 * (v48 * (2 * k + 1) + 2 * m + 1)) & 0x1F;
      a2[m + g_iPreviewImageSize * k] = ((v36 / 4) & 0x1F) + ((v37 / 4) & 0x3E0) + ((v38 / 4) & 0x7C00);
    }
  }
  if ( (g_iFlags & 1) != 0 )
  {
    for ( k = 0; k < g_iPreviewImageSize; ++k )
    {
      for ( n = 0; n < k; ++n )
        a2[k + g_iPreviewImageSize * n] = a2[n + g_iPreviewImageSize * k];
    }
  }
  if ( (g_iFlags & 2) != 0 )
  {
    for ( k = 0; k < g_iPreviewImageSize; ++k )
    {
      for ( ii = 0; ii < g_iPreviewImageSize - k - 1; ++ii )
        a2[g_iPreviewImageSize - k - 1 + g_iPreviewImageSize * (g_iPreviewImageSize - 1 - ii)] = a2[ii + g_iPreviewImageSize * k];
    }
  }
  v20 = v35;
  v23 = v35;
  if ( v35 )
    v19 = delete v23;
  else
    v19 = 0;
  C = (void *)g_pPreviewImage;
  operator delete[]((void *)g_pPreviewImage);
  return j___controlfp(NewValue, 0x30F031Fu);
}


// address=[0x2fc17f0]
// Decompiled from char __cdecl GenerateRandomMap(struct IMapGeneratorHost *a1)
bool __cdecl GenerateRandomMap(class IMapGeneratorHost * a1) {
  
  unsigned int v2; // eax
  unsigned int v3; // eax
  unsigned int v4; // eax
  unsigned int v5; // eax
  unsigned int v6; // eax
  unsigned int v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // eax
  float v10; // xmm0_4
  float v11; // xmm0_4
  int Index; // eax
  int v13; // eax
  char v14; // bl
  unsigned int v15; // eax
  int v16; // eax
  int v17; // eax
  char v18; // bl
  unsigned int v19; // eax
  unsigned int v20; // edx
  int v21; // eax
  int v22; // eax
  unsigned int v23; // eax
  int v24; // [esp-18h] [ebp-10034h]
  int v25; // [esp-14h] [ebp-10030h]
  int v26; // [esp-10h] [ebp-1002Ch]
  int v27; // [esp-8h] [ebp-10024h]
  int v28; // [esp-8h] [ebp-10024h]
  struct CCheckLayer *v29; // [esp-4h] [ebp-10020h]
  struct CCheckLayer *v30; // [esp-4h] [ebp-10020h]
  _BYTE v31[64]; // [esp+Ch] [ebp-10010h] BYREF
  _BYTE v32[64]; // [esp+4Ch] [ebp-FFD0h] BYREF
  _BYTE v33[64]; // [esp+8Ch] [ebp-FF90h] BYREF
  _BYTE v34[64]; // [esp+CCh] [ebp-FF50h] BYREF
  _BYTE v35[64]; // [esp+10Ch] [ebp-FF10h] BYREF
  _BYTE v36[64]; // [esp+14Ch] [ebp-FED0h] BYREF
  _BYTE v37[64]; // [esp+18Ch] [ebp-FE90h] BYREF
  _BYTE v38[64]; // [esp+1CCh] [ebp-FE50h] BYREF
  _BYTE v39[56]; // [esp+20Ch] [ebp-FE10h] BYREF
  _BYTE v40[56]; // [esp+244h] [ebp-FDD8h] BYREF
  _BYTE v41[56]; // [esp+27Ch] [ebp-FDA0h] BYREF
  _BYTE v42[56]; // [esp+2B4h] [ebp-FD68h] BYREF
  _BYTE v43[56]; // [esp+2ECh] [ebp-FD30h] BYREF
  _BYTE v44[56]; // [esp+324h] [ebp-FCF8h] BYREF
  _BYTE v45[56]; // [esp+35Ch] [ebp-FCC0h] BYREF
  _BYTE v46[56]; // [esp+394h] [ebp-FC88h] BYREF
  _BYTE v47[56]; // [esp+3CCh] [ebp-FC50h] BYREF
  _BYTE v48[56]; // [esp+404h] [ebp-FC18h] BYREF
  void *v49[3]; // [esp+43Ch] [ebp-FBE0h] BYREF
  void *v50[3]; // [esp+448h] [ebp-FBD4h] BYREF
  double v51; // [esp+454h] [ebp-FBC8h]
  double v52; // [esp+45Ch] [ebp-FBC0h]
  int v53; // [esp+464h] [ebp-FBB8h]
  float v54; // [esp+468h] [ebp-FBB4h]
  float v55; // [esp+46Ch] [ebp-FBB0h]
  CCheckLayer *v56; // [esp+470h] [ebp-FBACh]
  unsigned int NewValue; // [esp+474h] [ebp-FBA8h]
  int v58; // [esp+478h] [ebp-FBA4h]
  void *C; // [esp+47Ch] [ebp-FBA0h]
  void *v60; // [esp+480h] [ebp-FB9Ch]
  void *v61; // [esp+484h] [ebp-FB98h]
  int v62; // [esp+488h] [ebp-FB94h]
  void *v63; // [esp+48Ch] [ebp-FB90h]
  int v64; // [esp+490h] [ebp-FB8Ch]
  void *v65; // [esp+494h] [ebp-FB88h]
  int v66; // [esp+498h] [ebp-FB84h]
  int v67; // [esp+49Ch] [ebp-FB80h]
  int v68; // [esp+4A0h] [ebp-FB7Ch]
  int v69; // [esp+4A4h] [ebp-FB78h]
  int v70; // [esp+4A8h] [ebp-FB74h]
  CCheckLayer *v71; // [esp+4ACh] [ebp-FB70h]
  CCheckLayer *v72; // [esp+4B0h] [ebp-FB6Ch]
  __ExceptionPtr *v73; // [esp+4B4h] [ebp-FB68h]
  int v74; // [esp+4B8h] [ebp-FB64h]
  int v75; // [esp+4BCh] [ebp-FB60h]
  int v76; // [esp+4C0h] [ebp-FB5Ch] BYREF
  int v77; // [esp+4C4h] [ebp-FB58h] BYREF
  unsigned int v78; // [esp+4C8h] [ebp-FB54h]
  unsigned int v79; // [esp+4CCh] [ebp-FB50h]
  int v80; // [esp+4D0h] [ebp-FB4Ch] BYREF
  int v81; // [esp+4D4h] [ebp-FB48h] BYREF
  int v82; // [esp+4D8h] [ebp-FB44h]
  unsigned int v83; // [esp+4DCh] [ebp-FB40h]
  int v84; // [esp+4E0h] [ebp-FB3Ch]
  unsigned int v85; // [esp+4E4h] [ebp-FB38h]
  int v86; // [esp+4E8h] [ebp-FB34h]
  int v87; // [esp+4ECh] [ebp-FB30h]
  int v88; // [esp+4F0h] [ebp-FB2Ch]
  int j; // [esp+4F4h] [ebp-FB28h]
  int v90; // [esp+4F8h] [ebp-FB24h]
  int v91; // [esp+4FCh] [ebp-FB20h]
  int jj; // [esp+500h] [ebp-FB1Ch]
  int n; // [esp+504h] [ebp-FB18h]
  int v94; // [esp+508h] [ebp-FB14h]
  int v95; // [esp+50Ch] [ebp-FB10h]
  int m; // [esp+510h] [ebp-FB0Ch]
  unsigned int v97; // [esp+514h] [ebp-FB08h]
  int v98; // [esp+518h] [ebp-FB04h]
  int v99; // [esp+51Ch] [ebp-FB00h]
  int ii; // [esp+520h] [ebp-FAFCh]
  int v101; // [esp+524h] [ebp-FAF8h]
  int v102; // [esp+528h] [ebp-FAF4h]
  int k; // [esp+52Ch] [ebp-FAF0h]
  unsigned int v104; // [esp+530h] [ebp-FAECh]
  int v105; // [esp+534h] [ebp-FAE8h]
  int v106; // [esp+538h] [ebp-FAE4h]
  int v107; // [esp+53Ch] [ebp-FAE0h] BYREF
  int v108; // [esp+540h] [ebp-FADCh] BYREF
  int v109; // [esp+544h] [ebp-FAD8h]
  int v110; // [esp+548h] [ebp-FAD4h]
  int v111; // [esp+54Ch] [ebp-FAD0h]
  char v112; // [esp+553h] [ebp-FAC9h]
  int v113; // [esp+554h] [ebp-FAC8h]
  int v114; // [esp+558h] [ebp-FAC4h]
  unsigned int v115; // [esp+55Ch] [ebp-FAC0h]
  char v116; // [esp+562h] [ebp-FABAh]
  unsigned __int8 v117; // [esp+563h] [ebp-FAB9h]
  int Size; // [esp+564h] [ebp-FAB8h]
  unsigned __int8 v119; // [esp+56Ah] [ebp-FAB2h]
  char Element; // [esp+56Bh] [ebp-FAB1h]
  int i; // [esp+56Ch] [ebp-FAB0h]
  _BYTE v122[32032]; // [esp+570h] [ebp-FAACh] BYREF
  _BYTE v123[32032]; // [esp+8290h] [ebp-7D8Ch] BYREF
  _BYTE v124[92]; // [esp+FFB0h] [ebp-6Ch] BYREF
  int v125; // [esp+10018h] [ebp-4h]

  if ( !g_pMapElement )
    return 0;
  NewValue = j___controlfp(0xA031Fu, 0x30F031Fu);
  CRandom16Ex::Init((CRandom16Ex *)g_pRand, g_iRandomSeed, 0);
  g_pHost = (int)a1;
  v72 = (CCheckLayer *)operator new(0xCu);
  v125 = 0;
  if ( v72 )
    v71 = CCheckLayer::CCheckLayer(v72, 256);
  else
    v71 = 0;
  v56 = v71;
  v125 = -1;
  g_pCheckLayer = (int)v71;
  Size = CGrid::getSize((CGrid *)g_pFeatureGrid);
  v106 = Size * Size;
  g_iNumRivers = g_iWorldSize / (150 - g_iLandMassPercent) - (unsigned __int8)g_iNumPlayers;
  *(float *)&g_fScaleFactor = (float)(g_iWorldSize - 100) / (float)Size;
  v115 = (int)(float)(*(float *)&g_fScaleFactor / 2.0);
  v53 = (int)(float)(*(float *)&g_fScaleFactor / 4.0);
  for ( i = 0; i < Size * Size; ++i )
  {
    v109 = (int)(float)((float)((float)(i % Size) * *(float *)&g_fScaleFactor) + 50.0);
    v110 = (int)(float)((float)((float)(i / Size) * *(float *)&g_fScaleFactor) + 50.0);
    if ( (double)g_iWorldSize <= (double)v109 + *(float *)&g_fScaleFactor * 1.5
      && BBSupportDbgReport(2, "MapGen.cpp", 500, "iUpperLeftX + g_fScaleFactor * 1.5 < g_iWorldSize") == 1 )
    {
      __debugbreak();
    }
    if ( (double)g_iWorldSize <= (double)v110 + *(float *)&g_fScaleFactor * 1.5
      && BBSupportDbgReport(2, "MapGen.cpp", 501, "iUpperLeftY + g_fScaleFactor * 1.5 < g_iWorldSize") == 1 )
    {
      __debugbreak();
    }
    if ( CGrid::getElement((CGrid *)g_pFeatureGrid, i) )
    {
      if ( i < Size * (Size - 1)
        && i % Size != Size - 1
        && CGrid::getElement((CGrid *)g_pFeatureGrid, i + 1)
        && CGrid::getElement((CGrid *)g_pFeatureGrid, Size + i) )
      {
        if ( CGrid::getElement((CGrid *)g_pFeatureGrid, i + Size + 1) )
        {
          CLandBlob::CLandBlob(
            (CLandBlob *)v33,
            v115 + v109,
            v115 + v110,
            (int)(float)((float)((float)v109 + *(float *)&g_fScaleFactor) + (float)(int)v115),
            (int)(float)((float)((float)v110 + *(float *)&g_fScaleFactor) + (float)(int)v115),
            1,
            16,
            50,
            g_iWorldSize,
            (struct CCheckLayer *)g_pCheckLayer);
          CBlob::drawBlob((CBlob *)v33);
        }
      }
      v2 = CRandom16::Rand((CRandom16 *)g_pRand);
      v111 = v2 % v115;
      CLandBlob::CLandBlob(
        (CLandBlob *)v32,
        v2 % v115 + v109 - v115,
        v2 % v115 + v110 - v115,
        v2 % v115 + v115 + v109,
        v2 % v115 + v115 + v110,
        1,
        16,
        50,
        g_iWorldSize,
        (struct CCheckLayer *)g_pCheckLayer);
      CBlob::drawBlob((CBlob *)v32);
      v3 = CRandom16::Rand((CRandom16 *)g_pRand);
      v111 = v3 % v115;
      CLandBlob::CLandBlob(
        (CLandBlob *)v31,
        v3 % v115 + v109 - v115,
        v115 + v110 - v3 % v115,
        v3 % v115 + v115 + v109,
        (int)(float)((float)((float)v110 + (float)(*(float *)&g_fScaleFactor * 1.5)) - (float)(int)(v3 % v115)),
        1,
        16,
        50,
        g_iWorldSize,
        (struct CCheckLayer *)g_pCheckLayer);
      CBlob::drawBlob((CBlob *)v31);
      v4 = CRandom16::Rand((CRandom16 *)g_pRand);
      v111 = v4 % v115;
      CLandBlob::CLandBlob(
        (CLandBlob *)v38,
        v115 + v109 - v4 % v115,
        v4 % v115 + v110 - v115,
        (int)(float)((float)((float)v109 + (float)(*(float *)&g_fScaleFactor * 1.5)) - (float)(int)(v4 % v115)),
        v4 % v115 + v115 + v110,
        1,
        16,
        50,
        g_iWorldSize,
        (struct CCheckLayer *)g_pCheckLayer);
      CBlob::drawBlob((CBlob *)v38);
      v5 = CRandom16::Rand((CRandom16 *)g_pRand);
      v111 = v5 % v115;
      CLandBlob::CLandBlob(
        (CLandBlob *)v37,
        v115 + v109 - v5 % v115,
        v115 + v110 - v5 % v115,
        (int)(float)((float)((float)v109 + (float)(*(float *)&g_fScaleFactor * 1.5)) - (float)(int)(v5 % v115)),
        (int)(float)((float)((float)v110 + (float)(*(float *)&g_fScaleFactor * 1.5)) - (float)(int)(v5 % v115)),
        1,
        16,
        50,
        g_iWorldSize,
        (struct CCheckLayer *)g_pCheckLayer);
      CBlob::drawBlob((CBlob *)v37);
      CLandBlob::CLandBlob(
        (CLandBlob *)v36,
        v109,
        v110,
        (int)(float)((float)v109 + *(float *)&g_fScaleFactor),
        (int)(float)((float)v110 + *(float *)&g_fScaleFactor),
        1,
        16,
        50,
        g_iWorldSize,
        (struct CCheckLayer *)g_pCheckLayer);
      CBlob::drawBlob((CBlob *)v36);
    }
  }
  for ( i = 0; i < v106; ++i )
  {
    if ( CGrid::getElement((CGrid *)g_pFeatureGrid, i) == 102 )
    {
      v82 = (int)(float)((float)((float)(i % Size) * *(float *)&g_fScaleFactor) + 50.0);
      v84 = (int)(float)((float)((float)(i / Size) * *(float *)&g_fScaleFactor) + 50.0);
      v85 = 1;
      v70 = 1;
      v83 = 1;
      v86 = 1;
      if ( i - 1 > 0
        && (CGrid::getElement((CGrid *)g_pFeatureGrid, i - 1) == 1
         || CGrid::getElement((CGrid *)g_pFeatureGrid, i - 1) == 102) )
      {
        v83 = (int)(float)(*(float *)&g_fScaleFactor / 2.0);
        if ( CGrid::getElement((CGrid *)g_pFeatureGrid, i - 1) == 1 )
          CGrid::setElement((CGrid *)g_pFeatureGrid, i - 1, 102);
      }
      if ( i - Size > 0
        && (CGrid::getElement((CGrid *)g_pFeatureGrid, i - Size) == 1
         || CGrid::getElement((CGrid *)g_pFeatureGrid, i - Size) == 102) )
      {
        v85 = (int)(float)(*(float *)&g_fScaleFactor / 2.0);
        if ( CGrid::getElement((CGrid *)g_pFeatureGrid, i - Size) == 1 )
          CGrid::setElement((CGrid *)g_pFeatureGrid, i - Size, 102);
      }
      if ( i + 1 < v106 && CGrid::getElement((CGrid *)g_pFeatureGrid, i + 1) == 102 )
      {
        v86 = (int)(float)(*(float *)&g_fScaleFactor / 2.0);
        if ( CGrid::getElement((CGrid *)g_pFeatureGrid, i + 1) == 1 )
          CGrid::setElement((CGrid *)g_pFeatureGrid, i + 1, 102);
      }
      if ( Size + i < v106 && CGrid::getElement((CGrid *)g_pFeatureGrid, Size + i) == 102 )
      {
        v70 = (int)(float)(*(float *)&g_fScaleFactor / 2.0);
        if ( CGrid::getElement((CGrid *)g_pFeatureGrid, Size + i) == 1 )
          CGrid::setElement((CGrid *)g_pFeatureGrid, Size + i, 102);
      }
      v29 = (struct CCheckLayer *)g_pCheckLayer;
      v27 = g_iWorldSize;
      v26 = (int)(float)((float)((float)v84 + *(float *)&g_fScaleFactor) + (float)v70);
      v25 = (int)(float)((float)((float)v82 + *(float *)&g_fScaleFactor) + (float)v86);
      v6 = CRandom16::Rand((CRandom16 *)g_pRand);
      v24 = v84 - v6 % v85;
      v7 = CRandom16::Rand((CRandom16 *)g_pRand);
      CMountainBlob::CMountainBlob((CMountainBlob *)v124, v82 - v7 % v83, v24, v25, v26, 50, v27, v29);
      CBlob::drawBlob((CBlob *)v124);
    }
  }
  for ( i = 0; i < v106; ++i )
  {
    v98 = (int)(float)((float)((float)(i % Size) * *(float *)&g_fScaleFactor) + 50.0);
    v105 = (int)(float)((float)((float)(i / Size) * *(float *)&g_fScaleFactor) + 50.0);
    if ( CGrid::getElement((CGrid *)g_pFeatureGrid, i) == 106 )
    {
      CLandBlob::CLandBlob(
        (CLandBlob *)v35,
        (int)(float)((float)v98 + (float)(*(float *)&g_fScaleFactor / 4.0)),
        (int)(float)((float)v105 + (float)(*(float *)&g_fScaleFactor / 4.0)),
        (int)(float)((float)v98 + *(float *)&g_fScaleFactor),
        (int)(float)((float)v105 + *(float *)&g_fScaleFactor),
        0,
        64,
        50,
        g_iWorldSize,
        (struct CCheckLayer *)g_pCheckLayer);
      CBlob::drawBlob((CBlob *)v35);
    }
    else if ( (CGrid::getElement((CGrid *)g_pFeatureGrid, i) == 1 || CGrid::getElement((CGrid *)g_pFeatureGrid, i) == 104)
           && CRandom16::Rand((CRandom16 *)g_pRand) % 6u > 4 )
    {
      CLandBlob::CLandBlob(
        (CLandBlob *)v34,
        (int)(float)((float)v98 + (float)(*(float *)&g_fScaleFactor / 2.0)),
        (int)(float)((float)v105 + (float)(*(float *)&g_fScaleFactor / 2.0)),
        (int)(float)((float)v98 + *(float *)&g_fScaleFactor),
        (int)(float)((float)v105 + *(float *)&g_fScaleFactor),
        0,
        24,
        50,
        g_iWorldSize,
        (struct CCheckLayer *)g_pCheckLayer);
      CBlob::drawBlob((CBlob *)v34);
    }
  }
  CreateBorder(64, 7, 16);
  CreateBorder(64, 32, 16);
  CreateBorder(24, 7, 16);
  CreateBorder(24, 32, 16);
  CreateBorder(7, 16, 255);
  CreateBorder(7, 255, 254);
  ChangeBorder(255, 48);
  if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pHost + 32))(g_pHost) )
    ChangeBorder(254, 8);
  else
    ChangeBorder(254, 48);
  CreateBorder(32, 16, 17);
  CreateBorder(32, 17, 33);
  if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)g_pHost + 32))(g_pHost) )
    CreateBorder(7, 8, 255);
  else
    CreateBorder(7, 48, 255);
  CreateSpeckledBorder(7, 255, 1);
  CreateSpeckledBorder(7, 1, 2);
  CreateSpeckledBorder(7, 2, 3);
  CreateSpeckledBorder(7, 3, 4);
  CreateSpeckledBorder(7, 4, 5);
  CreateSpeckledBorder(7, 5, 6);
  ChangeBorder(255, 0);
  v99 = (unsigned __int8)g_iNumPlayers;
  if ( (g_iFlags & 1) != 0 && (g_iFlags & 2) != 0 )
  {
    if ( (unsigned __int8)g_iNumPlayers > 4u )
      v99 = 2;
    else
      v99 = 1;
  }
  if ( (g_iFlags & 1) != 0 || (g_iFlags & 2) != 0 )
    v99 = (int)(float)((float)((float)(unsigned __int8)g_iNumPlayers / 2.0) + 0.5);
  for ( i = 0; i < v99; ++i )
  {
    v80 = 0;
    v81 = 0;
    CPlayerData::getStartPos_Basic(*(CPlayerData **)(g_pPlayerData + 4 * i), &v80, &v81);
    CRiver::CRiver((CRiver *)v49, 2 * v80, 2 * v81);
    v125 = 1;
    CRiver::drawRiver((CRiver *)v49);
    v125 = -1;
    CRiver::~CRiver(v49);
  }
  for ( j = 0; j < g_iNumRivers; ++j )
  {
    do
    {
      do
      {
        v8 = CRandom16::Rand((CRandom16 *)g_pRand);
        v104 = v8 % Size;
        v9 = CRandom16::Rand((CRandom16 *)g_pRand);
        v97 = v9 % Size;
      }
      while ( !CGrid::getElement((CGrid *)g_pFeatureGrid, v104, v9 % Size) );
    }
    while ( CGrid::getElement((CGrid *)g_pFeatureGrid, v104, v97) == 102 );
    CRiver::CRiver((CRiver *)v50, v104, v97, 2);
    v125 = 2;
    CRiver::drawRiver((CRiver *)v50);
    v125 = -1;
    CRiver::~CRiver(v50);
  }
  CHexIndices::CHexIndices((CHexIndices *)v123);
  for ( i = 0; i < (unsigned __int8)g_iNumPlayers; ++i )
  {
    for ( k = 0; k < 3; ++k )
    {
      v108 = 0;
      v107 = 0;
      v88 = 0;
      do
      {
        CPlayerData::getNearestMountain(*(CPlayerData **)(g_pPlayerData + 4 * i), &v108, &v107);
        v55 = (float)((float)v108 * *(float *)&g_fScaleFactor) + 50.0;
        v79 = CRandom16::Rand((CRandom16 *)g_pRand) % (unsigned int)(int)*(float *)&g_fScaleFactor;
        v52 = (double)v79;
        v10 = (float)v79;
        v108 = (int)(float)(v55 + v10);
        v54 = (float)((float)v107 * *(float *)&g_fScaleFactor) + 50.0;
        v78 = CRandom16::Rand((CRandom16 *)g_pRand) % (unsigned int)(int)*(float *)&g_fScaleFactor;
        v51 = (double)v78;
        v11 = (float)v78;
        v107 = (int)(float)(v54 + v11);
        ++v88;
      }
      while ( (*(_BYTE *)(g_pMapElement + 4 * (v108 + g_iWorldSize * v107) + 1) != 32
            || *(_BYTE *)(g_pEditorLayer + 4 * (v108 + g_iWorldSize * v107) + 3))
           && v88 < 50 );
      v112 = 0;
      v87 = k;
      if ( k )
      {
        if ( v87 == 1 )
        {
          v112 = 32;
        }
        else if ( v87 == 2 )
        {
          v112 = 80;
        }
      }
      else
      {
        v112 = 16;
      }
      CHexIndices::SetFirst((CHexIndices *)v123);
      for ( m = 0; m < 16; ++m )
      {
        Index = CHexIndices::GetIndex((CHexIndices *)v123);
        v94 = v108 + Index;
        v13 = CHexIndices::GetIndex((CHexIndices *)v123);
        v95 = v107 + v13;
        if ( ValidateMapIndex(v94, v107 + v13) && *(_BYTE *)(g_pMapElement + 4 * (v94 + g_iWorldSize * v95) + 1) == 32 )
        {
          v14 = v112;
          v15 = CRandom16::Rand((CRandom16 *)g_pRand);
          *(_BYTE *)(g_pEditorLayer + 4 * (v94 + g_iWorldSize * v95) + 3) = (g_uResourceWealth
                                                                           + v15
                                                                           % (16
                                                                            - (unsigned int)(unsigned __int8)g_uResourceWealth)) | v14;
        }
      }
    }
  }
  v69 = g_iWorldSize * g_iWorldSize;
  for ( i = 0; i < v69; ++i )
  {
    if ( *(_BYTE *)(g_pMapElement + 4 * i + 1) == 32
      && !(CRandom16::Rand((CRandom16 *)g_pRand) % (250 - 10 * (unsigned int)(unsigned __int8)g_uResourceWealth)) )
    {
      v116 = 1;
      v119 = CRandom16::Rand((CRandom16 *)g_pRand) % 0x14u;
      v117 = 0;
      if ( v119 >= 7u )
      {
        if ( v119 < 0xCu )
        {
          v116 = 32;
          v117 = 24;
        }
      }
      else
      {
        v116 = 16;
        v117 = 48;
      }
      if ( v119 >= 0xCu && v119 < 0xFu )
      {
        v116 = 48;
        v117 = 18;
      }
      if ( v119 >= 0xFu && v119 < 0x11u )
      {
        v116 = 64;
        v117 = 24;
      }
      if ( v119 >= 0x11u && v119 < 0x14u )
      {
        v116 = 80;
        v117 = 24;
      }
      v68 = i % g_iWorldSize;
      v67 = i / g_iWorldSize;
      CHexIndices::SetFirst((CHexIndices *)v123);
      for ( n = 0; n < v117; ++n )
      {
        v16 = CHexIndices::GetIndex((CHexIndices *)v123);
        v101 = v68 + v16;
        v17 = CHexIndices::GetIndex((CHexIndices *)v123);
        v102 = v67 + v17;
        if ( ValidateMapIndex(v101, v67 + v17)
          && *(_BYTE *)(g_pMapElement + 4 * (v101 + g_iWorldSize * v102) + 1) == 32
          && !*(_BYTE *)(g_pEditorLayer + 4 * (v101 + g_iWorldSize * v102) + 3) )
        {
          v18 = v116;
          v19 = CRandom16::Rand((CRandom16 *)g_pRand);
          *(_BYTE *)(g_pEditorLayer + 4 * (v101 + g_iWorldSize * v102) + 3) = (g_uResourceWealth
                                                                             + v19
                                                                             % (16
                                                                              - (unsigned int)(unsigned __int8)g_uResourceWealth)) | v18;
        }
      }
    }
    if ( !*(_BYTE *)(g_pMapElement + 4 * i + 1)
      || *(_BYTE *)(g_pMapElement + 4 * i + 1) == 1
      || *(_BYTE *)(g_pMapElement + 4 * i + 1) == 2
      || *(_BYTE *)(g_pMapElement + 4 * i + 1) == 3
      || *(_BYTE *)(g_pMapElement + 4 * i + 1) == 4
      || *(_BYTE *)(g_pMapElement + 4 * i + 1) == 5
      || *(_BYTE *)(g_pMapElement + 4 * i + 1) == 6 )
    {
      v20 = (unsigned __int8)g_uResourceWealth
          + CRandom16::Rand((CRandom16 *)g_pRand) % (16 - (unsigned int)(unsigned __int8)g_uResourceWealth);
      *(_BYTE *)(g_pEditorLayer + 4 * i + 3) = v20;
    }
  }
  if ( (g_iFlags & 1) != 0 )
    mirrorMapDiag();
  if ( (g_iFlags & 2) != 0 )
    mirrorMapOppDiag();
  repairHeights();
  CreateBorder(128, 32, 35);
  CreateBorder(128, 35, 129);
  CreateSpeckledBorder(24, 16, 25);
  CreateBorder(64, 16, 20);
  CreateSpeckledBorder(64, 20, 65);
  for ( ii = 0; ii < (unsigned __int8)g_iNumPlayers; ++ii )
  {
    v77 = 0;
    v76 = 0;
    CPlayerData::getStartPos_Real(*(CPlayerData **)(g_pPlayerData + 4 * ii), &v77, &v76);
    CHexIndices::CHexIndices((CHexIndices *)v122);
    CHexIndices::SetFirst((CHexIndices *)v122);
    for ( jj = 0; jj < 96; ++jj )
    {
      v21 = CHexIndices::GetIndex((CHexIndices *)v122);
      v90 = v77 + v21;
      v22 = CHexIndices::GetIndex((CHexIndices *)v122);
      v91 = v76 + v22;
      if ( ValidateMapIndex(v90, v76 + v22) )
      {
        *(_BYTE *)(g_pMapElement + 4 * (v90 + g_iWorldSize * v91) + 1) = 16;
        *(_BYTE *)(g_pEditorLayer + 4 * (v90 + g_iWorldSize * v91) + 3) = 0;
      }
    }
  }
  (*(void (__thiscall **)(int))(*(_DWORD *)g_pHost + 8))(g_pHost);
  if ( !g_bNoObjects )
  {
    for ( i = 0; i < v106; ++i )
    {
      v113 = (int)(float)((float)((float)(i % Size) * *(float *)&g_fScaleFactor) + 50.0);
      v114 = (int)(float)((float)((float)(i / Size) * *(float *)&g_fScaleFactor) + 50.0);
      Element = CGrid::getElement((CGrid *)g_pFeatureGrid, i);
      if ( Element == 104 )
      {
        v30 = (struct CCheckLayer *)g_pCheckLayer;
        v28 = g_iWorldSize;
        v23 = CRandom16::Rand((CRandom16 *)g_pRand);
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v42,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          1,
          10,
          v23 % 0x19 + 60,
          16,
          50,
          v28,
          v30);
        CBlob::drawBlob((CBlob *)v42);
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v41,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          174,
          4,
          40,
          16,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v41);
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v40,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          181,
          3,
          5,
          16,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v40);
      }
      if ( Element == 105 )
      {
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v48,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          124,
          11,
          90,
          16,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v48);
      }
      if ( Element == 1 || Element == 104 || Element == 101 || Element == 105 )
      {
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v47,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          76,
          10,
          80,
          16,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v47);
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v46,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          43,
          7,
          5,
          16,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v46);
      }
      if ( Element == 1 && !(CRandom16::Rand((CRandom16 *)g_pRand) % 0xAu) )
      {
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v45,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          184,
          5,
          80,
          16,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v45);
      }
      if ( (Element == 1 || Element == 104 || Element == 105) && !(CRandom16::Rand((CRandom16 *)g_pRand) % 0x14u) )
      {
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v44,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          56,
          20,
          2,
          16,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v44);
      }
      if ( Element == 106 )
      {
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v43,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          52,
          2,
          -300,
          64,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v43);
        CObjectBlob::CObjectBlob(
          (CObjectBlob *)v39,
          v113,
          v114,
          (int)(float)((float)v113 + *(float *)&g_fScaleFactor),
          (int)(float)((float)v114 + *(float *)&g_fScaleFactor),
          120,
          3,
          0,
          64,
          50,
          g_iWorldSize,
          (struct CCheckLayer *)g_pCheckLayer);
        CBlob::drawBlob((CBlob *)v39);
      }
    }
  }
  if ( g_pCheckLayer )
  {
    v66 = g_pCheckLayer;
    v75 = g_pCheckLayer;
    v65 = delete (CCheckLayer *)g_pCheckLayer;
  }
  if ( g_pBasicGrid )
  {
    v64 = g_pBasicGrid;
    v74 = g_pBasicGrid;
    v63 = delete (CBasicGrid *)g_pBasicGrid;
  }
  if ( g_pFeatureGrid )
  {
    v62 = g_pFeatureGrid;
    v73 = (__ExceptionPtr *)g_pFeatureGrid;
    v61 = delete (__ExceptionPtr *)g_pFeatureGrid;
  }
  if ( g_pPlayerData )
  {
    for ( i = 0; i < (unsigned __int8)g_iNumPlayers; ++i )
    {
      if ( *(_DWORD *)(g_pPlayerData + 4 * i) )
      {
        v60 = *(void **)(g_pPlayerData + 4 * i);
        operator delete(v60);
      }
    }
    C = (void *)g_pPlayerData;
    operator delete[]((void *)g_pPlayerData);
  }
  if ( g_pRand )
  {
    v58 = g_pRand;
    operator delete((void *)g_pRand);
    g_pRand = 0;
  }
  g_pPlayerData = 0;
  g_pCheckLayer = 0;
  g_pFeatureGrid = 0;
  g_pBasicGrid = 0;
  g_pMapElement = 0;
  g_pEditorLayer = 0;
  g_pHost = 0;
  j___controlfp(NewValue, 0x30F031Fu);
  return 1;
}


// address=[0x2fc3800]
// Decompiled from void repairHeights()
void __cdecl repairHeights(void) {
  
  int v0; // eax
  int v1; // edx
  int v2; // [esp+0h] [ebp-14h]
  int j; // [esp+8h] [ebp-Ch]
  int i; // [esp+Ch] [ebp-8h]

  for ( i = 1; i < g_iWorldSize; ++i )
  {
    for ( j = 1; j < g_iWorldSize - 1; ++j )
    {
      if ( *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * (i - 1) - 1)) >= (int)*(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * (i - 1))) )
        v0 = j + g_iWorldSize * (i - 1);
      else
        v0 = j + g_iWorldSize * (i - 1) - 1;
      if ( *(unsigned __int8 *)(g_pMapElement + 4 * v0)
         + 5
         - *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * i)) < 0 )
      {
        *(_BYTE *)(g_pMapElement + 4 * (j + g_iWorldSize * i)) = *(_BYTE *)(g_pMapElement + 4 * v0) + 5;
        if ( *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * i)) > (int)(unsigned __int8)g_uSnowLimit
          && *(_BYTE *)(g_pMapElement + 4 * (j + g_iWorldSize * i) + 1) == 32 )
        {
          *(_BYTE *)(g_pMapElement + 4 * (j + g_iWorldSize * i) + 1) = 0x80;
          *(_BYTE *)(g_pEditorLayer + 4 * (j + g_iWorldSize * i) + 3) = 0;
        }
        else if ( *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * i)) < (int)(unsigned __int8)g_uSnowLimit
               && *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * i) + 1) == 128 )
        {
          *(_BYTE *)(g_pMapElement + 4 * (j + g_iWorldSize * i) + 1) = 32;
        }
      }
      if ( *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * (i - 1) - 1)) <= (int)*(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * (i - 1))) )
        v1 = j + g_iWorldSize * (i - 1);
      else
        v1 = j + g_iWorldSize * (i - 1) - 1;
      v2 = *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * i))
         - (*(unsigned __int8 *)(g_pMapElement + 4 * v1)
          - 7);
      if ( v2 < 0 )
      {
        *(_BYTE *)(g_pMapElement + 4 * (j + g_iWorldSize * i)) -= v2;
        if ( *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * i)) > (int)(unsigned __int8)g_uSnowLimit
          && *(_BYTE *)(g_pMapElement + 4 * (j + g_iWorldSize * i) + 1) == 32 )
        {
          *(_BYTE *)(g_pMapElement + 4 * (j + g_iWorldSize * i) + 1) = 0x80;
          *(_BYTE *)(g_pEditorLayer + 4 * (j + g_iWorldSize * i) + 3) = 0;
        }
        else if ( *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * i)) < (int)(unsigned __int8)g_uSnowLimit
               && *(unsigned __int8 *)(g_pMapElement + 4 * (j + g_iWorldSize * i) + 1) == 128 )
        {
          *(_BYTE *)(g_pMapElement + 4 * (j + g_iWorldSize * i) + 1) = 32;
        }
      }
    }
  }
}


// address=[0x2fc3b90]
// Decompiled from int mirrorMapDiag()
void __cdecl mirrorMapDiag(void) {
  
  int result; // eax
  int j; // [esp+0h] [ebp-8h]
  int i; // [esp+4h] [ebp-4h]

  for ( i = 0; i < g_iWorldSize; ++i )
  {
    for ( j = 0; j < i; ++j )
    {
      *(_DWORD *)(g_pMapElement + 4 * (i + g_iWorldSize * j)) = *(_DWORD *)(g_pMapElement + 4 * (j + g_iWorldSize * i));
      *(_DWORD *)(g_pEditorLayer + 4 * (i + g_iWorldSize * j)) = *(_DWORD *)(g_pEditorLayer + 4 * (j + g_iWorldSize * i));
    }
    result = i + 1;
  }
  return result;
}


// address=[0x2fc3c30]
// Decompiled from int mirrorMapOppDiag()
void __cdecl mirrorMapOppDiag(void) {
  
  int result; // eax
  int j; // [esp+0h] [ebp-8h]
  int i; // [esp+4h] [ebp-4h]

  for ( i = 0; i < g_iWorldSize; ++i )
  {
    for ( j = 0; j < g_iWorldSize - i - 1; ++j )
    {
      *(_DWORD *)(g_pMapElement + 4 * (g_iWorldSize - i + g_iWorldSize * (g_iWorldSize - 1 - j) - 1)) = *(_DWORD *)(g_pMapElement + 4 * (j + g_iWorldSize * i));
      *(_DWORD *)(g_pEditorLayer + 4 * (g_iWorldSize - i + g_iWorldSize * (g_iWorldSize - 1 - j) - 1)) = *(_DWORD *)(g_pEditorLayer + 4 * (j + g_iWorldSize * i));
    }
    result = i + 1;
  }
  return result;
}


// address=[0x2fc3d10]
// Decompiled from int __cdecl CreateBorder(int a1, int a2, char a3)
void __cdecl CreateBorder(int a1, int a2, int a3) {
  
  int result; // eax
  int v4; // [esp+0h] [ebp-Ch]
  int i; // [esp+4h] [ebp-8h]
  int j; // [esp+8h] [ebp-4h]

  result = (*(int (__thiscall **)(int))(*(_DWORD *)g_pHost + 12))(g_pHost);
  v4 = result;
  for ( i = 1; i < v4 - 1; ++i )
  {
    for ( j = 1; j < v4 - 1; ++j )
    {
      if ( GetGroundType(i, j) == a1
        && (GetGroundType(i + 1, j) == a2
         || GetGroundType(i - 1, j) == a2
         || GetGroundType(i, j - 1) == a2
         || GetGroundType(i, j + 1) == a2
         || GetGroundType(i + 1, j + 1) == a2
         || GetGroundType(i - 1, j - 1) == a2) )
      {
        SetGroundType(i, j, a3);
      }
      result = j + 1;
    }
  }
  return result;
}


// address=[0x2fc3e40]
// Decompiled from void __cdecl CreateSpeckledBorder(int a1, int a2, char a3)
void __cdecl CreateSpeckledBorder(int a1, int a2, int a3) {
  
  signed int ii; // [esp+0h] [ebp-24h]
  signed int n; // [esp+4h] [ebp-20h]
  signed int m; // [esp+8h] [ebp-1Ch]
  signed int k; // [esp+Ch] [ebp-18h]
  signed int v7; // [esp+10h] [ebp-14h]
  signed int kk; // [esp+14h] [ebp-10h]
  signed int jj; // [esp+18h] [ebp-Ch]
  int i; // [esp+1Ch] [ebp-8h]
  int j; // [esp+20h] [ebp-4h]

  for ( i = 4; i < g_iWorldSize - 4; ++i )
  {
    for ( j = 4; j < g_iWorldSize - 4; ++j )
    {
      if ( GetGroundType(i, j) == a1 )
      {
        v7 = CRandom16::Rand((CRandom16 *)g_pRand) % 4u + 1;
        if ( GetGroundType(i + 1, j) == a2 )
        {
          for ( k = 0; k < v7; ++k )
          {
            if ( GetGroundType(i - k, j) == a1 )
              SetGroundType(i - k, j, a3);
          }
        }
        if ( GetGroundType(i - 1, j) == a2 )
        {
          for ( m = 0; m < v7; ++m )
          {
            if ( GetGroundType(m + i, j) == a1 )
              SetGroundType(m + i, j, a3);
          }
        }
        if ( GetGroundType(i, j - 1) == a2 )
        {
          for ( n = 0; n < v7; ++n )
          {
            if ( GetGroundType(i, n + j) == a1 )
              SetGroundType(i, n + j, a3);
          }
        }
        if ( GetGroundType(i, j + 1) == a2 )
        {
          for ( ii = 0; ii < v7; ++ii )
          {
            if ( GetGroundType(i, j - ii) == a1 )
              SetGroundType(i, j - ii, a3);
          }
        }
        if ( GetGroundType(i + 1, j + 1) == a2 )
        {
          for ( jj = 0; jj < v7; ++jj )
          {
            if ( GetGroundType(i - jj, j - jj) == a1 )
              SetGroundType(i - jj, j - jj, a3);
          }
        }
        if ( GetGroundType(i - 1, j - 1) == a2 )
        {
          for ( kk = 0; kk < v7; ++kk )
          {
            if ( GetGroundType(kk + i, kk + j) == a1 )
              SetGroundType(kk + i, kk + j, a3);
          }
        }
      }
    }
  }
}


// address=[0x2fc4140]
// Decompiled from void __cdecl ChangeBorder(int a1, char a2)
void __cdecl ChangeBorder(int a1, int a2) {
  
  int i; // [esp+0h] [ebp-8h]
  int j; // [esp+4h] [ebp-4h]

  for ( i = 1; i < g_iWorldSize - 1; ++i )
  {
    for ( j = 1; j < g_iWorldSize - 1; ++j )
    {
      if ( GetGroundType(i, j) == a1 )
        SetGroundType(i, j, a2);
    }
  }
}


// address=[0x2fc5260]
// Decompiled from int __cdecl GetGroundType(int a1, int a2)
int __cdecl GetGroundType(int a1, int a2) {
  
  return *(unsigned __int8 *)(g_pMapElement + 4 * (a1 + g_iWorldSize * a2) + 1);
}


// address=[0x2fc52b0]
// Decompiled from int __cdecl SetGroundType(int a1, int a2, char a3)
void __cdecl SetGroundType(int a1, int a2, int a3) {
  
  int result; // eax

  result = a1 + g_iWorldSize * a2;
  *(_BYTE *)(g_pMapElement + 4 * result + 1) = a3;
  return result;
}


// address=[0x2fc52e0]
// Decompiled from BOOL __cdecl ValidateMapIndex(int a1, int a2)
int __cdecl ValidateMapIndex(int a1, int a2) {
  
  if ( a1 < 0 )
    return 0;
  if ( a1 >= g_iWorldSize )
    return 0;
  if ( a2 >= 0 )
    return a2 < g_iWorldSize;
  return 0;
}


// address=[0x2fc9950]
// Decompiled from void *__thiscall TPowerOf2Wrap<512>::TPowerOf2Wrap<512>(void *this)
protected: __thiscall TPowerOf2Wrap<512>::TPowerOf2Wrap<512>(void) {
  
  return this;
}


// address=[0x2fc9970]
// Decompiled from void *__thiscall TStaticFIFO<int,512>::TStaticFIFO<int,512>(void *this)
public: __thiscall TStaticFIFO<int,512>::TStaticFIFO<int,512>(void) {
  
  TPowerOf2Wrap<512>::TPowerOf2Wrap<512>(this);
  TStaticFIFO<int,512>::Init(this);
  return this;
}


// address=[0x2fc99a0]
// Decompiled from bool __thiscall TStaticFIFO<int,512>::Empty(_DWORD *this)
public: bool __thiscall TStaticFIFO<int,512>::Empty(void) {
  
  return *this == this[1];
}


// address=[0x2fc99e0]
// Decompiled from _DWORD *__thiscall TStaticFIFO<int,512>::Init(_DWORD *this)
public: void __thiscall TStaticFIFO<int,512>::Init(void) {
  
  _DWORD *result; // eax

  result = this;
  *this = 0;
  this[1] = 0;
  return result;
}


// address=[0x2fc9a10]
// Decompiled from int __thiscall TStaticFIFO<int,512>::Pop(_DWORD *this)
public: void __thiscall TStaticFIFO<int,512>::Pop(void) {
  
  int result; // eax

  result = TPowerOf2Wrap<512>::Wrap(*this + 1);
  *this = result;
  return result;
}


// address=[0x2fc9a40]
// Decompiled from int __thiscall TStaticFIFO<int,512>::Push(_DWORD *this, _DWORD *a2)
public: void __thiscall TStaticFIFO<int,512>::Push(int const & a2) {
  
  int result; // eax

  this[this[1] + 2] = *a2;
  result = TPowerOf2Wrap<512>::Wrap(this[1] + 1);
  this[1] = result;
  return result;
}


// address=[0x2fc9a90]
// Decompiled from int __thiscall TStaticFIFO<int,512>::Top(_DWORD *this)
public: int & __thiscall TStaticFIFO<int,512>::Top(void) {
  
  return (int)&this[*this + 2];
}


// address=[0x2fc9ab0]
// Decompiled from int __cdecl TPowerOf2Wrap<512>::Wrap(__int16 a1)
protected: int __cdecl TPowerOf2Wrap<512>::Wrap(int a1) {
  
  return a1 & 0x1FF;
}


// address=[0x2fca4a0]
// Decompiled from int __cdecl MakeRiverMouth(int a1, int a2)
void __cdecl MakeRiverMouth(int a1, int a2) {
  
  int result; // eax
  int v3; // esi
  float v4; // [esp+8h] [ebp-6Ch]
  float v5; // [esp+10h] [ebp-64h]
  int v6; // [esp+14h] [ebp-60h]
  int v7; // [esp+18h] [ebp-5Ch]
  int v8; // [esp+20h] [ebp-54h]
  int v9; // [esp+28h] [ebp-4Ch]
  float v10; // [esp+30h] [ebp-44h]
  float v11; // [esp+38h] [ebp-3Ch]
  int v12; // [esp+3Ch] [ebp-38h]
  int v13; // [esp+40h] [ebp-34h]
  int v14; // [esp+44h] [ebp-30h]
  int v15; // [esp+48h] [ebp-2Ch]
  int v16; // [esp+4Ch] [ebp-28h]
  int v17; // [esp+50h] [ebp-24h]
  int v18; // [esp+54h] [ebp-20h]
  int v19; // [esp+58h] [ebp-1Ch]
  int v20; // [esp+5Ch] [ebp-18h]
  int v21; // [esp+60h] [ebp-14h]
  int v22; // [esp+64h] [ebp-10h]
  int Number; // [esp+68h] [ebp-Ch]
  int i; // [esp+6Ch] [ebp-8h]
  int j; // [esp+6Ch] [ebp-8h]
  int v26; // [esp+6Ch] [ebp-8h]
  int v27; // [esp+6Ch] [ebp-8h]
  bool v28; // [esp+72h] [ebp-2h]
  char v29; // [esp+73h] [ebp-1h]

  CHexIndices::SetFirst((CHexIndices *)&unk_4727A28);
  result = 4;
  v9 = FieldForRings[5];
  v29 = 0;
  for ( i = 0; i < v9; ++i )
  {
    v19 = a1 + CHexIndices::GetIndex((CHexIndices *)&unk_4727A28);
    v18 = a2 + CHexIndices::GetIndex((CHexIndices *)&unk_4727A28);
    if ( ValidateMapIndex(v19, v18) )
    {
      if ( *(_BYTE *)(g_pMapElement + 4 * (v19 + g_iWorldSize * v18) + 1) == 99 )
        v29 = 1;
      if ( v29 )
      {
        if ( CheckForRiverNeighbours(v19, v18, v19 + g_iWorldSize * v18) == 1 )
        {
          v7 = v19;
          result = v18;
          v6 = v18;
          break;
        }
        v29 = 0;
      }
    }
    result = i + 1;
  }
  if ( !v29 )
    return result;
  CHexIndices::SetFirst((CHexIndices *)&unk_4727A28);
  v28 = 0;
  for ( j = 0; ; ++j )
  {
    result = j;
    if ( j >= v9 )
      break;
    v13 = a1 + CHexIndices::GetIndex((CHexIndices *)&unk_4727A28);
    v12 = a2 + CHexIndices::GetIndex((CHexIndices *)&unk_4727A28);
    if ( ValidateMapIndex(v13, v12) )
    {
      v28 = *(_BYTE *)(g_pMapElement + 4 * (v13 + g_iWorldSize * v12) + 1) == 0;
      if ( !*(_BYTE *)(g_pMapElement + 4 * (v13 + g_iWorldSize * v12) + 1) )
      {
        v16 = v13;
        result = v12;
        v17 = v12;
        break;
      }
    }
  }
  if ( !v28 )
    return result;
  Number = v16 - v7;
  v22 = v17 - v6;
  v3 = j__abs(v16 - v7);
  if ( v3 <= j__abs(v17 - v6) )
    v8 = j__abs(v22);
  else
    v8 = j__abs(Number);
  if ( v8 == j__abs(Number) )
  {
    v15 = v17;
    v11 = 0.0;
    if ( v22 )
    {
      v5 = (float)j__abs(v22);
      v11 = v5 / (float)j__abs(Number);
    }
    v21 = 1;
    v26 = v16;
    while ( 1 )
    {
      result = j__abs(Number);
      if ( v21 > result )
        break;
      *(_BYTE *)(g_pMapElement + 4 * (v26 + g_iWorldSize * v15) + 1) = 0;
      if ( v22 < 0 )
        v15 = (int)(float)((float)((float)v17 + (float)((float)v21 * v11)) + 0.5);
      else
        v15 = (int)(float)((float)((float)v17 - (float)((float)v21 * v11)) + 0.5);
      ++v21;
      *(_BYTE *)(g_pMapElement + 4 * (v26 + g_iWorldSize * v15) + 1) = 0;
      if ( Number >= 0 )
        --v26;
      else
        ++v26;
    }
  }
  else
  {
    v14 = v16;
    v10 = 0.0;
    if ( Number )
    {
      v4 = (float)j__abs(Number);
      v10 = v4 / (float)j__abs(v22);
    }
    v20 = 1;
    v27 = v17;
    while ( 1 )
    {
      result = j__abs(v22);
      if ( v20 > result )
        break;
      *(_BYTE *)(g_pMapElement + 4 * (v14 + g_iWorldSize * v27) + 1) = 0;
      if ( Number < 0 )
        v14 = (int)(float)((float)((float)v16 + (float)((float)v20 * v10)) + 0.5);
      else
        v14 = (int)(float)((float)((float)v16 - (float)((float)v20 * v10)) + 0.5);
      ++v20;
      *(_BYTE *)(g_pMapElement + 4 * (v14 + g_iWorldSize * v27) + 1) = 0;
      if ( v22 >= 0 )
        --v27;
      else
        ++v27;
    }
  }
  return result;
}


// address=[0x2fca920]
// Decompiled from int __cdecl CheckForRiverNeighbours(int a1, int a2, int a3)
int __cdecl CheckForRiverNeighbours(int a1, int a2, int a3) {
  
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v10; // [esp+18h] [ebp-8h]

  v10 = 0;
  if ( ValidateYMapIndex(a2 - 1) )
  {
    if ( ValidateXMapIndex(a1 - 1) )
    {
      if ( (*(unsigned __int8 *)(g_pMapElement + 4 * (a3 - 1 - g_iWorldSize) + 1) < 0x60u
         || *(unsigned __int8 *)(g_pMapElement + 4 * (a3 - 1 - g_iWorldSize) + 1) > 0x63u)
        && *(_BYTE *)(g_pMapElement + 4 * (a3 - 1 - g_iWorldSize) + 1) )
      {
        v3 = j__abs(0);
      }
      else
      {
        v3 = j__abs(1);
      }
      v10 = v3;
    }
    if ( ValidateXMapIndex(a1) )
    {
      if ( (*(unsigned __int8 *)(g_pMapElement + 4 * (a3 - g_iWorldSize) + 1) < 0x60u
         || *(unsigned __int8 *)(g_pMapElement + 4 * (a3 - g_iWorldSize) + 1) > 0x63u)
        && *(_BYTE *)(g_pMapElement + 4 * (a3 - g_iWorldSize) + 1) )
      {
        v4 = j__abs(0);
      }
      else
      {
        v4 = j__abs(1);
      }
      v10 += v4;
    }
  }
  if ( ValidateYMapIndex(a2) && ValidateXMapIndex(a1 + 1) )
  {
    if ( (*(unsigned __int8 *)(g_pMapElement + 4 * a3 + 5) < 0x60u
       || *(unsigned __int8 *)(g_pMapElement + 4 * a3 + 5) > 0x63u)
      && *(_BYTE *)(g_pMapElement + 4 * a3 + 5) )
    {
      v5 = j__abs(0);
    }
    else
    {
      v5 = j__abs(1);
    }
    v10 += v5;
  }
  if ( ValidateYMapIndex(a2 + 1) )
  {
    if ( ValidateXMapIndex(a1 + 1) )
    {
      if ( (*(unsigned __int8 *)(g_pMapElement + 4 * (g_iWorldSize + a3) + 5) < 0x60u
         || *(unsigned __int8 *)(g_pMapElement + 4 * (g_iWorldSize + a3) + 5) > 0x63u)
        && *(_BYTE *)(g_pMapElement + 4 * (g_iWorldSize + a3) + 5) )
      {
        v6 = j__abs(0);
      }
      else
      {
        v6 = j__abs(1);
      }
      v10 += v6;
    }
    if ( ValidateXMapIndex(a1) )
    {
      if ( (*(unsigned __int8 *)(g_pMapElement + 4 * (g_iWorldSize + a3) + 1) < 0x60u
         || *(unsigned __int8 *)(g_pMapElement + 4 * (g_iWorldSize + a3) + 1) > 0x63u)
        && *(_BYTE *)(g_pMapElement + 4 * (g_iWorldSize + a3) + 1) )
      {
        v7 = j__abs(0);
      }
      else
      {
        v7 = j__abs(1);
      }
      v10 += v7;
    }
  }
  if ( !ValidateYMapIndex(a2) || !ValidateXMapIndex(a1 - 1) )
    return v10;
  if ( (*(unsigned __int8 *)(g_pMapElement + 4 * a3 - 3) < 0x60u
     || *(unsigned __int8 *)(g_pMapElement + 4 * a3 - 3) > 0x63u)
    && *(_BYTE *)(g_pMapElement + 4 * a3 - 3) )
  {
    v8 = j__abs(0);
  }
  else
  {
    v8 = j__abs(1);
  }
  v10 += v8;
  return v10;
}


// address=[0x2fcb540]
// Decompiled from BOOL __cdecl ValidateXMapIndex(int a1)
int __cdecl ValidateXMapIndex(int a1) {
  
  return a1 >= 0 && a1 < g_iWorldSize;
}


// address=[0x2fcb570]
// Decompiled from BOOL __cdecl ValidateYMapIndex(int a1)
int __cdecl ValidateYMapIndex(int a1) {
  
  return a1 >= 0 && a1 < g_iWorldSize;
}


// address=[0x2fcd3e0]
// Decompiled from _crt_argv_mode __cdecl GetLibVersion()
unsigned int __cdecl GetLibVersion(void) {
  
  return 1;
}


// address=[0x2fcd3f0]
// Decompiled from int GetLibInstance()
class IRTComp * __cdecl GetLibInstance(void) {
  
  CRTComp *v1; // [esp+8h] [ebp-14h]
  CRTComp *C; // [esp+Ch] [ebp-10h]

  if ( pTheRTComp )
    return pTheRTComp;
  C = (CRTComp *)operator new(0x50u);
  if ( C )
    v1 = CRTComp::CRTComp(C);
  else
    v1 = 0;
  pTheRTComp = (int)v1;
  return pTheRTComp;
}


// address=[0x2fd5540]
// Decompiled from int GetSoundInterfaceVersion()
unsigned int __cdecl GetSoundInterfaceVersion(void) {
  
  return 151;
}


// address=[0x2fdbab0]
// Decompiled from void __stdcall PlaylistCallback(struct _STREAM *a1)
void __stdcall PlaylistCallback(struct _STREAM *) {
  
  if ( g_pcSoundSystem )
    CSoundSystem::PlaylistTitleEnded((CSoundSystem *)g_pcSoundSystem, a1);
}


// address=[0x2fdbad0]
// [Decompilation failed for void __stdcall SoundCallback(struct _SAMPLE *)]

// address=[0x2fdbaf0]
// Decompiled from int __stdcall SoundEnumCallback(struct _GUID *a1, char *a2, const char *a3, void *a4)
int __stdcall SoundEnumCallback(struct _GUID * a1, char const * a2, char const * a3, void * a4) {
  
  if ( g_pcSoundSystem )
    CSoundSystem::AddSoundCard((CSoundSystem *)g_pcSoundSystem, a1, a2);
  return 1;
}


// address=[0x2fe58f0]
// Decompiled from void __cdecl _Atexit(PVOID Ptr)
void __cdecl _Atexit(void (__cdecl*)(void) Ptr) {
  
  if ( !dword_3E519B0 )
    j__abort();
  --dword_3E519B0;
  dword_47313F0[dword_3E519B0] = (int)EncodePointer(Ptr);
}


// address=[0x30158b0]
// Decompiled from void *__cdecl operator new(size_t Size)
void * __cdecl operator new(unsigned int Size) {
  
  void *v2; // [esp+0h] [ebp-4h]

  while ( 1 )
  {
    v2 = j__malloc(Size);
    if ( v2 )
      break;
    if ( !j___callnewh(Size) )
    {
      if ( Size == -1 )
        __scrt_throw_std_bad_array_new_length();
      __scrt_throw_std_bad_alloc();
    }
  }
  return v2;
}


// address=[0x3015910]
// Decompiled from void __cdecl operator delete(unsigned int C)
void __cdecl operator delete(void * C) {
  
  j___free_dbg(C | 0xFFFFFFFF00000000uLL);
}


// address=[0x3015930]
// Decompiled from void __cdecl operator_delete_0(void *C)
void __cdecl operator delete(void * C, unsigned int a2) {
  
  operator delete((unsigned int)C);
}


// address=[0x30163a0]
// Decompiled from void __stdcall __ArrayUnwind(char *a1, unsigned int a2, unsigned int a3, void (__thiscall *a4)(void *))
void __stdcall __ArrayUnwind(void * a1, unsigned int a2, unsigned int a3, void (*)(void *) a4) {
  
  int i; // [esp+14h] [ebp-1Ch]

  for ( i = 0; i != a3; ++i )
  {
    a1 -= a2;
    a4(a1);
  }
}


// address=[0x3016470]
// Decompiled from int __cdecl operator delete[](void *C)
void __cdecl operator delete[](void * C, unsigned int a2) {
  
  return operator delete[](C);
}


// address=[0x30169e0]
// Decompiled from void *__cdecl operator new[](size_t Size)
void * __cdecl operator new[](unsigned int Size) {
  
  return operator new(Size);
}


// address=[0x3017030]
// Decompiled from void __cdecl operator delete[](void *C)
void __cdecl operator delete[](void * C) {
  
  operator delete((unsigned int)C);
}


// address=[0x3018150]
// Decompiled from void __cdecl _RTC_AllocaFailure(void *a1, struct _RTC_ALLOCA_NODE *a2, int a3)
void __cdecl _RTC_AllocaFailure(void * a1, struct _RTC_ALLOCA_NODE * a2, int a3) {
  
  int v3; // edi
  unsigned int v4; // eax
  size_t v5; // [esp-1Ch] [ebp-168h]
  CHAR Buffer[244]; // [esp+Ch] [ebp-140h] BYREF
  char v7[52]; // [esp+100h] [ebp-4Ch] BYREF
  char v8[20]; // [esp+134h] [ebp-18h] BYREF

  v3 = dword_3E51A60;
  if ( dword_3E51A60 != -1 )
  {
    if ( a2 )
    {
      j__sprintf_s(
        Buffer,
        0xF4u,
        "%s%s%p%s%zd%s%d%s",
        "Stack area around _alloca memory reserved by this function is corrupted",
        "\nAddress: 0x",
        &a2[1],
        "\nSize: ",
        a2->allocaSize - 36,
        "\nAllocation number within this function: ",
        a3,
        "\nData: <");
      unknown_libname_8812((int)v8, v7, (int)&a2[1], a2->allocaSize - 36);
      v5 = 244 - _strlen_priv(Buffer);
      v4 = _strlen_priv(Buffer);
      j__sprintf_s(&Buffer[v4], v5, "%s%s%s%s", v8, "> ", v7, "\n");
      failwithmessage(a1, v3, 4, Buffer);
    }
    else
    {
      failwithmessage(a1, dword_3E51A60, 4, "Stack area around _alloca memory reserved by this function is corrupted\n");
    }
  }
}


// address=[0x30182c0]
// Decompiled from void __cdecl _RTC_Failure(void *a1, unsigned int a2)
void __cdecl _RTC_Failure(void * a1, int a2) {
  
  int v2; // ecx

  if ( a2 > 4 )
  {
    failwithmessage(a1, 1, 5, "Unknown Runtime Check Error\n\r");
  }
  else
  {
    v2 = *(&RTC_ErrorLevels + a2);
    if ( v2 != -1 )
      failwithmessage(a1, v2, a2, (&lpMultiByteStr)[a2]);
  }
}


// address=[0x3018330]
// Decompiled from void __cdecl _RTC_StackFailure(void *a1, char *a2)
void __cdecl _RTC_StackFailure(void * a1, char const * a2) {
  
  int v2; // eax
  char v3; // cl
  unsigned int v4; // ebx
  char *v5; // edi
  unsigned int v7; // edx
  char *v8; // edi
  CHAR *p_MultiByteStr; // eax
  int v11; // [esp+8h] [ebp-408h] BYREF
  CHAR MultiByteStr; // [esp+Ch] [ebp-404h] BYREF

  v11 = dword_3E51A58;
  if ( dword_3E51A58 != -1 )
  {
    if ( *a2 && _strlen_priv(a2) + 45 <= 0x400 )
    {
      v2 = 0;
      do
      {
        v3 = byte_3ADCEEC[v2++];
        *((_BYTE *)&v11 + v2 + 3) = v3;
      }
      while ( v3 );
      v4 = strlen(a2) + 1;
      v5 = (char *)&v11 + 3;
      while ( *++v5 )
        ;
      qmemcpy(v5, a2, v4);
      v7 = strlen("' was corrupted.") + 1;
      v8 = (char *)&v11 + 3;
      while ( *++v8 )
        ;
      p_MultiByteStr = &MultiByteStr;
      qmemcpy(v8, "' was corrupted.", v7);
    }
    else
    {
      p_MultiByteStr = "Stack corrupted near unknown variable";
    }
    failwithmessage(a1, v11, 2, p_MultiByteStr);
  }
}


// address=[0x30188e0]
// Decompiled from void *__cdecl operator new(size_t Size)
void * __cdecl operator new(unsigned int Size, struct std::nothrow_t const & a2) {
  
  _DWORD v2[10]; // [esp+0h] [ebp-28h] BYREF

  v2[6] = v2;
  v2[9] = 0;
  return operator new(Size);
}


// address=[0x3018980]
// Decompiled from void *__cdecl operator new(size_t Size, int a2, char *a3, int a4)
void * __cdecl operator new(unsigned int Size, int a2, char const * a3, int a4) {
  
  void *v5; // [esp+0h] [ebp-4h]

  while ( 1 )
  {
    v5 = j___malloc_dbg(Size, a2, a3, a4);
    if ( v5 )
      break;
    if ( !j___callnewh(Size) )
    {
      if ( Size == -1 )
        __scrt_throw_std_bad_array_new_length();
      __scrt_throw_std_bad_alloc();
    }
  }
  return v5;
}


// address=[0x30189f0]
// Decompiled from void *__cdecl operator new[](size_t Size, int a2, char *a3, int a4)
void * __cdecl operator new[](unsigned int Size, int a2, char const * a3, int a4) {
  
  return operator new(Size, a2, a3, a4);
}


// address=[0x3018a20]
// Decompiled from int __cdecl operator delete(unsigned __int64 C)
void __cdecl operator delete(void * C, int a2, char const * a3, int a4) {
  
  return j___free_dbg(C);
}


// address=[0x3018a40]
// [Decompilation failed for void __cdecl operator delete[](void *,int,char const *,int)]

// address=[0x3019600]
// Decompiled from int _RTC_GetErrorFunc()
int (__cdecl*__cdecl _RTC_GetErrorFunc(void const *))(int,char const *,int,char const *,char const *,...) {
  
  return dword_4731C0C;
}


// address=[0x3019610]
// Decompiled from int _RTC_GetErrorFuncW()
int (__cdecl*__cdecl _RTC_GetErrorFuncW(void const *))(int,wchar_t const *,int,wchar_t const *,wchar_t const *,...) {
  
  return dword_4731C10;
}


// address=[0x3019ca0]
// Decompiled from int __cdecl _RTC_GetSrcLine(unsigned __int8 *a1, wchar_t *a2, char a3, int *a4, LPWSTR lpFilename, DWORD nSize)
int __cdecl _RTC_GetSrcLine(unsigned char * a1, wchar_t * a2, unsigned long a3, int * a4, wchar_t * lpFilename, unsigned long nSize) {
  
  int v7; // eax
  char *v8; // edx
  unsigned int v9; // esi
  unsigned int v10; // edi
  unsigned int v11; // ebx
  char *v12; // edx
  unsigned int v13; // eax
  _DWORD *v14; // ecx
  HMODULE PdbDll; // eax
  FARPROC PDBOpenValidate5; // eax
  unsigned int *v17; // edi
  HANDLE v18; // eax
  HANDLE ProcessHeap; // eax
  unsigned int *v20; // eax
  char v21; // al
  unsigned int v22; // ebx
  unsigned int i; // eax
  int v24; // edi
  char v25; // al
  SIZE_T v26; // [esp-Ch] [ebp-5Ch]
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+4h] [ebp-4Ch] BYREF
  char v28[4]; // [esp+20h] [ebp-30h] BYREF
  int v29; // [esp+24h] [ebp-2Ch] BYREF
  int v30; // [esp+28h] [ebp-28h] BYREF
  int v31; // [esp+2Ch] [ebp-24h]
  int v32; // [esp+30h] [ebp-20h] BYREF
  unsigned int v33; // [esp+34h] [ebp-1Ch] BYREF
  _DWORD *v34; // [esp+38h] [ebp-18h] BYREF
  int v35; // [esp+3Ch] [ebp-14h] BYREF
  unsigned int v36; // [esp+40h] [ebp-10h] BYREF
  unsigned int *v37; // [esp+44h] [ebp-Ch]
  int v38; // [esp+48h] [ebp-8h] BYREF
  unsigned __int16 v39; // [esp+4Ch] [ebp-4h] BYREF

  *a4 = 0;
  *a2 = 0;
  if ( !VirtualQuery(a1 - 1, &Buffer, 0x1Cu) )
    return 0;
  if ( !j____vcrt_GetModuleFileNameW((HMODULE)Buffer.AllocationBase, lpFilename, nSize) )
    return 0;
  if ( *(_WORD *)Buffer.AllocationBase != 23117 )
    return 0;
  v7 = *((_DWORD *)Buffer.AllocationBase + 15);
  if ( v7 <= 0 )
    return 0;
  v8 = (char *)Buffer.AllocationBase + v7;
  if ( *(_DWORD *)((char *)Buffer.AllocationBase + v7) != 17744 )
    return 0;
  v9 = (char *)(a1 - 1) - (char *)Buffer.AllocationBase;
  v10 = *((unsigned __int16 *)v8 + 3);
  v11 = 0;
  v12 = &v8[*((unsigned __int16 *)v8 + 10)];
  v13 = 0;
  if ( v10 )
  {
    v14 = v12 + 36;
    do
    {
      if ( v9 >= *v14 )
      {
        v11 = v9 - *v14;
        if ( v9 < *(v14 - 1) )
          break;
      }
      ++v13;
      v14 += 10;
    }
    while ( v13 < v10 );
  }
  if ( v13 == v10 )
    return 0;
  v37 = (unsigned int *)(v13 + 1);
  if ( byte_4731C1D )
  {
    PdbDll = (HMODULE)dword_4731C18;
  }
  else
  {
    if ( dword_4731C18 )
      return 0;
    PdbDll = GetPdbDll();
    dword_4731C18 = (int)PdbDll;
    if ( !PdbDll )
      return 0;
    byte_4731C1D = 1;
  }
  PDBOpenValidate5 = GetProcAddress(PdbDll, "PDBOpenValidate5");
  if ( !PDBOpenValidate5
    || !((int (__cdecl *)(LPWSTR, _DWORD, _DWORD, _DWORD, char *, _DWORD, _DWORD, _DWORD **))PDBOpenValidate5)(
          lpFilename,
          0,
          0,
          0,
          v28,
          0,
          0,
          &v34) )
  {
    return 0;
  }
  v31 = 0;
  if ( (_UNKNOWN *)(*(int (__thiscall **)(_DWORD *))*v34)(v34) == (_UNKNOWN *)((char *)&loc_1329140 + 1)
    && (*(int (__thiscall **)(_DWORD *, _DWORD, void *, int *))(*v34 + 28))(v34, 0, &string__107, &v32) )
  {
    if ( (*(int (__thiscall **)(int, unsigned int *, unsigned int, int *, _DWORD, _DWORD, _DWORD))(*(_DWORD *)v32 + 32))(
           v32,
           v37,
           v11,
           &v35,
           0,
           0,
           0) )
    {
      v38 = 0;
      if ( (*(unsigned __int8 (__thiscall **)(int, int *))(*(_DWORD *)v35 + 104))(v35, &v38) && v38 )
      {
        v17 = 0;
        if ( (*(int (__thiscall **)(int))(*(_DWORD *)v38 + 8))(v38) )
        {
          while ( (*(unsigned __int8 (__thiscall **)(int, _DWORD, unsigned int *, unsigned __int16 *, int *, unsigned int *, _DWORD))(*(_DWORD *)v38 + 12))(
                    v38,
                    0,
                    &v33,
                    &v39,
                    &v30,
                    &v36,
                    0) )
          {
            if ( (unsigned int *)v39 == v37 && v33 <= v11 && v11 < v33 + v30 )
            {
              if ( !v36 )
                break;
              if ( v36 >= 0x1FFFFFFF )
                break;
              v26 = 8 * v36;
              ProcessHeap = GetProcessHeap();
              v20 = (unsigned int *)HeapAlloc(ProcessHeap, 0, v26);
              v37 = v20;
              if ( !v20 )
                break;
              v21 = (*(int (__thiscall **)(int, int *, _DWORD, _DWORD, _DWORD, unsigned int *, unsigned int *))(*(_DWORD *)v38 + 12))(
                      v38,
                      &v29,
                      0,
                      0,
                      0,
                      &v36,
                      v20);
              v17 = v37;
              if ( v21 )
              {
                v22 = v11 - v33;
                if ( v22 >= *v37 )
                {
                  for ( i = 1; i < v36; ++i )
                  {
                    if ( v22 < v37[2 * i] )
                      break;
                  }
                  v24 = v35;
                  *a4 = ((unsigned int)&dword_F29144[220078] + 3) & v37[2 * i - 1];
                  v25 = (*(int (__thiscall **)(int, int, wchar_t *, char *, _DWORD, _DWORD, _DWORD))(*(_DWORD *)v24 + 112))(
                          v24,
                          v29,
                          a2,
                          &a3,
                          0,
                          0,
                          0);
                  v17 = v37;
                  if ( v25 )
                    v31 = 1;
                }
              }
              goto _RTC_GetSrcLine___$DONE5$74;
            }
            if ( !(*(int (__thiscall **)(int))(*(_DWORD *)v38 + 8))(v38) )
            {
              v17 = 0;
              goto _RTC_GetSrcLine___$DONE5$74;
            }
          }
        }
        else
        {
_RTC_GetSrcLine___$DONE5$74:
          v18 = GetProcessHeap();
          HeapFree(v18, 0, v17);
        }
        (**(void (__thiscall ***)(int))v38)(v38);
      }
      (*(void (__thiscall **)(int))(*(_DWORD *)v35 + 64))(v35);
    }
    (*(void (__thiscall **)(int))(*(_DWORD *)v32 + 56))(v32);
  }
  (*(void (__fastcall **)(_DWORD *, _DWORD))(*v34 + 44))(v34, *v34);
  return v31;
}


// address=[0x301a710]
// Decompiled from void __vcrt_va_start_verify_argument_type<unsigned short>()
void __stdcall __vcrt_va_start_verify_argument_type<unsigned short>(void) {
  
  ;
}


// address=[0x301a720]
// Decompiled from void __vcrt_va_start_verify_argument_type<wchar_t const *>()
void __stdcall __vcrt_va_start_verify_argument_type<wchar_t const *>(void) {
  
  ;
}


// address=[0x301a730]
// Decompiled from uintptr_t _com_dispatch_method(int a1, int a2, __int16 a3, __int16 a4, int a5, wchar_t *String, ...)
long __cdecl _com_dispatch_method(struct IDispatch * a1, long a2, unsigned short a3, unsigned short a4, void * a5, wchar_t const * String, ... a7) {
  
  uintptr_t Target[6]; // [esp+4h] [ebp-18h] BYREF
  va_list va; // [esp+3Ch] [ebp+20h] BYREF

  va_start(va, String);
  memset(Target, 204, sizeof(Target));
  __vcrt_va_start_verify_argument_type<wchar_t const *>();
  va_copy((va_list)&Target[5], va);
  Target[1] = _com_invoke_helper(a1, a2, a3, a4, a5, String, (int)va, (int)&Target[3]);
  if ( (Target[1] & 0x80000000) == 0 )
    return Target[1];
  Target[0] = (uintptr_t)_errorPfn;
  ((void (__thiscall *)(void (__stdcall __noreturn *)(struct _GUID *, struct IErrorInfo *), uintptr_t, uintptr_t))_errorPfn)(
    _errorPfn,
    Target[1],
    Target[3]);
  return Target[1];
}


// address=[0x301a830]
// [Decompilation failed for long __stdcall _com_dispatch_propget(struct IDispatch *,long,unsigned short,void *)]

// address=[0x301a870]
// [Decompilation failed for long __cdecl _com_dispatch_propput(struct IDispatch *,long,unsigned short,...)]

// address=[0x301a9f0]
// Decompiled from void __stdcall __noreturn _com_issue_error(int a1)
void __stdcall _com_issue_error(long a1) {
  
  ((void (__thiscall *)(void (__stdcall __noreturn *)(struct _GUID *, struct IErrorInfo *), int))_errorPfn)(
    _errorPfn,
    a1);
}


// address=[0x301aa40]
// [Decompilation failed for void __stdcall _com_issue_errorex(long,struct IUnknown *,struct _GUID const &)]

// address=[0x301ad40]
// Decompiled from int __stdcall _com_util::ConvertBSTRToString(LPCWCH lpWideCharStr)
char * __stdcall _com_util::ConvertBSTRToString(wchar_t * lpWideCharStr) {
  
  DWORD LastError; // eax
  HRESULT v3; // eax
  DWORD v4; // eax
  HRESULT v5; // eax
  _DWORD v6[11]; // [esp+0h] [ebp-38h] BYREF
  int v7; // [esp+34h] [ebp-4h]

  memset(&v6[4], 204, 24);
  v6[10] = v6;
  if ( !lpWideCharStr )
    return 0;
  v6[9] = j__wcslen(lpWideCharStr) + 1;
  v6[8] = WideCharToMultiByte(0, 0, lpWideCharStr, v6[9], 0, 0, 0, 0);
  if ( !v6[8] )
  {
    LastError = GetLastError();
    v3 = HRESULT_FROM_WIN32(LastError);
    _com_issue_error(v3);
  }
  v7 = 0;
  v6[4] = operator new[](v6[8]);
  v6[6] = v6[4];
  v6[7] = v6[4];
  v7 = -1;
  if ( !v6[4] )
    _com_issue_error(-2147024882);
  if ( WideCharToMultiByte(0, 0, lpWideCharStr, v6[9], (LPSTR)v6[7], v6[8], 0, 0) )
    return v6[7];
  v6[5] = v6[7];
  operator delete[]((void *)v6[7]);
  v6[7] = 0;
  v4 = GetLastError();
  v5 = HRESULT_FROM_WIN32(v4);
  _com_issue_error(v5);
  return v6[7];
}


// address=[0x301af30]
// [Decompilation failed for wchar_t * __stdcall _com_util::ConvertStringToBSTR(char const *)]

// address=[0x301b230]
// Decompiled from HRESULT __stdcall HRESULT_FROM_WIN32(unsigned int x)
long __stdcall HRESULT_FROM_WIN32(unsigned long x) {
  
  if ( (int)x > 0 )
    return (unsigned __int16)x | 0x80070000;
  else
    return x;
}


// address=[0x301b4e0]
// Decompiled from void __stdcall __noreturn _com_raise_error(struct _GUID *a1, int a2)
void __stdcall _com_raise_error(long a1, struct IErrorInfo * a2) {
  
  _DWORD pExceptionObject[4]; // [esp+0h] [ebp-10h] BYREF

  memset(pExceptionObject, 204, sizeof(pExceptionObject));
  _com_error::_com_error((COleControlLock *)pExceptionObject, a1);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI1_AV_com_error__);
}


// address=[0x301b540]
// Decompiled from int _com_dispatch_raw_method(int a1, int a2, __int16 a3, __int16 a4, int a5, wchar_t *String, ...)
long __cdecl _com_dispatch_raw_method(struct IDispatch * a1, long a2, unsigned short a3, unsigned short a4, void * a5, wchar_t const * String, ... a7) {
  
  int v7; // [esp+4h] [ebp-14h]
  IErrorInfo *perrinfo[3]; // [esp+Ch] [ebp-Ch] BYREF
  va_list va; // [esp+38h] [ebp+20h] BYREF

  va_start(va, String);
  memset(perrinfo, 204, sizeof(perrinfo));
  __vcrt_va_start_verify_argument_type<wchar_t const *>();
  va_copy((va_list)&perrinfo[2], va);
  v7 = _com_invoke_helper(a1, a2, a3, a4, a5, String, (int)va, (int)perrinfo);
  if ( v7 < 0 )
    SetErrorInfo(0, perrinfo[0]);
  return v7;
}


// address=[0x301b630]
// [Decompilation failed for long __stdcall _com_dispatch_raw_propget(struct IDispatch *,long,unsigned short,void *)]

// address=[0x301b670]
// [Decompilation failed for long __cdecl _com_dispatch_raw_propput(struct IDispatch *,long,unsigned short,...)]

// address=[0x301b7e0]
// Decompiled from int __cdecl _com_invoke_helper(  int a1,  int a2,  unsigned __int16 a3,  VARTYPE a4,  SHORT *a5,  wchar_t *String,  int a7,  struct IErrorInfo **a8)
long __cdecl _com_invoke_helper(struct IDispatch * a1, long a2, unsigned short a3, unsigned short a4, void * a5, wchar_t const * String, char * a7, struct IErrorInfo * * a8) {
  
  int result; // eax
  void *v9; // esp
  int *v10; // edx
  int v11; // eax
  int v12; // ecx
  char *v13; // edx
  _DWORD *v14; // eax
  _DWORD *v15; // ecx
  _DWORD *v16; // ecx
  _DWORD *v17; // edx
  char *v18; // edx
  char *v19; // edx
  _DWORD *v20; // edx
  _DWORD *v21; // eax
  int v22; // [esp+0h] [ebp-FCh] BYREF
  int v23; // [esp+10h] [ebp-ECh]
  uintptr_t Target; // [esp+18h] [ebp-E4h]
  VARIANTARG *p_pvarg; // [esp+1Ch] [ebp-E0h]
  char *v27; // [esp+20h] [ebp-DCh] BYREF
  __int16 v28; // [esp+26h] [ebp-D6h]
  int v29; // [esp+28h] [ebp-D4h]
  _RTC_ALLOCA_NODE *PAllocaBase; // [esp+30h] [ebp-CCh]
  size_t CbSize; // [esp+34h] [ebp-C8h]
  _RTC_ALLOCA_NODE *PAllocaInfoList; // [esp+3Ch] [ebp-C0h]
  HRESULT v33; // [esp+44h] [ebp-B8h]
  int v34[3]; // [esp+4Ch] [ebp-B0h] BYREF
  struct tagEXCEPINFO v35; // [esp+58h] [ebp-A4h] BYREF
  VARIANTARG pvarg; // [esp+80h] [ebp-7Ch] BYREF
  VARIANTARG *v37; // [esp+94h] [ebp-68h]
  unsigned int i; // [esp+98h] [ebp-64h]
  char *v39; // [esp+9Ch] [ebp-60h]
  int v40; // [esp+A0h] [ebp-5Ch]
  char *v41; // [esp+A4h] [ebp-58h]
  wchar_t *v42; // [esp+A8h] [ebp-54h]
  void *v43; // [esp+B0h] [ebp-4Ch]
  int v44; // [esp+BCh] [ebp-40h] BYREF
  size_t v45; // [esp+C4h] [ebp-38h]
  char *v46; // [esp+CCh] [ebp-30h] BYREF
  int *v47; // [esp+D0h] [ebp-2Ch]
  size_t v48; // [esp+D4h] [ebp-28h]
  unsigned int v49; // [esp+D8h] [ebp-24h]
  CPPEH_RECORD ms_exc; // [esp+E4h] [ebp-18h]

  PAllocaInfoList = 0;
  if ( !a1 )
    return -2147467261;
  if ( a8 )
    *a8 = 0;
  v46 = 0;
  v47 = 0;
  v48 = 0;
  v49 = 0;
  if ( String )
  {
    v45 = j__wcslen(String);
    v48 = v45;
  }
  v44 = -3;
  if ( (a3 & 0xC) != 0 )
  {
    if ( !v48 )
      return -2147024809;
    v49 = 1;
    v47 = &v44;
  }
  if ( v48 )
  {
    CbSize = 16 * v48 + 36;
    v9 = alloca(CbSize);
    ms_exc.old_esp = (DWORD)&v22;
    PAllocaBase = (_RTC_ALLOCA_NODE *)&v27;
    v43 = &v27;
    ms_exc.registration.TryLevel = -2;
    memset(&v27, 0, 16 * v48);
    v46 = (char *)v43;
    v42 = String;
    v41 = (char *)v43 + 16 * v48 - 16;
    while ( *v42 )
    {
      *(_WORD *)v41 = *v42 & 0xF7FF;
      v29 = *(unsigned __int16 *)v41;
      if ( v29 > 16386 )
      {
        v29 -= 16387;
        switch ( v29 )
        {
          case 0:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 1:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 2:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 3:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 4:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 5:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 6:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 7:
          case 22:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 8:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 9:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 10:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 11:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 13:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 14:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 15:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 16:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 17:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 18:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 19:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 20:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          case 33:
LABEL_42:
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
          default:
_com_invoke_helper___def_341BA01:
            if ( (*(_WORD *)v41 & 0x2000) == 0 )
              return -2147024809;
            a7 += 4;
            *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
            break;
        }
      }
      else
      {
        if ( v29 != 16386 )
        {
          v29 -= 2;
          switch ( v29 )
          {
            case 0:
              a7 += 4;
              *((_WORD *)v41 + 4) = *(_WORD *)(a7 - 4);
              goto LABEL_67;
            case 1:
              a7 += 4;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 2:
              *(_WORD *)v41 = 5;
              a7 += 8;
              *((double *)v41 + 1) = *(double *)(a7 - 8);
              goto LABEL_67;
            case 3:
              a7 += 8;
              *((double *)v41 + 1) = *(double *)(a7 - 8);
              goto LABEL_67;
            case 4:
              a7 += 4;
              v10 = *(int **)(a7 - 4);
              v11 = *v10;
              v12 = v10[1];
              v13 = v41;
              *((_DWORD *)v41 + 2) = v11;
              *((_DWORD *)v13 + 3) = v12;
              goto LABEL_67;
            case 5:
              a7 += 8;
              *((double *)v41 + 1) = *(double *)(a7 - 8);
              goto LABEL_67;
            case 6:
              a7 += 4;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 7:
              a7 += 4;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 8:
            case 23:
              a7 += 4;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 9:
              a7 += 4;
              if ( *(_WORD *)(a7 - 4) )
                v28 = -1;
              else
                v28 = 0;
              *((_WORD *)v41 + 4) = v28;
              goto LABEL_67;
            case 10:
              a7 += 4;
              v14 = *(_DWORD **)(a7 - 4);
              v15 = v41;
              *(_DWORD *)v41 = *v14;
              v15[1] = v14[1];
              v15[2] = v14[2];
              v15[3] = v14[3];
              goto LABEL_67;
            case 11:
              a7 += 4;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 12:
              a7 += 4;
              v16 = *(_DWORD **)(a7 - 4);
              v17 = v41;
              *(_DWORD *)v41 = *v16;
              v17[1] = v16[1];
              v17[2] = v16[2];
              v17[3] = v16[3];
              *(_WORD *)v41 = 14;
              goto LABEL_67;
            case 14:
              a7 += 4;
              v41[8] = *(_BYTE *)(a7 - 4);
              goto LABEL_67;
            case 15:
              a7 += 4;
              v41[8] = *(_BYTE *)(a7 - 4);
              goto LABEL_67;
            case 16:
              a7 += 4;
              *((_WORD *)v41 + 4) = *(_WORD *)(a7 - 4);
              goto LABEL_67;
            case 17:
              a7 += 4;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 18:
              a7 += 8;
              v18 = v41;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 8);
              *((_DWORD *)v18 + 3) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 19:
              a7 += 8;
              v19 = v41;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 8);
              *((_DWORD *)v19 + 3) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 20:
              a7 += 4;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 21:
              a7 += 4;
              *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
              goto LABEL_67;
            case 34:
              goto LABEL_42;
            default:
              goto _com_invoke_helper___def_341BA01;
          }
        }
        a7 += 4;
        *((_DWORD *)v41 + 2) = *(_DWORD *)(a7 - 4);
      }
LABEL_67:
      v41 -= 16;
      ++v42;
    }
    v41 = (char *)v43 + 16 * v49;
    v42 = &String[v48 - v49 - 1];
    v40 = 0;
    while ( v42 >= String && (*v42 & 0xBFFF) == 0x80C )
    {
      v27 = (*v42 & 0x4000) != 0 ? (char *)*((_DWORD *)v41 + 2) : v41;
      v39 = v27;
      if ( *(_WORD *)v27 != 10 || *((_DWORD *)v39 + 2) != -2147352572 )
        break;
      ++v40;
      v41 += 16;
      --v42;
    }
    if ( v40 )
    {
      for ( i = 0; i < v49; ++i )
      {
        v20 = (char *)v43 + 16 * i;
        v21 = (char *)v43 + 16 * v40 + 16 * i;
        *v21 = *v20;
        v21[1] = v20[1];
        v21[2] = v20[2];
        v21[3] = v20[3];
      }
      v48 -= v40;
      v46 += 16 * v40;
    }
  }
  VariantInit(&pvarg);
  if ( a4 )
    p_pvarg = &pvarg;
  else
    p_pvarg = 0;
  v37 = p_pvarg;
  memset(&v35, 0, sizeof(v35));
  v34[0] = -1;
  Target = *(_DWORD *)(*(_DWORD *)a1 + 24);
  v33 = ((int (__thiscall *)(uintptr_t, int, int, GUID *, _DWORD, _DWORD, char **, VARIANTARG *, struct tagEXCEPINFO *, int *))Target)(
          Target,
          a1,
          a2,
          &_GUID_00000000_0000_0000_0000_000000000000,
          0,
          a3,
          &v46,
          p_pvarg,
          &v35,
          v34);
  if ( v33 < 0 )
  {
    VariantClear(&pvarg);
    if ( v33 == -2147352567 )
      return _com_handle_excepinfo(&v35, a8);
    else
      return v33;
  }
  if ( !a4 || !a5 )
    return v33;
  if ( a4 != 12 && a4 != pvarg.vt )
  {
    v33 = VariantChangeType(&pvarg, &pvarg, 0, a4);
    if ( v33 < 0 )
    {
      VariantClear(&pvarg);
      return v33;
    }
  }
  v23 = a4;
  if ( a4 <= 0x4002u )
  {
    if ( v23 != 16386 )
    {
      v23 -= 2;
      switch ( v23 )
      {
        case 0:
          *a5 = pvarg.iVal;
          return v33;
        case 1:
          *(_DWORD *)a5 = pvarg.lVal;
          return v33;
        case 2:
          *(float *)a5 = pvarg.fltVal;
          return v33;
        case 3:
          *(double *)a5 = pvarg.dblVal;
          return v33;
        case 4:
          *(_QWORD *)a5 = pvarg.llVal;
          return v33;
        case 5:
          *(double *)a5 = pvarg.dblVal;
          return v33;
        case 6:
          *(_DWORD *)a5 = pvarg.lVal;
          return v33;
        case 7:
          *(_DWORD *)a5 = pvarg.lVal;
          return v33;
        case 8:
        case 23:
          *(_DWORD *)a5 = pvarg.lVal;
          return v33;
        case 9:
          *a5 = pvarg.iVal;
          return v33;
        case 10:
          *(VARIANTARG *)a5 = pvarg;
          return v33;
        case 11:
          *(_DWORD *)a5 = pvarg.lVal;
          return v33;
        case 12:
          *(VARIANTARG *)a5 = pvarg;
          return v33;
        case 14:
          *(_BYTE *)a5 = pvarg.bVal;
          return v33;
        case 15:
          *(_BYTE *)a5 = pvarg.bVal;
          return v33;
        case 16:
          *a5 = pvarg.iVal;
          return v33;
        case 17:
          *(_DWORD *)a5 = pvarg.lVal;
          return v33;
        case 18:
          *(_QWORD *)a5 = pvarg.llVal;
          return v33;
        case 19:
          *(_QWORD *)a5 = pvarg.llVal;
          return v33;
        case 20:
          *(_DWORD *)a5 = pvarg.lVal;
          return v33;
        case 21:
          *(_DWORD *)a5 = pvarg.lVal;
          return v33;
        case 34:
          goto LABEL_122;
        default:
          goto _com_invoke_helper___def_341C26C;
      }
    }
    *(_DWORD *)a5 = pvarg.lVal;
    return v33;
  }
  v23 -= 16387;
  switch ( v23 )
  {
    case 0:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 1:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 2:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 3:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 4:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 5:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 6:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 7:
    case 22:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 8:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 9:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 10:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 11:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 13:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 14:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 15:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 16:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 17:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 18:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 19:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 20:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    case 33:
LABEL_122:
      *(_DWORD *)a5 = pvarg.lVal;
      return v33;
    default:
_com_invoke_helper___def_341C26C:
      if ( (a4 & 0x2000) != 0 )
      {
        *(_DWORD *)a5 = pvarg.lVal;
        return v33;
      }
      VariantClear(&pvarg);
      result = -2147024809;
      break;
  }
  return result;
}


// address=[0x301cc90]
// Decompiled from SCODE __stdcall _com_handle_excepinfo(struct tagEXCEPINFO *a1, struct IErrorInfo **a2)
long __stdcall _com_handle_excepinfo(struct tagEXCEPINFO & a1, struct IErrorInfo * * a2) {
  
  ICreateErrorInfo *pperrinfo; // [esp+30h] [ebp-8h] BYREF

  if ( a1->pfnDeferredFillIn )
    ((void (__thiscall *)(HRESULT (__stdcall *)(struct tagEXCEPINFO *), struct tagEXCEPINFO *))a1->pfnDeferredFillIn)(
      a1->pfnDeferredFillIn,
      a1);
  pperrinfo = 0;
  if ( a2 && CreateErrorInfo(&pperrinfo) >= 0 )
  {
    ((void (__thiscall *)(HRESULT (__stdcall *)(ICreateErrorInfo *, const GUID *const), ICreateErrorInfo *, GUID *))pperrinfo->lpVtbl->SetGUID)(
      pperrinfo->lpVtbl->SetGUID,
      pperrinfo,
      &_GUID_00020400_0000_0000_c000_000000000046);
    if ( a1->bstrSource )
      ((void (__thiscall *)(HRESULT (__stdcall *)(ICreateErrorInfo *, LPOLESTR), ICreateErrorInfo *, BSTR))pperrinfo->lpVtbl->SetSource)(
        pperrinfo->lpVtbl->SetSource,
        pperrinfo,
        a1->bstrSource);
    if ( a1->bstrDescription )
      ((void (__thiscall *)(HRESULT (__stdcall *)(ICreateErrorInfo *, LPOLESTR), ICreateErrorInfo *, BSTR))pperrinfo->lpVtbl->SetDescription)(
        pperrinfo->lpVtbl->SetDescription,
        pperrinfo,
        a1->bstrDescription);
    if ( a1->bstrHelpFile )
      ((void (__thiscall *)(HRESULT (__stdcall *)(ICreateErrorInfo *, LPOLESTR), ICreateErrorInfo *, BSTR))pperrinfo->lpVtbl->SetHelpFile)(
        pperrinfo->lpVtbl->SetHelpFile,
        pperrinfo,
        a1->bstrHelpFile);
    ((void (__thiscall *)(HRESULT (__stdcall *)(ICreateErrorInfo *, DWORD), ICreateErrorInfo *, DWORD))pperrinfo->lpVtbl->SetHelpContext)(
      pperrinfo->lpVtbl->SetHelpContext,
      pperrinfo,
      a1->dwHelpContext);
    if ( ((int (__thiscall *)(HRESULT (__stdcall *)(ICreateErrorInfo *, const IID *const, void **), ICreateErrorInfo *, GUID *, struct IErrorInfo **))pperrinfo->lpVtbl->QueryInterface)(
           pperrinfo->lpVtbl->QueryInterface,
           pperrinfo,
           &_GUID_1cf2b120_547d_101b_8e65_08002b2bd119,
           a2) < 0 )
      *a2 = 0;
    ((void (__thiscall *)(ULONG (__stdcall *)(ICreateErrorInfo *), ICreateErrorInfo *))pperrinfo->lpVtbl->Release)(
      pperrinfo->lpVtbl->Release,
      pperrinfo);
  }
  if ( a1->bstrSource )
    SysFreeString(a1->bstrSource);
  if ( a1->bstrDescription )
    SysFreeString(a1->bstrDescription);
  if ( a1->bstrHelpFile )
    SysFreeString(a1->bstrHelpFile);
  if ( a1->wCode )
    return _com_error::WCodeToHRESULT(a1->wCode);
  else
    return a1->scode;
}


// address=[0x3020c20]
// Decompiled from void *__cdecl operator new(size_t Size, int a2, char *a3, int a4)
void * __cdecl operator new(unsigned int Size, class _ConcRTNewMoniker a2, char const * a3, int a4) {
  
  return operator new(Size, 2, a3, a4);
}


// address=[0x3020c50]
// Decompiled from void __cdecl operator delete(void *C)
void __cdecl operator delete(void * C, class _ConcRTNewMoniker a2, char const * a3, int a4) {
  
  operator delete((unsigned int)C);
}


// address=[0x3020cb0]
// Decompiled from void *__cdecl operator new[](unsigned int a1, int a2, char *a3, int a4)
void * __cdecl operator new[](unsigned int a1, class _ConcRTNewMoniker a2, char const * a3, int a4) {
  
  return operator new[](a1, 2, a3, a4);
}


// address=[0x3026ad0]
// Decompiled from int __cdecl operator delete[](void *C)
void __cdecl operator delete[](void * C, class _ConcRTNewMoniker a2, char const * a3, int a4) {
  
  return operator delete[](C);
}


// address=[0x304fcc0]
// Decompiled from void __vcrt_va_start_verify_argument_type<unsigned int>()
void __cdecl __vcrt_va_start_verify_argument_type<unsigned int>(void) {
  
  ;
}


// address=[0x3052640]
// Decompiled from double __cdecl abs(double X)
double __cdecl abs(double X) {
  
  return j__fabs(X);
}


// address=[0x3058710]
// Decompiled from void __vcrt_va_start_verify_argument_type<__int64>()
void __cdecl __vcrt_va_start_verify_argument_type<__int64>(void) {
  
  ;
}


// address=[0x3078a90]
// Decompiled from void *__cdecl _CallCatchBlock2(  struct EHRegistrationNode *a1,  const struct _s_FuncInfo *a2,  void *a3,  int a4,  unsigned int a5)
void * __cdecl _CallCatchBlock2(struct EHRegistrationNode * a1, struct _s_FuncInfo const * a2, void * a3, int a4, unsigned long a5) {
  
  return (void *)_CallSettingFrame(a3, a1, a5);
}


// address=[0x3078b20]
// Decompiled from int __cdecl _CallSETranslator(  struct EHExceptionRecord *a1,  struct EHRegistrationNode *a2,  void *a3,  void *a4,  const struct _s_FuncInfo *a5,  int a6,  struct EHRegistrationNode *a7)
int __cdecl _CallSETranslator(struct EHExceptionRecord * a1, struct EHRegistrationNode * a2, void * a3, void * a4, struct _s_FuncInfo const * a5, int a6, struct EHRegistrationNode * a7) {
  
  int v8; // [esp+0h] [ebp-3Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+4h] [ebp-38h]
  int (__cdecl *v10)(PEXCEPTION_RECORD, PVOID, int); // [esp+8h] [ebp-34h]
  const struct _s_FuncInfo *v11; // [esp+10h] [ebp-2Ch]
  struct EHRegistrationNode *v12; // [esp+14h] [ebp-28h]
  int v13; // [esp+18h] [ebp-24h]
  struct EHRegistrationNode *v14; // [esp+1Ch] [ebp-20h]
  int *v15; // [esp+20h] [ebp-1Ch]
  int *v16; // [esp+24h] [ebp-18h]
  int v17; // [esp+28h] [ebp-14h]
  _DWORD v18[2]; // [esp+2Ch] [ebp-10h] BYREF
  int v19; // [esp+34h] [ebp-8h]
  void (__cdecl *v20)(unsigned int, _DWORD *); // [esp+38h] [ebp-4h]
  int savedregs; // [esp+3Ch] [ebp+0h] BYREF

  if ( a1 == (struct EHExceptionRecord *)291 )
  {
    a2->pNext = (EHRegistrationNode *)&CallSETranslator_::_ExceptionContinuation_6;
    return 1;
  }
  else
  {
    v10 = _TranslatorGuardHandler;
    v11 = a5;
    v12 = a2;
    v13 = a6;
    v14 = a7;
    v17 = 0;
    v15 = &v8;
    v16 = &savedregs;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    v19 = 1;
    v18[0] = a1;
    v18[1] = a3;
    v20 = *(void (__cdecl **)(unsigned int, _DWORD *))(j____vcrt_getptd() + 8);
    v20(a1->ExceptionCode, v18);
    v19 = 0;
    if ( v17 )
      ExceptionList->Next = NtCurrentTeb()->NtTib.ExceptionList->Next;
    return v19;
  }
}


// address=[0x3078c50]
// Decompiled from TryBlockMapEntry *__cdecl _GetRangeOfTrysToCheck(  const struct _s_FuncInfo *a1,  int a2,  int a3,  unsigned int *a4,  unsigned int *a5)
struct _s_TryBlockMapEntry const * __cdecl _GetRangeOfTrysToCheck(struct _s_FuncInfo const * a1, int a2, int a3, unsigned int * a4, unsigned int * a5) {
  
  unsigned int v6; // [esp+0h] [ebp-10h]
  TryBlockMapEntry *pTryBlockMap; // [esp+4h] [ebp-Ch]
  unsigned int v8; // [esp+8h] [ebp-8h]
  unsigned int nTryBlocks; // [esp+Ch] [ebp-4h]
  unsigned int v10; // [esp+Ch] [ebp-4h]

  pTryBlockMap = a1->pTryBlockMap;
  nTryBlocks = a1->nTryBlocks;
  v8 = nTryBlocks;
  v6 = nTryBlocks;
  while ( a2 >= 0 )
  {
    if ( nTryBlocks == -1 )
      j__terminate();
    if ( pTryBlockMap[--nTryBlocks].tryHigh < a3 && a3 <= pTryBlockMap[nTryBlocks].catchHigh || nTryBlocks == -1 )
    {
      --a2;
      v8 = v6;
      v6 = nTryBlocks;
    }
  }
  v10 = nTryBlocks + 1;
  *a4 = v10;
  *a5 = v8;
  if ( v8 > a1->nTryBlocks || v10 > v8 )
    j__terminate();
  return &pTryBlockMap[v10];
}


// address=[0x3078d50]
// Decompiled from void __stdcall _JumpToContinuation(  void (__stdcall *a1)(void *, struct EHRegistrationNode *),  struct EHRegistrationNode *a2)
void __stdcall _JumpToContinuation(void * a1, struct EHRegistrationNode * a2) {
  
  a1(a1, a2);
}


// address=[0x3078d90]
// Decompiled from void __userpurge _UnwindNestedFrames(  struct _EXCEPTION_REGISTRATION_RECORD **a1@<ebx>,  PVOID TargetFrame,  PEXCEPTION_RECORD ExceptionRecord)
void __stdcall _UnwindNestedFrames(struct EHRegistrationNode * a1, struct EHExceptionRecord * TargetFrame) {
  
  RtlUnwind(TargetFrame, &UnwindNestedFrames_::_ReturnPoint_3, ExceptionRecord, 0);
  ExceptionRecord->ExceptionFlags &= ~2u;
  *a1 = NtCurrentTeb()->NtTib.ExceptionList;
}


// address=[0x307cae0]
// Decompiled from void (__cdecl *__cdecl _set_se_translator(int a1))(unsigned int, struct _EXCEPTION_POINTERS *)
void (__cdecl*__cdecl _set_se_translator(int))(unsigned int a1, struct _EXCEPTION_POINTERS * a2) {
  
  if ( a1 )
    return 0;
  else
    return (void (__cdecl *)(unsigned int, struct _EXCEPTION_POINTERS *))j___set_se_translator(0);
}


// address=[0x307dd20]
// Decompiled from int __cdecl _CallMemberFunction0(void *const a1, void *const a2)
void __stdcall _CallMemberFunction0(void * const a1, void * const a2) {
  
  __int32 v3; // [esp-8h] [ebp-8h]
  _UNKNOWN *retaddr; // [esp+0h] [ebp+0h] BYREF

  return ((int (*)(void))_InterlockedExchange((volatile __int32 *)&retaddr, v3))();
}


// address=[0x307dd30]
// Decompiled from int __cdecl _CallMemberFunction1(void *const a1, void *const a2, void *const a3)
void __stdcall _CallMemberFunction1(void * const a1, void * const a2, void * const a3) {
  
  __int32 v4; // [esp-8h] [ebp-8h]
  _UNKNOWN *retaddr; // [esp+0h] [ebp+0h] BYREF

  return ((int (*)(void))_InterlockedExchange((volatile __int32 *)&retaddr, v4))();
}


// address=[0x307dd40]
// Decompiled from int __cdecl _CallMemberFunction2(void *const a1, void *const a2, void *const a3, int a4)
void __stdcall _CallMemberFunction2(void * const a1, void * const a2, void * const a3, int a4) {
  
  __int32 v5; // [esp-8h] [ebp-8h]
  _UNKNOWN *retaddr; // [esp+0h] [ebp+0h] BYREF

  return ((int (*)(void))_InterlockedExchange((volatile __int32 *)&retaddr, v5))();
}


// address=[0x307dd50]
// Decompiled from bool __cdecl _ValidateExecute(int (__stdcall *a1)())
bool __cdecl _ValidateExecute(int (__stdcall*)(void)) {
  
  return a1 != 0;
}


// address=[0x307dd70]
// Decompiled from bool __cdecl _ValidateRead(const void *a1)
bool __cdecl _ValidateRead(void const * a1, unsigned int a2) {
  
  return a1 != 0;
}


// address=[0x307dd90]
// Decompiled from bool __cdecl _ValidateWrite(void *a1)
bool __cdecl _ValidateWrite(void * a1, unsigned int a2) {
  
  return a1 != 0;
}


// address=[0x308a8e0]
// Decompiled from char *__cdecl getStringHelper(char *a1, int a2, char *a3, int a4)
char * __cdecl getStringHelper(char * a1, char * a2, char * a3, int a4) {
  
  if ( a4 > a2 - (int)a1 )
    a4 = a2 - (_DWORD)a1;
  und_memcpy(a1, a3, a4);
  return &a1[a4];
}


// address=[0x30e3180]
// Decompiled from int __cdecl LongLongSub(__int64 a1, __int64 a2, __int64 *a3)
long __cdecl LongLongSub(__int64 a1, __int64 a2, __int64 * a3) {
  
  __int64 v4; // [esp+0h] [ebp-1Ch]

  v4 = a1 - a2;
  if ( a1 < 0 == a2 < 0 || a1 < 0 == v4 < 0 )
  {
    *a3 = v4;
    return 0;
  }
  else
  {
    *(_DWORD *)a3 = -1;
    *((_DWORD *)a3 + 1) = -1;
    return -2147024362;
  }
}


// address=[0x31074e0]
// Decompiled from void __vcrt_va_start_verify_argument_type<int const>()
void __cdecl __vcrt_va_start_verify_argument_type<int const >(void) {
  
  ;
}


// address=[0x310fdf0]
// Decompiled from _PNH __cdecl _set_new_handler(int a1)
int (__cdecl*__cdecl _set_new_handler(int))(unsigned int a1) {
  
  int v1; // ecx
  int (__cdecl *v2)(size_t); // eax
  int v4; // [esp-2h] [ebp-4h] BYREF

  v4 = v1;
  if ( a1
    && j___CrtDbgReportW(
         2,
         (char)L"minkernel\\crts\\ucrt\\src\\appcrt\\heap\\new_handler.cpp",
         49,
         0,
         (wchar_t *)L"%ls",
         (char)L"new_handler == 0") == 1 )
  {
    __debugbreak();
  }
  HIBYTE(v4) = __crt_fast_encode_pointer(0);
  v2 = (int (__cdecl *)(size_t))__crt_fast_encoded_nullptr_t::operator<int __cdecl (unsigned int)> int (__cdecl *)(unsigned int)(
                                  (char *)&v4 + 3,
                                  v4);
  return j___set_new_handler(v2);
}


// address=[0x3112f10]
// Decompiled from char *__cdecl strrchr(char *const Str, int a2)
char * __cdecl strrchr(char * const Str, int a2) {
  
  return j__strrchr(Str, a2);
}


// address=[0x31351a0]
// Decompiled from int *__cdecl _set_daylight(int a1)
void __cdecl _set_daylight(int a1) {
  
  int *result; // eax

  result = j____daylight();
  *result = a1;
  return result;
}


// address=[0x31351c0]
// Decompiled from int *__cdecl _set_dstbias(int a1)
void __cdecl _set_dstbias(long a1) {
  
  int *result; // eax

  result = j____dstbias();
  *result = a1;
  return result;
}


// address=[0x31351e0]
// Decompiled from int *__cdecl _set_timezone(int a1)
void __cdecl _set_timezone(long a1) {
  
  int *result; // eax

  result = j____timezone();
  *result = a1;
  return result;
}


// address=[0x3143ef2]
// Decompiled from char *__cdecl strchr(const char *Str, int Val)
char * __cdecl strchr(char * const Str, int Val) {
  
  return j__strchr(Str, Val);
}


// address=[0x3146c10]
// Decompiled from char *__cdecl strpbrk(char *const Str, char *Control)
char * __cdecl strpbrk(char * const Str, char const * const Control) {
  
  return j__strpbrk(Str, Control);
}


// address=[0x3146c30]
// Decompiled from wchar_t *__cdecl wcspbrk(wchar_t *String, wchar_t *Control)
wchar_t * __cdecl wcspbrk(wchar_t * String, wchar_t const * Control) {
  
  return j__wcspbrk(String, Control);
}


// address=[0x3209fe0]
// Decompiled from int __cdecl _mbsnbcpy<unsigned char *>(unsigned __int8 **a1, unsigned __int8 *Source, size_t Count)
unsigned char * __cdecl _mbsnbcpy<unsigned char *>(unsigned char * const & a1, unsigned char const * Source, unsigned int Count) {
  
  return j____insecure__mbsnbcpy(*a1, Source, Count);
}


// address=[0x320a010]
// Decompiled from int __cdecl _tcsncpy<char *>(int *a1, unsigned __int8 *Source, size_t Count)
char * __cdecl _tcsncpy<char *>(char * & a1, char const * Source, unsigned int Count) {
  
  return j____insecure__tcsncpy(*a1, Source, Count);
}


// address=[0x32126d0]
// Decompiled from int __cdecl _tcsncpy<char *>(int *a1, unsigned __int8 *Source, size_t Count)
char * __cdecl _tcsncpy<char *>(char * const & a1, char const * Source, unsigned int Count) {
  
  return j____insecure__tcsncpy(*a1, Source, Count);
}


// address=[0x3212700]
// Decompiled from int __cdecl wcscpy<wchar_t *>(_DWORD *a1, int a2)
wchar_t * __cdecl wcscpy<wchar_t *>(wchar_t * & a1, wchar_t const * a2) {
  
  return j____insecure_wcscpy(*a1, a2);
}


// address=[0x3212730]
// Decompiled from int __cdecl _tcschr(unsigned __int8 *Str, unsigned int C)
char * __cdecl _tcschr(char * Str, unsigned int C) {
  
  return j___tcschr(Str, C);
}


// address=[0x3212770]
// Decompiled from int __cdecl _tcsrchr(unsigned __int8 *String, unsigned int C)
char * __cdecl _tcsrchr(char * String, unsigned int C) {
  
  return j___tcsrchr(String, C);
}


// address=[0x322c510]
// Decompiled from int __cdecl strcat<char *>(_DWORD *a1, int a2)
char * __cdecl strcat<char *>(char * & a1, char const * a2) {
  
  return j____insecure_strcat(*a1, a2);
}


// address=[0x325dfd0]
// Decompiled from char *__cdecl strcat<260>(char *Destination, char *Source)
char * __cdecl strcat<260>(char (&)[260] Destination, char const * Source) {
  
  if ( j__strcat_s(Destination, 0x104u, Source) )
    return 0;
  else
    return Destination;
}


// address=[0x32c4850]
// Decompiled from char *__cdecl strcat<512>(char *Destination, char *Source)
char * __cdecl strcat<512>(char (&)[512] Destination, char const * Source) {
  
  if ( j__strcat_s(Destination, 0x200u, Source) )
    return 0;
  else
    return Destination;
}


// address=[0x32e4540]
// Decompiled from char *__cdecl strcat<64>(char *Destination, char *Source)
char * __cdecl strcat<64>(char (&)[64] Destination, char const * Source) {
  
  if ( j__strcat_s(Destination, 0x40u, Source) )
    return 0;
  else
    return Destination;
}


// address=[0x335a070]
// Decompiled from unsigned __int8 *__cdecl _tcsncpy<128>(unsigned __int8 *Dst, unsigned __int8 *Src, size_t MaxCount)
char * __cdecl _tcsncpy<128>(char (&)[128] Dst, char const * Src, unsigned int MaxCount) {
  
  if ( j___tcsncpy_s(Dst, 0x80u, Src, MaxCount) )
    return 0;
  else
    return Dst;
}


// address=[0x3425fb0]
// Decompiled from char *__cdecl strcat<1024>(char *Destination, char *Source)
char * __cdecl strcat<1024>(char (&)[1024] Destination, char const * Source) {
  
  if ( j__strcat_s(Destination, 0x400u, Source) )
    return 0;
  else
    return Destination;
}


// address=[0x3679264]
// [Decompilation failed for enum T_AI_TASK_FORCE_CLASS const * const g_tAITaskForceTypeToClassMap]

// address=[0x367b590]
// [Decompilation failed for class IAIWatchTowers * g_pWatchTowers]

// address=[0x36828e0]
// [Decompilation failed for public: static unsigned int const std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >::npos]

// address=[0x36868d4]
// [Decompilation failed for public: static unsigned int const std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> >::npos]

// address=[0x36ab8b0]
// [Decompilation failed for struct SPointF const * const g_sEffectDir16Deltas]

// address=[0x36b6564]
// [Decompilation failed for class CStaticConfigVarInt const * const g_pMagicShieldDmgDecrease256]

// address=[0x36b6568]
// [Decompilation failed for class CStaticConfigVarInt const * const g_pMagicBloodlustDmgIncrease256]

// address=[0x36b656c]
// [Decompilation failed for class CStaticConfigVarInt const * const g_pMagicFasterCropsDecrease256]

// address=[0x36b6570]
// [Decompilation failed for class CStaticConfigVarInt const * const g_pMagicVikingWarmachineShotCost]

// address=[0x36c2644]
// [Decompilation failed for wchar_t const * const DIRECTORY_CD_S4]

// address=[0x36c264c]
// [Decompilation failed for wchar_t const * const FILE_CD_ID]

// address=[0x36c2660]
// [Decompilation failed for wchar_t const * const DIRECTORY_SOUND_USER]

// address=[0x3703ba4]
// [Decompilation failed for char const * const g_szRegKey]

// address=[0x37745a8]
// [Decompilation failed for struct SConfigTypeString const * const asWarningTypeStrings]

// address=[0x37bebf0]
// [Decompilation failed for struct SVehicleDirInfo const * const g_sVehicleDirInfos]

// address=[0x37bec08]
// [Decompilation failed for struct SVehicleDirExInfo const * const g_sVehicleDirExInfos]

// address=[0x37d330c]
// [Decompilation failed for wchar_t const * const NETGAME_INI_NAME]

// address=[0x37d8c08]
// [Decompilation failed for struct SPoint const * const g_sNeighborPoints]

// address=[0x37d8c38]
// [Decompilation failed for struct SPoint const * const g_sNeighborOrthos]

// address=[0x37d8c68]
// [Decompilation failed for struct SPoint const * const g_sSurroundingHexPoints]

// address=[0x37d8d90]
// [Decompilation failed for struct SSurroundingPoint8 const * const g_sSurroundingHexPoints8]

// address=[0x37d98d4]
// [Decompilation failed for int const * const Y16X16::g_iNeighborY16X16Modifiers]

// address=[0x37de3ac]
// [Decompilation failed for class ITiling * g_pTiling]

// address=[0x37f48c8]
// [Decompilation failed for wchar_t const * const SCRIPT_START_RESOURCES_FILE]

// address=[0x3ab9cec]
// [Decompilation failed for char const * const * const BBSupportLib::g_pBBSupportInfoStrings]

// address=[0x3ad3f2c]
// [Decompilation failed for int const * const FieldForRings]

// address=[0x3ad8730]
// [Decompilation failed for __int64 const std::_BADOFF]

// address=[0x3ad93a8]
// [Decompilation failed for public: static unsigned int const std::basic_string<unsigned short,struct std::char_traits<unsigned short>,class std::allocator<unsigned short> >::npos]

// address=[0x3d7a210]
// [Decompilation failed for class IAIDifficultyLevels * g_pAIDifficultyLevels]

// address=[0x3d7a214]
// [Decompilation failed for class IAIEnvironment * g_pAIEnv]

// address=[0x3d7a3d8]
// [Decompilation failed for class IAIMain * g_pAI]

// address=[0x3d7a560]
// [Decompilation failed for class IAIScripting * g_pAIScripting]

// address=[0x3d7a6a8]
// [Decompilation failed for class IAIShaman * g_pAIShaman]

// address=[0x3d7a758]
// [Decompilation failed for int volatile debug]

// address=[0x3d7a764]
// [Decompilation failed for bool g_bDbgIsValidHeapPointer]

// address=[0x3d7aae4]
// [Decompilation failed for struct SResolutionPair * g_pResolutions]

// address=[0x3d7ab28]
// [Decompilation failed for char const * * HACK_STRINGS_ENG]

// address=[0x3d7e738]
// [Decompilation failed for char const * * HACK_STRINGS_GER]

// address=[0x3d82348]
// [Decompilation failed for char const * * HACK_STRINGS_FRE]

// address=[0x3d885bc]
// [Decompilation failed for int g_iCamWndScale]

// address=[0x3d891b0]
// [Decompilation failed for bool g_bIsPrivateSession]

// address=[0x3d891b4]
// [Decompilation failed for int MAX_LISTENTRIES_COUNT]

// address=[0x3d89408]
// [Decompilation failed for wchar_t (* g_szExt)[5]]

// address=[0x3d89490]
// [Decompilation failed for class IDarkTribe * g_pDarkTribe]

// address=[0x3d897c0]
// [Decompilation failed for class CMagic * g_pMagic]

// address=[0x3d897c8]
// [Decompilation failed for class INetInputProcessor * g_pNetInputProcessor]

// address=[0x3d899d0]
// [Decompilation failed for class ICDDrive * g_pCDDrive]

// address=[0x3d899d4]
// [Decompilation failed for class IClipboard * g_pClipboard]

// address=[0x3d89a3c]
// [Decompilation failed for class IErrorMessages * g_pErrorMessages]

// address=[0x3d89a58]
// [Decompilation failed for wchar_t const * * s_pMissionDiskFiles]

// address=[0x3d89a70]
// [Decompilation failed for wchar_t const * * s_pAddOnDiskFiles]

// address=[0x3d89ab4]
// [Decompilation failed for wchar_t const * * s_pMissionDisk2Files]

// address=[0x3d89adc]
// [Decompilation failed for wchar_t const * * s_pMissionDisk3Files]

// address=[0x3d89b30]
// [Decompilation failed for char * * g_pszMapMode]

// address=[0x3d89b4c]
// [Decompilation failed for char * * g_pszGameType]

// address=[0x3d89b6c]
// [Decompilation failed for class IInstallationInfo * g_pInstallationInfo]

// address=[0x3d89b70]
// [Decompilation failed for class IMapCheck * g_pMapCheck]

// address=[0x3d89b74]
// [Decompilation failed for wchar_t * FOUR_ISLES_NAME]

// address=[0x3d89b84]
// [Decompilation failed for unsigned int FOUR_ISLES_CRC2]

// address=[0x3d89b88]
// [Decompilation failed for unsigned int FOUR_ISLES_LEN]

// address=[0x3d89b8c]
// [Decompilation failed for wchar_t * AO_SETTLE1_NAME]

// address=[0x3d89ba4]
// [Decompilation failed for unsigned int AO_SETTLE1_CRC2]

// address=[0x3d89ba8]
// [Decompilation failed for unsigned int AO_SETTLE1_LEN]

// address=[0x3d89bf4]
// [Decompilation failed for class IMessageTracer * g_pMsgTracer]

// address=[0x3d89bf8]
// [Decompilation failed for class IMessageTracer * g_pMsgTracer2]

// address=[0x3d89c00]
// [Decompilation failed for class IRandomMaps * g_pRandomMaps]

// address=[0x3d89c04]
// [Decompilation failed for class IRegistry * g_pRegistry]

// address=[0x3d89c20]
// [Decompilation failed for char const * * aacMusicStyles]

// address=[0x3d8a084]
// [Decompilation failed for unsigned int g_iGameSpeed]

// address=[0x3d8a088]
// [Decompilation failed for wchar_t g_iAutosavePrefix]

// address=[0x3d8a08c]
// [Decompilation failed for wchar_t * MAP_FILE_EXTENSION]

// address=[0x3d8a810]
// [Decompilation failed for char (* g_aszMonthNamesEn)[6]]

// address=[0x3d8a858]
// [Decompilation failed for char (* g_aszMonthNamesDe)[6]]

// address=[0x3d8a968]
// [Decompilation failed for struct SRecruiteNeedDesc (* sRecruiteNeedDesc)[10]]

// address=[0x3d8ae18]
// [Decompilation failed for struct STranslate * g_vSoldierProductionMap]

// address=[0x3d8aeb8]
// [Decompilation failed for struct STranslate * slotMap]

// address=[0x3d8b119]
// [Decompilation failed for bool g_bDbgDisableAdditionalWaterBuildingCheck]

// address=[0x3d8b590]
// [Decompilation failed for struct SSearchData * g_sSearchData]

// address=[0x3d8bb9c]
// [Decompilation failed for class IGroupMgr * g_pGroupMgr]

// address=[0x3d8becc]
// [Decompilation failed for class IHJBMgr * g_pHJBMgr]

// address=[0x3d8bf00]
// [Decompilation failed for int * g_iBackPackCatapultistPercent]

// address=[0x3d8c018]
// [Decompilation failed for class IVehicleInfoMgr * g_pVehicleInfoMgr]

// address=[0x3d8c0c8]
// [Decompilation failed for int COMMUNICATION_TICK_VALUE]

// address=[0x3d8c0e4]
// [Decompilation failed for class IFogging * g_pFogging]

// address=[0x3d8c0e8]
// [Decompilation failed for class CScanner * g_pScanner]

// address=[0x3e2e228]
// [Decompilation failed for int BBSupportLib::g_iBBSDevelopmentFlags]

// address=[0x3e2e22c]
// [Decompilation failed for int BBSupportLib::g_iBBSSupportFlags]

// address=[0x3e2e238]
// [Decompilation failed for int g_iCameraMode]

// address=[0x3e2e23c]
// [Decompilation failed for struct tagRECT g_sMiniMapSize]

// address=[0x3e2e260]
// [Decompilation failed for struct GFX_ENGINE_SETUP GfxEngineSetup]

// address=[0x3e2e328]
// [Decompilation failed for bool s_bCursorIsVisible]

// address=[0x3e2e32c]
// [Decompilation failed for int s_iCurrentCursor]

// address=[0x3e2e330]
// [Decompilation failed for struct _DDCOLORKEY g_sColorKeyMagenta555]

// address=[0x3e2e338]
// [Decompilation failed for struct _DDCOLORKEY g_sColorKeyMagenta565]

// address=[0x3e2e340]
// [Decompilation failed for struct _DDCOLORKEY g_sColorKeyGui]

// address=[0x3e2e378]
// [Decompilation failed for int g_iZoomGradient]

// address=[0x3e2e37c]
// [Decompilation failed for int g_iCamZoomGradient]

// address=[0x3e2e380]
// [Decompilation failed for int g_iZoomInit]

// address=[0x3e2e388]
// [Decompilation failed for struct SGfxObject g_sGfxObjectCursorBuilding]

// address=[0x3e2e700]
// [Decompilation failed for bool g_bRenderSuccess]

// address=[0x3e2e704]
// [Decompilation failed for int g_iFadeYBorder]

// address=[0x3e2e70c]
// [Decompilation failed for float g_fVertexSize]

// address=[0x3e2e710]
// [Decompilation failed for float g_fCamVertexSize]

// address=[0x3e2f130]
// [Decompilation failed for int g_iDialogToIgnore]

// address=[0x3e3133c]
// [Decompilation failed for int g_iPreviewSize]

// address=[0x3e31340]
// [Decompilation failed for unsigned char g_uSnowLimit]

// address=[0x3e519b8]
// [Decompilation failed for char * _PJP_CPP_Copyright]

// address=[0x3e51a50]
// [Decompilation failed for int * _RTC_ErrorLevels]

// address=[0x3e51a70]
// [Decompilation failed for void (__stdcall* __errorPfn)(long,struct IErrorInfo *)]

// address=[0x3e951e8]
// [Decompilation failed for class CAIPlayerEvaluations g_cAIPlayerEvaluations]

// address=[0x3e95500]
// [Decompilation failed for class CAIRegions g_cAIRegions]

// address=[0x3e95804]
// [Decompilation failed for class CAIConfigInt g_cAIDarkTribeCostMushroomFarmer]

// address=[0x3e95810]
// [Decompilation failed for class CAIConfigInt g_cAIDarkTribeCostDarkGardener]

// address=[0x3e9581c]
// [Decompilation failed for class CAIConfigInt g_cAIDarkTribeCostShaman]

// address=[0x3e95828]
// [Decompilation failed for class CAIConfigInt g_cAIDarkTribeCostSwordsman]

// address=[0x3e95834]
// [Decompilation failed for class CAIConfigInt g_cAIDarkTribeCostBowman]

// address=[0x3e95840]
// [Decompilation failed for class CAIConfigInt g_cAIDarkTribeMushroomFarmCreationDelay]

// address=[0x3e97780]
// [Decompilation failed for class CAIResourceMap g_cAIResourceMap]

// address=[0x3ecb830]
// [Decompilation failed for class CAIPlayersScriptVars g_cAIPlayersScriptVars]

// address=[0x3eccd20]
// [Decompilation failed for class CAITaskForces g_cAITaskForces]

// address=[0x3ecd470]
// [Decompilation failed for class CAIDarkTribe * g_pAIDarkTribe]

// address=[0x3ecd500]
// [Decompilation failed for int volatile * volatile DEBUG_FLAGS]

// address=[0x3ecd9d4]
// [Decompilation failed for int g_iDbgTickCounter]

// address=[0x3ecd9d8]
// [Decompilation failed for void * g_pDbgValidHeapPointer]

// address=[0x3ecda58]
// [Decompilation failed for unsigned int g_iApplicationVersionMajor]

// address=[0x3ecda5c]
// [Decompilation failed for unsigned int g_iApplicationVersionMinor]

// address=[0x3ecda60]
// [Decompilation failed for unsigned int g_iApplicationVersionBuild]

// address=[0x3ecda64]
// [Decompilation failed for unsigned int g_iScriptVersion]

// address=[0x3ecda68]
// [Decompilation failed for unsigned int g_iConfigVersion]

// address=[0x3ecda6c]
// [Decompilation failed for unsigned int g_iGfxVersion]

// address=[0x3ecda70]
// [Decompilation failed for struct HWND__ * g_hWnd]

// address=[0x3ecda74]
// [Decompilation failed for struct HINSTANCE__ * g_hInstance]

// address=[0x3ecda78]
// [Decompilation failed for char * g_strTitleEx]

// address=[0x3ecdadc]
// [Decompilation failed for unsigned int g_iFileVersionMS]

// address=[0x3ecdae0]
// [Decompilation failed for char * g_strSerial]

// address=[0x3ecdb44]
// [Decompilation failed for unsigned int g_iFileVersionLS]

// address=[0x3ecdb48]
// [Decompilation failed for char * * g_pArgv]

// address=[0x3ecdb4c]
// [Decompilation failed for unsigned int g_iArgc]

// address=[0x3ecdbe8]
// [Decompilation failed for class CGameData * g_pGameData]

// address=[0x3ecdbf1]
// [Decompilation failed for bool g_bGfxHJBLoadSpecialGfx]

// address=[0x3ecde90]
// [Decompilation failed for class CScrollMultiline s_cAOScrolltext]

// address=[0x3ece818]
// [Decompilation failed for bool g_bGuiSplashInitDone]

// address=[0x3ece820]
// [Decompilation failed for class CScrollMultiline s_cAOSplashScrolltext]

// address=[0x3ecfa3c]
// [Decompilation failed for unsigned short g_uCamWndEntityId]

// address=[0x3ecfa40]
// [Decompilation failed for int g_iCamWndUniqueId]

// address=[0x3ecfa44]
// [Decompilation failed for class IEntity * pCamWndEntity]

// address=[0x3ecfa48]
// [Decompilation failed for int g_iCamWndX]

// address=[0x3ecfa4c]
// [Decompilation failed for int g_iCamWndY]

// address=[0x3ecfa58]
// [Decompilation failed for class CScrollMultiline s_cScrolltext]

// address=[0x3ed0400]
// [Decompilation failed for int s_iMainDeteilStatisticTopOffset]

// address=[0x3ed0404]
// [Decompilation failed for int iItemNumber]

// address=[0x3ed0408]
// [Decompilation failed for struct SDetailStatisticItem * sDetailStatisticList]

// address=[0x3ed2070]
// [Decompilation failed for class CGuiChatMsgList s_cMsgLst]

// address=[0x3eddca0]
// [Decompilation failed for int s_iMainLoadTopOffset]

// address=[0x3eddcb0]
// [Decompilation failed for unsigned char g_uiExtrasAllowed]

// address=[0x3eddcb1]
// [Decompilation failed for bool g_bNewTextures]

// address=[0x3eddcb4]
// [Decompilation failed for int g_iMapListTopOffset]

// address=[0x3eddd04]
// [Decompilation failed for std::string g_iMessageBoxStringID]

// address=[0x3eddd28]
// [Decompilation failed for struct CONTROL (* aControls)[16]]

// address=[0x3ede628]
// [Decompilation failed for int iStatus]

// address=[0x3ede800]
// [Decompilation failed for class CScrollMultiline s_cMD2Scrolltext]

// address=[0x3edf188]
// [Decompilation failed for class CScrollMultiline s_cMDScrolltext]

// address=[0x3edfb50]
// [Decompilation failed for class CGuiMsgList s_cMsgLst]

// address=[0x3efd446]
// [Decompilation failed for bool g_bOpenSidebar]

// address=[0x3efd620]
// [Decompilation failed for class CScrollMultiline s_cXMD3Scrolltext]

// address=[0x3efdfa8]
// [Decompilation failed for private: static class cdm_crc::CRCGenerator<16,32773,0,0,1,1>::CRCTable const cdm_crc::CRCGenerator<16,32773,0,0,1,1>::Table]

// address=[0x3efe4c0]
// [Decompilation failed for class CAttackMsgList g_cAttackMsgList]

// address=[0x3efeb30]
// [Decompilation failed for class CEcoSectorMgr g_cESMgr]

// address=[0x3f122c8]
// [Decompilation failed for class CEndStatistic g_cEndStatistic]

// address=[0x3f1e498]
// [Decompilation failed for class CInfoExchangeEx g_cInfoExchange]

// address=[0x3f1e4a0]
// [Decompilation failed for class CInfoExchangeInt g_cInfoExchangeInt]

// address=[0x3f1e4ac]
// [Decompilation failed for class CBuildingInfoEx g_cBuildingInfo]

// address=[0x3f1e4c0]
// [Decompilation failed for class CBuildingSiteInfo g_cBuildingSiteInfo]

// address=[0x3f1e4e4]
// [Decompilation failed for class CResourceCollectorInfo g_cResourceCollectorInfo]

// address=[0x3f1e4fc]
// [Decompilation failed for class CResourceUpgradeInfo g_cResourceUpgradeInfo]

// address=[0x3f1e530]
// [Decompilation failed for class CMilitaryBuildingInfo g_cMilitaryBuildingInfo]

// address=[0x3f1e56c]
// [Decompilation failed for class CPortInfo g_cPortInfo]

// address=[0x3f1e5a0]
// [Decompilation failed for class CStorageInfo g_cStorageInfo]

// address=[0x3f1e5c8]
// [Decompilation failed for class CSmallTempleInfo g_cSmallTempleInfo]

// address=[0x3f1e5e4]
// [Decompilation failed for class CBarracksInfo g_cBarracksInfo]

// address=[0x3f1e604]
// [Decompilation failed for class CVehicleProductionInfo g_cVehicleProductionInfo]

// address=[0x3f1e62c]
// [Decompilation failed for class CExtendedMenuInfo g_cExtendedMenuInfo]

// address=[0x3f1e660]
// [Decompilation failed for class CSoldierInfo g_cSoldierInfo]

// address=[0x3f1e6f8]
// [Decompilation failed for class CSpecialistsInfo g_cSpecialistsInfo]

// address=[0x3f1e73c]
// [Decompilation failed for class CVehicleInfo g_cVehicleInfo]

// address=[0x3f1e75c]
// [Decompilation failed for class CGroupSideBarInfo g_cGroupSideBarInfo]

// address=[0x3f1e788]
// [Decompilation failed for class CVehicleLoadInfo g_cVehicleLoadInfo]

// address=[0x3f1e88c]
// [Decompilation failed for class CFerryLoadInfo g_cFerryLoadInfo]

// address=[0x3f1e8c4]
// [Decompilation failed for class CWeaponSideBarInfo g_cWeaponSideBarInfo]

// address=[0x3f1e900]
// [Decompilation failed for struct SBuildingMenu g_sBuildingMenu]

// address=[0x3f1e9ac]
// [Decompilation failed for class CPortGoodsOutBarInfo g_cPortGoodsOutBarInfo]

// address=[0x3f1e9e0]
// [Decompilation failed for class CSettlerStatisticInfo g_cSettlerStatisticInfo]

// address=[0x3f1eb28]
// [Decompilation failed for class CSettlerProductionInfo g_cSettlerProductionInfo]

// address=[0x3f1ebc8]
// [Decompilation failed for class CFreeCarrierInfo g_cFreeCarrierInfo]

// address=[0x3f1ec00]
// [Decompilation failed for class CGoodsStatisticInfo g_cGoodsStatisticInfo]

// address=[0x3f1ed64]
// [Decompilation failed for class CPortGoodsTradeBarInfo g_cPortTradeBarInfo]

// address=[0x3f1eda0]
// [Decompilation failed for class CTransportpriorityInfo g_cTransportpriorityInfo]

// address=[0x3f1ee28]
// [Decompilation failed for class CGoodDistributionInfo g_cGoodDistributionInfo]

// address=[0x3f1ee6c]
// [Decompilation failed for class CAddVehicleBarInfo g_cVehicleSideBarInfo]

// address=[0x3f1ee80]
// [Decompilation failed for class CEconomyGameInfo g_cEconomyGameInfo]

// address=[0x3f1eee0]
// [Decompilation failed for class CMagicSpellSideBarInfo g_cMagicSpellSideBarInfo]

// address=[0x3f1ef68]
// [Decompilation failed for class CAddSoldierSideBarInfo g_cAddSoldierSideBarInfo]

// address=[0x3f1ef80]
// [Decompilation failed for class CAddToolSideBarInfo g_cAddToolSideBarInfo]

// address=[0x3f1ef90]
// [Decompilation failed for class CEyeCatcherBarInfo g_cEyeCatcherBarInfo]

// address=[0x3f1f058]
// [Decompilation failed for class CStorageSideBarInfo g_cStorageSideBarInfo]

// address=[0x3f1f648]
// [Decompilation failed for class CInputProcessor g_cInputProcessor]

// address=[0x3f1f7d0]
// [Decompilation failed for double lastTime]

// address=[0x3f1f7d8]
// [Decompilation failed for class CPerformanceCounter cTimer]

// address=[0x3f20328]
// [Decompilation failed for class CStatistic g_cStatistic]

// address=[0x3f2bca0]
// [Decompilation failed for class CStatisticArchive g_cStatisticArchive]

// address=[0x3f44ac8]
// [Decompilation failed for class CTutorial g_cTutorial]

// address=[0x3f450a0]
// [Decompilation failed for class IExtraCD * g_pMissionCD]

// address=[0x3f450a4]
// [Decompilation failed for class IExtraCD * g_pAddOn]

// address=[0x3f450a8]
// [Decompilation failed for class IExtraCD * g_pMissionCD2]

// address=[0x3f450ac]
// [Decompilation failed for class IExtraCD * g_pMissionCD3]

// address=[0x3f450c0]
// [Decompilation failed for unsigned int g_iAITicks]

// address=[0x3f450c4]
// [Decompilation failed for unsigned int g_iLogicTicks]

// address=[0x3f450c8]
// [Decompilation failed for unsigned int g_iTilingTicks]

// address=[0x3f450cc]
// [Decompilation failed for unsigned int g_iScriptingTicks]

// address=[0x3f450d0]
// [Decompilation failed for unsigned int g_iAnimalTicks]

// address=[0x3f455f0]
// [Decompilation failed for class IGfxEngine * g_pGfxEngine]

// address=[0x3f455f4]
// [Decompilation failed for class IRTComp * g_pRTComp]

// address=[0x3f45628]
// [Decompilation failed for class CGfxManager * g_pGfxManager]

// address=[0x402bdc0]
// [Decompilation failed for class CPlayerManager g_cPlayerMgr]

// address=[0x402c930]
// [Decompilation failed for int g_iAOSplashType]

// address=[0x402c978]
// [Decompilation failed for class CBriefingSettings g_cBriefingSettings]

// address=[0x402cbb8]
// [Decompilation failed for class CCampaignSettings g_cCampaignSettings]

// address=[0x402cc54]
// [Decompilation failed for int iScreenFlag]

// address=[0x402cc60]
// [Decompilation failed for char * g_szBugReportText]

// address=[0x402ec60]
// [Decompilation failed for bool g_bBugReportScreenshot]

// address=[0x402ec68]
// [Decompilation failed for union _LARGE_INTEGER g_lFrequency]

// address=[0x402ec70]
// [Decompilation failed for class CGameType * g_pGameType]

// address=[0x4030370]
// [Decompilation failed for class CSaveGameContext g_cSaveGameContext]

// address=[0x4030710]
// [Decompilation failed for class CLanLobbyConnect g_cLobbyConnectInfo]

// address=[0x40307c8]
// [Decompilation failed for class CLanLobbyGameSettings g_cLobbyGameInfo]

// address=[0x4031910]
// [Decompilation failed for class CLanLobbyMapSettings g_cLobbyMapInfo]

// address=[0x4031cf8]
// [Decompilation failed for class CLocalTypeSettings g_cLocalTypeSettings]

// address=[0x4031d10]
// [Decompilation failed for char * g_pDialogData]

// address=[0x4031f80]
// [Decompilation failed for struct SRandomMapParams g_sRMP]

// address=[0x40320b8]
// [Decompilation failed for class CTutorialSettings g_cTutorialStatus]

// address=[0x403212c]
// [Decompilation failed for int g_iVictoryScreenCampaignType]

// address=[0x4032238]
// [Decompilation failed for class CTextMsgHandler g_cTextMsgHandler]

// address=[0x4032ee0]
// [Decompilation failed for class CAnimalMgr g_cAnimalMgr]

// address=[0x4035298]
// [Decompilation failed for class CBuildingInfoMgr g_cBuildingInfoMgr]

// address=[0x409cae0]
// [Decompilation failed for class CBuildingMgr g_cBuildingMgr]

// address=[0x40f2320]
// [Decompilation failed for class CDecoObjMgr g_cDecoObjMgr]

// address=[0x40ff380]
// [Decompilation failed for class CFlyingMgr g_cFlyingMgr]

// address=[0x415205c]
// [Decompilation failed for class CPileMgr g_cPileMgr]

// address=[0x41521dc]
// [Decompilation failed for unsigned int g_uSaboteurHitChange]

// address=[0x41521e0]
// [Decompilation failed for class CSettlerMgr g_cSettlerMgr]

// address=[0x4157a68]
// [Decompilation failed for int * g_iBlowgunWarriorFreezeChange]

// address=[0x4158d00]
// [Decompilation failed for class CVehicleMgr g_cVehicleMgr]

// address=[0x415ad38]
// [Decompilation failed for int Version]

// address=[0x415b804]
// [Decompilation failed for class CStaticConfigVarInt g_iNetClientTimeOut]

// address=[0x415b810]
// [Decompilation failed for class CStaticConfigVarInt g_iNetSearchHostRetries]

// address=[0x415b81c]
// [Decompilation failed for class CStaticConfigVarInt g_iNetSenderPort]

// address=[0x415b828]
// [Decompilation failed for class CStaticConfigVarInt g_iNetReceiverPort]

// address=[0x415b834]
// [Decompilation failed for class CStaticConfigVarInt g_iNotReadyWarnDelay]

// address=[0x415b840]
// [Decompilation failed for class CStaticConfigVarInt g_iNotReadyWarnAgainDelay]

// address=[0x415b84c]
// [Decompilation failed for class CStaticConfigVarInt g_iNotReadyKickDelay]

// address=[0x415b858]
// [Decompilation failed for class CStaticConfigVarInt g_iNotReadyGameStartTimeout]

// address=[0x415b864]
// [Decompilation failed for class CStaticConfigVarInt g_iNetworkTimeDelta]

// address=[0x415b870]
// [Decompilation failed for class CStaticConfigVarInt g_iNetAfterLobbyConnectTimeout]

// address=[0x415b87c]
// [Decompilation failed for class CStaticConfigVarInt g_iNetClientWaitingStartTick]

// address=[0x415b888]
// [Decompilation failed for class CStaticConfigVarInt g_iHostWaitAfterLobbyForClientsTimeout]

// address=[0x415b894]
// [Decompilation failed for class CStaticConfigVarInt g_iResendTimeout]

// address=[0x415b8a0]
// [Decompilation failed for class CStaticConfigVarInt g_iPingGood]

// address=[0x415b8ac]
// [Decompilation failed for class CStaticConfigVarInt g_iPingAverage]

// address=[0x415b8b8]
// [Decompilation failed for class CStaticConfigVarInt g_iSaveingTimeout]

// address=[0x415c3b0]
// [Decompilation failed for class CAlliances g_cAlliances]

// address=[0x415c768]
// [Decompilation failed for class CAStarTiling g_cAStarTiling]

// address=[0x415c778]
// [Decompilation failed for class CAStar64Normal g_cAStar64Normal]

// address=[0x415c77c]
// [Decompilation failed for class CAStar64Worker g_cAStar64Worker]

// address=[0x415c780]
// [Decompilation failed for class CAStar64Catapult g_cAStar64Catapult]

// address=[0x415c784]
// [Decompilation failed for class CAStar64Ship g_cAStar64Ship]

// address=[0x41799e8]
// [Decompilation failed for class CInfluMap g_cInfluMap]

// address=[0x418fe58]
// [Decompilation failed for class COwnerMapEx g_cOwnerMap]

// address=[0x45b2048]
// [Decompilation failed for class CWarMap g_cWarMap]

// address=[0x4617a98]
// [Decompilation failed for class CShipMap g_cShipMap]

// address=[0x4617a99]
// [Decompilation failed for class CWaterFlags g_cWaterFlags]

// address=[0x46282b0]
// [Decompilation failed for class CWater g_cWater]

// address=[0x462b784]
// [Decompilation failed for unsigned int g_uDbgTickCounter]

// address=[0x462b788]
// [Decompilation failed for class CSoundManager * g_pSoundManager]

// address=[0x462b78c]
// [Decompilation failed for class CMapObjectMgr * g_pMapObjectMgr]

// address=[0x462b790]
// [Decompilation failed for class CStateGame * g_pGame]

// address=[0x462b794]
// [Decompilation failed for class IGuiEngine * g_pGUIEngine]

// address=[0x462b798]
// [Decompilation failed for class ISoundEngine * g_pSoundEngine]

// address=[0x462b79c]
// [Decompilation failed for class IVideoEngine * g_pVideoEngine]

// address=[0x462b7a0]
// [Decompilation failed for class CStringEngine * g_pStringEngine]

// address=[0x462b7a4]
// [Decompilation failed for class CEntityToDoListMgr * g_pEntityToDoListMgr]

// address=[0x462b7a8]
// [Decompilation failed for class CLogic * g_pLogic]

// address=[0x462b7ac]
// [Decompilation failed for class CGuiEventHandler * g_pGuiMainEvents]

// address=[0x462b7b0]
// [Decompilation failed for class INetworkEngine * g_pNetworkEngine]

// address=[0x462b7b4]
// [Decompilation failed for class IConfigManager * g_pCfgMgr]

// address=[0x462b828]
// [Decompilation failed for class CGameScriptManager * g_pScriptMgr]

// address=[0x462b830]
// [Decompilation failed for int iType]

// address=[0x462b834]
// [Decompilation failed for char * pszTypeString]

// address=[0x462bcd4]
// [Decompilation failed for class CBinkInterface * g_pVideo]

// address=[0x462c858]
// [Decompilation failed for class CWorldManager g_cWorld]

// address=[0x462c860]
// [Decompilation failed for class CLandscapeProperties g_cLandscapeProperties]

// address=[0x462cc1d]
// [Decompilation failed for char JobRequestPrimaryStoreItemsCatalog_BF::dummy]

// address=[0x462cc1e]
// [Decompilation failed for char JobRequestPrimaryStoreInventory_BF::dummy]

// address=[0x46549e8]
// [Decompilation failed for bool SIMPL_NS::g_memoryLeakAtShutdown]

// address=[0x46549e9]
// [Decompilation failed for bool SIMPL_NS::g_memoryCorruption]

// address=[0x46549f0]
// [Decompilation failed for unsigned __int64 SIMPL_NS::g_allocations_current]

// address=[0x46549f8]
// [Decompilation failed for unsigned __int64 SIMPL_NS::g_allocations_total_count]

// address=[0x4654a00]
// [Decompilation failed for unsigned __int64 SIMPL_NS::g_allocations_total_size]

// address=[0x4654c48]
// [Decompilation failed for unsigned __int64 g_InitCount]

// address=[0x4654ce8]
// [Decompilation failed for unsigned __int64 g_EalToFAPTimeFactor]

// address=[0x46851a9]
// [Decompilation failed for class CConfigManagerPtr g_cConfigManagerPtr]

// address=[0x46853c8]
// [Decompilation failed for class CFileLibrary g_cFileLibrary]

// address=[0x46856dc]
// [Decompilation failed for class std::map<std::string,char,struct std::less<std::string >,class std::allocator<struct std::pair<std::string const ,char> > > AdvXMLParser::s_mapReferences]

// address=[0x46869b0]
// [Decompilation failed for class CFileMgr g_cFileMgr]

// address=[0x4686d50]
// [Decompilation failed for class BBSupportLib::CBBSupportTraceFilePtr BBSupportLib::g_pBBSTraceFile]

// address=[0x4687114]
// [Decompilation failed for int BBSupportLib::g_iBBSErrorhandlingMode]

// address=[0x4687118]
// [Decompilation failed for int BBSupportLib::g_iBBSIsDevelopmentMachine]

// address=[0x468711c]
// [Decompilation failed for int BBSupportLib::g_iBBSDeveloperErrorHandling]

// address=[0x468719c]
// [Decompilation failed for class IConfigManager * l_pCfgMgr]

// address=[0x4689a68]
// [Decompilation failed for unsigned int * g_pTickCounter]

// address=[0x4689a6c]
// [Decompilation failed for bool g_bExclusive]

// address=[0x4689a70]
// [Decompilation failed for void * g_pDirectDraw]

// address=[0x4689a74]
// [Decompilation failed for int g_iTextTmpPosX]

// address=[0x4689a78]
// [Decompilation failed for char * g_cTextTmp]

// address=[0x4689b78]
// [Decompilation failed for int g_iTextTmpPosY]

// address=[0x4689b7c]
// [Decompilation failed for int g_iTextTmpWidth]

// address=[0x4689b80]
// [Decompilation failed for int g_iTextTmpHeight]

// address=[0x4689b84]
// [Decompilation failed for int g_iTextTmpColor]

// address=[0x4689b88]
// [Decompilation failed for int g_iRefreshWaitFrames]

// address=[0x4689b8c]
// [Decompilation failed for struct tagRECT g_sMiniMapRect]

// address=[0x4689be0]
// [Decompilation failed for class CInterfaceD3D * D3DObjectPtr]

// address=[0x4689be4]
// [Decompilation failed for void * g_pBorderstonePalette]

// address=[0x4689be8]
// [Decompilation failed for void * * g_pWavePalettes]

// address=[0x4689c30]
// [Decompilation failed for void * * g_pWaveGfx]

// address=[0x468a1d0]
// [Decompilation failed for void * * g_pBorderstoneGfx]

// address=[0x468a1f4]
// [Decompilation failed for unsigned char * g_uWaveFrames]

// address=[0x468a206]
// [Decompilation failed for unsigned char g_uBorderstoneFrames]

// address=[0x468a207]
// [Decompilation failed for bool s_bCursorIsFixed]

// address=[0x468a208]
// [Decompilation failed for int * g_iWaveIndices]

// address=[0x468a250]
// [Decompilation failed for int g_iBorderstoneIndices]

// address=[0x468a254]
// [Decompilation failed for struct HICON__ * s_hCursor]

// address=[0x468a258]
// [Decompilation failed for struct HICON__ * * s_hCursorHandles]

// address=[0x468a2e8]
// [Decompilation failed for struct _DDCOLORKEY g_sColorKeyBlack]

// address=[0x468a2f0]
// [Decompilation failed for void * (__cdecl* g_pfForceReload)(int,bool,bool)]

// address=[0x468a2f8]
// [Decompilation failed for class CBlitFX g_cBlitFX]

// address=[0x468a5e0]
// [Decompilation failed for unsigned short * g_uColorPalette]

// address=[0x468a7e0]
// [Decompilation failed for void * g_pRenderAdress]

// address=[0x468a7e4]
// [Decompilation failed for void * g_pBeginOfRenderBuffer]

// address=[0x468a7e8]
// [Decompilation failed for void * g_pEndOfRenderBuffer]

// address=[0x468a7ec]
// [Decompilation failed for int g_iRenderPitch]

// address=[0x468a7f0]
// [Decompilation failed for int g_iScanlineLength]

// address=[0x468a7f4]
// [Decompilation failed for int * g_pPreCalculatedGradients]

// address=[0x468a7f8]
// [Decompilation failed for int * g_iDestSizeTable]

// address=[0x468aff8]
// [Decompilation failed for int * g_iCamDestSizeTable]

// address=[0x468b7f8]
// [Decompilation failed for int * g_pDestSizeTable]

// address=[0x468b7fc]
// [Decompilation failed for int * g_pZoomGradient]

// address=[0x468b800]
// [Decompilation failed for bool (__cdecl* g_pfBlitSettler)(int,int,int,struct SGfxObjectInfo *)]

// address=[0x468b804]
// [Decompilation failed for bool (__cdecl* g_pfBlitObject)(int,int,int,struct SGfxObjectInfo *)]

// address=[0x468b808]
// [Decompilation failed for bool (__cdecl* g_pfBlitVehicle)(int,int,int,struct SGfxObjectInfo *)]

// address=[0x468b80c]
// [Decompilation failed for bool (__cdecl* g_pfBlitBuilding)(int,int,int,struct SGfxObjectInfo *,int *,int &)]

// address=[0x468b810]
// [Decompilation failed for bool (__cdecl* g_pfBlitBorderstone)(int,int,int,int)]

// address=[0x468b814]
// [Decompilation failed for bool (__cdecl* g_pfBlitAccessoryIcon)(int,int,int,int)]

// address=[0x468b818]
// [Decompilation failed for bool (__cdecl* g_pfBlitWave)(int,int,int,int,int)]

// address=[0x468b81c]
// [Decompilation failed for void * g_pIconPalette]

// address=[0x468b820]
// [Decompilation failed for void * * g_pIconGfx]

// address=[0x468bc20]
// [Decompilation failed for int (* g_iSettlerSelections)[3]]

// address=[0x468c0dc]
// [Decompilation failed for int g_iSettlerSelectionCounter]

// address=[0x468c0e0]
// [Decompilation failed for int (* g_iSettlerFitness)[5]]

// address=[0x468c8c4]
// [Decompilation failed for int g_iSettlerFitnessCounter]

// address=[0x468c8c8]
// [Decompilation failed for int (* g_iSettlerMagic)[5]]

// address=[0x468d0ac]
// [Decompilation failed for int g_iSettlerMagicCounter]

// address=[0x468d0b0]
// [Decompilation failed for struct SGfxObjectInfo * (__cdecl* g_pfGetGfxObjectInfo)(unsigned int,int)]

// address=[0x468d0b4]
// [Decompilation failed for void (__cdecl* g_pfSetNumberOfNextLine)(int)]

// address=[0x468d0b8]
// [Decompilation failed for unsigned char (__cdecl* g_pfGetIconObjectByX)(int)]

// address=[0x468d0bc]
// [Decompilation failed for int (__cdecl* g_pfGetOwnerID)(int)]

// address=[0x468d0c0]
// [Decompilation failed for class IGfxEffects * s_pEffectSystem]

// address=[0x468d0c8]
// [Decompilation failed for class CColorGradient g_cColorGradient]

// address=[0x468e3a8]
// [Decompilation failed for int g_iMapSize]

// address=[0x468e3ac]
// [Decompilation failed for unsigned char * g_pLuminanceTablesMemory]

// address=[0x468e3b0]
// [Decompilation failed for unsigned char * g_pLuminanceTablesStart]

// address=[0x468e3bc]
// [Decompilation failed for unsigned char * CurrentTexturePagePtr]

// address=[0x468e3c0]
// [Decompilation failed for unsigned char * * g_pTextureTable]

// address=[0x468e470]
// [Decompilation failed for unsigned char (* g_uColorPalettes)[768]]

// address=[0x4696870]
// [Decompilation failed for unsigned char * g_pSoftwareTexturePages]

// address=[0x4696874]
// [Decompilation failed for bool g_bRiverMouth]

// address=[0x4696875]
// [Decompilation failed for bool g_bHalfLine]

// address=[0x4696876]
// [Decompilation failed for bool g_bSplitTriangle]

// address=[0x4696878]
// [Decompilation failed for struct TRIANGLE_CROSSING (* PatternTripleVertices)[4][6]]

// address=[0x4697178]
// [Decompilation failed for unsigned char * g_uMaxYTable]

// address=[0x4697578]
// [Decompilation failed for int g_iLastUsedPage]

// address=[0x469757c]
// [Decompilation failed for float g_fPatternSuboffsetX]

// address=[0x4697580]
// [Decompilation failed for float g_fPatternSuboffsetY]

// address=[0x4697584]
// [Decompilation failed for int s_iDarkTribeElement]

// address=[0x4697588]
// [Decompilation failed for int g_iFogFadeStep]

// address=[0x469758c]
// [Decompilation failed for int g_iUsedFogFadeStep]

// address=[0x4697590]
// [Decompilation failed for class CHeightAndTypeTable g_cHeightAndTypeTable]

// address=[0x46c169c]
// [Decompilation failed for int s_iObjectOffsetX]

// address=[0x46c1ea4]
// [Decompilation failed for int s_iObjectOffsetY]

// address=[0x46c1ea8]
// [Decompilation failed for class CBlitFX s_cBlitFx]

// address=[0x46c6710]
// [Decompilation failed for class CSurfaceDescription s_cSurfaceDescription]

// address=[0x46c67f8]
// [Decompilation failed for class CBlitFX s_cBlitFxAlpha]

// address=[0x46c6860]
// [Decompilation failed for class CBlitFX s_cBlitFxAlphaDebug]

// address=[0x46c7e50]
// [Decompilation failed for struct SGfxColor * (__cdecl* g_pfGetGfxMiniMapColor)(unsigned int)]

// address=[0x46c7e58]
// [Decompilation failed for class CLandscapeColorProperties g_cLandscapeColorProperties]

// address=[0x46f32d0]
// [Decompilation failed for class CCacheManager g_cCacheManager]

// address=[0x471f790]
// [Decompilation failed for struct GUI_MENU_FILE_HEADER * g_pFileHeader]

// address=[0x471f79c]
// [Decompilation failed for int * g_iOpenDialogs]

// address=[0x471f7d4]
// [Decompilation failed for bool (__cdecl** g_pfDialogCallbacks)(int,int,int)]

// address=[0x471f80c]
// [Decompilation failed for struct SGuiControl * g_pCurrentSelectedControl]

// address=[0x471f810]
// [Decompilation failed for struct SGuiControl * g_pCurrentDragControl]

// address=[0x471f814]
// [Decompilation failed for struct SGuiControl * g_pCurrentEditControl]

// address=[0x471f818]
// [Decompilation failed for struct SGuiControl * g_pCurrentRepeatControl]

// address=[0x471f820]
// [Decompilation failed for int * g_iEditWidthTable]

// address=[0x471fcd0]
// [Decompilation failed for char (* g_mbstrTextTable)[300]]

// address=[0x4725a90]
// [Decompilation failed for bool * g_bUsedTexts]

// address=[0x4726ec8]
// [Decompilation failed for struct HFONT__ * * g_hFonts]

// address=[0x4726f14]
// [Decompilation failed for bool g_bDisableEvents]

// address=[0x4726f15]
// [Decompilation failed for bool g_bGuiIsDirty]

// address=[0x4726f18]
// [Decompilation failed for bool (__cdecl* g_pfSetEnableStatus)(int,int,int,bool,int)]

// address=[0x4726f1c]
// [Decompilation failed for int g_iAlignMode]

// address=[0x4726f20]
// [Decompilation failed for unsigned short * g_uShadeTable1]

// address=[0x4726f40]
// [Decompilation failed for unsigned short * g_uShadeTable2]

// address=[0x4726f60]
// [Decompilation failed for int g_iStdShadeColor]

// address=[0x4726f64]
// [Decompilation failed for int g_iLeftShadeColor]

// address=[0x4726f68]
// [Decompilation failed for int g_iRightShadeColor]

// address=[0x4726f90]
// [Decompilation failed for class CToolTip g_cToolTip]

// address=[0x47270e8]
// [Decompilation failed for class CToolTipExt g_cToolTipExt]

// address=[0x4727558]
// [Decompilation failed for struct EDITOR_INFO g_sEditorInfo]

// address=[0x472756c]
// [Decompilation failed for struct SEditorGlobalMapData g_sGeneralMapData]

// address=[0x4727584]
// [Decompilation failed for bool g_bMapIsLoaded]

// address=[0x4727588]
// [Decompilation failed for short * g_pPreviewGfx]

// address=[0x472758c]
// [Decompilation failed for char * g_pTextDescription]

// address=[0x4727590]
// [Decompilation failed for char * g_pTextTandT]

// address=[0x4727594]
// [Decompilation failed for char * g_pTextEnglishDescription]

// address=[0x4727598]
// [Decompilation failed for char * g_pTextEnglishTandT]

// address=[0x472759c]
// [Decompilation failed for int g_bEditorMap]

// address=[0x47275a0]
// [Decompilation failed for int g_bAddOnMap]

// address=[0x47275a4]
// [Decompilation failed for int g_bCampaign]

// address=[0x47275a8]
// [Decompilation failed for int g_bSettlersAvailable]

// address=[0x47275ac]
// [Decompilation failed for int g_bBuildingsAvailable]

// address=[0x47275b0]
// [Decompilation failed for int g_bPilesAvailable]

// address=[0x47275b8]
// [Decompilation failed for class CPlayerData g_cPlayerAndTeamData]

// address=[0x47279d4]
// [Decompilation failed for struct T_GFX_MAP_ELEMENT * g_pMapElement]

// address=[0x47279d8]
// [Decompilation failed for int g_iWorldSize]

// address=[0x47279dc]
// [Decompilation failed for struct SEditorElementMap * g_pEditorLayer]

// address=[0x47279e0]
// [Decompilation failed for class IMapGeneratorHost * g_pHost]

// address=[0x47279e4]
// [Decompilation failed for float g_fScaleFactor]

// address=[0x47279e8]
// [Decompilation failed for unsigned char g_uResourceWealth]

// address=[0x47279e9]
// [Decompilation failed for unsigned char g_iNumPlayers]

// address=[0x47279ea]
// [Decompilation failed for bool g_bNoObjects]

// address=[0x47279ec]
// [Decompilation failed for class CPlayerData * * g_pPlayerData]

// address=[0x47279f0]
// [Decompilation failed for class CBasicGrid * g_pBasicGrid]

// address=[0x47279f4]
// [Decompilation failed for class CFeatureGrid * g_pFeatureGrid]

// address=[0x47279f8]
// [Decompilation failed for int g_iLandMassPercent]

// address=[0x47279fc]
// [Decompilation failed for int g_iFlags]

// address=[0x4727a00]
// [Decompilation failed for unsigned short * g_pPreviewImage]

// address=[0x4727a04]
// [Decompilation failed for int g_iPreviewImageSize]

// address=[0x4727a08]
// [Decompilation failed for class CRandom16Ex * g_pRand]

// address=[0x4727a0c]
// [Decompilation failed for int g_iNumRivers]

// address=[0x4727a10]
// [Decompilation failed for class CCheckLayer * g_pCheckLayer]

// address=[0x4727a14]
// [Decompilation failed for int g_iRandomSeed]

// address=[0x4731050]
// [Decompilation failed for class CRTComp * pTheRTComp]

// address=[0x4731054]
// [Decompilation failed for void * hRTComHandle]

// address=[0x4731068]
// [Decompilation failed for class IEventEngine * g_pEvnEngine]

// address=[0x473106c]
// [Decompilation failed for class CVC_EventHandle g_cVC_EventHandle]

// address=[0x4731078]
// [Decompilation failed for class CSoundSystem * g_pcSoundSystem]

// address=[0x473107c]
// [Decompilation failed for class CVoiceChat * g_pcVoiceChat]

// address=[0x4731081]
// [Decompilation failed for class CSpiralOffsets g_cSpiralOffsets]

// address=[0x47311af]
// [Decompilation failed for struct std::nothrow_t const std::nothrow]

// address=[0x47311f4]
// [Decompilation failed for enum __stl_sync_api_modes_enum __stl_sync_api_impl_mode]

// address=[0x4731210]
// [Decompilation failed for std::ostream std::cout]

// address=[0x4731348]
// [Decompilation failed for std::istream std::cin]

// address=[0x47313d0]
// [Decompilation failed for std::istream * std::_Ptr_cin]

// address=[0x47313d4]
// [Decompilation failed for std::ostream * std::_Ptr_cout]

// address=[0x47313d8]
// [Decompilation failed for std::ostream * std::_Ptr_cerr]

// address=[0x47313dc]
// [Decompilation failed for std::ostream * std::_Ptr_clog]

// address=[0x47313e0]
// [Decompilation failed for std::wistream * std::_Ptr_wcin]

// address=[0x47313e4]
// [Decompilation failed for std::wostream * std::_Ptr_wcout]

// address=[0x47313e8]
// [Decompilation failed for std::wostream * std::_Ptr_wcerr]

// address=[0x47313ec]
// [Decompilation failed for std::wostream * std::_Ptr_wclog]

// address=[0x4731df4]
// [Decompilation failed for void * (__stdcall* g_OutOfMemoryExceptionCallback)(void)]

